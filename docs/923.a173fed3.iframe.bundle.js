/*! For license information please see 923.a173fed3.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkweb_components_repo=self.webpackChunkweb_components_repo||[]).push([[923],{"./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}__webpack_require__.d(__webpack_exports__,{A:()=>_objectWithoutPropertiesLoose})},"./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/extends.js":module=>{function _extends(){return module.exports=_extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},module.exports.__esModule=!0,module.exports.default=module.exports,_extends.apply(null,arguments)}module.exports=_extends,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js":module=>{module.exports=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}},module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js":module=>{module.exports=function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t},module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/.pnpm/@emotion+cache@11.11.0/node_modules/@emotion/cache/dist/emotion-cache.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>createCache});var StyleSheet=function(){function StyleSheet(options){var _this=this;this._insertTag=function(tag){var before;before=0===_this.tags.length?_this.insertionPoint?_this.insertionPoint.nextSibling:_this.prepend?_this.container.firstChild:_this.before:_this.tags[_this.tags.length-1].nextSibling,_this.container.insertBefore(tag,before),_this.tags.push(tag)},this.isSpeedy=void 0===options.speedy||options.speedy,this.tags=[],this.ctr=0,this.nonce=options.nonce,this.key=options.key,this.container=options.container,this.prepend=options.prepend,this.insertionPoint=options.insertionPoint,this.before=null}var _proto=StyleSheet.prototype;return _proto.hydrate=function hydrate(nodes){nodes.forEach(this._insertTag)},_proto.insert=function insert(rule){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function createStyleElement(options){var tag=document.createElement("style");return tag.setAttribute("data-emotion",options.key),void 0!==options.nonce&&tag.setAttribute("nonce",options.nonce),tag.appendChild(document.createTextNode("")),tag.setAttribute("data-s",""),tag}(this));var tag=this.tags[this.tags.length-1];if(this.isSpeedy){var sheet=function sheetForTag(tag){if(tag.sheet)return tag.sheet;for(var i=0;i<document.styleSheets.length;i++)if(document.styleSheets[i].ownerNode===tag)return document.styleSheets[i]}(tag);try{sheet.insertRule(rule,sheet.cssRules.length)}catch(e){0}}else tag.appendChild(document.createTextNode(rule));this.ctr++},_proto.flush=function flush(){this.tags.forEach((function(tag){return tag.parentNode&&tag.parentNode.removeChild(tag)})),this.tags=[],this.ctr=0},StyleSheet}(),abs=Math.abs,Utility_from=String.fromCharCode,Utility_assign=Object.assign;function trim(value){return value.trim()}function Utility_replace(value,pattern,replacement){return value.replace(pattern,replacement)}function indexof(value,search){return value.indexOf(search)}function Utility_charat(value,index){return 0|value.charCodeAt(index)}function Utility_substr(value,begin,end){return value.slice(begin,end)}function Utility_strlen(value){return value.length}function Utility_sizeof(value){return value.length}function Utility_append(value,array){return array.push(value),value}var line=1,column=1,Tokenizer_length=0,position=0,character=0,characters="";function node(value,root,parent,type,props,children,length){return{value,root,parent,type,props,children,line,column,length,return:""}}function Tokenizer_copy(root,props){return Utility_assign(node("",null,null,"",null,null,0),root,{length:-root.length},props)}function prev(){return character=position>0?Utility_charat(characters,--position):0,column--,10===character&&(column=1,line--),character}function next(){return character=position<Tokenizer_length?Utility_charat(characters,position++):0,column++,10===character&&(column=1,line++),character}function peek(){return Utility_charat(characters,position)}function caret(){return position}function slice(begin,end){return Utility_substr(characters,begin,end)}function token(type){switch(type){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(value){return line=column=1,Tokenizer_length=Utility_strlen(characters=value),position=0,[]}function dealloc(value){return characters="",value}function delimit(type){return trim(slice(position-1,delimiter(91===type?type+2:40===type?type+1:type)))}function whitespace(type){for(;(character=peek())&&character<33;)next();return token(type)>2||token(character)>3?"":" "}function escaping(index,count){for(;--count&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(index,caret()+(count<6&&32==peek()&&32==next()))}function delimiter(type){for(;next();)switch(character){case type:return position;case 34:case 39:34!==type&&39!==type&&delimiter(character);break;case 40:41===type&&delimiter(type);break;case 92:next()}return position}function commenter(type,index){for(;next()&&type+character!==57&&(type+character!==84||47!==peek()););return"/*"+slice(index,position-1)+"*"+Utility_from(47===type?type:next())}function identifier(index){for(;!token(peek());)next();return slice(index,position)}var COMMENT="comm",Enum_RULESET="rule",Enum_DECLARATION="decl";function Serializer_serialize(children,callback){for(var output="",length=Utility_sizeof(children),i=0;i<length;i++)output+=callback(children[i],i,children,callback)||"";return output}function stringify(element,index,children,callback){switch(element.type){case"@layer":if(element.children.length)break;case"@import":case Enum_DECLARATION:return element.return=element.return||element.value;case COMMENT:return"";case"@keyframes":return element.return=element.value+"{"+Serializer_serialize(element.children,callback)+"}";case Enum_RULESET:element.value=element.props.join(",")}return Utility_strlen(children=Serializer_serialize(element.children,callback))?element.return=element.value+"{"+children+"}":""}function compile(value){return dealloc(parse("",null,null,null,[""],value=alloc(value),0,[0],value))}function parse(value,root,parent,rule,rules,rulesets,pseudo,points,declarations){for(var index=0,offset=0,length=pseudo,atrule=0,property=0,previous=0,variable=1,scanning=1,ampersand=1,character=0,type="",props=rules,children=rulesets,reference=rule,characters=type;scanning;)switch(previous=character,character=next()){case 40:if(108!=previous&&58==Utility_charat(characters,length-1)){-1!=indexof(characters+=Utility_replace(delimit(character),"&","&\f"),"&\f")&&(ampersand=-1);break}case 34:case 39:case 91:characters+=delimit(character);break;case 9:case 10:case 13:case 32:characters+=whitespace(previous);break;case 92:characters+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:Utility_append(comment(commenter(next(),caret()),root,parent),declarations);break;default:characters+="/"}break;case 123*variable:points[index++]=Utility_strlen(characters)*ampersand;case 125*variable:case 59:case 0:switch(character){case 0:case 125:scanning=0;case 59+offset:-1==ampersand&&(characters=Utility_replace(characters,/\f/g,"")),property>0&&Utility_strlen(characters)-length&&Utility_append(property>32?declaration(characters+";",rule,parent,length-1):declaration(Utility_replace(characters," ","")+";",rule,parent,length-2),declarations);break;case 59:characters+=";";default:if(Utility_append(reference=ruleset(characters,root,parent,index,offset,rules,points,type,props=[],children=[],length),rulesets),123===character)if(0===offset)parse(characters,root,reference,reference,props,rulesets,length,points,children);else switch(99===atrule&&110===Utility_charat(characters,3)?100:atrule){case 100:case 108:case 109:case 115:parse(value,reference,reference,rule&&Utility_append(ruleset(value,reference,reference,0,0,rules,points,type,rules,props=[],length),children),rules,children,length,points,rule?props:children);break;default:parse(characters,reference,reference,reference,[""],children,0,points,children)}}index=offset=property=0,variable=ampersand=1,type=characters="",length=pseudo;break;case 58:length=1+Utility_strlen(characters),property=previous;default:if(variable<1)if(123==character)--variable;else if(125==character&&0==variable++&&125==prev())continue;switch(characters+=Utility_from(character),character*variable){case 38:ampersand=offset>0?1:(characters+="\f",-1);break;case 44:points[index++]=(Utility_strlen(characters)-1)*ampersand,ampersand=1;break;case 64:45===peek()&&(characters+=delimit(next())),atrule=peek(),offset=length=Utility_strlen(type=characters+=identifier(caret())),character++;break;case 45:45===previous&&2==Utility_strlen(characters)&&(variable=0)}}return rulesets}function ruleset(value,root,parent,index,offset,rules,points,type,props,children,length){for(var post=offset-1,rule=0===offset?rules:[""],size=Utility_sizeof(rule),i=0,j=0,k=0;i<index;++i)for(var x=0,y=Utility_substr(value,post+1,post=abs(j=points[i])),z=value;x<size;++x)(z=trim(j>0?rule[x]+" "+y:Utility_replace(y,/&\f/g,rule[x])))&&(props[k++]=z);return node(value,root,parent,0===offset?Enum_RULESET:type,props,children,length)}function comment(value,root,parent){return node(value,root,parent,COMMENT,Utility_from(function Tokenizer_char(){return character}()),Utility_substr(value,2,-2),0)}function declaration(value,root,parent,length){return node(value,root,parent,Enum_DECLARATION,Utility_substr(value,0,length),Utility_substr(value,length+1,-1),length)}var identifierWithPointTracking=function identifierWithPointTracking(begin,points,index){for(var previous=0,character=0;previous=character,character=peek(),38===previous&&12===character&&(points[index]=1),!token(character);)next();return slice(begin,position)},getRules=function getRules(value,points){return dealloc(function toRules(parsed,points){var index=-1,character=44;do{switch(token(character)){case 0:38===character&&12===peek()&&(points[index]=1),parsed[index]+=identifierWithPointTracking(position-1,points,index);break;case 2:parsed[index]+=delimit(character);break;case 4:if(44===character){parsed[++index]=58===peek()?"&\f":"",points[index]=parsed[index].length;break}default:parsed[index]+=Utility_from(character)}}while(character=next());return parsed}(alloc(value),points))},fixedElements=new WeakMap,compat=function compat(element){if("rule"===element.type&&element.parent&&!(element.length<1)){for(var value=element.value,parent=element.parent,isImplicitRule=element.column===parent.column&&element.line===parent.line;"rule"!==parent.type;)if(!(parent=parent.parent))return;if((1!==element.props.length||58===value.charCodeAt(0)||fixedElements.get(parent))&&!isImplicitRule){fixedElements.set(element,!0);for(var points=[],rules=getRules(value,points),parentRules=parent.props,i=0,k=0;i<rules.length;i++)for(var j=0;j<parentRules.length;j++,k++)element.props[k]=points[i]?rules[i].replace(/&\f/g,parentRules[j]):parentRules[j]+" "+rules[i]}}},removeLabel=function removeLabel(element){if("decl"===element.type){var value=element.value;108===value.charCodeAt(0)&&98===value.charCodeAt(2)&&(element.return="",element.value="")}};function emotion_cache_browser_esm_prefix(value,length){switch(function hash(value,length){return 45^Utility_charat(value,0)?(((length<<2^Utility_charat(value,0))<<2^Utility_charat(value,1))<<2^Utility_charat(value,2))<<2^Utility_charat(value,3):0}(value,length)){case 5103:return"-webkit-print-"+value+value;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return"-webkit-"+value+value;case 5349:case 4246:case 4810:case 6968:case 2756:return"-webkit-"+value+"-moz-"+value+"-ms-"+value+value;case 6828:case 4268:return"-webkit-"+value+"-ms-"+value+value;case 6165:return"-webkit-"+value+"-ms-flex-"+value+value;case 5187:return"-webkit-"+value+Utility_replace(value,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+value;case 5443:return"-webkit-"+value+"-ms-flex-item-"+Utility_replace(value,/flex-|-self/,"")+value;case 4675:return"-webkit-"+value+"-ms-flex-line-pack"+Utility_replace(value,/align-content|flex-|-self/,"")+value;case 5548:return"-webkit-"+value+"-ms-"+Utility_replace(value,"shrink","negative")+value;case 5292:return"-webkit-"+value+"-ms-"+Utility_replace(value,"basis","preferred-size")+value;case 6060:return"-webkit-box-"+Utility_replace(value,"-grow","")+"-webkit-"+value+"-ms-"+Utility_replace(value,"grow","positive")+value;case 4554:return"-webkit-"+Utility_replace(value,/([^-])(transform)/g,"$1-webkit-$2")+value;case 6187:return Utility_replace(Utility_replace(Utility_replace(value,/(zoom-|grab)/,"-webkit-$1"),/(image-set)/,"-webkit-$1"),value,"")+value;case 5495:case 3959:return Utility_replace(value,/(image-set\([^]*)/,"-webkit-$1$`$1");case 4968:return Utility_replace(Utility_replace(value,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+"-webkit-"+value+value;case 4095:case 3583:case 4068:case 2532:return Utility_replace(value,/(.+)-inline(.+)/,"-webkit-$1$2")+value;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Utility_strlen(value)-1-length>6)switch(Utility_charat(value,length+1)){case 109:if(45!==Utility_charat(value,length+4))break;case 102:return Utility_replace(value,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1-moz-"+(108==Utility_charat(value,length+3)?"$3":"$2-$3"))+value;case 115:return~indexof(value,"stretch")?emotion_cache_browser_esm_prefix(Utility_replace(value,"stretch","fill-available"),length)+value:value}break;case 4949:if(115!==Utility_charat(value,length+1))break;case 6444:switch(Utility_charat(value,Utility_strlen(value)-3-(~indexof(value,"!important")&&10))){case 107:return Utility_replace(value,":",":-webkit-")+value;case 101:return Utility_replace(value,/(.+:)([^;!]+)(;|!.+)?/,"$1-webkit-"+(45===Utility_charat(value,14)?"inline-":"")+"box$3$1-webkit-$2$3$1-ms-$2box$3")+value}break;case 5936:switch(Utility_charat(value,length+11)){case 114:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"tb")+value;case 108:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"tb-rl")+value;case 45:return"-webkit-"+value+"-ms-"+Utility_replace(value,/[svh]\w+-[tblr]{2}/,"lr")+value}return"-webkit-"+value+"-ms-"+value+value}return value}var defaultStylisPlugins=[function prefixer(element,index,children,callback){if(element.length>-1&&!element.return)switch(element.type){case Enum_DECLARATION:element.return=emotion_cache_browser_esm_prefix(element.value,element.length);break;case"@keyframes":return Serializer_serialize([Tokenizer_copy(element,{value:Utility_replace(element.value,"@","@-webkit-")})],callback);case Enum_RULESET:if(element.length)return function Utility_combine(array,callback){return array.map(callback).join("")}(element.props,(function(value){switch(function Utility_match(value,pattern){return(value=pattern.exec(value))?value[0]:value}(value,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Serializer_serialize([Tokenizer_copy(element,{props:[Utility_replace(value,/:(read-\w+)/,":-moz-$1")]})],callback);case"::placeholder":return Serializer_serialize([Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,":-webkit-input-$1")]}),Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,":-moz-$1")]}),Tokenizer_copy(element,{props:[Utility_replace(value,/:(plac\w+)/,"-ms-input-$1")]})],callback)}return""}))}}],createCache=function createCache(options){var key=options.key;if("css"===key){var ssrStyles=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(ssrStyles,(function(node){-1!==node.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(node),node.setAttribute("data-s",""))}))}var stylisPlugins=options.stylisPlugins||defaultStylisPlugins;var container,_insert,inserted={},nodesToHydrate=[];container=options.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+key+' "]'),(function(node){for(var attrib=node.getAttribute("data-emotion").split(" "),i=1;i<attrib.length;i++)inserted[attrib[i]]=!0;nodesToHydrate.push(node)}));var currentSheet,callback,finalizingPlugins=[stringify,(callback=function(rule){currentSheet.insert(rule)},function(element){element.root||(element=element.return)&&callback(element)})],serializer=function middleware(collection){var length=Utility_sizeof(collection);return function(element,index,children,callback){for(var output="",i=0;i<length;i++)output+=collection[i](element,index,children,callback)||"";return output}}([compat,removeLabel].concat(stylisPlugins,finalizingPlugins));_insert=function insert(selector,serialized,sheet,shouldCache){currentSheet=sheet,function stylis(styles){Serializer_serialize(compile(styles),serializer)}(selector?selector+"{"+serialized.styles+"}":serialized.styles),shouldCache&&(cache.inserted[serialized.name]=!0)};var cache={key,sheet:new StyleSheet({key,container,nonce:options.nonce,speedy:options.speedy,prepend:options.prepend,insertionPoint:options.insertionPoint}),nonce:options.nonce,inserted,registered:{},insert:_insert};return cache.sheet.hydrate(nodesToHydrate),cache}},"./node_modules/.pnpm/@emotion+memoize@0.8.1/node_modules/@emotion/memoize/dist/emotion-memoize.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function memoize(fn){var cache=Object.create(null);return function(arg){return void 0===cache[arg]&&(cache[arg]=fn(arg)),cache[arg]}}__webpack_require__.d(__webpack_exports__,{A:()=>memoize})},"./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-element-43c6fea0.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>CacheProvider,T:()=>ThemeContext,i:()=>isBrowser,w:()=>withEmotionCache});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_emotion_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@emotion+cache@11.11.0/node_modules/@emotion/cache/dist/emotion-cache.browser.esm.js"),isBrowser=(__webpack_require__("./node_modules/.pnpm/@emotion+serialize@1.1.4/node_modules/@emotion/serialize/dist/emotion-serialize.browser.esm.js"),__webpack_require__("./node_modules/.pnpm/@emotion+use-insertion-effect-with-fallbacks@1.0.1_react@17.0.2/node_modules/@emotion/use-insertion-effect-with-fallbacks/dist/emotion-use-insertion-effect-with-fallbacks.browser.esm.js"),!0),EmotionCacheContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext("undefined"!=typeof HTMLElement?(0,_emotion_cache__WEBPACK_IMPORTED_MODULE_1__.A)({key:"css"}):null);var CacheProvider=EmotionCacheContext.Provider,withEmotionCache=function withEmotionCache(func){return(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function(props,ref){var cache=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(EmotionCacheContext);return func(props,cache,ref)}))};isBrowser||(withEmotionCache=function withEmotionCache(func){return function(props){var cache=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(EmotionCacheContext);return null===cache?(cache=(0,_emotion_cache__WEBPACK_IMPORTED_MODULE_1__.A)({key:"css"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(EmotionCacheContext.Provider,{value:cache},func(props,cache))):func(props,cache)}});var ThemeContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({})},"./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-react.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AH:()=>css,i7:()=>keyframes,mL:()=>Global});var _emotion_element_43c6fea0_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-element-43c6fea0.browser.esm.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_emotion_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/@emotion+utils@1.2.1/node_modules/@emotion/utils/dist/emotion-utils.browser.esm.js"),_emotion_use_insertion_effect_with_fallbacks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@emotion+use-insertion-effect-with-fallbacks@1.0.1_react@17.0.2/node_modules/@emotion/use-insertion-effect-with-fallbacks/dist/emotion-use-insertion-effect-with-fallbacks.browser.esm.js"),_emotion_serialize__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@emotion+serialize@1.1.4/node_modules/@emotion/serialize/dist/emotion-serialize.browser.esm.js"),Global=(__webpack_require__("./node_modules/.pnpm/@emotion+cache@11.11.0/node_modules/@emotion/cache/dist/emotion-cache.browser.esm.js"),__webpack_require__("./node_modules/.pnpm/hoist-non-react-statics@3.3.2/node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js"),(0,_emotion_element_43c6fea0_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.w)((function(props,cache){var styles=props.styles,serialized=(0,_emotion_serialize__WEBPACK_IMPORTED_MODULE_2__.J)([styles],void 0,react__WEBPACK_IMPORTED_MODULE_0__.useContext(_emotion_element_43c6fea0_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.T));if(!_emotion_element_43c6fea0_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.i){for(var _ref,serializedNames=serialized.name,serializedStyles=serialized.styles,next=serialized.next;void 0!==next;)serializedNames+=" "+next.name,serializedStyles+=next.styles,next=next.next;var shouldCache=!0===cache.compat,rules=cache.insert("",{name:serializedNames,styles:serializedStyles},cache.sheet,shouldCache);return shouldCache?null:react__WEBPACK_IMPORTED_MODULE_0__.createElement("style",((_ref={})["data-emotion"]=cache.key+"-global "+serializedNames,_ref.dangerouslySetInnerHTML={__html:rules},_ref.nonce=cache.sheet.nonce,_ref))}var sheetRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef();return(0,_emotion_use_insertion_effect_with_fallbacks__WEBPACK_IMPORTED_MODULE_1__.i)((function(){var key=cache.key+"-global",sheet=new cache.sheet.constructor({key,nonce:cache.sheet.nonce,container:cache.sheet.container,speedy:cache.sheet.isSpeedy}),rehydrating=!1,node=document.querySelector('style[data-emotion="'+key+" "+serialized.name+'"]');return cache.sheet.tags.length&&(sheet.before=cache.sheet.tags[0]),null!==node&&(rehydrating=!0,node.setAttribute("data-emotion",key),sheet.hydrate([node])),sheetRef.current=[sheet,rehydrating],function(){sheet.flush()}}),[cache]),(0,_emotion_use_insertion_effect_with_fallbacks__WEBPACK_IMPORTED_MODULE_1__.i)((function(){var sheetRefCurrent=sheetRef.current,sheet=sheetRefCurrent[0];if(sheetRefCurrent[1])sheetRefCurrent[1]=!1;else{if(void 0!==serialized.next&&(0,_emotion_utils__WEBPACK_IMPORTED_MODULE_6__.sk)(cache,serialized.next,!0),sheet.tags.length){var element=sheet.tags[sheet.tags.length-1].nextElementSibling;sheet.before=element,sheet.flush()}cache.insert("",serialized,sheet,!1)}}),[cache,serialized.name]),null})));function css(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(0,_emotion_serialize__WEBPACK_IMPORTED_MODULE_2__.J)(args)}var keyframes=function keyframes(){var insertable=css.apply(void 0,arguments),name="animation-"+insertable.name;return{name,styles:"@keyframes "+name+"{"+insertable.styles+"}",anim:1,toString:function toString(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},"./node_modules/.pnpm/@emotion+serialize@1.1.4/node_modules/@emotion/serialize/dist/emotion-serialize.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{J:()=>serializeStyles});var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},emotion_memoize_esm=__webpack_require__("./node_modules/.pnpm/@emotion+memoize@0.8.1/node_modules/@emotion/memoize/dist/emotion-memoize.esm.js"),hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function isCustomProperty(property){return 45===property.charCodeAt(1)},isProcessableValue=function isProcessableValue(value){return null!=value&&"boolean"!=typeof value},processStyleName=(0,emotion_memoize_esm.A)((function(styleName){return isCustomProperty(styleName)?styleName:styleName.replace(hyphenateRegex,"-$&").toLowerCase()})),processStyleValue=function processStyleValue(key,value){switch(key){case"animation":case"animationName":if("string"==typeof value)return value.replace(animationRegex,(function(match,p1,p2){return cursor={name:p1,styles:p2,next:cursor},p1}))}return 1===unitlessKeys[key]||isCustomProperty(key)||"number"!=typeof value||0===value?value:value+"px"};function handleInterpolation(mergedProps,registered,interpolation){if(null==interpolation)return"";if(void 0!==interpolation.__emotion_styles)return interpolation;switch(typeof interpolation){case"boolean":return"";case"object":if(1===interpolation.anim)return cursor={name:interpolation.name,styles:interpolation.styles,next:cursor},interpolation.name;if(void 0!==interpolation.styles){var next=interpolation.next;if(void 0!==next)for(;void 0!==next;)cursor={name:next.name,styles:next.styles,next:cursor},next=next.next;return interpolation.styles+";"}return function createStringFromObject(mergedProps,registered,obj){var string="";if(Array.isArray(obj))for(var i=0;i<obj.length;i++)string+=handleInterpolation(mergedProps,registered,obj[i])+";";else for(var _key in obj){var value=obj[_key];if("object"!=typeof value)null!=registered&&void 0!==registered[value]?string+=_key+"{"+registered[value]+"}":isProcessableValue(value)&&(string+=processStyleName(_key)+":"+processStyleValue(_key,value)+";");else if(!Array.isArray(value)||"string"!=typeof value[0]||null!=registered&&void 0!==registered[value[0]]){var interpolated=handleInterpolation(mergedProps,registered,value);switch(_key){case"animation":case"animationName":string+=processStyleName(_key)+":"+interpolated+";";break;default:string+=_key+"{"+interpolated+"}"}}else for(var _i=0;_i<value.length;_i++)isProcessableValue(value[_i])&&(string+=processStyleName(_key)+":"+processStyleValue(_key,value[_i])+";")}return string}(mergedProps,registered,interpolation);case"function":if(void 0!==mergedProps){var previousCursor=cursor,result=interpolation(mergedProps);return cursor=previousCursor,handleInterpolation(mergedProps,registered,result)}}if(null==registered)return interpolation;var cached=registered[interpolation];return void 0!==cached?cached:interpolation}var cursor,labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var serializeStyles=function serializeStyles(args,registered,mergedProps){if(1===args.length&&"object"==typeof args[0]&&null!==args[0]&&void 0!==args[0].styles)return args[0];var stringMode=!0,styles="";cursor=void 0;var strings=args[0];null==strings||void 0===strings.raw?(stringMode=!1,styles+=handleInterpolation(mergedProps,registered,strings)):styles+=strings[0];for(var i=1;i<args.length;i++)styles+=handleInterpolation(mergedProps,registered,args[i]),stringMode&&(styles+=strings[i]);labelPattern.lastIndex=0;for(var match,identifierName="";null!==(match=labelPattern.exec(styles));)identifierName+="-"+match[1];var name=function murmur2(str){for(var k,h=0,i=0,len=str.length;len>=4;++i,len-=4)k=1540483477*(65535&(k=255&str.charCodeAt(i)|(255&str.charCodeAt(++i))<<8|(255&str.charCodeAt(++i))<<16|(255&str.charCodeAt(++i))<<24))+(59797*(k>>>16)<<16),h=1540483477*(65535&(k^=k>>>24))+(59797*(k>>>16)<<16)^1540483477*(65535&h)+(59797*(h>>>16)<<16);switch(len){case 3:h^=(255&str.charCodeAt(i+2))<<16;case 2:h^=(255&str.charCodeAt(i+1))<<8;case 1:h=1540483477*(65535&(h^=255&str.charCodeAt(i)))+(59797*(h>>>16)<<16)}return(((h=1540483477*(65535&(h^=h>>>13))+(59797*(h>>>16)<<16))^h>>>15)>>>0).toString(36)}(styles)+identifierName;return{name,styles,next:cursor}}},"./node_modules/.pnpm/@emotion+utils@1.2.1/node_modules/@emotion/utils/dist/emotion-utils.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Rk:()=>getRegisteredStyles,SF:()=>registerStyles,sk:()=>insertStyles});function getRegisteredStyles(registered,registeredStyles,classNames){var rawClassName="";return classNames.split(" ").forEach((function(className){void 0!==registered[className]?registeredStyles.push(registered[className]+";"):rawClassName+=className+" "})),rawClassName}var registerStyles=function registerStyles(cache,serialized,isStringTag){var className=cache.key+"-"+serialized.name;!1===isStringTag&&void 0===cache.registered[className]&&(cache.registered[className]=serialized.styles)},insertStyles=function insertStyles(cache,serialized,isStringTag){registerStyles(cache,serialized,isStringTag);var className=cache.key+"-"+serialized.name;if(void 0===cache.inserted[serialized.name]){var current=serialized;do{cache.insert(serialized===current?"."+className:"",current,cache.sheet,!0),current=current.next}while(void 0!==current)}}},"./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/Portal/Portal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>Portal});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react-dom@17.0.2_react@17.0.2/node_modules/react-dom/index.js"),_mui_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js"),_mui_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEnhancedEffect/useEnhancedEffect.js"),_mui_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/setRef/setRef.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const Portal=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function Portal(props,forwardedRef){const{children,container,disablePortal=!1}=props,[mountNode,setMountNode]=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),handleRef=(0,_mui_utils__WEBPACK_IMPORTED_MODULE_3__.A)(react__WEBPACK_IMPORTED_MODULE_0__.isValidElement(children)?children.ref:null,forwardedRef);if((0,_mui_utils__WEBPACK_IMPORTED_MODULE_4__.A)((()=>{disablePortal||setMountNode(function getContainer(container){return"function"==typeof container?container():container}(container)||document.body)}),[container,disablePortal]),(0,_mui_utils__WEBPACK_IMPORTED_MODULE_4__.A)((()=>{if(mountNode&&!disablePortal)return(0,_mui_utils__WEBPACK_IMPORTED_MODULE_5__.A)(forwardedRef,mountNode),()=>{(0,_mui_utils__WEBPACK_IMPORTED_MODULE_5__.A)(forwardedRef,null)}}),[forwardedRef,mountNode,disablePortal]),disablePortal){if(react__WEBPACK_IMPORTED_MODULE_0__.isValidElement(children)){const newProps={ref:handleRef};return react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(children,newProps)}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children})}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:mountNode?react_dom__WEBPACK_IMPORTED_MODULE_1__.createPortal(children,mountNode):mountNode})}))},"./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/appendOwnerState.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>appendOwnerState});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),_isHostComponent__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/isHostComponent.js");function appendOwnerState(elementType,otherProps,ownerState){return void 0===elementType||(0,_isHostComponent__WEBPACK_IMPORTED_MODULE_0__.g)(elementType)?otherProps:(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__.A)({},otherProps,{ownerState:(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_1__.A)({},otherProps.ownerState,ownerState)})}},"./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/extractEventHandlers.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function extractEventHandlers(object,excludeKeys=[]){if(void 0===object)return{};const result={};return Object.keys(object).filter((prop=>prop.match(/^on[A-Z]/)&&"function"==typeof object[prop]&&!excludeKeys.includes(prop))).forEach((prop=>{result[prop]=object[prop]})),result}__webpack_require__.d(__webpack_exports__,{h:()=>extractEventHandlers})},"./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/isHostComponent.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function isHostComponent(element){return"string"==typeof element}__webpack_require__.d(__webpack_exports__,{g:()=>isHostComponent})},"./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/useSlotProps.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>useSlotProps});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js"),appendOwnerState=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/appendOwnerState.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),extractEventHandlers=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/extractEventHandlers.js");function omitEventHandlers(object){if(void 0===object)return{};const result={};return Object.keys(object).filter((prop=>!(prop.match(/^on[A-Z]/)&&"function"==typeof object[prop]))).forEach((prop=>{result[prop]=object[prop]})),result}const _excluded=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function useSlotProps(parameters){var _parameters$additiona;const{elementType,externalSlotProps,ownerState,skipResolvingSlotProps=!1}=parameters,rest=(0,objectWithoutPropertiesLoose.A)(parameters,_excluded),resolvedComponentsProps=skipResolvingSlotProps?{}:function resolveComponentProps(componentProps,ownerState,slotState){return"function"==typeof componentProps?componentProps(ownerState,slotState):componentProps}(externalSlotProps,ownerState),{props:mergedProps,internalRef}=function mergeSlotProps(parameters){const{getSlotProps,additionalProps,externalSlotProps,externalForwardedProps,className}=parameters;if(!getSlotProps){const joinedClasses=(0,clsx.A)(null==additionalProps?void 0:additionalProps.className,className,null==externalForwardedProps?void 0:externalForwardedProps.className,null==externalSlotProps?void 0:externalSlotProps.className),mergedStyle=(0,esm_extends.A)({},null==additionalProps?void 0:additionalProps.style,null==externalForwardedProps?void 0:externalForwardedProps.style,null==externalSlotProps?void 0:externalSlotProps.style),props=(0,esm_extends.A)({},additionalProps,externalForwardedProps,externalSlotProps);return joinedClasses.length>0&&(props.className=joinedClasses),Object.keys(mergedStyle).length>0&&(props.style=mergedStyle),{props,internalRef:void 0}}const eventHandlers=(0,extractEventHandlers.h)((0,esm_extends.A)({},externalForwardedProps,externalSlotProps)),componentsPropsWithoutEventHandlers=omitEventHandlers(externalSlotProps),otherPropsWithoutEventHandlers=omitEventHandlers(externalForwardedProps),internalSlotProps=getSlotProps(eventHandlers),joinedClasses=(0,clsx.A)(null==internalSlotProps?void 0:internalSlotProps.className,null==additionalProps?void 0:additionalProps.className,className,null==externalForwardedProps?void 0:externalForwardedProps.className,null==externalSlotProps?void 0:externalSlotProps.className),mergedStyle=(0,esm_extends.A)({},null==internalSlotProps?void 0:internalSlotProps.style,null==additionalProps?void 0:additionalProps.style,null==externalForwardedProps?void 0:externalForwardedProps.style,null==externalSlotProps?void 0:externalSlotProps.style),props=(0,esm_extends.A)({},internalSlotProps,additionalProps,otherPropsWithoutEventHandlers,componentsPropsWithoutEventHandlers);return joinedClasses.length>0&&(props.className=joinedClasses),Object.keys(mergedStyle).length>0&&(props.style=mergedStyle),{props,internalRef:internalSlotProps.ref}}((0,esm_extends.A)({},rest,{externalSlotProps:resolvedComponentsProps})),ref=(0,useForkRef.A)(internalRef,null==resolvedComponentsProps?void 0:resolvedComponentsProps.ref,null==(_parameters$additiona=parameters.additionalProps)?void 0:_parameters$additiona.ref);return(0,appendOwnerState.X)(elementType,(0,esm_extends.A)({},mergedProps,{ref}),ownerState)}},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/ArrowBackIos.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/BrightnessHigh.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"}),"BrightnessHigh")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/Close.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/ContentCut.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-1zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .89 2 2-.9 2-2 2m6-7.5c-.28 0-.5-.22-.5-.5s.22-.5.5-.5.5.22.5.5-.22.5-.5.5M19 3l-6 6 2 2 7-7V3z"}),"ContentCut")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/Fullscreen.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"}),"Fullscreen")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/FullscreenExit.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"}),"FullscreenExit")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/MoreVert.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/Replay.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.A=void 0;var _createSvgIcon=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js")),_jsxRuntime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");exports.A=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay")},"./node_modules/.pnpm/@mui+icons-material@5.15.19_e5vbikw6bo5rfwrsmp2ncoem5y/node_modules/@mui/icons-material/utils/createSvgIcon.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _utils.createSvgIcon}});var _utils=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/index.js")},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Box/Box.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Box_Box});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),styled_engine=__webpack_require__("./node_modules/.pnpm/@mui+styled-engine@5.15.14_hj6yibkjkhvdx4xakusaw2oiva/node_modules/@mui/styled-engine/index.js"),styleFunctionSx=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js"),extendSxProp=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/extendSxProp.js"),useTheme=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useTheme.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["className","component"];var ClassNameGenerator=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ClassNameGenerator/ClassNameGenerator.js"),createTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/createTheme.js"),identifier=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js");const Box_boxClasses=(0,__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js").A)("MuiBox",["root"]),defaultTheme=(0,createTheme.A)(),Box=function createBox(options={}){const{themeId,defaultTheme,defaultClassName="MuiBox-root",generateClassName}=options,BoxRoot=(0,styled_engine.default)("div",{shouldForwardProp:prop=>"theme"!==prop&&"sx"!==prop&&"as"!==prop})(styleFunctionSx.A);return react.forwardRef((function Box(inProps,ref){const theme=(0,useTheme.A)(defaultTheme),_extendSxProp=(0,extendSxProp.A)(inProps),{className,component="div"}=_extendSxProp,other=(0,objectWithoutPropertiesLoose.A)(_extendSxProp,_excluded);return(0,jsx_runtime.jsx)(BoxRoot,(0,esm_extends.A)({as:component,ref,className:(0,clsx.A)(className,generateClassName?generateClassName(defaultClassName):defaultClassName),theme:themeId&&theme[themeId]||theme},other))}))}({themeId:identifier.A,defaultTheme,defaultClassName:Box_boxClasses.root,generateClassName:ClassNameGenerator.A.generate}),Box_Box=Box},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Button/Button.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Button_Button});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),resolveProps=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/resolveProps/resolveProps.js"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),rootShouldForwardProp=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/rootShouldForwardProp.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),ButtonBase=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ButtonBase/ButtonBase.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getButtonUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiButton",slot)}const Button_buttonClasses=(0,generateUtilityClasses.A)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);const ButtonGroup_ButtonGroupContext=react.createContext({});const ButtonGroup_ButtonGroupButtonContext=react.createContext(void 0);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],commonIconStyles=ownerState=>(0,esm_extends.A)({},"small"===ownerState.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===ownerState.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===ownerState.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),ButtonRoot=(0,styled.Ay)(ButtonBase.A,{shouldForwardProp:prop=>(0,rootShouldForwardProp.A)(prop)||"classes"===prop,name:"MuiButton",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,styles[ownerState.variant],styles[`${ownerState.variant}${(0,capitalize.A)(ownerState.color)}`],styles[`size${(0,capitalize.A)(ownerState.size)}`],styles[`${ownerState.variant}Size${(0,capitalize.A)(ownerState.size)}`],"inherit"===ownerState.color&&styles.colorInherit,ownerState.disableElevation&&styles.disableElevation,ownerState.fullWidth&&styles.fullWidth]}})((({theme,ownerState})=>{var _theme$palette$getCon,_theme$palette;const inheritContainedBackgroundColor="light"===theme.palette.mode?theme.palette.grey[300]:theme.palette.grey[800],inheritContainedHoverBackgroundColor="light"===theme.palette.mode?theme.palette.grey.A100:theme.palette.grey[700];return(0,esm_extends.A)({},theme.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(theme.vars||theme).shape.borderRadius,transition:theme.transitions.create(["background-color","box-shadow","border-color","color"],{duration:theme.transitions.duration.short}),"&:hover":(0,esm_extends.A)({textDecoration:"none",backgroundColor:theme.vars?`rgba(${theme.vars.palette.text.primaryChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.X4)(theme.palette.text.primary,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===ownerState.variant&&"inherit"!==ownerState.color&&{backgroundColor:theme.vars?`rgba(${theme.vars.palette[ownerState.color].mainChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.X4)(theme.palette[ownerState.color].main,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===ownerState.variant&&"inherit"!==ownerState.color&&{border:`1px solid ${(theme.vars||theme).palette[ownerState.color].main}`,backgroundColor:theme.vars?`rgba(${theme.vars.palette[ownerState.color].mainChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.X4)(theme.palette[ownerState.color].main,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===ownerState.variant&&{backgroundColor:theme.vars?theme.vars.palette.Button.inheritContainedHoverBg:inheritContainedHoverBackgroundColor,boxShadow:(theme.vars||theme).shadows[4],"@media (hover: none)":{boxShadow:(theme.vars||theme).shadows[2],backgroundColor:(theme.vars||theme).palette.grey[300]}},"contained"===ownerState.variant&&"inherit"!==ownerState.color&&{backgroundColor:(theme.vars||theme).palette[ownerState.color].dark,"@media (hover: none)":{backgroundColor:(theme.vars||theme).palette[ownerState.color].main}}),"&:active":(0,esm_extends.A)({},"contained"===ownerState.variant&&{boxShadow:(theme.vars||theme).shadows[8]}),[`&.${Button_buttonClasses.focusVisible}`]:(0,esm_extends.A)({},"contained"===ownerState.variant&&{boxShadow:(theme.vars||theme).shadows[6]}),[`&.${Button_buttonClasses.disabled}`]:(0,esm_extends.A)({color:(theme.vars||theme).palette.action.disabled},"outlined"===ownerState.variant&&{border:`1px solid ${(theme.vars||theme).palette.action.disabledBackground}`},"contained"===ownerState.variant&&{color:(theme.vars||theme).palette.action.disabled,boxShadow:(theme.vars||theme).shadows[0],backgroundColor:(theme.vars||theme).palette.action.disabledBackground})},"text"===ownerState.variant&&{padding:"6px 8px"},"text"===ownerState.variant&&"inherit"!==ownerState.color&&{color:(theme.vars||theme).palette[ownerState.color].main},"outlined"===ownerState.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===ownerState.variant&&"inherit"!==ownerState.color&&{color:(theme.vars||theme).palette[ownerState.color].main,border:theme.vars?`1px solid rgba(${theme.vars.palette[ownerState.color].mainChannel} / 0.5)`:`1px solid ${(0,colorManipulator.X4)(theme.palette[ownerState.color].main,.5)}`},"contained"===ownerState.variant&&{color:theme.vars?theme.vars.palette.text.primary:null==(_theme$palette$getCon=(_theme$palette=theme.palette).getContrastText)?void 0:_theme$palette$getCon.call(_theme$palette,theme.palette.grey[300]),backgroundColor:theme.vars?theme.vars.palette.Button.inheritContainedBg:inheritContainedBackgroundColor,boxShadow:(theme.vars||theme).shadows[2]},"contained"===ownerState.variant&&"inherit"!==ownerState.color&&{color:(theme.vars||theme).palette[ownerState.color].contrastText,backgroundColor:(theme.vars||theme).palette[ownerState.color].main},"inherit"===ownerState.color&&{color:"inherit",borderColor:"currentColor"},"small"===ownerState.size&&"text"===ownerState.variant&&{padding:"4px 5px",fontSize:theme.typography.pxToRem(13)},"large"===ownerState.size&&"text"===ownerState.variant&&{padding:"8px 11px",fontSize:theme.typography.pxToRem(15)},"small"===ownerState.size&&"outlined"===ownerState.variant&&{padding:"3px 9px",fontSize:theme.typography.pxToRem(13)},"large"===ownerState.size&&"outlined"===ownerState.variant&&{padding:"7px 21px",fontSize:theme.typography.pxToRem(15)},"small"===ownerState.size&&"contained"===ownerState.variant&&{padding:"4px 10px",fontSize:theme.typography.pxToRem(13)},"large"===ownerState.size&&"contained"===ownerState.variant&&{padding:"8px 22px",fontSize:theme.typography.pxToRem(15)},ownerState.fullWidth&&{width:"100%"})}),(({ownerState})=>ownerState.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Button_buttonClasses.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Button_buttonClasses.disabled}`]:{boxShadow:"none"}})),ButtonStartIcon=(0,styled.Ay)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.startIcon,styles[`iconSize${(0,capitalize.A)(ownerState.size)}`]]}})((({ownerState})=>(0,esm_extends.A)({display:"inherit",marginRight:8,marginLeft:-4},"small"===ownerState.size&&{marginLeft:-2},commonIconStyles(ownerState)))),ButtonEndIcon=(0,styled.Ay)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.endIcon,styles[`iconSize${(0,capitalize.A)(ownerState.size)}`]]}})((({ownerState})=>(0,esm_extends.A)({display:"inherit",marginRight:-4,marginLeft:8},"small"===ownerState.size&&{marginRight:-2},commonIconStyles(ownerState)))),Button_Button=react.forwardRef((function Button(inProps,ref){const contextProps=react.useContext(ButtonGroup_ButtonGroupContext),buttonGroupButtonContextPositionClassName=react.useContext(ButtonGroup_ButtonGroupButtonContext),resolvedProps=(0,resolveProps.A)(contextProps,inProps),props=(0,useThemeProps.A)({props:resolvedProps,name:"MuiButton"}),{children,color="primary",component="button",className,disabled=!1,disableElevation=!1,disableFocusRipple=!1,endIcon:endIconProp,focusVisibleClassName,fullWidth=!1,size="medium",startIcon:startIconProp,type,variant="text"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),ownerState=(0,esm_extends.A)({},props,{color,component,disabled,disableElevation,disableFocusRipple,fullWidth,size,type,variant}),classes=(ownerState=>{const{color,disableElevation,fullWidth,size,variant,classes}=ownerState,slots={root:["root",variant,`${variant}${(0,capitalize.A)(color)}`,`size${(0,capitalize.A)(size)}`,`${variant}Size${(0,capitalize.A)(size)}`,`color${(0,capitalize.A)(color)}`,disableElevation&&"disableElevation",fullWidth&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${(0,capitalize.A)(size)}`],endIcon:["icon","endIcon",`iconSize${(0,capitalize.A)(size)}`]},composedClasses=(0,composeClasses.A)(slots,getButtonUtilityClass,classes);return(0,esm_extends.A)({},classes,composedClasses)})(ownerState),startIcon=startIconProp&&(0,jsx_runtime.jsx)(ButtonStartIcon,{className:classes.startIcon,ownerState,children:startIconProp}),endIcon=endIconProp&&(0,jsx_runtime.jsx)(ButtonEndIcon,{className:classes.endIcon,ownerState,children:endIconProp}),positionClassName=buttonGroupButtonContextPositionClassName||"";return(0,jsx_runtime.jsxs)(ButtonRoot,(0,esm_extends.A)({ownerState,className:(0,clsx.A)(contextProps.className,classes.root,className,positionClassName),component,disabled,focusRipple:!disableFocusRipple,focusVisibleClassName:(0,clsx.A)(classes.focusVisible,focusVisibleClassName),ref,type},other,{classes,children:[startIcon,children,endIcon]}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ButtonBase/ButtonBase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ButtonBase_ButtonBase});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),useEventCallback=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEventCallback.js"),useIsFocusVisible=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useIsFocusVisible.js"),assertThisInitialized=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),inheritsLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),TransitionGroupContext=__webpack_require__("./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/TransitionGroupContext.js");function getChildMapping(children,mapFn){var result=Object.create(null);return children&&react.Children.map(children,(function(c){return c})).forEach((function(child){result[child.key]=function mapper(child){return mapFn&&(0,react.isValidElement)(child)?mapFn(child):child}(child)})),result}function getProp(child,prop,props){return null!=props[prop]?props[prop]:child.props[prop]}function getNextChildMapping(nextProps,prevChildMapping,onExited){var nextChildMapping=getChildMapping(nextProps.children),children=function mergeChildMappings(prev,next){function getValueForKey(key){return key in next?next[key]:prev[key]}prev=prev||{},next=next||{};var i,nextKeysPending=Object.create(null),pendingKeys=[];for(var prevKey in prev)prevKey in next?pendingKeys.length&&(nextKeysPending[prevKey]=pendingKeys,pendingKeys=[]):pendingKeys.push(prevKey);var childMapping={};for(var nextKey in next){if(nextKeysPending[nextKey])for(i=0;i<nextKeysPending[nextKey].length;i++){var pendingNextKey=nextKeysPending[nextKey][i];childMapping[nextKeysPending[nextKey][i]]=getValueForKey(pendingNextKey)}childMapping[nextKey]=getValueForKey(nextKey)}for(i=0;i<pendingKeys.length;i++)childMapping[pendingKeys[i]]=getValueForKey(pendingKeys[i]);return childMapping}(prevChildMapping,nextChildMapping);return Object.keys(children).forEach((function(key){var child=children[key];if((0,react.isValidElement)(child)){var hasPrev=key in prevChildMapping,hasNext=key in nextChildMapping,prevChild=prevChildMapping[key],isLeaving=(0,react.isValidElement)(prevChild)&&!prevChild.props.in;!hasNext||hasPrev&&!isLeaving?hasNext||!hasPrev||isLeaving?hasNext&&hasPrev&&(0,react.isValidElement)(prevChild)&&(children[key]=(0,react.cloneElement)(child,{onExited:onExited.bind(null,child),in:prevChild.props.in,exit:getProp(child,"exit",nextProps),enter:getProp(child,"enter",nextProps)})):children[key]=(0,react.cloneElement)(child,{in:!1}):children[key]=(0,react.cloneElement)(child,{onExited:onExited.bind(null,child),in:!0,exit:getProp(child,"exit",nextProps),enter:getProp(child,"enter",nextProps)})}})),children}var values=Object.values||function(obj){return Object.keys(obj).map((function(k){return obj[k]}))},TransitionGroup=function(_React$Component){function TransitionGroup(props,context){var _this,handleExited=(_this=_React$Component.call(this,props,context)||this).handleExited.bind((0,assertThisInitialized.A)(_this));return _this.state={contextValue:{isMounting:!0},handleExited,firstRender:!0},_this}(0,inheritsLoose.A)(TransitionGroup,_React$Component);var _proto=TransitionGroup.prototype;return _proto.componentDidMount=function componentDidMount(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},_proto.componentWillUnmount=function componentWillUnmount(){this.mounted=!1},TransitionGroup.getDerivedStateFromProps=function getDerivedStateFromProps(nextProps,_ref){var props,onExited,prevChildMapping=_ref.children,handleExited=_ref.handleExited;return{children:_ref.firstRender?(props=nextProps,onExited=handleExited,getChildMapping(props.children,(function(child){return(0,react.cloneElement)(child,{onExited:onExited.bind(null,child),in:!0,appear:getProp(child,"appear",props),enter:getProp(child,"enter",props),exit:getProp(child,"exit",props)})}))):getNextChildMapping(nextProps,prevChildMapping,handleExited),firstRender:!1}},_proto.handleExited=function handleExited(child,node){var currentChildMapping=getChildMapping(this.props.children);child.key in currentChildMapping||(child.props.onExited&&child.props.onExited(node),this.mounted&&this.setState((function(state){var children=(0,esm_extends.A)({},state.children);return delete children[child.key],{children}})))},_proto.render=function render(){var _this$props=this.props,Component=_this$props.component,childFactory=_this$props.childFactory,props=(0,objectWithoutPropertiesLoose.A)(_this$props,["component","childFactory"]),contextValue=this.state.contextValue,children=values(this.state.children).map(childFactory);return delete props.appear,delete props.enter,delete props.exit,null===Component?react.createElement(TransitionGroupContext.A.Provider,{value:contextValue},children):react.createElement(TransitionGroupContext.A.Provider,{value:contextValue},react.createElement(Component,props,children))},TransitionGroup}(react.Component);TransitionGroup.propTypes={},TransitionGroup.defaultProps={component:"div",childFactory:function childFactory(child){return child}};const esm_TransitionGroup=TransitionGroup;var emotion_react_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),useTimeout=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const ButtonBase_Ripple=function Ripple(props){const{className,classes,pulsate=!1,rippleX,rippleY,rippleSize,in:inProp,onExited,timeout}=props,[leaving,setLeaving]=react.useState(!1),rippleClassName=(0,clsx.A)(className,classes.ripple,classes.rippleVisible,pulsate&&classes.ripplePulsate),rippleStyles={width:rippleSize,height:rippleSize,top:-rippleSize/2+rippleY,left:-rippleSize/2+rippleX},childClassName=(0,clsx.A)(classes.child,leaving&&classes.childLeaving,pulsate&&classes.childPulsate);return inProp||leaving||setLeaving(!0),react.useEffect((()=>{if(!inProp&&null!=onExited){const timeoutId=setTimeout(onExited,timeout);return()=>{clearTimeout(timeoutId)}}}),[onExited,inProp,timeout]),(0,jsx_runtime.jsx)("span",{className:rippleClassName,style:rippleStyles,children:(0,jsx_runtime.jsx)("span",{className:childClassName})})};var generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js");const ButtonBase_touchRippleClasses=(0,generateUtilityClasses.A)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),_excluded=["center","classes","className"];let _t,_t2,_t3,_t4,_=t=>t;const enterKeyframe=(0,emotion_react_browser_esm.i7)(_t||(_t=_`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),exitKeyframe=(0,emotion_react_browser_esm.i7)(_t2||(_t2=_`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),pulsateKeyframe=(0,emotion_react_browser_esm.i7)(_t3||(_t3=_`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),TouchRippleRoot=(0,styled.Ay)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),TouchRippleRipple=(0,styled.Ay)(ButtonBase_Ripple,{name:"MuiTouchRipple",slot:"Ripple"})(_t4||(_t4=_`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),ButtonBase_touchRippleClasses.rippleVisible,enterKeyframe,550,(({theme})=>theme.transitions.easing.easeInOut),ButtonBase_touchRippleClasses.ripplePulsate,(({theme})=>theme.transitions.duration.shorter),ButtonBase_touchRippleClasses.child,ButtonBase_touchRippleClasses.childLeaving,exitKeyframe,550,(({theme})=>theme.transitions.easing.easeInOut),ButtonBase_touchRippleClasses.childPulsate,pulsateKeyframe,(({theme})=>theme.transitions.easing.easeInOut)),ButtonBase_TouchRipple=react.forwardRef((function TouchRipple(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiTouchRipple"}),{center:centerProp=!1,classes={},className}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),[ripples,setRipples]=react.useState([]),nextKey=react.useRef(0),rippleCallback=react.useRef(null);react.useEffect((()=>{rippleCallback.current&&(rippleCallback.current(),rippleCallback.current=null)}),[ripples]);const ignoringMouseDown=react.useRef(!1),startTimer=(0,useTimeout.A)(),startTimerCommit=react.useRef(null),container=react.useRef(null),startCommit=react.useCallback((params=>{const{pulsate,rippleX,rippleY,rippleSize,cb}=params;setRipples((oldRipples=>[...oldRipples,(0,jsx_runtime.jsx)(TouchRippleRipple,{classes:{ripple:(0,clsx.A)(classes.ripple,ButtonBase_touchRippleClasses.ripple),rippleVisible:(0,clsx.A)(classes.rippleVisible,ButtonBase_touchRippleClasses.rippleVisible),ripplePulsate:(0,clsx.A)(classes.ripplePulsate,ButtonBase_touchRippleClasses.ripplePulsate),child:(0,clsx.A)(classes.child,ButtonBase_touchRippleClasses.child),childLeaving:(0,clsx.A)(classes.childLeaving,ButtonBase_touchRippleClasses.childLeaving),childPulsate:(0,clsx.A)(classes.childPulsate,ButtonBase_touchRippleClasses.childPulsate)},timeout:550,pulsate,rippleX,rippleY,rippleSize},nextKey.current)])),nextKey.current+=1,rippleCallback.current=cb}),[classes]),start=react.useCallback(((event={},options={},cb=(()=>{}))=>{const{pulsate=!1,center=centerProp||options.pulsate,fakeElement=!1}=options;if("mousedown"===(null==event?void 0:event.type)&&ignoringMouseDown.current)return void(ignoringMouseDown.current=!1);"touchstart"===(null==event?void 0:event.type)&&(ignoringMouseDown.current=!0);const element=fakeElement?null:container.current,rect=element?element.getBoundingClientRect():{width:0,height:0,left:0,top:0};let rippleX,rippleY,rippleSize;if(center||void 0===event||0===event.clientX&&0===event.clientY||!event.clientX&&!event.touches)rippleX=Math.round(rect.width/2),rippleY=Math.round(rect.height/2);else{const{clientX,clientY}=event.touches&&event.touches.length>0?event.touches[0]:event;rippleX=Math.round(clientX-rect.left),rippleY=Math.round(clientY-rect.top)}if(center)rippleSize=Math.sqrt((2*rect.width**2+rect.height**2)/3),rippleSize%2==0&&(rippleSize+=1);else{const sizeX=2*Math.max(Math.abs((element?element.clientWidth:0)-rippleX),rippleX)+2,sizeY=2*Math.max(Math.abs((element?element.clientHeight:0)-rippleY),rippleY)+2;rippleSize=Math.sqrt(sizeX**2+sizeY**2)}null!=event&&event.touches?null===startTimerCommit.current&&(startTimerCommit.current=()=>{startCommit({pulsate,rippleX,rippleY,rippleSize,cb})},startTimer.start(80,(()=>{startTimerCommit.current&&(startTimerCommit.current(),startTimerCommit.current=null)}))):startCommit({pulsate,rippleX,rippleY,rippleSize,cb})}),[centerProp,startCommit,startTimer]),pulsate=react.useCallback((()=>{start({},{pulsate:!0})}),[start]),stop=react.useCallback(((event,cb)=>{if(startTimer.clear(),"touchend"===(null==event?void 0:event.type)&&startTimerCommit.current)return startTimerCommit.current(),startTimerCommit.current=null,void startTimer.start(0,(()=>{stop(event,cb)}));startTimerCommit.current=null,setRipples((oldRipples=>oldRipples.length>0?oldRipples.slice(1):oldRipples)),rippleCallback.current=cb}),[startTimer]);return react.useImperativeHandle(ref,(()=>({pulsate,start,stop})),[pulsate,start,stop]),(0,jsx_runtime.jsx)(TouchRippleRoot,(0,esm_extends.A)({className:(0,clsx.A)(ButtonBase_touchRippleClasses.root,classes.root,className),ref:container},other,{children:(0,jsx_runtime.jsx)(esm_TransitionGroup,{component:null,exit:!0,children:ripples})}))}));var generateUtilityClass_generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getButtonBaseUtilityClass(slot){return(0,generateUtilityClass_generateUtilityClass.Ay)("MuiButtonBase",slot)}const ButtonBase_buttonBaseClasses=(0,generateUtilityClasses.A)("MuiButtonBase",["root","disabled","focusVisible"]),ButtonBase_excluded=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],ButtonBaseRoot=(0,styled.Ay)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(props,styles)=>styles.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ButtonBase_buttonBaseClasses.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ButtonBase_ButtonBase=react.forwardRef((function ButtonBase(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiButtonBase"}),{action,centerRipple=!1,children,className,component="button",disabled=!1,disableRipple=!1,disableTouchRipple=!1,focusRipple=!1,LinkComponent="a",onBlur,onClick,onContextMenu,onDragLeave,onFocus,onFocusVisible,onKeyDown,onKeyUp,onMouseDown,onMouseLeave,onMouseUp,onTouchEnd,onTouchMove,onTouchStart,tabIndex=0,TouchRippleProps,touchRippleRef,type}=props,other=(0,objectWithoutPropertiesLoose.A)(props,ButtonBase_excluded),buttonRef=react.useRef(null),rippleRef=react.useRef(null),handleRippleRef=(0,useForkRef.A)(rippleRef,touchRippleRef),{isFocusVisibleRef,onFocus:handleFocusVisible,onBlur:handleBlurVisible,ref:focusVisibleRef}=(0,useIsFocusVisible.A)(),[focusVisible,setFocusVisible]=react.useState(!1);disabled&&focusVisible&&setFocusVisible(!1),react.useImperativeHandle(action,(()=>({focusVisible:()=>{setFocusVisible(!0),buttonRef.current.focus()}})),[]);const[mountedState,setMountedState]=react.useState(!1);react.useEffect((()=>{setMountedState(!0)}),[]);const enableTouchRipple=mountedState&&!disableRipple&&!disabled;function useRippleHandler(rippleAction,eventCallback,skipRippleAction=disableTouchRipple){return(0,useEventCallback.A)((event=>{eventCallback&&eventCallback(event);return!skipRippleAction&&rippleRef.current&&rippleRef.current[rippleAction](event),!0}))}react.useEffect((()=>{focusVisible&&focusRipple&&!disableRipple&&mountedState&&rippleRef.current.pulsate()}),[disableRipple,focusRipple,focusVisible,mountedState]);const handleMouseDown=useRippleHandler("start",onMouseDown),handleContextMenu=useRippleHandler("stop",onContextMenu),handleDragLeave=useRippleHandler("stop",onDragLeave),handleMouseUp=useRippleHandler("stop",onMouseUp),handleMouseLeave=useRippleHandler("stop",(event=>{focusVisible&&event.preventDefault(),onMouseLeave&&onMouseLeave(event)})),handleTouchStart=useRippleHandler("start",onTouchStart),handleTouchEnd=useRippleHandler("stop",onTouchEnd),handleTouchMove=useRippleHandler("stop",onTouchMove),handleBlur=useRippleHandler("stop",(event=>{handleBlurVisible(event),!1===isFocusVisibleRef.current&&setFocusVisible(!1),onBlur&&onBlur(event)}),!1),handleFocus=(0,useEventCallback.A)((event=>{buttonRef.current||(buttonRef.current=event.currentTarget),handleFocusVisible(event),!0===isFocusVisibleRef.current&&(setFocusVisible(!0),onFocusVisible&&onFocusVisible(event)),onFocus&&onFocus(event)})),isNonNativeButton=()=>{const button=buttonRef.current;return component&&"button"!==component&&!("A"===button.tagName&&button.href)},keydownRef=react.useRef(!1),handleKeyDown=(0,useEventCallback.A)((event=>{focusRipple&&!keydownRef.current&&focusVisible&&rippleRef.current&&" "===event.key&&(keydownRef.current=!0,rippleRef.current.stop(event,(()=>{rippleRef.current.start(event)}))),event.target===event.currentTarget&&isNonNativeButton()&&" "===event.key&&event.preventDefault(),onKeyDown&&onKeyDown(event),event.target===event.currentTarget&&isNonNativeButton()&&"Enter"===event.key&&!disabled&&(event.preventDefault(),onClick&&onClick(event))})),handleKeyUp=(0,useEventCallback.A)((event=>{focusRipple&&" "===event.key&&rippleRef.current&&focusVisible&&!event.defaultPrevented&&(keydownRef.current=!1,rippleRef.current.stop(event,(()=>{rippleRef.current.pulsate(event)}))),onKeyUp&&onKeyUp(event),onClick&&event.target===event.currentTarget&&isNonNativeButton()&&" "===event.key&&!event.defaultPrevented&&onClick(event)}));let ComponentProp=component;"button"===ComponentProp&&(other.href||other.to)&&(ComponentProp=LinkComponent);const buttonProps={};"button"===ComponentProp?(buttonProps.type=void 0===type?"button":type,buttonProps.disabled=disabled):(other.href||other.to||(buttonProps.role="button"),disabled&&(buttonProps["aria-disabled"]=disabled));const handleRef=(0,useForkRef.A)(ref,focusVisibleRef,buttonRef);const ownerState=(0,esm_extends.A)({},props,{centerRipple,component,disabled,disableRipple,disableTouchRipple,focusRipple,tabIndex,focusVisible}),classes=(ownerState=>{const{disabled,focusVisible,focusVisibleClassName,classes}=ownerState,slots={root:["root",disabled&&"disabled",focusVisible&&"focusVisible"]},composedClasses=(0,composeClasses.A)(slots,getButtonBaseUtilityClass,classes);return focusVisible&&focusVisibleClassName&&(composedClasses.root+=` ${focusVisibleClassName}`),composedClasses})(ownerState);return(0,jsx_runtime.jsxs)(ButtonBaseRoot,(0,esm_extends.A)({as:ComponentProp,className:(0,clsx.A)(classes.root,className),ownerState,onBlur:handleBlur,onClick,onContextMenu:handleContextMenu,onFocus:handleFocus,onKeyDown:handleKeyDown,onKeyUp:handleKeyUp,onMouseDown:handleMouseDown,onMouseLeave:handleMouseLeave,onMouseUp:handleMouseUp,onDragLeave:handleDragLeave,onTouchEnd:handleTouchEnd,onTouchMove:handleTouchMove,onTouchStart:handleTouchStart,ref:handleRef,tabIndex:disabled?-1:tabIndex,type},buttonProps,other,{children:[children,enableTouchRipple?(0,jsx_runtime.jsx)(ButtonBase_TouchRipple,(0,esm_extends.A)({ref:handleRippleRef,center:centerRipple},TouchRippleProps)):null]}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Divider/dividerClasses.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,K:()=>getDividerUtilityClass});var _mui_utils_generateUtilityClasses__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),_mui_utils_generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getDividerUtilityClass(slot){return(0,_mui_utils_generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__.Ay)("MuiDivider",slot)}const __WEBPACK_DEFAULT_EXPORT__=(0,_mui_utils_generateUtilityClasses__WEBPACK_IMPORTED_MODULE_1__.A)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"])},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Drawer/Drawer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>Drawer_Drawer});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),RtlProvider=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/RtlProvider/index.js"),Modal=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Modal/Modal.js"),Transition=__webpack_require__("./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/Transition.js"),debounce=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/debounce.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),useTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js"),utils=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/transitions/utils.js"),ownerWindow=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerWindow.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function setTranslateValue(direction,node,containerProp){const transform=function getTranslateValue(direction,node,resolvedContainer){const rect=node.getBoundingClientRect(),containerRect=resolvedContainer&&resolvedContainer.getBoundingClientRect(),containerWindow=(0,ownerWindow.A)(node);let transform;if(node.fakeTransform)transform=node.fakeTransform;else{const computedStyle=containerWindow.getComputedStyle(node);transform=computedStyle.getPropertyValue("-webkit-transform")||computedStyle.getPropertyValue("transform")}let offsetX=0,offsetY=0;if(transform&&"none"!==transform&&"string"==typeof transform){const transformValues=transform.split("(")[1].split(")")[0].split(",");offsetX=parseInt(transformValues[4],10),offsetY=parseInt(transformValues[5],10)}return"left"===direction?containerRect?`translateX(${containerRect.right+offsetX-rect.left}px)`:`translateX(${containerWindow.innerWidth+offsetX-rect.left}px)`:"right"===direction?containerRect?`translateX(-${rect.right-containerRect.left-offsetX}px)`:`translateX(-${rect.left+rect.width-offsetX}px)`:"up"===direction?containerRect?`translateY(${containerRect.bottom+offsetY-rect.top}px)`:`translateY(${containerWindow.innerHeight+offsetY-rect.top}px)`:containerRect?`translateY(-${rect.top-containerRect.top+rect.height-offsetY}px)`:`translateY(-${rect.top+rect.height-offsetY}px)`}(direction,node,function resolveContainer(containerPropProp){return"function"==typeof containerPropProp?containerPropProp():containerPropProp}(containerProp));transform&&(node.style.webkitTransform=transform,node.style.transform=transform)}const Slide_Slide=react.forwardRef((function Slide(props,ref){const theme=(0,useTheme.A)(),defaultEasing={enter:theme.transitions.easing.easeOut,exit:theme.transitions.easing.sharp},defaultTimeout={enter:theme.transitions.duration.enteringScreen,exit:theme.transitions.duration.leavingScreen},{addEndListener,appear=!0,children,container:containerProp,direction="down",easing:easingProp=defaultEasing,in:inProp,onEnter,onEntered,onEntering,onExit,onExited,onExiting,style,timeout=defaultTimeout,TransitionComponent=Transition.Ay}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),childrenRef=react.useRef(null),handleRef=(0,useForkRef.A)(children.ref,childrenRef,ref),normalizedTransitionCallback=callback=>isAppearing=>{callback&&(void 0===isAppearing?callback(childrenRef.current):callback(childrenRef.current,isAppearing))},handleEnter=normalizedTransitionCallback(((node,isAppearing)=>{setTranslateValue(direction,node,containerProp),(0,utils.q)(node),onEnter&&onEnter(node,isAppearing)})),handleEntering=normalizedTransitionCallback(((node,isAppearing)=>{const transitionProps=(0,utils.c)({timeout,style,easing:easingProp},{mode:"enter"});node.style.webkitTransition=theme.transitions.create("-webkit-transform",(0,esm_extends.A)({},transitionProps)),node.style.transition=theme.transitions.create("transform",(0,esm_extends.A)({},transitionProps)),node.style.webkitTransform="none",node.style.transform="none",onEntering&&onEntering(node,isAppearing)})),handleEntered=normalizedTransitionCallback(onEntered),handleExiting=normalizedTransitionCallback(onExiting),handleExit=normalizedTransitionCallback((node=>{const transitionProps=(0,utils.c)({timeout,style,easing:easingProp},{mode:"exit"});node.style.webkitTransition=theme.transitions.create("-webkit-transform",transitionProps),node.style.transition=theme.transitions.create("transform",transitionProps),setTranslateValue(direction,node,containerProp),onExit&&onExit(node)})),handleExited=normalizedTransitionCallback((node=>{node.style.webkitTransition="",node.style.transition="",onExited&&onExited(node)})),updatePosition=react.useCallback((()=>{childrenRef.current&&setTranslateValue(direction,childrenRef.current,containerProp)}),[direction,containerProp]);return react.useEffect((()=>{if(inProp||"down"===direction||"right"===direction)return;const handleResize=(0,debounce.A)((()=>{childrenRef.current&&setTranslateValue(direction,childrenRef.current,containerProp)})),containerWindow=(0,ownerWindow.A)(childrenRef.current);return containerWindow.addEventListener("resize",handleResize),()=>{handleResize.clear(),containerWindow.removeEventListener("resize",handleResize)}}),[direction,inProp,containerProp]),react.useEffect((()=>{inProp||updatePosition()}),[inProp,updatePosition]),(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({nodeRef:childrenRef,onEnter:handleEnter,onEntered:handleEntered,onEntering:handleEntering,onExit:handleExit,onExited:handleExited,onExiting:handleExiting,addEndListener:next=>{addEndListener&&addEndListener(childrenRef.current,next)},appear,in:inProp,timeout},other,{children:(state,childProps)=>react.cloneElement(children,(0,esm_extends.A)({ref:handleRef,style:(0,esm_extends.A)({visibility:"exited"!==state||inProp?void 0:"hidden"},style,children.props.style)},childProps))}))}));var Paper=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Paper/Paper.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),rootShouldForwardProp=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/rootShouldForwardProp.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getDrawerUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiDrawer",slot)}(0,generateUtilityClasses.A)("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Drawer_excluded=["BackdropProps"],_excluded2=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],overridesResolver=(props,styles)=>{const{ownerState}=props;return[styles.root,("permanent"===ownerState.variant||"persistent"===ownerState.variant)&&styles.docked,styles.modal]},DrawerRoot=(0,styled.Ay)(Modal.A,{name:"MuiDrawer",slot:"Root",overridesResolver})((({theme})=>({zIndex:(theme.vars||theme).zIndex.drawer}))),DrawerDockedRoot=(0,styled.Ay)("div",{shouldForwardProp:rootShouldForwardProp.A,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver})({flex:"0 0 auto"}),DrawerPaper=(0,styled.Ay)(Paper.A,{name:"MuiDrawer",slot:"Paper",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.paper,styles[`paperAnchor${(0,capitalize.A)(ownerState.anchor)}`],"temporary"!==ownerState.variant&&styles[`paperAnchorDocked${(0,capitalize.A)(ownerState.anchor)}`]]}})((({theme,ownerState})=>(0,esm_extends.A)({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(theme.vars||theme).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},"left"===ownerState.anchor&&{left:0},"top"===ownerState.anchor&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},"right"===ownerState.anchor&&{right:0},"bottom"===ownerState.anchor&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},"left"===ownerState.anchor&&"temporary"!==ownerState.variant&&{borderRight:`1px solid ${(theme.vars||theme).palette.divider}`},"top"===ownerState.anchor&&"temporary"!==ownerState.variant&&{borderBottom:`1px solid ${(theme.vars||theme).palette.divider}`},"right"===ownerState.anchor&&"temporary"!==ownerState.variant&&{borderLeft:`1px solid ${(theme.vars||theme).palette.divider}`},"bottom"===ownerState.anchor&&"temporary"!==ownerState.variant&&{borderTop:`1px solid ${(theme.vars||theme).palette.divider}`}))),oppositeDirection={left:"right",right:"left",top:"down",bottom:"up"};const Drawer_Drawer=react.forwardRef((function Drawer(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiDrawer"}),theme=(0,useTheme.A)(),isRtl=(0,RtlProvider.I)(),defaultTransitionDuration={enter:theme.transitions.duration.enteringScreen,exit:theme.transitions.duration.leavingScreen},{anchor:anchorProp="left",BackdropProps,children,className,elevation=16,hideBackdrop=!1,ModalProps:{BackdropProps:BackdropPropsProp}={},onClose,open=!1,PaperProps={},SlideProps,TransitionComponent=Slide_Slide,transitionDuration=defaultTransitionDuration,variant="temporary"}=props,ModalProps=(0,objectWithoutPropertiesLoose.A)(props.ModalProps,Drawer_excluded),other=(0,objectWithoutPropertiesLoose.A)(props,_excluded2),mounted=react.useRef(!1);react.useEffect((()=>{mounted.current=!0}),[]);const anchorInvariant=function getAnchor({direction},anchor){return"rtl"===direction&&function isHorizontal(anchor){return-1!==["left","right"].indexOf(anchor)}(anchor)?oppositeDirection[anchor]:anchor}({direction:isRtl?"rtl":"ltr"},anchorProp),anchor=anchorProp,ownerState=(0,esm_extends.A)({},props,{anchor,elevation,open,variant},other),classes=(ownerState=>{const{classes,anchor,variant}=ownerState,slots={root:["root"],docked:[("permanent"===variant||"persistent"===variant)&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${(0,capitalize.A)(anchor)}`,"temporary"!==variant&&`paperAnchorDocked${(0,capitalize.A)(anchor)}`]};return(0,composeClasses.A)(slots,getDrawerUtilityClass,classes)})(ownerState),drawer=(0,jsx_runtime.jsx)(DrawerPaper,(0,esm_extends.A)({elevation:"temporary"===variant?elevation:0,square:!0},PaperProps,{className:(0,clsx.A)(classes.paper,PaperProps.className),ownerState,children}));if("permanent"===variant)return(0,jsx_runtime.jsx)(DrawerDockedRoot,(0,esm_extends.A)({className:(0,clsx.A)(classes.root,classes.docked,className),ownerState,ref},other,{children:drawer}));const slidingDrawer=(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({in:open,direction:oppositeDirection[anchorInvariant],timeout:transitionDuration,appear:mounted.current},SlideProps,{children:drawer}));return"persistent"===variant?(0,jsx_runtime.jsx)(DrawerDockedRoot,(0,esm_extends.A)({className:(0,clsx.A)(classes.root,classes.docked,className),ownerState,ref},other,{children:slidingDrawer})):(0,jsx_runtime.jsx)(DrawerRoot,(0,esm_extends.A)({BackdropProps:(0,esm_extends.A)({},BackdropProps,BackdropPropsProp,{transitionDuration}),className:(0,clsx.A)(classes.root,classes.modal,className),open,ownerState,onClose,hideBackdrop,ref},other,ModalProps,{children:slidingDrawer}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Grow/Grow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_mui_utils_useTimeout__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js"),react_transition_group__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/Transition.js"),_styles_useTheme__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js"),_transitions_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/transitions/utils.js"),_utils_useForkRef__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function getScale(value){return`scale(${value}, ${value**2})`}const styles={entering:{opacity:1,transform:getScale(1)},entered:{opacity:1,transform:"none"}},isWebKit154="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Grow=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function Grow(props,ref){const{addEndListener,appear=!0,children,easing,in:inProp,onEnter,onEntered,onEntering,onExit,onExited,onExiting,style,timeout="auto",TransitionComponent=react_transition_group__WEBPACK_IMPORTED_MODULE_2__.Ay}=props,other=(0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_3__.A)(props,_excluded),timer=(0,_mui_utils_useTimeout__WEBPACK_IMPORTED_MODULE_4__.A)(),autoTimeout=react__WEBPACK_IMPORTED_MODULE_0__.useRef(),theme=(0,_styles_useTheme__WEBPACK_IMPORTED_MODULE_5__.A)(),nodeRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),handleRef=(0,_utils_useForkRef__WEBPACK_IMPORTED_MODULE_6__.A)(nodeRef,children.ref,ref),normalizedTransitionCallback=callback=>maybeIsAppearing=>{if(callback){const node=nodeRef.current;void 0===maybeIsAppearing?callback(node):callback(node,maybeIsAppearing)}},handleEntering=normalizedTransitionCallback(onEntering),handleEnter=normalizedTransitionCallback(((node,isAppearing)=>{(0,_transitions_utils__WEBPACK_IMPORTED_MODULE_7__.q)(node);const{duration:transitionDuration,delay,easing:transitionTimingFunction}=(0,_transitions_utils__WEBPACK_IMPORTED_MODULE_7__.c)({style,timeout,easing},{mode:"enter"});let duration;"auto"===timeout?(duration=theme.transitions.getAutoHeightDuration(node.clientHeight),autoTimeout.current=duration):duration=transitionDuration,node.style.transition=[theme.transitions.create("opacity",{duration,delay}),theme.transitions.create("transform",{duration:isWebKit154?duration:.666*duration,delay,easing:transitionTimingFunction})].join(","),onEnter&&onEnter(node,isAppearing)})),handleEntered=normalizedTransitionCallback(onEntered),handleExiting=normalizedTransitionCallback(onExiting),handleExit=normalizedTransitionCallback((node=>{const{duration:transitionDuration,delay,easing:transitionTimingFunction}=(0,_transitions_utils__WEBPACK_IMPORTED_MODULE_7__.c)({style,timeout,easing},{mode:"exit"});let duration;"auto"===timeout?(duration=theme.transitions.getAutoHeightDuration(node.clientHeight),autoTimeout.current=duration):duration=transitionDuration,node.style.transition=[theme.transitions.create("opacity",{duration,delay}),theme.transitions.create("transform",{duration:isWebKit154?duration:.666*duration,delay:isWebKit154?delay:delay||.333*duration,easing:transitionTimingFunction})].join(","),node.style.opacity=0,node.style.transform=getScale(.75),onExit&&onExit(node)})),handleExited=normalizedTransitionCallback(onExited);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(TransitionComponent,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.A)({appear,in:inProp,nodeRef,onEnter:handleEnter,onEntered:handleEntered,onEntering:handleEntering,onExit:handleExit,onExited:handleExited,onExiting:handleExiting,addEndListener:next=>{"auto"===timeout&&timer.start(autoTimeout.current||0,next),addEndListener&&addEndListener(nodeRef.current,next)},timeout:"auto"===timeout?null:timeout},other,{children:(state,childProps)=>react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(children,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.A)({style:(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.A)({opacity:0,transform:getScale(.75),visibility:"exited"!==state||inProp?void 0:"hidden"},styles[state],style,children.props.style),ref:handleRef},childProps))}))}));Grow.muiSupportAuto=!0;const __WEBPACK_DEFAULT_EXPORT__=Grow},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/IconButton/IconButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>IconButton_IconButton});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),ButtonBase=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ButtonBase/ButtonBase.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getIconButtonUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiIconButton",slot)}const IconButton_iconButtonClasses=(0,generateUtilityClasses.A)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["edge","children","className","color","disabled","disableFocusRipple","size"],IconButtonRoot=(0,styled.Ay)(ButtonBase.A,{name:"MuiIconButton",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,"default"!==ownerState.color&&styles[`color${(0,capitalize.A)(ownerState.color)}`],ownerState.edge&&styles[`edge${(0,capitalize.A)(ownerState.edge)}`],styles[`size${(0,capitalize.A)(ownerState.size)}`]]}})((({theme,ownerState})=>(0,esm_extends.A)({textAlign:"center",flex:"0 0 auto",fontSize:theme.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(theme.vars||theme).palette.action.active,transition:theme.transitions.create("background-color",{duration:theme.transitions.duration.shortest})},!ownerState.disableRipple&&{"&:hover":{backgroundColor:theme.vars?`rgba(${theme.vars.palette.action.activeChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.X4)(theme.palette.action.active,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===ownerState.edge&&{marginLeft:"small"===ownerState.size?-3:-12},"end"===ownerState.edge&&{marginRight:"small"===ownerState.size?-3:-12})),(({theme,ownerState})=>{var _palette;const palette=null==(_palette=(theme.vars||theme).palette)?void 0:_palette[ownerState.color];return(0,esm_extends.A)({},"inherit"===ownerState.color&&{color:"inherit"},"inherit"!==ownerState.color&&"default"!==ownerState.color&&(0,esm_extends.A)({color:null==palette?void 0:palette.main},!ownerState.disableRipple&&{"&:hover":(0,esm_extends.A)({},palette&&{backgroundColor:theme.vars?`rgba(${palette.mainChannel} / ${theme.vars.palette.action.hoverOpacity})`:(0,colorManipulator.X4)(palette.main,theme.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===ownerState.size&&{padding:5,fontSize:theme.typography.pxToRem(18)},"large"===ownerState.size&&{padding:12,fontSize:theme.typography.pxToRem(28)},{[`&.${IconButton_iconButtonClasses.disabled}`]:{backgroundColor:"transparent",color:(theme.vars||theme).palette.action.disabled}})})),IconButton_IconButton=react.forwardRef((function IconButton(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiIconButton"}),{edge=!1,children,className,color="default",disabled=!1,disableFocusRipple=!1,size="medium"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),ownerState=(0,esm_extends.A)({},props,{edge,color,disabled,disableFocusRipple,size}),classes=(ownerState=>{const{classes,disabled,color,edge,size}=ownerState,slots={root:["root",disabled&&"disabled","default"!==color&&`color${(0,capitalize.A)(color)}`,edge&&`edge${(0,capitalize.A)(edge)}`,`size${(0,capitalize.A)(size)}`]};return(0,composeClasses.A)(slots,getIconButtonUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsx)(IconButtonRoot,(0,esm_extends.A)({className:(0,clsx.A)(classes.root,className),centerRipple:!0,focusRipple:!disableFocusRipple,disabled,ref},other,{ownerState,children}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/List/ListContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js").createContext({})},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/MenuItem/MenuItem.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>MenuItem_MenuItem});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),rootShouldForwardProp=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/rootShouldForwardProp.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),ListContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/List/ListContext.js"),ButtonBase=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ButtonBase/ButtonBase.js"),useEnhancedEffect=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEnhancedEffect.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),dividerClasses=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Divider/dividerClasses.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js");const ListItemIcon_listItemIconClasses=(0,generateUtilityClasses.A)("MuiListItemIcon",["root","alignItemsFlexStart"]);const ListItemText_listItemTextClasses=(0,generateUtilityClasses.A)("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);var generateUtilityClass_generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getMenuItemUtilityClass(slot){return(0,generateUtilityClass_generateUtilityClass.Ay)("MuiMenuItem",slot)}const MenuItem_menuItemClasses=(0,generateUtilityClasses.A)("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],MenuItemRoot=(0,styled.Ay)(ButtonBase.A,{shouldForwardProp:prop=>(0,rootShouldForwardProp.A)(prop)||"classes"===prop,name:"MuiMenuItem",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,ownerState.dense&&styles.dense,ownerState.divider&&styles.divider,!ownerState.disableGutters&&styles.gutters]}})((({theme,ownerState})=>(0,esm_extends.A)({},theme.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!ownerState.disableGutters&&{paddingLeft:16,paddingRight:16},ownerState.divider&&{borderBottom:`1px solid ${(theme.vars||theme).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(theme.vars||theme).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${MenuItem_menuItemClasses.selected}`]:{backgroundColor:theme.vars?`rgba(${theme.vars.palette.primary.mainChannel} / ${theme.vars.palette.action.selectedOpacity})`:(0,colorManipulator.X4)(theme.palette.primary.main,theme.palette.action.selectedOpacity),[`&.${MenuItem_menuItemClasses.focusVisible}`]:{backgroundColor:theme.vars?`rgba(${theme.vars.palette.primary.mainChannel} / calc(${theme.vars.palette.action.selectedOpacity} + ${theme.vars.palette.action.focusOpacity}))`:(0,colorManipulator.X4)(theme.palette.primary.main,theme.palette.action.selectedOpacity+theme.palette.action.focusOpacity)}},[`&.${MenuItem_menuItemClasses.selected}:hover`]:{backgroundColor:theme.vars?`rgba(${theme.vars.palette.primary.mainChannel} / calc(${theme.vars.palette.action.selectedOpacity} + ${theme.vars.palette.action.hoverOpacity}))`:(0,colorManipulator.X4)(theme.palette.primary.main,theme.palette.action.selectedOpacity+theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:theme.vars?`rgba(${theme.vars.palette.primary.mainChannel} / ${theme.vars.palette.action.selectedOpacity})`:(0,colorManipulator.X4)(theme.palette.primary.main,theme.palette.action.selectedOpacity)}},[`&.${MenuItem_menuItemClasses.focusVisible}`]:{backgroundColor:(theme.vars||theme).palette.action.focus},[`&.${MenuItem_menuItemClasses.disabled}`]:{opacity:(theme.vars||theme).palette.action.disabledOpacity},[`& + .${dividerClasses.A.root}`]:{marginTop:theme.spacing(1),marginBottom:theme.spacing(1)},[`& + .${dividerClasses.A.inset}`]:{marginLeft:52},[`& .${ListItemText_listItemTextClasses.root}`]:{marginTop:0,marginBottom:0},[`& .${ListItemText_listItemTextClasses.inset}`]:{paddingLeft:36},[`& .${ListItemIcon_listItemIconClasses.root}`]:{minWidth:36}},!ownerState.dense&&{[theme.breakpoints.up("sm")]:{minHeight:"auto"}},ownerState.dense&&(0,esm_extends.A)({minHeight:32,paddingTop:4,paddingBottom:4},theme.typography.body2,{[`& .${ListItemIcon_listItemIconClasses.root} svg`]:{fontSize:"1.25rem"}})))),MenuItem_MenuItem=react.forwardRef((function MenuItem(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiMenuItem"}),{autoFocus=!1,component="li",dense=!1,divider=!1,disableGutters=!1,focusVisibleClassName,role="menuitem",tabIndex:tabIndexProp,className}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),context=react.useContext(ListContext.A),childContext=react.useMemo((()=>({dense:dense||context.dense||!1,disableGutters})),[context.dense,dense,disableGutters]),menuItemRef=react.useRef(null);(0,useEnhancedEffect.A)((()=>{autoFocus&&menuItemRef.current&&menuItemRef.current.focus()}),[autoFocus]);const ownerState=(0,esm_extends.A)({},props,{dense:childContext.dense,divider,disableGutters}),classes=(ownerState=>{const{disabled,dense,divider,disableGutters,selected,classes}=ownerState,slots={root:["root",dense&&"dense",disabled&&"disabled",!disableGutters&&"gutters",divider&&"divider",selected&&"selected"]},composedClasses=(0,composeClasses.A)(slots,getMenuItemUtilityClass,classes);return(0,esm_extends.A)({},classes,composedClasses)})(props),handleRef=(0,useForkRef.A)(menuItemRef,ref);let tabIndex;return props.disabled||(tabIndex=void 0!==tabIndexProp?tabIndexProp:-1),(0,jsx_runtime.jsx)(ListContext.A.Provider,{value:childContext,children:(0,jsx_runtime.jsx)(MenuItemRoot,(0,esm_extends.A)({ref:handleRef,role,tabIndex,component,focusVisibleClassName:(0,clsx.A)(classes.focusVisible,focusVisibleClassName),className:(0,clsx.A)(classes.root,className)},other,{ownerState,classes}))})}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/MenuList/MenuList.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>MenuList_MenuList});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),ownerDocument=(__webpack_require__("./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/index.js"),__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerDocument.js")),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),ListContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/List/ListContext.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getListUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiList",slot)}(0,generateUtilityClasses.A)("MuiList",["root","padding","dense","subheader"]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["children","className","component","dense","disablePadding","subheader"],ListRoot=(0,styled.Ay)("ul",{name:"MuiList",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,!ownerState.disablePadding&&styles.padding,ownerState.dense&&styles.dense,ownerState.subheader&&styles.subheader]}})((({ownerState})=>(0,esm_extends.A)({listStyle:"none",margin:0,padding:0,position:"relative"},!ownerState.disablePadding&&{paddingTop:8,paddingBottom:8},ownerState.subheader&&{paddingTop:0}))),List_List=react.forwardRef((function List(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiList"}),{children,className,component="ul",dense=!1,disablePadding=!1,subheader}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),context=react.useMemo((()=>({dense})),[dense]),ownerState=(0,esm_extends.A)({},props,{component,dense,disablePadding}),classes=(ownerState=>{const{classes,disablePadding,dense,subheader}=ownerState,slots={root:["root",!disablePadding&&"padding",dense&&"dense",subheader&&"subheader"]};return(0,composeClasses.A)(slots,getListUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsx)(ListContext.A.Provider,{value:context,children:(0,jsx_runtime.jsxs)(ListRoot,(0,esm_extends.A)({as:component,className:(0,clsx.A)(classes.root,className),ref,ownerState},other,{children:[subheader,children]}))})}));const utils_getScrollbarSize=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/getScrollbarSize/getScrollbarSize.js").A;var useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),useEnhancedEffect=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEnhancedEffect.js");const MenuList_excluded=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function nextItem(list,item,disableListWrap){return list===item?list.firstChild:item&&item.nextElementSibling?item.nextElementSibling:disableListWrap?null:list.firstChild}function previousItem(list,item,disableListWrap){return list===item?disableListWrap?list.firstChild:list.lastChild:item&&item.previousElementSibling?item.previousElementSibling:disableListWrap?null:list.lastChild}function textCriteriaMatches(nextFocus,textCriteria){if(void 0===textCriteria)return!0;let text=nextFocus.innerText;return void 0===text&&(text=nextFocus.textContent),text=text.trim().toLowerCase(),0!==text.length&&(textCriteria.repeating?text[0]===textCriteria.keys[0]:0===text.indexOf(textCriteria.keys.join("")))}function moveFocus(list,currentFocus,disableListWrap,disabledItemsFocusable,traversalFunction,textCriteria){let wrappedOnce=!1,nextFocus=traversalFunction(list,currentFocus,!!currentFocus&&disableListWrap);for(;nextFocus;){if(nextFocus===list.firstChild){if(wrappedOnce)return!1;wrappedOnce=!0}const nextFocusDisabled=!disabledItemsFocusable&&(nextFocus.disabled||"true"===nextFocus.getAttribute("aria-disabled"));if(nextFocus.hasAttribute("tabindex")&&textCriteriaMatches(nextFocus,textCriteria)&&!nextFocusDisabled)return nextFocus.focus(),!0;nextFocus=traversalFunction(list,nextFocus,disableListWrap)}return!1}const MenuList_MenuList=react.forwardRef((function MenuList(props,ref){const{actions,autoFocus=!1,autoFocusItem=!1,children,className,disabledItemsFocusable=!1,disableListWrap=!1,onKeyDown,variant="selectedMenu"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,MenuList_excluded),listRef=react.useRef(null),textCriteriaRef=react.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});(0,useEnhancedEffect.A)((()=>{autoFocus&&listRef.current.focus()}),[autoFocus]),react.useImperativeHandle(actions,(()=>({adjustStyleForScrollbar:(containerElement,{direction})=>{const noExplicitWidth=!listRef.current.style.width;if(containerElement.clientHeight<listRef.current.clientHeight&&noExplicitWidth){const scrollbarSize=`${utils_getScrollbarSize((0,ownerDocument.A)(containerElement))}px`;listRef.current.style["rtl"===direction?"paddingLeft":"paddingRight"]=scrollbarSize,listRef.current.style.width=`calc(100% + ${scrollbarSize})`}return listRef.current}})),[]);const handleRef=(0,useForkRef.A)(listRef,ref);let activeItemIndex=-1;react.Children.forEach(children,((child,index)=>{react.isValidElement(child)?(child.props.disabled||("selectedMenu"===variant&&child.props.selected||-1===activeItemIndex)&&(activeItemIndex=index),activeItemIndex===index&&(child.props.disabled||child.props.muiSkipListHighlight||child.type.muiSkipListHighlight)&&(activeItemIndex+=1,activeItemIndex>=children.length&&(activeItemIndex=-1))):activeItemIndex===index&&(activeItemIndex+=1,activeItemIndex>=children.length&&(activeItemIndex=-1))}));const items=react.Children.map(children,((child,index)=>{if(index===activeItemIndex){const newChildProps={};return autoFocusItem&&(newChildProps.autoFocus=!0),void 0===child.props.tabIndex&&"selectedMenu"===variant&&(newChildProps.tabIndex=0),react.cloneElement(child,newChildProps)}return child}));return(0,jsx_runtime.jsx)(List_List,(0,esm_extends.A)({role:"menu",ref:handleRef,className,onKeyDown:event=>{const list=listRef.current,key=event.key,currentFocus=(0,ownerDocument.A)(list).activeElement;if("ArrowDown"===key)event.preventDefault(),moveFocus(list,currentFocus,disableListWrap,disabledItemsFocusable,nextItem);else if("ArrowUp"===key)event.preventDefault(),moveFocus(list,currentFocus,disableListWrap,disabledItemsFocusable,previousItem);else if("Home"===key)event.preventDefault(),moveFocus(list,null,disableListWrap,disabledItemsFocusable,nextItem);else if("End"===key)event.preventDefault(),moveFocus(list,null,disableListWrap,disabledItemsFocusable,previousItem);else if(1===key.length){const criteria=textCriteriaRef.current,lowerKey=key.toLowerCase(),currTime=performance.now();criteria.keys.length>0&&(currTime-criteria.lastTime>500?(criteria.keys=[],criteria.repeating=!0,criteria.previousKeyMatched=!0):criteria.repeating&&lowerKey!==criteria.keys[0]&&(criteria.repeating=!1)),criteria.lastTime=currTime,criteria.keys.push(lowerKey);const keepFocusOnCurrent=currentFocus&&!criteria.repeating&&textCriteriaMatches(currentFocus,criteria);criteria.previousKeyMatched&&(keepFocusOnCurrent||moveFocus(list,currentFocus,!1,disabledItemsFocusable,nextItem,criteria))?event.preventDefault():criteria.previousKeyMatched=!1}onKeyDown&&onKeyDown(event)},tabIndex:autoFocus?0:-1},other,{children:items}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Modal/Modal.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Modal_Modal});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),useSlotProps=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/useSlotProps.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js"),ownerDocument=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js"),useEventCallback=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEventCallback/useEventCallback.js"),createChainedFunction=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/createChainedFunction/createChainedFunction.js"),extractEventHandlers=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/extractEventHandlers.js"),ownerWindow=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerWindow/ownerWindow.js"),getScrollbarSize=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/getScrollbarSize/getScrollbarSize.js");function ariaHidden(element,show){show?element.setAttribute("aria-hidden","true"):element.removeAttribute("aria-hidden")}function getPaddingRight(element){return parseInt((0,ownerWindow.A)(element).getComputedStyle(element).paddingRight,10)||0}function ariaHiddenSiblings(container,mountElement,currentElement,elementsToExclude,show){const blacklist=[mountElement,currentElement,...elementsToExclude];[].forEach.call(container.children,(element=>{const isNotExcludedElement=-1===blacklist.indexOf(element),isNotForbiddenElement=!function isAriaHiddenForbiddenOnElement(element){const isForbiddenTagName=-1!==["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(element.tagName),isInputHidden="INPUT"===element.tagName&&"hidden"===element.getAttribute("type");return isForbiddenTagName||isInputHidden}(element);isNotExcludedElement&&isNotForbiddenElement&&ariaHidden(element,show)}))}function findIndexOf(items,callback){let idx=-1;return items.some(((item,index)=>!!callback(item)&&(idx=index,!0))),idx}function handleContainer(containerInfo,props){const restoreStyle=[],container=containerInfo.container;if(!props.disableScrollLock){if(function isOverflowing(container){const doc=(0,ownerDocument.A)(container);return doc.body===container?(0,ownerWindow.A)(container).innerWidth>doc.documentElement.clientWidth:container.scrollHeight>container.clientHeight}(container)){const scrollbarSize=(0,getScrollbarSize.A)((0,ownerDocument.A)(container));restoreStyle.push({value:container.style.paddingRight,property:"padding-right",el:container}),container.style.paddingRight=`${getPaddingRight(container)+scrollbarSize}px`;const fixedElements=(0,ownerDocument.A)(container).querySelectorAll(".mui-fixed");[].forEach.call(fixedElements,(element=>{restoreStyle.push({value:element.style.paddingRight,property:"padding-right",el:element}),element.style.paddingRight=`${getPaddingRight(element)+scrollbarSize}px`}))}let scrollContainer;if(container.parentNode instanceof DocumentFragment)scrollContainer=(0,ownerDocument.A)(container).body;else{const parent=container.parentElement,containerWindow=(0,ownerWindow.A)(container);scrollContainer="HTML"===(null==parent?void 0:parent.nodeName)&&"scroll"===containerWindow.getComputedStyle(parent).overflowY?parent:container}restoreStyle.push({value:scrollContainer.style.overflow,property:"overflow",el:scrollContainer},{value:scrollContainer.style.overflowX,property:"overflow-x",el:scrollContainer},{value:scrollContainer.style.overflowY,property:"overflow-y",el:scrollContainer}),scrollContainer.style.overflow="hidden"}return()=>{restoreStyle.forEach((({value,el,property})=>{value?el.style.setProperty(property,value):el.style.removeProperty(property)}))}}const defaultManager=new class ModalManager{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(modal,container){let modalIndex=this.modals.indexOf(modal);if(-1!==modalIndex)return modalIndex;modalIndex=this.modals.length,this.modals.push(modal),modal.modalRef&&ariaHidden(modal.modalRef,!1);const hiddenSiblings=function getHiddenSiblings(container){const hiddenSiblings=[];return[].forEach.call(container.children,(element=>{"true"===element.getAttribute("aria-hidden")&&hiddenSiblings.push(element)})),hiddenSiblings}(container);ariaHiddenSiblings(container,modal.mount,modal.modalRef,hiddenSiblings,!0);const containerIndex=findIndexOf(this.containers,(item=>item.container===container));return-1!==containerIndex?(this.containers[containerIndex].modals.push(modal),modalIndex):(this.containers.push({modals:[modal],container,restore:null,hiddenSiblings}),modalIndex)}mount(modal,props){const containerIndex=findIndexOf(this.containers,(item=>-1!==item.modals.indexOf(modal))),containerInfo=this.containers[containerIndex];containerInfo.restore||(containerInfo.restore=handleContainer(containerInfo,props))}remove(modal,ariaHiddenState=!0){const modalIndex=this.modals.indexOf(modal);if(-1===modalIndex)return modalIndex;const containerIndex=findIndexOf(this.containers,(item=>-1!==item.modals.indexOf(modal))),containerInfo=this.containers[containerIndex];if(containerInfo.modals.splice(containerInfo.modals.indexOf(modal),1),this.modals.splice(modalIndex,1),0===containerInfo.modals.length)containerInfo.restore&&containerInfo.restore(),modal.modalRef&&ariaHidden(modal.modalRef,ariaHiddenState),ariaHiddenSiblings(containerInfo.container,modal.mount,modal.modalRef,containerInfo.hiddenSiblings,!1),this.containers.splice(containerIndex,1);else{const nextTop=containerInfo.modals[containerInfo.modals.length-1];nextTop.modalRef&&ariaHidden(nextTop.modalRef,!1)}return modalIndex}isTopModal(modal){return this.modals.length>0&&this.modals[this.modals.length-1]===modal}};function useModal(parameters){const{container,disableEscapeKeyDown=!1,disableScrollLock=!1,manager=defaultManager,closeAfterTransition=!1,onTransitionEnter,onTransitionExited,children,onClose,open,rootRef}=parameters,modal=react.useRef({}),mountNodeRef=react.useRef(null),modalRef=react.useRef(null),handleRef=(0,useForkRef.A)(modalRef,rootRef),[exited,setExited]=react.useState(!open),hasTransition=function getHasTransition(children){return!!children&&children.props.hasOwnProperty("in")}(children);let ariaHiddenProp=!0;"false"!==parameters["aria-hidden"]&&!1!==parameters["aria-hidden"]||(ariaHiddenProp=!1);const getModal=()=>(modal.current.modalRef=modalRef.current,modal.current.mount=mountNodeRef.current,modal.current),handleMounted=()=>{manager.mount(getModal(),{disableScrollLock}),modalRef.current&&(modalRef.current.scrollTop=0)},handleOpen=(0,useEventCallback.A)((()=>{const resolvedContainer=function getContainer(container){return"function"==typeof container?container():container}(container)||(0,ownerDocument.A)(mountNodeRef.current).body;manager.add(getModal(),resolvedContainer),modalRef.current&&handleMounted()})),isTopModal=react.useCallback((()=>manager.isTopModal(getModal())),[manager]),handlePortalRef=(0,useEventCallback.A)((node=>{mountNodeRef.current=node,node&&(open&&isTopModal()?handleMounted():modalRef.current&&ariaHidden(modalRef.current,ariaHiddenProp))})),handleClose=react.useCallback((()=>{manager.remove(getModal(),ariaHiddenProp)}),[ariaHiddenProp,manager]);react.useEffect((()=>()=>{handleClose()}),[handleClose]),react.useEffect((()=>{open?handleOpen():hasTransition&&closeAfterTransition||handleClose()}),[open,handleClose,hasTransition,closeAfterTransition,handleOpen]);const createHandleKeyDown=otherHandlers=>event=>{var _otherHandlers$onKeyD;null==(_otherHandlers$onKeyD=otherHandlers.onKeyDown)||_otherHandlers$onKeyD.call(otherHandlers,event),"Escape"===event.key&&229!==event.which&&isTopModal()&&(disableEscapeKeyDown||(event.stopPropagation(),onClose&&onClose(event,"escapeKeyDown")))},createHandleBackdropClick=otherHandlers=>event=>{var _otherHandlers$onClic;null==(_otherHandlers$onClic=otherHandlers.onClick)||_otherHandlers$onClic.call(otherHandlers,event),event.target===event.currentTarget&&onClose&&onClose(event,"backdropClick")};return{getRootProps:(otherHandlers={})=>{const propsEventHandlers=(0,extractEventHandlers.h)(parameters);delete propsEventHandlers.onTransitionEnter,delete propsEventHandlers.onTransitionExited;const externalEventHandlers=(0,esm_extends.A)({},propsEventHandlers,otherHandlers);return(0,esm_extends.A)({role:"presentation"},externalEventHandlers,{onKeyDown:createHandleKeyDown(externalEventHandlers),ref:handleRef})},getBackdropProps:(otherHandlers={})=>{const externalEventHandlers=otherHandlers;return(0,esm_extends.A)({"aria-hidden":!0},externalEventHandlers,{onClick:createHandleBackdropClick(externalEventHandlers),open})},getTransitionProps:()=>({onEnter:(0,createChainedFunction.A)((()=>{setExited(!1),onTransitionEnter&&onTransitionEnter()}),null==children?void 0:children.props.onEnter),onExited:(0,createChainedFunction.A)((()=>{setExited(!0),onTransitionExited&&onTransitionExited(),closeAfterTransition&&handleClose()}),null==children?void 0:children.props.onExited)}),rootRef:handleRef,portalRef:handlePortalRef,isTopModal,exited,hasTransition}}var composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const candidatesSelector=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function defaultGetTabbable(root){const regularTabNodes=[],orderedTabNodes=[];return Array.from(root.querySelectorAll(candidatesSelector)).forEach(((node,i)=>{const nodeTabIndex=function getTabIndex(node){const tabindexAttr=parseInt(node.getAttribute("tabindex")||"",10);return Number.isNaN(tabindexAttr)?"true"===node.contentEditable||("AUDIO"===node.nodeName||"VIDEO"===node.nodeName||"DETAILS"===node.nodeName)&&null===node.getAttribute("tabindex")?0:node.tabIndex:tabindexAttr}(node);-1!==nodeTabIndex&&function isNodeMatchingSelectorFocusable(node){return!(node.disabled||"INPUT"===node.tagName&&"hidden"===node.type||function isNonTabbableRadio(node){if("INPUT"!==node.tagName||"radio"!==node.type)return!1;if(!node.name)return!1;const getRadio=selector=>node.ownerDocument.querySelector(`input[type="radio"]${selector}`);let roving=getRadio(`[name="${node.name}"]:checked`);return roving||(roving=getRadio(`[name="${node.name}"]`)),roving!==node}(node))}(node)&&(0===nodeTabIndex?regularTabNodes.push(node):orderedTabNodes.push({documentOrder:i,tabIndex:nodeTabIndex,node}))})),orderedTabNodes.sort(((a,b)=>a.tabIndex===b.tabIndex?a.documentOrder-b.documentOrder:a.tabIndex-b.tabIndex)).map((a=>a.node)).concat(regularTabNodes)}function defaultIsEnabled(){return!0}function FocusTrap(props){const{children,disableAutoFocus=!1,disableEnforceFocus=!1,disableRestoreFocus=!1,getTabbable=defaultGetTabbable,isEnabled=defaultIsEnabled,open}=props,ignoreNextEnforceFocus=react.useRef(!1),sentinelStart=react.useRef(null),sentinelEnd=react.useRef(null),nodeToRestore=react.useRef(null),reactFocusEventTarget=react.useRef(null),activated=react.useRef(!1),rootRef=react.useRef(null),handleRef=(0,useForkRef.A)(children.ref,rootRef),lastKeydown=react.useRef(null);react.useEffect((()=>{open&&rootRef.current&&(activated.current=!disableAutoFocus)}),[disableAutoFocus,open]),react.useEffect((()=>{if(!open||!rootRef.current)return;const doc=(0,ownerDocument.A)(rootRef.current);return rootRef.current.contains(doc.activeElement)||(rootRef.current.hasAttribute("tabIndex")||rootRef.current.setAttribute("tabIndex","-1"),activated.current&&rootRef.current.focus()),()=>{disableRestoreFocus||(nodeToRestore.current&&nodeToRestore.current.focus&&(ignoreNextEnforceFocus.current=!0,nodeToRestore.current.focus()),nodeToRestore.current=null)}}),[open]),react.useEffect((()=>{if(!open||!rootRef.current)return;const doc=(0,ownerDocument.A)(rootRef.current),loopFocus=nativeEvent=>{lastKeydown.current=nativeEvent,!disableEnforceFocus&&isEnabled()&&"Tab"===nativeEvent.key&&doc.activeElement===rootRef.current&&nativeEvent.shiftKey&&(ignoreNextEnforceFocus.current=!0,sentinelEnd.current&&sentinelEnd.current.focus())},contain=()=>{const rootElement=rootRef.current;if(null===rootElement)return;if(!doc.hasFocus()||!isEnabled()||ignoreNextEnforceFocus.current)return void(ignoreNextEnforceFocus.current=!1);if(rootElement.contains(doc.activeElement))return;if(disableEnforceFocus&&doc.activeElement!==sentinelStart.current&&doc.activeElement!==sentinelEnd.current)return;if(doc.activeElement!==reactFocusEventTarget.current)reactFocusEventTarget.current=null;else if(null!==reactFocusEventTarget.current)return;if(!activated.current)return;let tabbable=[];if(doc.activeElement!==sentinelStart.current&&doc.activeElement!==sentinelEnd.current||(tabbable=getTabbable(rootRef.current)),tabbable.length>0){var _lastKeydown$current,_lastKeydown$current2;const isShiftTab=Boolean((null==(_lastKeydown$current=lastKeydown.current)?void 0:_lastKeydown$current.shiftKey)&&"Tab"===(null==(_lastKeydown$current2=lastKeydown.current)?void 0:_lastKeydown$current2.key)),focusNext=tabbable[0],focusPrevious=tabbable[tabbable.length-1];"string"!=typeof focusNext&&"string"!=typeof focusPrevious&&(isShiftTab?focusPrevious.focus():focusNext.focus())}else rootElement.focus()};doc.addEventListener("focusin",contain),doc.addEventListener("keydown",loopFocus,!0);const interval=setInterval((()=>{doc.activeElement&&"BODY"===doc.activeElement.tagName&&contain()}),50);return()=>{clearInterval(interval),doc.removeEventListener("focusin",contain),doc.removeEventListener("keydown",loopFocus,!0)}}),[disableAutoFocus,disableEnforceFocus,disableRestoreFocus,isEnabled,open,getTabbable]);const handleFocusSentinel=event=>{null===nodeToRestore.current&&(nodeToRestore.current=event.relatedTarget),activated.current=!0};return(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)("div",{tabIndex:open?0:-1,onFocus:handleFocusSentinel,ref:sentinelStart,"data-testid":"sentinelStart"}),react.cloneElement(children,{ref:handleRef,onFocus:event=>{null===nodeToRestore.current&&(nodeToRestore.current=event.relatedTarget),activated.current=!0,reactFocusEventTarget.current=event.target;const childrenPropsHandler=children.props.onFocus;childrenPropsHandler&&childrenPropsHandler(event)}}),(0,jsx_runtime.jsx)("div",{tabIndex:open?0:-1,onFocus:handleFocusSentinel,ref:sentinelEnd,"data-testid":"sentinelEnd"})]})}var Portal=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/Portal/Portal.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),Transition=__webpack_require__("./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/Transition.js"),useTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js"),utils=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/transitions/utils.js"),utils_useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js");const _excluded=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],styles={entering:{opacity:1},entered:{opacity:1}},Fade_Fade=react.forwardRef((function Fade(props,ref){const theme=(0,useTheme.A)(),defaultTimeout={enter:theme.transitions.duration.enteringScreen,exit:theme.transitions.duration.leavingScreen},{addEndListener,appear=!0,children,easing,in:inProp,onEnter,onEntered,onEntering,onExit,onExited,onExiting,style,timeout=defaultTimeout,TransitionComponent=Transition.Ay}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),nodeRef=react.useRef(null),handleRef=(0,utils_useForkRef.A)(nodeRef,children.ref,ref),normalizedTransitionCallback=callback=>maybeIsAppearing=>{if(callback){const node=nodeRef.current;void 0===maybeIsAppearing?callback(node):callback(node,maybeIsAppearing)}},handleEntering=normalizedTransitionCallback(onEntering),handleEnter=normalizedTransitionCallback(((node,isAppearing)=>{(0,utils.q)(node);const transitionProps=(0,utils.c)({style,timeout,easing},{mode:"enter"});node.style.webkitTransition=theme.transitions.create("opacity",transitionProps),node.style.transition=theme.transitions.create("opacity",transitionProps),onEnter&&onEnter(node,isAppearing)})),handleEntered=normalizedTransitionCallback(onEntered),handleExiting=normalizedTransitionCallback(onExiting),handleExit=normalizedTransitionCallback((node=>{const transitionProps=(0,utils.c)({style,timeout,easing},{mode:"exit"});node.style.webkitTransition=theme.transitions.create("opacity",transitionProps),node.style.transition=theme.transitions.create("opacity",transitionProps),onExit&&onExit(node)})),handleExited=normalizedTransitionCallback(onExited);return(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({appear,in:inProp,nodeRef,onEnter:handleEnter,onEntered:handleEntered,onEntering:handleEntering,onExit:handleExit,onExited:handleExited,onExiting:handleExiting,addEndListener:next=>{addEndListener&&addEndListener(nodeRef.current,next)},timeout},other,{children:(state,childProps)=>react.cloneElement(children,(0,esm_extends.A)({style:(0,esm_extends.A)({opacity:0,visibility:"exited"!==state||inProp?void 0:"hidden"},styles[state],style,children.props.style),ref:handleRef},childProps))}))}));var generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getBackdropUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiBackdrop",slot)}(0,generateUtilityClasses.A)("MuiBackdrop",["root","invisible"]);const Backdrop_excluded=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],BackdropRoot=(0,styled.Ay)("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,ownerState.invisible&&styles.invisible]}})((({ownerState})=>(0,esm_extends.A)({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},ownerState.invisible&&{backgroundColor:"transparent"}))),Backdrop_Backdrop=react.forwardRef((function Backdrop(inProps,ref){var _slotProps$root,_ref,_slots$root;const props=(0,useThemeProps.A)({props:inProps,name:"MuiBackdrop"}),{children,className,component="div",components={},componentsProps={},invisible=!1,open,slotProps={},slots={},TransitionComponent=Fade_Fade,transitionDuration}=props,other=(0,objectWithoutPropertiesLoose.A)(props,Backdrop_excluded),ownerState=(0,esm_extends.A)({},props,{component,invisible}),classes=(ownerState=>{const{classes,invisible}=ownerState,slots={root:["root",invisible&&"invisible"]};return(0,composeClasses.A)(slots,getBackdropUtilityClass,classes)})(ownerState),rootSlotProps=null!=(_slotProps$root=slotProps.root)?_slotProps$root:componentsProps.root;return(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({in:open,timeout:transitionDuration},other,{children:(0,jsx_runtime.jsx)(BackdropRoot,(0,esm_extends.A)({"aria-hidden":!0},rootSlotProps,{as:null!=(_ref=null!=(_slots$root=slots.root)?_slots$root:components.Root)?_ref:component,className:(0,clsx.A)(classes.root,className,null==rootSlotProps?void 0:rootSlotProps.className),ownerState:(0,esm_extends.A)({},ownerState,null==rootSlotProps?void 0:rootSlotProps.ownerState),classes,ref,children}))}))}));function getModalUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiModal",slot)}(0,generateUtilityClasses.A)("MuiModal",["root","hidden","backdrop"]);const Modal_excluded=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],ModalRoot=(0,styled.Ay)("div",{name:"MuiModal",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,!ownerState.open&&ownerState.exited&&styles.hidden]}})((({theme,ownerState})=>(0,esm_extends.A)({position:"fixed",zIndex:(theme.vars||theme).zIndex.modal,right:0,bottom:0,top:0,left:0},!ownerState.open&&ownerState.exited&&{visibility:"hidden"}))),ModalBackdrop=(0,styled.Ay)(Backdrop_Backdrop,{name:"MuiModal",slot:"Backdrop",overridesResolver:(props,styles)=>styles.backdrop})({zIndex:-1}),Modal_Modal=react.forwardRef((function Modal(inProps,ref){var _ref,_slots$root,_ref2,_slots$backdrop,_slotProps$root,_slotProps$backdrop;const props=(0,useThemeProps.A)({name:"MuiModal",props:inProps}),{BackdropComponent=ModalBackdrop,BackdropProps,className,closeAfterTransition=!1,children,container,component,components={},componentsProps={},disableAutoFocus=!1,disableEnforceFocus=!1,disableEscapeKeyDown=!1,disablePortal=!1,disableRestoreFocus=!1,disableScrollLock=!1,hideBackdrop=!1,keepMounted=!1,onBackdropClick,open,slotProps,slots}=props,other=(0,objectWithoutPropertiesLoose.A)(props,Modal_excluded),propsWithDefaults=(0,esm_extends.A)({},props,{closeAfterTransition,disableAutoFocus,disableEnforceFocus,disableEscapeKeyDown,disablePortal,disableRestoreFocus,disableScrollLock,hideBackdrop,keepMounted}),{getRootProps,getBackdropProps,getTransitionProps,portalRef,isTopModal,exited,hasTransition}=useModal((0,esm_extends.A)({},propsWithDefaults,{rootRef:ref})),ownerState=(0,esm_extends.A)({},propsWithDefaults,{exited}),classes=(ownerState=>{const{open,exited,classes}=ownerState,slots={root:["root",!open&&exited&&"hidden"],backdrop:["backdrop"]};return(0,composeClasses.A)(slots,getModalUtilityClass,classes)})(ownerState),childProps={};if(void 0===children.props.tabIndex&&(childProps.tabIndex="-1"),hasTransition){const{onEnter,onExited}=getTransitionProps();childProps.onEnter=onEnter,childProps.onExited=onExited}const RootSlot=null!=(_ref=null!=(_slots$root=null==slots?void 0:slots.root)?_slots$root:components.Root)?_ref:ModalRoot,BackdropSlot=null!=(_ref2=null!=(_slots$backdrop=null==slots?void 0:slots.backdrop)?_slots$backdrop:components.Backdrop)?_ref2:BackdropComponent,rootSlotProps=null!=(_slotProps$root=null==slotProps?void 0:slotProps.root)?_slotProps$root:componentsProps.root,backdropSlotProps=null!=(_slotProps$backdrop=null==slotProps?void 0:slotProps.backdrop)?_slotProps$backdrop:componentsProps.backdrop,rootProps=(0,useSlotProps.Q)({elementType:RootSlot,externalSlotProps:rootSlotProps,externalForwardedProps:other,getSlotProps:getRootProps,additionalProps:{ref,as:component},ownerState,className:(0,clsx.A)(className,null==rootSlotProps?void 0:rootSlotProps.className,null==classes?void 0:classes.root,!ownerState.open&&ownerState.exited&&(null==classes?void 0:classes.hidden))}),backdropProps=(0,useSlotProps.Q)({elementType:BackdropSlot,externalSlotProps:backdropSlotProps,additionalProps:BackdropProps,getSlotProps:otherHandlers=>getBackdropProps((0,esm_extends.A)({},otherHandlers,{onClick:e=>{onBackdropClick&&onBackdropClick(e),null!=otherHandlers&&otherHandlers.onClick&&otherHandlers.onClick(e)}})),className:(0,clsx.A)(null==backdropSlotProps?void 0:backdropSlotProps.className,null==BackdropProps?void 0:BackdropProps.className,null==classes?void 0:classes.backdrop),ownerState});return keepMounted||open||hasTransition&&!exited?(0,jsx_runtime.jsx)(Portal.Z,{ref:portalRef,container,disablePortal,children:(0,jsx_runtime.jsxs)(RootSlot,(0,esm_extends.A)({},rootProps,{children:[!hideBackdrop&&BackdropComponent?(0,jsx_runtime.jsx)(BackdropSlot,(0,esm_extends.A)({},backdropProps)):null,(0,jsx_runtime.jsx)(FocusTrap,{disableEnforceFocus,disableAutoFocus,disableRestoreFocus,isEnabled:isTopModal,open,children:react.cloneElement(children,childProps)})]}))}):null}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Paper/Paper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Paper_Paper});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js");const styles_getOverlayAlpha=elevation=>{let alphaValue;return alphaValue=elevation<1?5.11916*elevation**2:4.5*Math.log(elevation+1)+2,(alphaValue/100).toFixed(2)};var useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getPaperUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiPaper",slot)}(0,generateUtilityClasses.A)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["className","component","elevation","square","variant"],PaperRoot=(0,styled.Ay)("div",{name:"MuiPaper",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,styles[ownerState.variant],!ownerState.square&&styles.rounded,"elevation"===ownerState.variant&&styles[`elevation${ownerState.elevation}`]]}})((({theme,ownerState})=>{var _theme$vars$overlays;return(0,esm_extends.A)({backgroundColor:(theme.vars||theme).palette.background.paper,color:(theme.vars||theme).palette.text.primary,transition:theme.transitions.create("box-shadow")},!ownerState.square&&{borderRadius:theme.shape.borderRadius},"outlined"===ownerState.variant&&{border:`1px solid ${(theme.vars||theme).palette.divider}`},"elevation"===ownerState.variant&&(0,esm_extends.A)({boxShadow:(theme.vars||theme).shadows[ownerState.elevation]},!theme.vars&&"dark"===theme.palette.mode&&{backgroundImage:`linear-gradient(${(0,colorManipulator.X4)("#fff",styles_getOverlayAlpha(ownerState.elevation))}, ${(0,colorManipulator.X4)("#fff",styles_getOverlayAlpha(ownerState.elevation))})`},theme.vars&&{backgroundImage:null==(_theme$vars$overlays=theme.vars.overlays)?void 0:_theme$vars$overlays[ownerState.elevation]}))})),Paper_Paper=react.forwardRef((function Paper(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiPaper"}),{className,component="div",elevation=1,square=!1,variant="elevation"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),ownerState=(0,esm_extends.A)({},props,{component,elevation,square,variant}),classes=(ownerState=>{const{square,elevation,variant,classes}=ownerState,slots={root:["root",variant,!square&&"rounded","elevation"===variant&&`elevation${elevation}`]};return(0,composeClasses.A)(slots,getPaperUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsx)(PaperRoot,(0,esm_extends.A)({as:component,ownerState,className:(0,clsx.A)(classes.root,className),ref},other))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Snackbar/Snackbar.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Snackbar_Snackbar});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),useSlotProps=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/useSlotProps.js"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js"),useEventCallback=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEventCallback/useEventCallback.js"),ownerDocument=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");function mapEventPropToEvent(eventProp){return eventProp.substring(2).toLowerCase()}function ClickAwayListener(props){const{children,disableReactTree=!1,mouseEvent="onClick",onClickAway,touchEvent="onTouchEnd"}=props,movedRef=react.useRef(!1),nodeRef=react.useRef(null),activatedRef=react.useRef(!1),syntheticEventRef=react.useRef(!1);react.useEffect((()=>(setTimeout((()=>{activatedRef.current=!0}),0),()=>{activatedRef.current=!1})),[]);const handleRef=(0,useForkRef.A)(children.ref,nodeRef),handleClickAway=(0,useEventCallback.A)((event=>{const insideReactTree=syntheticEventRef.current;syntheticEventRef.current=!1;const doc=(0,ownerDocument.A)(nodeRef.current);if(!activatedRef.current||!nodeRef.current||"clientX"in event&&function clickedRootScrollbar(event,doc){return doc.documentElement.clientWidth<event.clientX||doc.documentElement.clientHeight<event.clientY}(event,doc))return;if(movedRef.current)return void(movedRef.current=!1);let insideDOM;insideDOM=event.composedPath?event.composedPath().indexOf(nodeRef.current)>-1:!doc.documentElement.contains(event.target)||nodeRef.current.contains(event.target),insideDOM||!disableReactTree&&insideReactTree||onClickAway(event)})),createHandleSynthetic=handlerName=>event=>{syntheticEventRef.current=!0;const childrenPropsHandler=children.props[handlerName];childrenPropsHandler&&childrenPropsHandler(event)},childrenProps={ref:handleRef};return!1!==touchEvent&&(childrenProps[touchEvent]=createHandleSynthetic(touchEvent)),react.useEffect((()=>{if(!1!==touchEvent){const mappedTouchEvent=mapEventPropToEvent(touchEvent),doc=(0,ownerDocument.A)(nodeRef.current),handleTouchMove=()=>{movedRef.current=!0};return doc.addEventListener(mappedTouchEvent,handleClickAway),doc.addEventListener("touchmove",handleTouchMove),()=>{doc.removeEventListener(mappedTouchEvent,handleClickAway),doc.removeEventListener("touchmove",handleTouchMove)}}}),[handleClickAway,touchEvent]),!1!==mouseEvent&&(childrenProps[mouseEvent]=createHandleSynthetic(mouseEvent)),react.useEffect((()=>{if(!1!==mouseEvent){const mappedMouseEvent=mapEventPropToEvent(mouseEvent),doc=(0,ownerDocument.A)(nodeRef.current);return doc.addEventListener(mappedMouseEvent,handleClickAway),()=>{doc.removeEventListener(mappedMouseEvent,handleClickAway)}}}),[handleClickAway,mouseEvent]),(0,jsx_runtime.jsx)(react.Fragment,{children:react.cloneElement(children,childrenProps)})}var useTimeout=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js"),extractEventHandlers=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/extractEventHandlers.js");var styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),Grow=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Grow/Grow.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),Paper=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Paper/Paper.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getSnackbarContentUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiSnackbarContent",slot)}(0,generateUtilityClasses.A)("MuiSnackbarContent",["root","message","action"]);const _excluded=["action","className","message","role"],SnackbarContentRoot=(0,styled.Ay)(Paper.A,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(props,styles)=>styles.root})((({theme})=>{const emphasis="light"===theme.palette.mode?.8:.98,backgroundColor=(0,colorManipulator.tL)(theme.palette.background.default,emphasis);return(0,esm_extends.A)({},theme.typography.body2,{color:theme.vars?theme.vars.palette.SnackbarContent.color:theme.palette.getContrastText(backgroundColor),backgroundColor:theme.vars?theme.vars.palette.SnackbarContent.bg:backgroundColor,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(theme.vars||theme).shape.borderRadius,flexGrow:1,[theme.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})})),SnackbarContentMessage=(0,styled.Ay)("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(props,styles)=>styles.message})({padding:"8px 0"}),SnackbarContentAction=(0,styled.Ay)("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(props,styles)=>styles.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),SnackbarContent_SnackbarContent=react.forwardRef((function SnackbarContent(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiSnackbarContent"}),{action,className,message,role="alert"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),ownerState=props,classes=(ownerState=>{const{classes}=ownerState;return(0,composeClasses.A)({root:["root"],action:["action"],message:["message"]},getSnackbarContentUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsxs)(SnackbarContentRoot,(0,esm_extends.A)({role,square:!0,elevation:6,className:(0,clsx.A)(classes.root,className),ownerState,ref},other,{children:[(0,jsx_runtime.jsx)(SnackbarContentMessage,{className:classes.message,ownerState,children:message}),action?(0,jsx_runtime.jsx)(SnackbarContentAction,{className:classes.action,ownerState,children:action}):null]}))}));function getSnackbarUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiSnackbar",slot)}(0,generateUtilityClasses.A)("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Snackbar_excluded=["onEnter","onExited"],_excluded2=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],SnackbarRoot=(0,styled.Ay)("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,styles[`anchorOrigin${(0,capitalize.A)(ownerState.anchorOrigin.vertical)}${(0,capitalize.A)(ownerState.anchorOrigin.horizontal)}`]]}})((({theme,ownerState})=>(0,esm_extends.A)({zIndex:(theme.vars||theme).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},"top"===ownerState.anchorOrigin.vertical?{top:8}:{bottom:8},"left"===ownerState.anchorOrigin.horizontal&&{justifyContent:"flex-start"},"right"===ownerState.anchorOrigin.horizontal&&{justifyContent:"flex-end"},{[theme.breakpoints.up("sm")]:(0,esm_extends.A)({},"top"===ownerState.anchorOrigin.vertical?{top:24}:{bottom:24},"center"===ownerState.anchorOrigin.horizontal&&{left:"50%",right:"auto",transform:"translateX(-50%)"},"left"===ownerState.anchorOrigin.horizontal&&{left:24,right:"auto"},"right"===ownerState.anchorOrigin.horizontal&&{right:24,left:"auto"})}))),Snackbar_Snackbar=react.forwardRef((function Snackbar(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiSnackbar"}),theme=(0,useTheme.A)(),defaultTransitionDuration={enter:theme.transitions.duration.enteringScreen,exit:theme.transitions.duration.leavingScreen},{action,anchorOrigin:{vertical,horizontal}={vertical:"bottom",horizontal:"left"},autoHideDuration=null,children,className,ClickAwayListenerProps,ContentProps,disableWindowBlurListener=!1,message,open,TransitionComponent=Grow.A,transitionDuration=defaultTransitionDuration,TransitionProps:{onEnter,onExited}={}}=props,TransitionProps=(0,objectWithoutPropertiesLoose.A)(props.TransitionProps,Snackbar_excluded),other=(0,objectWithoutPropertiesLoose.A)(props,_excluded2),ownerState=(0,esm_extends.A)({},props,{anchorOrigin:{vertical,horizontal},autoHideDuration,disableWindowBlurListener,TransitionComponent,transitionDuration}),classes=(ownerState=>{const{classes,anchorOrigin}=ownerState,slots={root:["root",`anchorOrigin${(0,capitalize.A)(anchorOrigin.vertical)}${(0,capitalize.A)(anchorOrigin.horizontal)}`]};return(0,composeClasses.A)(slots,getSnackbarUtilityClass,classes)})(ownerState),{getRootProps,onClickAway}=function useSnackbar(parameters={}){const{autoHideDuration=null,disableWindowBlurListener=!1,onClose,open,resumeHideDuration}=parameters,timerAutoHide=(0,useTimeout.A)();react.useEffect((()=>{if(open)return document.addEventListener("keydown",handleKeyDown),()=>{document.removeEventListener("keydown",handleKeyDown)};function handleKeyDown(nativeEvent){nativeEvent.defaultPrevented||"Escape"!==nativeEvent.key&&"Esc"!==nativeEvent.key||null==onClose||onClose(nativeEvent,"escapeKeyDown")}}),[open,onClose]);const handleClose=(0,useEventCallback.A)(((event,reason)=>{null==onClose||onClose(event,reason)})),setAutoHideTimer=(0,useEventCallback.A)((autoHideDurationParam=>{onClose&&null!=autoHideDurationParam&&timerAutoHide.start(autoHideDurationParam,(()=>{handleClose(null,"timeout")}))}));react.useEffect((()=>(open&&setAutoHideTimer(autoHideDuration),timerAutoHide.clear)),[open,autoHideDuration,setAutoHideTimer,timerAutoHide]);const handlePause=timerAutoHide.clear,handleResume=react.useCallback((()=>{null!=autoHideDuration&&setAutoHideTimer(null!=resumeHideDuration?resumeHideDuration:.5*autoHideDuration)}),[autoHideDuration,resumeHideDuration,setAutoHideTimer]),createHandleFocus=otherHandlers=>event=>{const onFocusCallback=otherHandlers.onFocus;null==onFocusCallback||onFocusCallback(event),handlePause()},createMouseEnter=otherHandlers=>event=>{const onMouseEnterCallback=otherHandlers.onMouseEnter;null==onMouseEnterCallback||onMouseEnterCallback(event),handlePause()},createMouseLeave=otherHandlers=>event=>{const onMouseLeaveCallback=otherHandlers.onMouseLeave;null==onMouseLeaveCallback||onMouseLeaveCallback(event),handleResume()};return react.useEffect((()=>{if(!disableWindowBlurListener&&open)return window.addEventListener("focus",handleResume),window.addEventListener("blur",handlePause),()=>{window.removeEventListener("focus",handleResume),window.removeEventListener("blur",handlePause)}}),[disableWindowBlurListener,open,handleResume,handlePause]),{getRootProps:(externalProps={})=>{const externalEventHandlers=(0,esm_extends.A)({},(0,extractEventHandlers.h)(parameters),(0,extractEventHandlers.h)(externalProps));return(0,esm_extends.A)({role:"presentation"},externalProps,externalEventHandlers,{onBlur:(otherHandlers=externalEventHandlers,event=>{const onBlurCallback=otherHandlers.onBlur;null==onBlurCallback||onBlurCallback(event),handleResume()}),onFocus:createHandleFocus(externalEventHandlers),onMouseEnter:createMouseEnter(externalEventHandlers),onMouseLeave:createMouseLeave(externalEventHandlers)});var otherHandlers},onClickAway:event=>{null==onClose||onClose(event,"clickaway")}}}((0,esm_extends.A)({},ownerState)),[exited,setExited]=react.useState(!0),rootProps=(0,useSlotProps.Q)({elementType:SnackbarRoot,getSlotProps:getRootProps,externalForwardedProps:other,ownerState,additionalProps:{ref},className:[classes.root,className]});return!open&&exited?null:(0,jsx_runtime.jsx)(ClickAwayListener,(0,esm_extends.A)({onClickAway},ClickAwayListenerProps,{children:(0,jsx_runtime.jsx)(SnackbarRoot,(0,esm_extends.A)({},rootProps,{children:(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({appear:!0,in:open,timeout:transitionDuration,direction:"top"===vertical?"down":"up",onEnter:(node,isAppearing)=>{setExited(!1),onEnter&&onEnter(node,isAppearing)},onExited:node=>{setExited(!0),onExited&&onExited(node)}},TransitionProps,{children:children||(0,jsx_runtime.jsx)(SnackbarContent_SnackbarContent,(0,esm_extends.A)({message,action},ContentProps))}))}))}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButton/ToggleButton.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ToggleButton_ToggleButton});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),resolveProps=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/resolveProps/resolveProps.js"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),formatMuiErrorMessage=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/formatMuiErrorMessage.js"),clamp=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/clamp/clamp.js");function clampWrapper(value,min=0,max=1){return(0,clamp.A)(value,min,max)}function decomposeColor(color){if(color.type)return color;if("#"===color.charAt(0))return decomposeColor(function hexToRgb(color){color=color.slice(1);const re=new RegExp(`.{1,${color.length>=6?2:1}}`,"g");let colors=color.match(re);return colors&&1===colors[0].length&&(colors=colors.map((n=>n+n))),colors?`rgb${4===colors.length?"a":""}(${colors.map(((n,index)=>index<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3)).join(", ")})`:""}(color));const marker=color.indexOf("("),type=color.substring(0,marker);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(type))throw new Error((0,formatMuiErrorMessage.A)(9,color));let colorSpace,values=color.substring(marker+1,color.length-1);if("color"===type){if(values=values.split(" "),colorSpace=values.shift(),4===values.length&&"/"===values[3].charAt(0)&&(values[3]=values[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(colorSpace))throw new Error((0,formatMuiErrorMessage.A)(10,colorSpace))}else values=values.split(",");return values=values.map((value=>parseFloat(value))),{type,values,colorSpace}}function recomposeColor(color){const{type,colorSpace}=color;let{values}=color;return-1!==type.indexOf("rgb")?values=values.map(((n,i)=>i<3?parseInt(n,10):n)):-1!==type.indexOf("hsl")&&(values[1]=`${values[1]}%`,values[2]=`${values[2]}%`),values=-1!==type.indexOf("color")?`${colorSpace} ${values.join(" ")}`:`${values.join(", ")}`,`${type}(${values})`}function alpha(color,value){return color=decomposeColor(color),value=clampWrapper(value),"rgb"!==color.type&&"hsl"!==color.type||(color.type+="a"),"color"===color.type?color.values[3]=`/${value}`:color.values[3]=value,recomposeColor(color)}var ButtonBase=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ButtonBase/ButtonBase.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),toggleButtonClasses=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButton/toggleButtonClasses.js"),ToggleButtonGroupContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupContext.js"),ToggleButtonGroupButtonContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupButtonContext.js");function isValueSelected(value,candidate){return void 0!==candidate&&void 0!==value&&(Array.isArray(candidate)?candidate.indexOf(value)>=0:value===candidate)}var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["value"],_excluded2=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],ToggleButtonRoot=(0,styled.Ay)(ButtonBase.A,{name:"MuiToggleButton",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,styles[`size${(0,capitalize.A)(ownerState.size)}`]]}})((({theme,ownerState})=>{let selectedColorChannel,selectedColor="standard"===ownerState.color?theme.palette.text.primary:theme.palette[ownerState.color].main;return theme.vars&&(selectedColor="standard"===ownerState.color?theme.vars.palette.text.primary:theme.vars.palette[ownerState.color].main,selectedColorChannel="standard"===ownerState.color?theme.vars.palette.text.primaryChannel:theme.vars.palette[ownerState.color].mainChannel),(0,esm_extends.A)({},theme.typography.button,{borderRadius:(theme.vars||theme).shape.borderRadius,padding:11,border:`1px solid ${(theme.vars||theme).palette.divider}`,color:(theme.vars||theme).palette.action.active},ownerState.fullWidth&&{width:"100%"},{[`&.${toggleButtonClasses.A.disabled}`]:{color:(theme.vars||theme).palette.action.disabled,border:`1px solid ${(theme.vars||theme).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:theme.vars?`rgba(${theme.vars.palette.text.primaryChannel} / ${theme.vars.palette.action.hoverOpacity})`:alpha(theme.palette.text.primary,theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${toggleButtonClasses.A.selected}`]:{color:selectedColor,backgroundColor:theme.vars?`rgba(${selectedColorChannel} / ${theme.vars.palette.action.selectedOpacity})`:alpha(selectedColor,theme.palette.action.selectedOpacity),"&:hover":{backgroundColor:theme.vars?`rgba(${selectedColorChannel} / calc(${theme.vars.palette.action.selectedOpacity} + ${theme.vars.palette.action.hoverOpacity}))`:alpha(selectedColor,theme.palette.action.selectedOpacity+theme.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:theme.vars?`rgba(${selectedColorChannel} / ${theme.vars.palette.action.selectedOpacity})`:alpha(selectedColor,theme.palette.action.selectedOpacity)}}}},"small"===ownerState.size&&{padding:7,fontSize:theme.typography.pxToRem(13)},"large"===ownerState.size&&{padding:15,fontSize:theme.typography.pxToRem(15)})})),ToggleButton_ToggleButton=react.forwardRef((function ToggleButton(inProps,ref){const _React$useContext=react.useContext(ToggleButtonGroupContext.A),{value:contextValue}=_React$useContext,contextProps=(0,objectWithoutPropertiesLoose.A)(_React$useContext,_excluded),toggleButtonGroupButtonContextPositionClassName=react.useContext(ToggleButtonGroupButtonContext.A),resolvedProps=(0,resolveProps.A)((0,esm_extends.A)({},contextProps,{selected:isValueSelected(inProps.value,contextValue)}),inProps),props=(0,useThemeProps.A)({props:resolvedProps,name:"MuiToggleButton"}),{children,className,color="standard",disabled=!1,disableFocusRipple=!1,fullWidth=!1,onChange,onClick,selected,size="medium",value}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded2),ownerState=(0,esm_extends.A)({},props,{color,disabled,disableFocusRipple,fullWidth,size}),classes=(ownerState=>{const{classes,fullWidth,selected,disabled,size,color}=ownerState,slots={root:["root",selected&&"selected",disabled&&"disabled",fullWidth&&"fullWidth",`size${(0,capitalize.A)(size)}`,color]};return(0,composeClasses.A)(slots,toggleButtonClasses.J,classes)})(ownerState),positionClassName=toggleButtonGroupButtonContextPositionClassName||"";return(0,jsx_runtime.jsx)(ToggleButtonRoot,(0,esm_extends.A)({className:(0,clsx.A)(contextProps.className,classes.root,className,positionClassName),disabled,focusRipple:!disableFocusRipple,ref,onClick:event=>{onClick&&(onClick(event,value),event.defaultPrevented)||onChange&&onChange(event,value)},onChange,value,ownerState,"aria-pressed":selected},other,{children}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButton/toggleButtonClasses.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,J:()=>getToggleButtonUtilityClass});var _mui_utils_generateUtilityClasses__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),_mui_utils_generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getToggleButtonUtilityClass(slot){return(0,_mui_utils_generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__.Ay)("MuiToggleButton",slot)}const __WEBPACK_DEFAULT_EXPORT__=(0,_mui_utils_generateUtilityClasses__WEBPACK_IMPORTED_MODULE_1__.A)("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"])},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ToggleButtonGroup_ToggleButtonGroup});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=(__webpack_require__("./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/index.js"),__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs")),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js");var styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getToggleButtonGroupUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiToggleButtonGroup",slot)}const ToggleButtonGroup_toggleButtonGroupClasses=(0,generateUtilityClasses.A)("MuiToggleButtonGroup",["root","selected","horizontal","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth","firstButton","lastButton","middleButton"]);var ToggleButtonGroupContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupContext.js"),ToggleButtonGroupButtonContext=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupButtonContext.js"),toggleButtonClasses=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButton/toggleButtonClasses.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],ToggleButtonGroupRoot=(0,styled.Ay)("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.grouped}`]:styles.grouped},{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.grouped}`]:styles[`grouped${(0,capitalize.A)(ownerState.orientation)}`]},{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.firstButton}`]:styles.firstButton},{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.lastButton}`]:styles.lastButton},{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}`]:styles.middleButton},styles.root,"vertical"===ownerState.orientation&&styles.vertical,ownerState.fullWidth&&styles.fullWidth]}})((({ownerState,theme})=>(0,esm_extends.A)({display:"inline-flex",borderRadius:(theme.vars||theme).shape.borderRadius},"vertical"===ownerState.orientation&&{flexDirection:"column"},ownerState.fullWidth&&{width:"100%"},{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.grouped}`]:(0,esm_extends.A)({},"horizontal"===ownerState.orientation?{[`&.${ToggleButtonGroup_toggleButtonGroupClasses.selected} + .${ToggleButtonGroup_toggleButtonGroupClasses.grouped}.${ToggleButtonGroup_toggleButtonGroupClasses.selected}`]:{borderLeft:0,marginLeft:0}}:{[`&.${ToggleButtonGroup_toggleButtonGroupClasses.selected} + .${ToggleButtonGroup_toggleButtonGroupClasses.grouped}.${ToggleButtonGroup_toggleButtonGroupClasses.selected}`]:{borderTop:0,marginTop:0}})},"horizontal"===ownerState.orientation?{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.firstButton},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${ToggleButtonGroup_toggleButtonGroupClasses.lastButton},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}`]:{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0}}:{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.firstButton},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${ToggleButtonGroup_toggleButtonGroupClasses.lastButton},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}`]:{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0}},"horizontal"===ownerState.orientation?{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.lastButton}.${toggleButtonClasses.A.disabled},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}.${toggleButtonClasses.A.disabled}`]:{borderLeft:"1px solid transparent"}}:{[`& .${ToggleButtonGroup_toggleButtonGroupClasses.lastButton}.${toggleButtonClasses.A.disabled},& .${ToggleButtonGroup_toggleButtonGroupClasses.middleButton}.${toggleButtonClasses.A.disabled}`]:{borderTop:"1px solid transparent"}}))),ToggleButtonGroup_ToggleButtonGroup=react.forwardRef((function ToggleButtonGroup(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiToggleButtonGroup"}),{children,className,color="standard",disabled=!1,exclusive=!1,fullWidth=!1,onChange,orientation="horizontal",size="medium",value}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),ownerState=(0,esm_extends.A)({},props,{disabled,fullWidth,orientation,size}),classes=(ownerState=>{const{classes,orientation,fullWidth,disabled}=ownerState,slots={root:["root","vertical"===orientation&&"vertical",fullWidth&&"fullWidth"],grouped:["grouped",`grouped${(0,capitalize.A)(orientation)}`,disabled&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return(0,composeClasses.A)(slots,getToggleButtonGroupUtilityClass,classes)})(ownerState),handleChange=react.useCallback(((event,buttonValue)=>{if(!onChange)return;const index=value&&value.indexOf(buttonValue);let newValue;value&&index>=0?(newValue=value.slice(),newValue.splice(index,1)):newValue=value?value.concat(buttonValue):[buttonValue],onChange(event,newValue)}),[onChange,value]),handleExclusiveChange=react.useCallback(((event,buttonValue)=>{onChange&&onChange(event,value===buttonValue?null:buttonValue)}),[onChange,value]),context=react.useMemo((()=>({className:classes.grouped,onChange:exclusive?handleExclusiveChange:handleChange,value,size,fullWidth,color,disabled})),[classes.grouped,exclusive,handleExclusiveChange,handleChange,value,size,fullWidth,color,disabled]),validChildren=function getValidReactChildren(children){return react.Children.toArray(children).filter((child=>react.isValidElement(child)))}(children),childrenCount=validChildren.length,getButtonPositionClassName=index=>{const isFirstButton=0===index,isLastButton=index===childrenCount-1;return isFirstButton&&isLastButton?"":isFirstButton?classes.firstButton:isLastButton?classes.lastButton:classes.middleButton};return(0,jsx_runtime.jsx)(ToggleButtonGroupRoot,(0,esm_extends.A)({role:"group",className:(0,clsx.A)(classes.root,className),ref,ownerState},other,{children:(0,jsx_runtime.jsx)(ToggleButtonGroupContext.A.Provider,{value:context,children:validChildren.map(((child,index)=>(0,jsx_runtime.jsx)(ToggleButtonGroupButtonContext.A.Provider,{value:getButtonPositionClassName(index),children:child},index)))})}))}))},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupButtonContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js").createContext(void 0)},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/ToggleButtonGroup/ToggleButtonGroupContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js").createContext({})},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Tooltip/Tooltip.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>Tooltip_Tooltip});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),useTimeout=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js"),appendOwnerState=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/appendOwnerState.js"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js"),RtlProvider=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/RtlProvider/index.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),useTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js"),Grow=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/Grow/Grow.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js"),useEnhancedEffect=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEnhancedEffect/useEnhancedEffect.js"),ownerDocument=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js");function getWindow(node){if(null==node)return window;if("[object Window]"!==node.toString()){var ownerDocument=node.ownerDocument;return ownerDocument&&ownerDocument.defaultView||window}return node}function isElement(node){return node instanceof getWindow(node).Element||node instanceof Element}function isHTMLElement(node){return node instanceof getWindow(node).HTMLElement||node instanceof HTMLElement}function isShadowRoot(node){return"undefined"!=typeof ShadowRoot&&(node instanceof getWindow(node).ShadowRoot||node instanceof ShadowRoot)}var math_max=Math.max,math_min=Math.min,round=Math.round;function getUAString(){var uaData=navigator.userAgentData;return null!=uaData&&uaData.brands&&Array.isArray(uaData.brands)?uaData.brands.map((function(item){return item.brand+"/"+item.version})).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(element,includeScale,isFixedStrategy){void 0===includeScale&&(includeScale=!1),void 0===isFixedStrategy&&(isFixedStrategy=!1);var clientRect=element.getBoundingClientRect(),scaleX=1,scaleY=1;includeScale&&isHTMLElement(element)&&(scaleX=element.offsetWidth>0&&round(clientRect.width)/element.offsetWidth||1,scaleY=element.offsetHeight>0&&round(clientRect.height)/element.offsetHeight||1);var visualViewport=(isElement(element)?getWindow(element):window).visualViewport,addVisualOffsets=!isLayoutViewport()&&isFixedStrategy,x=(clientRect.left+(addVisualOffsets&&visualViewport?visualViewport.offsetLeft:0))/scaleX,y=(clientRect.top+(addVisualOffsets&&visualViewport?visualViewport.offsetTop:0))/scaleY,width=clientRect.width/scaleX,height=clientRect.height/scaleY;return{width,height,top:y,right:x+width,bottom:y+height,left:x,x,y}}function getWindowScroll(node){var win=getWindow(node);return{scrollLeft:win.pageXOffset,scrollTop:win.pageYOffset}}function getNodeName(element){return element?(element.nodeName||"").toLowerCase():null}function getDocumentElement(element){return((isElement(element)?element.ownerDocument:element.document)||window.document).documentElement}function getWindowScrollBarX(element){return getBoundingClientRect(getDocumentElement(element)).left+getWindowScroll(element).scrollLeft}function getComputedStyle(element){return getWindow(element).getComputedStyle(element)}function isScrollParent(element){var _getComputedStyle=getComputedStyle(element),overflow=_getComputedStyle.overflow,overflowX=_getComputedStyle.overflowX,overflowY=_getComputedStyle.overflowY;return/auto|scroll|overlay|hidden/.test(overflow+overflowY+overflowX)}function getCompositeRect(elementOrVirtualElement,offsetParent,isFixed){void 0===isFixed&&(isFixed=!1);var isOffsetParentAnElement=isHTMLElement(offsetParent),offsetParentIsScaled=isHTMLElement(offsetParent)&&function isElementScaled(element){var rect=element.getBoundingClientRect(),scaleX=round(rect.width)/element.offsetWidth||1,scaleY=round(rect.height)/element.offsetHeight||1;return 1!==scaleX||1!==scaleY}(offsetParent),documentElement=getDocumentElement(offsetParent),rect=getBoundingClientRect(elementOrVirtualElement,offsetParentIsScaled,isFixed),scroll={scrollLeft:0,scrollTop:0},offsets={x:0,y:0};return(isOffsetParentAnElement||!isOffsetParentAnElement&&!isFixed)&&(("body"!==getNodeName(offsetParent)||isScrollParent(documentElement))&&(scroll=function getNodeScroll(node){return node!==getWindow(node)&&isHTMLElement(node)?function getHTMLElementScroll(element){return{scrollLeft:element.scrollLeft,scrollTop:element.scrollTop}}(node):getWindowScroll(node)}(offsetParent)),isHTMLElement(offsetParent)?((offsets=getBoundingClientRect(offsetParent,!0)).x+=offsetParent.clientLeft,offsets.y+=offsetParent.clientTop):documentElement&&(offsets.x=getWindowScrollBarX(documentElement))),{x:rect.left+scroll.scrollLeft-offsets.x,y:rect.top+scroll.scrollTop-offsets.y,width:rect.width,height:rect.height}}function getLayoutRect(element){var clientRect=getBoundingClientRect(element),width=element.offsetWidth,height=element.offsetHeight;return Math.abs(clientRect.width-width)<=1&&(width=clientRect.width),Math.abs(clientRect.height-height)<=1&&(height=clientRect.height),{x:element.offsetLeft,y:element.offsetTop,width,height}}function getParentNode(element){return"html"===getNodeName(element)?element:element.assignedSlot||element.parentNode||(isShadowRoot(element)?element.host:null)||getDocumentElement(element)}function getScrollParent(node){return["html","body","#document"].indexOf(getNodeName(node))>=0?node.ownerDocument.body:isHTMLElement(node)&&isScrollParent(node)?node:getScrollParent(getParentNode(node))}function listScrollParents(element,list){var _element$ownerDocumen;void 0===list&&(list=[]);var scrollParent=getScrollParent(element),isBody=scrollParent===(null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body),win=getWindow(scrollParent),target=isBody?[win].concat(win.visualViewport||[],isScrollParent(scrollParent)?scrollParent:[]):scrollParent,updatedList=list.concat(target);return isBody?updatedList:updatedList.concat(listScrollParents(getParentNode(target)))}function isTableElement(element){return["table","td","th"].indexOf(getNodeName(element))>=0}function getTrueOffsetParent(element){return isHTMLElement(element)&&"fixed"!==getComputedStyle(element).position?element.offsetParent:null}function getOffsetParent(element){for(var window=getWindow(element),offsetParent=getTrueOffsetParent(element);offsetParent&&isTableElement(offsetParent)&&"static"===getComputedStyle(offsetParent).position;)offsetParent=getTrueOffsetParent(offsetParent);return offsetParent&&("html"===getNodeName(offsetParent)||"body"===getNodeName(offsetParent)&&"static"===getComputedStyle(offsetParent).position)?window:offsetParent||function getContainingBlock(element){var isFirefox=/firefox/i.test(getUAString());if(/Trident/i.test(getUAString())&&isHTMLElement(element)&&"fixed"===getComputedStyle(element).position)return null;var currentNode=getParentNode(element);for(isShadowRoot(currentNode)&&(currentNode=currentNode.host);isHTMLElement(currentNode)&&["html","body"].indexOf(getNodeName(currentNode))<0;){var css=getComputedStyle(currentNode);if("none"!==css.transform||"none"!==css.perspective||"paint"===css.contain||-1!==["transform","perspective"].indexOf(css.willChange)||isFirefox&&"filter"===css.willChange||isFirefox&&css.filter&&"none"!==css.filter)return currentNode;currentNode=currentNode.parentNode}return null}(element)||window}var enums_top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[enums_top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce((function(acc,placement){return acc.concat([placement+"-"+start,placement+"-"+end])}),[]),enums_placements=[].concat(basePlacements,[auto]).reduce((function(acc,placement){return acc.concat([placement,placement+"-"+start,placement+"-"+end])}),[]),modifierPhases=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function order(modifiers){var map=new Map,visited=new Set,result=[];function sort(modifier){visited.add(modifier.name),[].concat(modifier.requires||[],modifier.requiresIfExists||[]).forEach((function(dep){if(!visited.has(dep)){var depModifier=map.get(dep);depModifier&&sort(depModifier)}})),result.push(modifier)}return modifiers.forEach((function(modifier){map.set(modifier.name,modifier)})),modifiers.forEach((function(modifier){visited.has(modifier.name)||sort(modifier)})),result}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return!args.some((function(element){return!(element&&"function"==typeof element.getBoundingClientRect)}))}function popperGenerator(generatorOptions){void 0===generatorOptions&&(generatorOptions={});var _generatorOptions=generatorOptions,_generatorOptions$def=_generatorOptions.defaultModifiers,defaultModifiers=void 0===_generatorOptions$def?[]:_generatorOptions$def,_generatorOptions$def2=_generatorOptions.defaultOptions,defaultOptions=void 0===_generatorOptions$def2?DEFAULT_OPTIONS:_generatorOptions$def2;return function createPopper(reference,popper,options){void 0===options&&(options=defaultOptions);var fn,pending,state={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,defaultOptions),modifiersData:{},elements:{reference,popper},attributes:{},styles:{}},effectCleanupFns=[],isDestroyed=!1,instance={state,setOptions:function setOptions(setOptionsAction){var options="function"==typeof setOptionsAction?setOptionsAction(state.options):setOptionsAction;cleanupModifierEffects(),state.options=Object.assign({},defaultOptions,state.options,options),state.scrollParents={reference:isElement(reference)?listScrollParents(reference):reference.contextElement?listScrollParents(reference.contextElement):[],popper:listScrollParents(popper)};var orderedModifiers=function orderModifiers(modifiers){var orderedModifiers=order(modifiers);return modifierPhases.reduce((function(acc,phase){return acc.concat(orderedModifiers.filter((function(modifier){return modifier.phase===phase})))}),[])}(function mergeByName(modifiers){var merged=modifiers.reduce((function(merged,current){var existing=merged[current.name];return merged[current.name]=existing?Object.assign({},existing,current,{options:Object.assign({},existing.options,current.options),data:Object.assign({},existing.data,current.data)}):current,merged}),{});return Object.keys(merged).map((function(key){return merged[key]}))}([].concat(defaultModifiers,state.options.modifiers)));return state.orderedModifiers=orderedModifiers.filter((function(m){return m.enabled})),function runModifierEffects(){state.orderedModifiers.forEach((function(_ref){var name=_ref.name,_ref$options=_ref.options,options=void 0===_ref$options?{}:_ref$options,effect=_ref.effect;if("function"==typeof effect){var cleanupFn=effect({state,name,instance,options}),noopFn=function noopFn(){};effectCleanupFns.push(cleanupFn||noopFn)}}))}(),instance.update()},forceUpdate:function forceUpdate(){if(!isDestroyed){var _state$elements=state.elements,reference=_state$elements.reference,popper=_state$elements.popper;if(areValidElements(reference,popper)){state.rects={reference:getCompositeRect(reference,getOffsetParent(popper),"fixed"===state.options.strategy),popper:getLayoutRect(popper)},state.reset=!1,state.placement=state.options.placement,state.orderedModifiers.forEach((function(modifier){return state.modifiersData[modifier.name]=Object.assign({},modifier.data)}));for(var index=0;index<state.orderedModifiers.length;index++)if(!0!==state.reset){var _state$orderedModifie=state.orderedModifiers[index],fn=_state$orderedModifie.fn,_state$orderedModifie2=_state$orderedModifie.options,_options=void 0===_state$orderedModifie2?{}:_state$orderedModifie2,name=_state$orderedModifie.name;"function"==typeof fn&&(state=fn({state,options:_options,name,instance})||state)}else state.reset=!1,index=-1}}},update:(fn=function(){return new Promise((function(resolve){instance.forceUpdate(),resolve(state)}))},function(){return pending||(pending=new Promise((function(resolve){Promise.resolve().then((function(){pending=void 0,resolve(fn())}))}))),pending}),destroy:function destroy(){cleanupModifierEffects(),isDestroyed=!0}};if(!areValidElements(reference,popper))return instance;function cleanupModifierEffects(){effectCleanupFns.forEach((function(fn){return fn()})),effectCleanupFns=[]}return instance.setOptions(options).then((function(state){!isDestroyed&&options.onFirstUpdate&&options.onFirstUpdate(state)})),instance}}var passive={passive:!0};function getBasePlacement(placement){return placement.split("-")[0]}function getVariation(placement){return placement.split("-")[1]}function getMainAxisFromPlacement(placement){return["top","bottom"].indexOf(placement)>=0?"x":"y"}function computeOffsets(_ref){var offsets,reference=_ref.reference,element=_ref.element,placement=_ref.placement,basePlacement=placement?getBasePlacement(placement):null,variation=placement?getVariation(placement):null,commonX=reference.x+reference.width/2-element.width/2,commonY=reference.y+reference.height/2-element.height/2;switch(basePlacement){case enums_top:offsets={x:commonX,y:reference.y-element.height};break;case bottom:offsets={x:commonX,y:reference.y+reference.height};break;case right:offsets={x:reference.x+reference.width,y:commonY};break;case left:offsets={x:reference.x-element.width,y:commonY};break;default:offsets={x:reference.x,y:reference.y}}var mainAxis=basePlacement?getMainAxisFromPlacement(basePlacement):null;if(null!=mainAxis){var len="y"===mainAxis?"height":"width";switch(variation){case start:offsets[mainAxis]=offsets[mainAxis]-(reference[len]/2-element[len]/2);break;case end:offsets[mainAxis]=offsets[mainAxis]+(reference[len]/2-element[len]/2)}}return offsets}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function mapToStyles(_ref2){var _Object$assign2,popper=_ref2.popper,popperRect=_ref2.popperRect,placement=_ref2.placement,variation=_ref2.variation,offsets=_ref2.offsets,position=_ref2.position,gpuAcceleration=_ref2.gpuAcceleration,adaptive=_ref2.adaptive,roundOffsets=_ref2.roundOffsets,isFixed=_ref2.isFixed,_offsets$x=offsets.x,x=void 0===_offsets$x?0:_offsets$x,_offsets$y=offsets.y,y=void 0===_offsets$y?0:_offsets$y,_ref3="function"==typeof roundOffsets?roundOffsets({x,y}):{x,y};x=_ref3.x,y=_ref3.y;var hasX=offsets.hasOwnProperty("x"),hasY=offsets.hasOwnProperty("y"),sideX=left,sideY=enums_top,win=window;if(adaptive){var offsetParent=getOffsetParent(popper),heightProp="clientHeight",widthProp="clientWidth";if(offsetParent===getWindow(popper)&&"static"!==getComputedStyle(offsetParent=getDocumentElement(popper)).position&&"absolute"===position&&(heightProp="scrollHeight",widthProp="scrollWidth"),placement===enums_top||(placement===left||placement===right)&&variation===end)sideY=bottom,y-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.height:offsetParent[heightProp])-popperRect.height,y*=gpuAcceleration?1:-1;if(placement===left||(placement===enums_top||placement===bottom)&&variation===end)sideX=right,x-=(isFixed&&offsetParent===win&&win.visualViewport?win.visualViewport.width:offsetParent[widthProp])-popperRect.width,x*=gpuAcceleration?1:-1}var _Object$assign,commonStyles=Object.assign({position},adaptive&&unsetSides),_ref4=!0===roundOffsets?function roundOffsetsByDPR(_ref,win){var x=_ref.x,y=_ref.y,dpr=win.devicePixelRatio||1;return{x:round(x*dpr)/dpr||0,y:round(y*dpr)/dpr||0}}({x,y},getWindow(popper)):{x,y};return x=_ref4.x,y=_ref4.y,gpuAcceleration?Object.assign({},commonStyles,((_Object$assign={})[sideY]=hasY?"0":"",_Object$assign[sideX]=hasX?"0":"",_Object$assign.transform=(win.devicePixelRatio||1)<=1?"translate("+x+"px, "+y+"px)":"translate3d("+x+"px, "+y+"px, 0)",_Object$assign)):Object.assign({},commonStyles,((_Object$assign2={})[sideY]=hasY?y+"px":"",_Object$assign2[sideX]=hasX?x+"px":"",_Object$assign2.transform="",_Object$assign2))}const modifiers_offset={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function offset(_ref2){var state=_ref2.state,options=_ref2.options,name=_ref2.name,_options$offset=options.offset,offset=void 0===_options$offset?[0,0]:_options$offset,data=enums_placements.reduce((function(acc,placement){return acc[placement]=function distanceAndSkiddingToXY(placement,rects,offset){var basePlacement=getBasePlacement(placement),invertDistance=[left,enums_top].indexOf(basePlacement)>=0?-1:1,_ref="function"==typeof offset?offset(Object.assign({},rects,{placement})):offset,skidding=_ref[0],distance=_ref[1];return skidding=skidding||0,distance=(distance||0)*invertDistance,[left,right].indexOf(basePlacement)>=0?{x:distance,y:skidding}:{x:skidding,y:distance}}(placement,state.rects,offset),acc}),{}),_data$state$placement=data[state.placement],x=_data$state$placement.x,y=_data$state$placement.y;null!=state.modifiersData.popperOffsets&&(state.modifiersData.popperOffsets.x+=x,state.modifiersData.popperOffsets.y+=y),state.modifiersData[name]=data}};var hash={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(placement){return placement.replace(/left|right|bottom|top/g,(function(matched){return hash[matched]}))}var getOppositeVariationPlacement_hash={start:"end",end:"start"};function getOppositeVariationPlacement(placement){return placement.replace(/start|end/g,(function(matched){return getOppositeVariationPlacement_hash[matched]}))}function contains(parent,child){var rootNode=child.getRootNode&&child.getRootNode();if(parent.contains(child))return!0;if(rootNode&&isShadowRoot(rootNode)){var next=child;do{if(next&&parent.isSameNode(next))return!0;next=next.parentNode||next.host}while(next)}return!1}function rectToClientRect(rect){return Object.assign({},rect,{left:rect.x,top:rect.y,right:rect.x+rect.width,bottom:rect.y+rect.height})}function getClientRectFromMixedType(element,clippingParent,strategy){return clippingParent===viewport?rectToClientRect(function getViewportRect(element,strategy){var win=getWindow(element),html=getDocumentElement(element),visualViewport=win.visualViewport,width=html.clientWidth,height=html.clientHeight,x=0,y=0;if(visualViewport){width=visualViewport.width,height=visualViewport.height;var layoutViewport=isLayoutViewport();(layoutViewport||!layoutViewport&&"fixed"===strategy)&&(x=visualViewport.offsetLeft,y=visualViewport.offsetTop)}return{width,height,x:x+getWindowScrollBarX(element),y}}(element,strategy)):isElement(clippingParent)?function getInnerBoundingClientRect(element,strategy){var rect=getBoundingClientRect(element,!1,"fixed"===strategy);return rect.top=rect.top+element.clientTop,rect.left=rect.left+element.clientLeft,rect.bottom=rect.top+element.clientHeight,rect.right=rect.left+element.clientWidth,rect.width=element.clientWidth,rect.height=element.clientHeight,rect.x=rect.left,rect.y=rect.top,rect}(clippingParent,strategy):rectToClientRect(function getDocumentRect(element){var _element$ownerDocumen,html=getDocumentElement(element),winScroll=getWindowScroll(element),body=null==(_element$ownerDocumen=element.ownerDocument)?void 0:_element$ownerDocumen.body,width=math_max(html.scrollWidth,html.clientWidth,body?body.scrollWidth:0,body?body.clientWidth:0),height=math_max(html.scrollHeight,html.clientHeight,body?body.scrollHeight:0,body?body.clientHeight:0),x=-winScroll.scrollLeft+getWindowScrollBarX(element),y=-winScroll.scrollTop;return"rtl"===getComputedStyle(body||html).direction&&(x+=math_max(html.clientWidth,body?body.clientWidth:0)-width),{width,height,x,y}}(getDocumentElement(element)))}function getClippingRect(element,boundary,rootBoundary,strategy){var mainClippingParents="clippingParents"===boundary?function getClippingParents(element){var clippingParents=listScrollParents(getParentNode(element)),clipperElement=["absolute","fixed"].indexOf(getComputedStyle(element).position)>=0&&isHTMLElement(element)?getOffsetParent(element):element;return isElement(clipperElement)?clippingParents.filter((function(clippingParent){return isElement(clippingParent)&&contains(clippingParent,clipperElement)&&"body"!==getNodeName(clippingParent)})):[]}(element):[].concat(boundary),clippingParents=[].concat(mainClippingParents,[rootBoundary]),firstClippingParent=clippingParents[0],clippingRect=clippingParents.reduce((function(accRect,clippingParent){var rect=getClientRectFromMixedType(element,clippingParent,strategy);return accRect.top=math_max(rect.top,accRect.top),accRect.right=math_min(rect.right,accRect.right),accRect.bottom=math_min(rect.bottom,accRect.bottom),accRect.left=math_max(rect.left,accRect.left),accRect}),getClientRectFromMixedType(element,firstClippingParent,strategy));return clippingRect.width=clippingRect.right-clippingRect.left,clippingRect.height=clippingRect.bottom-clippingRect.top,clippingRect.x=clippingRect.left,clippingRect.y=clippingRect.top,clippingRect}function mergePaddingObject(paddingObject){return Object.assign({},{top:0,right:0,bottom:0,left:0},paddingObject)}function expandToHashMap(value,keys){return keys.reduce((function(hashMap,key){return hashMap[key]=value,hashMap}),{})}function detectOverflow(state,options){void 0===options&&(options={});var _options=options,_options$placement=_options.placement,placement=void 0===_options$placement?state.placement:_options$placement,_options$strategy=_options.strategy,strategy=void 0===_options$strategy?state.strategy:_options$strategy,_options$boundary=_options.boundary,boundary=void 0===_options$boundary?clippingParents:_options$boundary,_options$rootBoundary=_options.rootBoundary,rootBoundary=void 0===_options$rootBoundary?viewport:_options$rootBoundary,_options$elementConte=_options.elementContext,elementContext=void 0===_options$elementConte?popper:_options$elementConte,_options$altBoundary=_options.altBoundary,altBoundary=void 0!==_options$altBoundary&&_options$altBoundary,_options$padding=_options.padding,padding=void 0===_options$padding?0:_options$padding,paddingObject=mergePaddingObject("number"!=typeof padding?padding:expandToHashMap(padding,basePlacements)),altContext=elementContext===popper?reference:popper,popperRect=state.rects.popper,element=state.elements[altBoundary?altContext:elementContext],clippingClientRect=getClippingRect(isElement(element)?element:element.contextElement||getDocumentElement(state.elements.popper),boundary,rootBoundary,strategy),referenceClientRect=getBoundingClientRect(state.elements.reference),popperOffsets=computeOffsets({reference:referenceClientRect,element:popperRect,strategy:"absolute",placement}),popperClientRect=rectToClientRect(Object.assign({},popperRect,popperOffsets)),elementClientRect=elementContext===popper?popperClientRect:referenceClientRect,overflowOffsets={top:clippingClientRect.top-elementClientRect.top+paddingObject.top,bottom:elementClientRect.bottom-clippingClientRect.bottom+paddingObject.bottom,left:clippingClientRect.left-elementClientRect.left+paddingObject.left,right:elementClientRect.right-clippingClientRect.right+paddingObject.right},offsetData=state.modifiersData.offset;if(elementContext===popper&&offsetData){var offset=offsetData[placement];Object.keys(overflowOffsets).forEach((function(key){var multiply=[right,bottom].indexOf(key)>=0?1:-1,axis=[enums_top,bottom].indexOf(key)>=0?"y":"x";overflowOffsets[key]+=offset[axis]*multiply}))}return overflowOffsets}function within(min,value,max){return math_max(min,math_min(value,max))}const modifiers_preventOverflow={name:"preventOverflow",enabled:!0,phase:"main",fn:function preventOverflow(_ref){var state=_ref.state,options=_ref.options,name=_ref.name,_options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0!==_options$altAxis&&_options$altAxis,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,padding=options.padding,_options$tether=options.tether,tether=void 0===_options$tether||_options$tether,_options$tetherOffset=options.tetherOffset,tetherOffset=void 0===_options$tetherOffset?0:_options$tetherOffset,overflow=detectOverflow(state,{boundary,rootBoundary,padding,altBoundary}),basePlacement=getBasePlacement(state.placement),variation=getVariation(state.placement),isBasePlacement=!variation,mainAxis=getMainAxisFromPlacement(basePlacement),altAxis=function getAltAxis(axis){return"x"===axis?"y":"x"}(mainAxis),popperOffsets=state.modifiersData.popperOffsets,referenceRect=state.rects.reference,popperRect=state.rects.popper,tetherOffsetValue="function"==typeof tetherOffset?tetherOffset(Object.assign({},state.rects,{placement:state.placement})):tetherOffset,normalizedTetherOffsetValue="number"==typeof tetherOffsetValue?{mainAxis:tetherOffsetValue,altAxis:tetherOffsetValue}:Object.assign({mainAxis:0,altAxis:0},tetherOffsetValue),offsetModifierState=state.modifiersData.offset?state.modifiersData.offset[state.placement]:null,data={x:0,y:0};if(popperOffsets){if(checkMainAxis){var _offsetModifierState$,mainSide="y"===mainAxis?enums_top:left,altSide="y"===mainAxis?bottom:right,len="y"===mainAxis?"height":"width",offset=popperOffsets[mainAxis],min=offset+overflow[mainSide],max=offset-overflow[altSide],additive=tether?-popperRect[len]/2:0,minLen=variation===start?referenceRect[len]:popperRect[len],maxLen=variation===start?-popperRect[len]:-referenceRect[len],arrowElement=state.elements.arrow,arrowRect=tether&&arrowElement?getLayoutRect(arrowElement):{width:0,height:0},arrowPaddingObject=state.modifiersData["arrow#persistent"]?state.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},arrowPaddingMin=arrowPaddingObject[mainSide],arrowPaddingMax=arrowPaddingObject[altSide],arrowLen=within(0,referenceRect[len],arrowRect[len]),minOffset=isBasePlacement?referenceRect[len]/2-additive-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis:minLen-arrowLen-arrowPaddingMin-normalizedTetherOffsetValue.mainAxis,maxOffset=isBasePlacement?-referenceRect[len]/2+additive+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis:maxLen+arrowLen+arrowPaddingMax+normalizedTetherOffsetValue.mainAxis,arrowOffsetParent=state.elements.arrow&&getOffsetParent(state.elements.arrow),clientOffset=arrowOffsetParent?"y"===mainAxis?arrowOffsetParent.clientTop||0:arrowOffsetParent.clientLeft||0:0,offsetModifierValue=null!=(_offsetModifierState$=null==offsetModifierState?void 0:offsetModifierState[mainAxis])?_offsetModifierState$:0,tetherMax=offset+maxOffset-offsetModifierValue,preventedOffset=within(tether?math_min(min,offset+minOffset-offsetModifierValue-clientOffset):min,offset,tether?math_max(max,tetherMax):max);popperOffsets[mainAxis]=preventedOffset,data[mainAxis]=preventedOffset-offset}if(checkAltAxis){var _offsetModifierState$2,_mainSide="x"===mainAxis?enums_top:left,_altSide="x"===mainAxis?bottom:right,_offset=popperOffsets[altAxis],_len="y"===altAxis?"height":"width",_min=_offset+overflow[_mainSide],_max=_offset-overflow[_altSide],isOriginSide=-1!==[enums_top,left].indexOf(basePlacement),_offsetModifierValue=null!=(_offsetModifierState$2=null==offsetModifierState?void 0:offsetModifierState[altAxis])?_offsetModifierState$2:0,_tetherMin=isOriginSide?_min:_offset-referenceRect[_len]-popperRect[_len]-_offsetModifierValue+normalizedTetherOffsetValue.altAxis,_tetherMax=isOriginSide?_offset+referenceRect[_len]+popperRect[_len]-_offsetModifierValue-normalizedTetherOffsetValue.altAxis:_max,_preventedOffset=tether&&isOriginSide?function withinMaxClamp(min,value,max){var v=within(min,value,max);return v>max?max:v}(_tetherMin,_offset,_tetherMax):within(tether?_tetherMin:_min,_offset,tether?_tetherMax:_max);popperOffsets[altAxis]=_preventedOffset,data[altAxis]=_preventedOffset-_offset}state.modifiersData[name]=data}},requiresIfExists:["offset"]};const modifiers_arrow={name:"arrow",enabled:!0,phase:"main",fn:function arrow(_ref){var _state$modifiersData$,state=_ref.state,name=_ref.name,options=_ref.options,arrowElement=state.elements.arrow,popperOffsets=state.modifiersData.popperOffsets,basePlacement=getBasePlacement(state.placement),axis=getMainAxisFromPlacement(basePlacement),len=[left,right].indexOf(basePlacement)>=0?"height":"width";if(arrowElement&&popperOffsets){var paddingObject=function toPaddingObject(padding,state){return mergePaddingObject("number"!=typeof(padding="function"==typeof padding?padding(Object.assign({},state.rects,{placement:state.placement})):padding)?padding:expandToHashMap(padding,basePlacements))}(options.padding,state),arrowRect=getLayoutRect(arrowElement),minProp="y"===axis?enums_top:left,maxProp="y"===axis?bottom:right,endDiff=state.rects.reference[len]+state.rects.reference[axis]-popperOffsets[axis]-state.rects.popper[len],startDiff=popperOffsets[axis]-state.rects.reference[axis],arrowOffsetParent=getOffsetParent(arrowElement),clientSize=arrowOffsetParent?"y"===axis?arrowOffsetParent.clientHeight||0:arrowOffsetParent.clientWidth||0:0,centerToReference=endDiff/2-startDiff/2,min=paddingObject[minProp],max=clientSize-arrowRect[len]-paddingObject[maxProp],center=clientSize/2-arrowRect[len]/2+centerToReference,offset=within(min,center,max),axisProp=axis;state.modifiersData[name]=((_state$modifiersData$={})[axisProp]=offset,_state$modifiersData$.centerOffset=offset-center,_state$modifiersData$)}},effect:function arrow_effect(_ref2){var state=_ref2.state,_options$element=_ref2.options.element,arrowElement=void 0===_options$element?"[data-popper-arrow]":_options$element;null!=arrowElement&&("string"!=typeof arrowElement||(arrowElement=state.elements.popper.querySelector(arrowElement)))&&contains(state.elements.popper,arrowElement)&&(state.elements.arrow=arrowElement)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getSideOffsets(overflow,rect,preventedOffsets){return void 0===preventedOffsets&&(preventedOffsets={x:0,y:0}),{top:overflow.top-rect.height-preventedOffsets.y,right:overflow.right-rect.width+preventedOffsets.x,bottom:overflow.bottom-rect.height+preventedOffsets.y,left:overflow.left-rect.width-preventedOffsets.x}}function isAnySideFullyClipped(overflow){return[enums_top,right,bottom,left].some((function(side){return overflow[side]>=0}))}var popper_createPopper=popperGenerator({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function fn(){},effect:function effect(_ref){var state=_ref.state,instance=_ref.instance,options=_ref.options,_options$scroll=options.scroll,scroll=void 0===_options$scroll||_options$scroll,_options$resize=options.resize,resize=void 0===_options$resize||_options$resize,window=getWindow(state.elements.popper),scrollParents=[].concat(state.scrollParents.reference,state.scrollParents.popper);return scroll&&scrollParents.forEach((function(scrollParent){scrollParent.addEventListener("scroll",instance.update,passive)})),resize&&window.addEventListener("resize",instance.update,passive),function(){scroll&&scrollParents.forEach((function(scrollParent){scrollParent.removeEventListener("scroll",instance.update,passive)})),resize&&window.removeEventListener("resize",instance.update,passive)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function popperOffsets(_ref){var state=_ref.state,name=_ref.name;state.modifiersData[name]=computeOffsets({reference:state.rects.reference,element:state.rects.popper,strategy:"absolute",placement:state.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function computeStyles(_ref5){var state=_ref5.state,options=_ref5.options,_options$gpuAccelerat=options.gpuAcceleration,gpuAcceleration=void 0===_options$gpuAccelerat||_options$gpuAccelerat,_options$adaptive=options.adaptive,adaptive=void 0===_options$adaptive||_options$adaptive,_options$roundOffsets=options.roundOffsets,roundOffsets=void 0===_options$roundOffsets||_options$roundOffsets,commonStyles={placement:getBasePlacement(state.placement),variation:getVariation(state.placement),popper:state.elements.popper,popperRect:state.rects.popper,gpuAcceleration,isFixed:"fixed"===state.options.strategy};null!=state.modifiersData.popperOffsets&&(state.styles.popper=Object.assign({},state.styles.popper,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.popperOffsets,position:state.options.strategy,adaptive,roundOffsets})))),null!=state.modifiersData.arrow&&(state.styles.arrow=Object.assign({},state.styles.arrow,mapToStyles(Object.assign({},commonStyles,{offsets:state.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets})))),state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-placement":state.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function applyStyles(_ref){var state=_ref.state;Object.keys(state.elements).forEach((function(name){var style=state.styles[name]||{},attributes=state.attributes[name]||{},element=state.elements[name];isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style),Object.keys(attributes).forEach((function(name){var value=attributes[name];!1===value?element.removeAttribute(name):element.setAttribute(name,!0===value?"":value)})))}))},effect:function applyStyles_effect(_ref2){var state=_ref2.state,initialStyles={popper:{position:state.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(state.elements.popper.style,initialStyles.popper),state.styles=initialStyles,state.elements.arrow&&Object.assign(state.elements.arrow.style,initialStyles.arrow),function(){Object.keys(state.elements).forEach((function(name){var element=state.elements[name],attributes=state.attributes[name]||{},style=Object.keys(state.styles.hasOwnProperty(name)?state.styles[name]:initialStyles[name]).reduce((function(style,property){return style[property]="",style}),{});isHTMLElement(element)&&getNodeName(element)&&(Object.assign(element.style,style),Object.keys(attributes).forEach((function(attribute){element.removeAttribute(attribute)})))}))}},requires:["computeStyles"]},modifiers_offset,{name:"flip",enabled:!0,phase:"main",fn:function flip(_ref){var state=_ref.state,options=_ref.options,name=_ref.name;if(!state.modifiersData[name]._skip){for(var _options$mainAxis=options.mainAxis,checkMainAxis=void 0===_options$mainAxis||_options$mainAxis,_options$altAxis=options.altAxis,checkAltAxis=void 0===_options$altAxis||_options$altAxis,specifiedFallbackPlacements=options.fallbackPlacements,padding=options.padding,boundary=options.boundary,rootBoundary=options.rootBoundary,altBoundary=options.altBoundary,_options$flipVariatio=options.flipVariations,flipVariations=void 0===_options$flipVariatio||_options$flipVariatio,allowedAutoPlacements=options.allowedAutoPlacements,preferredPlacement=state.options.placement,basePlacement=getBasePlacement(preferredPlacement),fallbackPlacements=specifiedFallbackPlacements||(basePlacement===preferredPlacement||!flipVariations?[getOppositePlacement(preferredPlacement)]:function getExpandedFallbackPlacements(placement){if(getBasePlacement(placement)===auto)return[];var oppositePlacement=getOppositePlacement(placement);return[getOppositeVariationPlacement(placement),oppositePlacement,getOppositeVariationPlacement(oppositePlacement)]}(preferredPlacement)),placements=[preferredPlacement].concat(fallbackPlacements).reduce((function(acc,placement){return acc.concat(getBasePlacement(placement)===auto?function computeAutoPlacement(state,options){void 0===options&&(options={});var _options=options,placement=_options.placement,boundary=_options.boundary,rootBoundary=_options.rootBoundary,padding=_options.padding,flipVariations=_options.flipVariations,_options$allowedAutoP=_options.allowedAutoPlacements,allowedAutoPlacements=void 0===_options$allowedAutoP?enums_placements:_options$allowedAutoP,variation=getVariation(placement),placements=variation?flipVariations?variationPlacements:variationPlacements.filter((function(placement){return getVariation(placement)===variation})):basePlacements,allowedPlacements=placements.filter((function(placement){return allowedAutoPlacements.indexOf(placement)>=0}));0===allowedPlacements.length&&(allowedPlacements=placements);var overflows=allowedPlacements.reduce((function(acc,placement){return acc[placement]=detectOverflow(state,{placement,boundary,rootBoundary,padding})[getBasePlacement(placement)],acc}),{});return Object.keys(overflows).sort((function(a,b){return overflows[a]-overflows[b]}))}(state,{placement,boundary,rootBoundary,padding,flipVariations,allowedAutoPlacements}):placement)}),[]),referenceRect=state.rects.reference,popperRect=state.rects.popper,checksMap=new Map,makeFallbackChecks=!0,firstFittingPlacement=placements[0],i=0;i<placements.length;i++){var placement=placements[i],_basePlacement=getBasePlacement(placement),isStartVariation=getVariation(placement)===start,isVertical=[enums_top,bottom].indexOf(_basePlacement)>=0,len=isVertical?"width":"height",overflow=detectOverflow(state,{placement,boundary,rootBoundary,altBoundary,padding}),mainVariationSide=isVertical?isStartVariation?right:left:isStartVariation?bottom:enums_top;referenceRect[len]>popperRect[len]&&(mainVariationSide=getOppositePlacement(mainVariationSide));var altVariationSide=getOppositePlacement(mainVariationSide),checks=[];if(checkMainAxis&&checks.push(overflow[_basePlacement]<=0),checkAltAxis&&checks.push(overflow[mainVariationSide]<=0,overflow[altVariationSide]<=0),checks.every((function(check){return check}))){firstFittingPlacement=placement,makeFallbackChecks=!1;break}checksMap.set(placement,checks)}if(makeFallbackChecks)for(var _loop=function _loop(_i){var fittingPlacement=placements.find((function(placement){var checks=checksMap.get(placement);if(checks)return checks.slice(0,_i).every((function(check){return check}))}));if(fittingPlacement)return firstFittingPlacement=fittingPlacement,"break"},_i=flipVariations?3:1;_i>0;_i--){if("break"===_loop(_i))break}state.placement!==firstFittingPlacement&&(state.modifiersData[name]._skip=!0,state.placement=firstFittingPlacement,state.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},modifiers_preventOverflow,modifiers_arrow,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function hide(_ref){var state=_ref.state,name=_ref.name,referenceRect=state.rects.reference,popperRect=state.rects.popper,preventedOffsets=state.modifiersData.preventOverflow,referenceOverflow=detectOverflow(state,{elementContext:"reference"}),popperAltOverflow=detectOverflow(state,{altBoundary:!0}),referenceClippingOffsets=getSideOffsets(referenceOverflow,referenceRect),popperEscapeOffsets=getSideOffsets(popperAltOverflow,popperRect,preventedOffsets),isReferenceHidden=isAnySideFullyClipped(referenceClippingOffsets),hasPopperEscaped=isAnySideFullyClipped(popperEscapeOffsets);state.modifiersData[name]={referenceClippingOffsets,popperEscapeOffsets,isReferenceHidden,hasPopperEscaped},state.attributes.popper=Object.assign({},state.attributes.popper,{"data-popper-reference-hidden":isReferenceHidden,"data-popper-escaped":hasPopperEscaped})}}]}),Portal=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/Portal/Portal.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");const GLOBAL_CLASS_PREFIX="base";function generateUtilityClass_generateUtilityClass(componentName,slot){const globalStateClass=generateUtilityClass.li[slot];return globalStateClass?function buildStateClass(state){return`${GLOBAL_CLASS_PREFIX}--${state}`}(globalStateClass):function buildSlotClass(componentName,slot){return`${GLOBAL_CLASS_PREFIX}-${componentName}-${slot}`}(componentName,slot)}function getPopperUtilityClass(slot){return generateUtilityClass_generateUtilityClass("Popper",slot)}(function generateUtilityClasses(componentName,slots){const result={};return slots.forEach((slot=>{result[slot]=generateUtilityClass_generateUtilityClass(componentName,slot)})),result})("Popper",["root"]);var useSlotProps=__webpack_require__("./node_modules/.pnpm/@mui+base@5.0.0-beta.40_3scdnhsmr7zu3cqadlewkavxvq/node_modules/@mui/base/utils/useSlotProps.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const defaultContextValue={disableDefaultClasses:!1},ClassNameConfiguratorContext=react.createContext(defaultContextValue);const _excluded=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],_excluded2=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function resolveAnchorEl(anchorEl){return"function"==typeof anchorEl?anchorEl():anchorEl}function Popper_isHTMLElement(element){return void 0!==element.nodeType}const useUtilityClasses=()=>(0,composeClasses.A)({root:["root"]},function useClassNamesOverride(generateUtilityClass){const{disableDefaultClasses}=react.useContext(ClassNameConfiguratorContext);return slot=>disableDefaultClasses?"":generateUtilityClass(slot)}(getPopperUtilityClass)),defaultPopperOptions={},PopperTooltip=react.forwardRef((function PopperTooltip(props,forwardedRef){var _slots$root;const{anchorEl,children,direction,disablePortal,modifiers,open,placement:initialPlacement,popperOptions,popperRef:popperRefProp,slotProps={},slots={},TransitionProps}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),tooltipRef=react.useRef(null),ownRef=(0,useForkRef.A)(tooltipRef,forwardedRef),popperRef=react.useRef(null),handlePopperRef=(0,useForkRef.A)(popperRef,popperRefProp),handlePopperRefRef=react.useRef(handlePopperRef);(0,useEnhancedEffect.A)((()=>{handlePopperRefRef.current=handlePopperRef}),[handlePopperRef]),react.useImperativeHandle(popperRefProp,(()=>popperRef.current),[]);const rtlPlacement=function flipPlacement(placement,direction){if("ltr"===direction)return placement;switch(placement){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return placement}}(initialPlacement,direction),[placement,setPlacement]=react.useState(rtlPlacement),[resolvedAnchorElement,setResolvedAnchorElement]=react.useState(resolveAnchorEl(anchorEl));react.useEffect((()=>{popperRef.current&&popperRef.current.forceUpdate()})),react.useEffect((()=>{anchorEl&&setResolvedAnchorElement(resolveAnchorEl(anchorEl))}),[anchorEl]),(0,useEnhancedEffect.A)((()=>{if(!resolvedAnchorElement||!open)return;let popperModifiers=[{name:"preventOverflow",options:{altBoundary:disablePortal}},{name:"flip",options:{altBoundary:disablePortal}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state})=>{setPlacement(state.placement)}}];null!=modifiers&&(popperModifiers=popperModifiers.concat(modifiers)),popperOptions&&null!=popperOptions.modifiers&&(popperModifiers=popperModifiers.concat(popperOptions.modifiers));const popper=popper_createPopper(resolvedAnchorElement,tooltipRef.current,(0,esm_extends.A)({placement:rtlPlacement},popperOptions,{modifiers:popperModifiers}));return handlePopperRefRef.current(popper),()=>{popper.destroy(),handlePopperRefRef.current(null)}}),[resolvedAnchorElement,disablePortal,modifiers,open,popperOptions,rtlPlacement]);const childProps={placement};null!==TransitionProps&&(childProps.TransitionProps=TransitionProps);const classes=useUtilityClasses(),Root=null!=(_slots$root=slots.root)?_slots$root:"div",rootProps=(0,useSlotProps.Q)({elementType:Root,externalSlotProps:slotProps.root,externalForwardedProps:other,additionalProps:{role:"tooltip",ref:ownRef},ownerState:props,className:classes.root});return(0,jsx_runtime.jsx)(Root,(0,esm_extends.A)({},rootProps,{children:"function"==typeof children?children(childProps):children}))})),Popper=react.forwardRef((function Popper(props,forwardedRef){const{anchorEl,children,container:containerProp,direction="ltr",disablePortal=!1,keepMounted=!1,modifiers,open,placement="bottom",popperOptions=defaultPopperOptions,popperRef,style,transition=!1,slotProps={},slots={}}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded2),[exited,setExited]=react.useState(!0);if(!keepMounted&&!open&&(!transition||exited))return null;let container;if(containerProp)container=containerProp;else if(anchorEl){const resolvedAnchorEl=resolveAnchorEl(anchorEl);container=resolvedAnchorEl&&Popper_isHTMLElement(resolvedAnchorEl)?(0,ownerDocument.A)(resolvedAnchorEl).body:(0,ownerDocument.A)(null).body}const display=open||!keepMounted||transition&&!exited?void 0:"none",transitionProps=transition?{in:open,onEnter:()=>{setExited(!1)},onExited:()=>{setExited(!0)}}:void 0;return(0,jsx_runtime.jsx)(Portal.Z,{disablePortal,container,children:(0,jsx_runtime.jsx)(PopperTooltip,(0,esm_extends.A)({anchorEl,direction,disablePortal,modifiers,ref:forwardedRef,open:transition?!exited:open,placement,popperOptions,popperRef,slotProps,slots},other,{style:(0,esm_extends.A)({position:"fixed",top:0,left:0,display},style),TransitionProps:transitionProps,children}))})}));var useThemeWithoutDefault=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/useThemeWithoutDefault.js");const Popper_excluded=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],PopperRoot=(0,styled.Ay)(Popper,{name:"MuiPopper",slot:"Root",overridesResolver:(props,styles)=>styles.root})({}),material_Popper_Popper=react.forwardRef((function Popper(inProps,ref){var _slots$root;const theme=(0,useThemeWithoutDefault.A)(),props=(0,useThemeProps.A)({props:inProps,name:"MuiPopper"}),{anchorEl,component,components,componentsProps,container,disablePortal,keepMounted,modifiers,open,placement,popperOptions,popperRef,transition,slots,slotProps}=props,other=(0,objectWithoutPropertiesLoose.A)(props,Popper_excluded),RootComponent=null!=(_slots$root=null==slots?void 0:slots.root)?_slots$root:null==components?void 0:components.Root,otherProps=(0,esm_extends.A)({anchorEl,container,disablePortal,keepMounted,modifiers,open,placement,popperOptions,popperRef,transition},other);return(0,jsx_runtime.jsx)(PopperRoot,(0,esm_extends.A)({as:component,direction:null==theme?void 0:theme.direction,slots:{root:RootComponent},slotProps:null!=slotProps?slotProps:componentsProps},otherProps,{ref}))}));var useEventCallback=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEventCallback.js"),utils_useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),useId=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useId.js"),useIsFocusVisible=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useIsFocusVisible.js"),useControlled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useControlled.js");function getTooltipUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiTooltip",slot)}const Tooltip_tooltipClasses=(0,__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js").A)("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),Tooltip_excluded=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];const TooltipPopper=(0,styled.Ay)(material_Popper_Popper,{name:"MuiTooltip",slot:"Popper",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.popper,!ownerState.disableInteractive&&styles.popperInteractive,ownerState.arrow&&styles.popperArrow,!ownerState.open&&styles.popperClose]}})((({theme,ownerState,open})=>(0,esm_extends.A)({zIndex:(theme.vars||theme).zIndex.tooltip,pointerEvents:"none"},!ownerState.disableInteractive&&{pointerEvents:"auto"},!open&&{pointerEvents:"none"},ownerState.arrow&&{[`&[data-popper-placement*="bottom"] .${Tooltip_tooltipClasses.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Tooltip_tooltipClasses.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Tooltip_tooltipClasses.arrow}`]:(0,esm_extends.A)({},ownerState.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${Tooltip_tooltipClasses.arrow}`]:(0,esm_extends.A)({},ownerState.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})}))),TooltipTooltip=(0,styled.Ay)("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.tooltip,ownerState.touch&&styles.touch,ownerState.arrow&&styles.tooltipArrow,styles[`tooltipPlacement${(0,capitalize.A)(ownerState.placement.split("-")[0])}`]]}})((({theme,ownerState})=>{return(0,esm_extends.A)({backgroundColor:theme.vars?theme.vars.palette.Tooltip.bg:(0,colorManipulator.X4)(theme.palette.grey[700],.92),borderRadius:(theme.vars||theme).shape.borderRadius,color:(theme.vars||theme).palette.common.white,fontFamily:theme.typography.fontFamily,padding:"4px 8px",fontSize:theme.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:theme.typography.fontWeightMedium},ownerState.arrow&&{position:"relative",margin:0},ownerState.touch&&{padding:"8px 16px",fontSize:theme.typography.pxToRem(14),lineHeight:(value=16/14,Math.round(1e5*value)/1e5)+"em",fontWeight:theme.typography.fontWeightRegular},{[`.${Tooltip_tooltipClasses.popper}[data-popper-placement*="left"] &`]:(0,esm_extends.A)({transformOrigin:"right center"},ownerState.isRtl?(0,esm_extends.A)({marginLeft:"14px"},ownerState.touch&&{marginLeft:"24px"}):(0,esm_extends.A)({marginRight:"14px"},ownerState.touch&&{marginRight:"24px"})),[`.${Tooltip_tooltipClasses.popper}[data-popper-placement*="right"] &`]:(0,esm_extends.A)({transformOrigin:"left center"},ownerState.isRtl?(0,esm_extends.A)({marginRight:"14px"},ownerState.touch&&{marginRight:"24px"}):(0,esm_extends.A)({marginLeft:"14px"},ownerState.touch&&{marginLeft:"24px"})),[`.${Tooltip_tooltipClasses.popper}[data-popper-placement*="top"] &`]:(0,esm_extends.A)({transformOrigin:"center bottom",marginBottom:"14px"},ownerState.touch&&{marginBottom:"24px"}),[`.${Tooltip_tooltipClasses.popper}[data-popper-placement*="bottom"] &`]:(0,esm_extends.A)({transformOrigin:"center top",marginTop:"14px"},ownerState.touch&&{marginTop:"24px"})});var value})),TooltipArrow=(0,styled.Ay)("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(props,styles)=>styles.arrow})((({theme})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:theme.vars?theme.vars.palette.Tooltip.bg:(0,colorManipulator.X4)(theme.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let hystersisOpen=!1;const hystersisTimer=new useTimeout.E;let cursorPosition={x:0,y:0};function composeEventHandler(handler,eventHandler){return(event,...params)=>{eventHandler&&eventHandler(event,...params),handler(event,...params)}}const Tooltip=react.forwardRef((function Tooltip(inProps,ref){var _ref,_slots$popper,_ref2,_ref3,_slots$transition,_ref4,_slots$tooltip,_ref5,_slots$arrow,_slotProps$popper,_ref6,_slotProps$popper2,_slotProps$transition,_slotProps$tooltip,_ref7,_slotProps$tooltip2,_slotProps$arrow,_ref8,_slotProps$arrow2;const props=(0,useThemeProps.A)({props:inProps,name:"MuiTooltip"}),{arrow=!1,children:childrenProp,components={},componentsProps={},describeChild=!1,disableFocusListener=!1,disableHoverListener=!1,disableInteractive:disableInteractiveProp=!1,disableTouchListener=!1,enterDelay=100,enterNextDelay=0,enterTouchDelay=700,followCursor=!1,id:idProp,leaveDelay=0,leaveTouchDelay=1500,onClose,onOpen,open:openProp,placement="bottom",PopperComponent:PopperComponentProp,PopperProps={},slotProps={},slots={},title,TransitionComponent:TransitionComponentProp=Grow.A,TransitionProps}=props,other=(0,objectWithoutPropertiesLoose.A)(props,Tooltip_excluded),children=react.isValidElement(childrenProp)?childrenProp:(0,jsx_runtime.jsx)("span",{children:childrenProp}),theme=(0,useTheme.A)(),isRtl=(0,RtlProvider.I)(),[childNode,setChildNode]=react.useState(),[arrowRef,setArrowRef]=react.useState(null),ignoreNonTouchEvents=react.useRef(!1),disableInteractive=disableInteractiveProp||followCursor,closeTimer=(0,useTimeout.A)(),enterTimer=(0,useTimeout.A)(),leaveTimer=(0,useTimeout.A)(),touchTimer=(0,useTimeout.A)(),[openState,setOpenState]=(0,useControlled.A)({controlled:openProp,default:!1,name:"Tooltip",state:"open"});let open=openState;const id=(0,useId.A)(idProp),prevUserSelect=react.useRef(),stopTouchInteraction=(0,useEventCallback.A)((()=>{void 0!==prevUserSelect.current&&(document.body.style.WebkitUserSelect=prevUserSelect.current,prevUserSelect.current=void 0),touchTimer.clear()}));react.useEffect((()=>stopTouchInteraction),[stopTouchInteraction]);const handleOpen=event=>{hystersisTimer.clear(),hystersisOpen=!0,setOpenState(!0),onOpen&&!open&&onOpen(event)},handleClose=(0,useEventCallback.A)((event=>{hystersisTimer.start(800+leaveDelay,(()=>{hystersisOpen=!1})),setOpenState(!1),onClose&&open&&onClose(event),closeTimer.start(theme.transitions.duration.shortest,(()=>{ignoreNonTouchEvents.current=!1}))})),handleMouseOver=event=>{ignoreNonTouchEvents.current&&"touchstart"!==event.type||(childNode&&childNode.removeAttribute("title"),enterTimer.clear(),leaveTimer.clear(),enterDelay||hystersisOpen&&enterNextDelay?enterTimer.start(hystersisOpen?enterNextDelay:enterDelay,(()=>{handleOpen(event)})):handleOpen(event))},handleMouseLeave=event=>{enterTimer.clear(),leaveTimer.start(leaveDelay,(()=>{handleClose(event)}))},{isFocusVisibleRef,onBlur:handleBlurVisible,onFocus:handleFocusVisible,ref:focusVisibleRef}=(0,useIsFocusVisible.A)(),[,setChildIsFocusVisible]=react.useState(!1),handleBlur=event=>{handleBlurVisible(event),!1===isFocusVisibleRef.current&&(setChildIsFocusVisible(!1),handleMouseLeave(event))},handleFocus=event=>{childNode||setChildNode(event.currentTarget),handleFocusVisible(event),!0===isFocusVisibleRef.current&&(setChildIsFocusVisible(!0),handleMouseOver(event))},detectTouchStart=event=>{ignoreNonTouchEvents.current=!0;const childrenProps=children.props;childrenProps.onTouchStart&&childrenProps.onTouchStart(event)},handleTouchStart=event=>{detectTouchStart(event),leaveTimer.clear(),closeTimer.clear(),stopTouchInteraction(),prevUserSelect.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",touchTimer.start(enterTouchDelay,(()=>{document.body.style.WebkitUserSelect=prevUserSelect.current,handleMouseOver(event)}))},handleTouchEnd=event=>{children.props.onTouchEnd&&children.props.onTouchEnd(event),stopTouchInteraction(),leaveTimer.start(leaveTouchDelay,(()=>{handleClose(event)}))};react.useEffect((()=>{if(open)return document.addEventListener("keydown",handleKeyDown),()=>{document.removeEventListener("keydown",handleKeyDown)};function handleKeyDown(nativeEvent){"Escape"!==nativeEvent.key&&"Esc"!==nativeEvent.key||handleClose(nativeEvent)}}),[handleClose,open]);const handleRef=(0,utils_useForkRef.A)(children.ref,focusVisibleRef,setChildNode,ref);title||0===title||(open=!1);const popperRef=react.useRef(),nameOrDescProps={},titleIsString="string"==typeof title;describeChild?(nameOrDescProps.title=open||!titleIsString||disableHoverListener?null:title,nameOrDescProps["aria-describedby"]=open?id:null):(nameOrDescProps["aria-label"]=titleIsString?title:null,nameOrDescProps["aria-labelledby"]=open&&!titleIsString?id:null);const childrenProps=(0,esm_extends.A)({},nameOrDescProps,other,children.props,{className:(0,clsx.A)(other.className,children.props.className),onTouchStart:detectTouchStart,ref:handleRef},followCursor?{onMouseMove:event=>{const childrenProps=children.props;childrenProps.onMouseMove&&childrenProps.onMouseMove(event),cursorPosition={x:event.clientX,y:event.clientY},popperRef.current&&popperRef.current.update()}}:{});const interactiveWrapperListeners={};disableTouchListener||(childrenProps.onTouchStart=handleTouchStart,childrenProps.onTouchEnd=handleTouchEnd),disableHoverListener||(childrenProps.onMouseOver=composeEventHandler(handleMouseOver,childrenProps.onMouseOver),childrenProps.onMouseLeave=composeEventHandler(handleMouseLeave,childrenProps.onMouseLeave),disableInteractive||(interactiveWrapperListeners.onMouseOver=handleMouseOver,interactiveWrapperListeners.onMouseLeave=handleMouseLeave)),disableFocusListener||(childrenProps.onFocus=composeEventHandler(handleFocus,childrenProps.onFocus),childrenProps.onBlur=composeEventHandler(handleBlur,childrenProps.onBlur),disableInteractive||(interactiveWrapperListeners.onFocus=handleFocus,interactiveWrapperListeners.onBlur=handleBlur));const popperOptions=react.useMemo((()=>{var _PopperProps$popperOp;let tooltipModifiers=[{name:"arrow",enabled:Boolean(arrowRef),options:{element:arrowRef,padding:4}}];return null!=(_PopperProps$popperOp=PopperProps.popperOptions)&&_PopperProps$popperOp.modifiers&&(tooltipModifiers=tooltipModifiers.concat(PopperProps.popperOptions.modifiers)),(0,esm_extends.A)({},PopperProps.popperOptions,{modifiers:tooltipModifiers})}),[arrowRef,PopperProps]),ownerState=(0,esm_extends.A)({},props,{isRtl,arrow,disableInteractive,placement,PopperComponentProp,touch:ignoreNonTouchEvents.current}),classes=(ownerState=>{const{classes,disableInteractive,arrow,touch,placement}=ownerState,slots={popper:["popper",!disableInteractive&&"popperInteractive",arrow&&"popperArrow"],tooltip:["tooltip",arrow&&"tooltipArrow",touch&&"touch",`tooltipPlacement${(0,capitalize.A)(placement.split("-")[0])}`],arrow:["arrow"]};return(0,composeClasses.A)(slots,getTooltipUtilityClass,classes)})(ownerState),PopperComponent=null!=(_ref=null!=(_slots$popper=slots.popper)?_slots$popper:components.Popper)?_ref:TooltipPopper,TransitionComponent=null!=(_ref2=null!=(_ref3=null!=(_slots$transition=slots.transition)?_slots$transition:components.Transition)?_ref3:TransitionComponentProp)?_ref2:Grow.A,TooltipComponent=null!=(_ref4=null!=(_slots$tooltip=slots.tooltip)?_slots$tooltip:components.Tooltip)?_ref4:TooltipTooltip,ArrowComponent=null!=(_ref5=null!=(_slots$arrow=slots.arrow)?_slots$arrow:components.Arrow)?_ref5:TooltipArrow,popperProps=(0,appendOwnerState.X)(PopperComponent,(0,esm_extends.A)({},PopperProps,null!=(_slotProps$popper=slotProps.popper)?_slotProps$popper:componentsProps.popper,{className:(0,clsx.A)(classes.popper,null==PopperProps?void 0:PopperProps.className,null==(_ref6=null!=(_slotProps$popper2=slotProps.popper)?_slotProps$popper2:componentsProps.popper)?void 0:_ref6.className)}),ownerState),transitionProps=(0,appendOwnerState.X)(TransitionComponent,(0,esm_extends.A)({},TransitionProps,null!=(_slotProps$transition=slotProps.transition)?_slotProps$transition:componentsProps.transition),ownerState),tooltipProps=(0,appendOwnerState.X)(TooltipComponent,(0,esm_extends.A)({},null!=(_slotProps$tooltip=slotProps.tooltip)?_slotProps$tooltip:componentsProps.tooltip,{className:(0,clsx.A)(classes.tooltip,null==(_ref7=null!=(_slotProps$tooltip2=slotProps.tooltip)?_slotProps$tooltip2:componentsProps.tooltip)?void 0:_ref7.className)}),ownerState),tooltipArrowProps=(0,appendOwnerState.X)(ArrowComponent,(0,esm_extends.A)({},null!=(_slotProps$arrow=slotProps.arrow)?_slotProps$arrow:componentsProps.arrow,{className:(0,clsx.A)(classes.arrow,null==(_ref8=null!=(_slotProps$arrow2=slotProps.arrow)?_slotProps$arrow2:componentsProps.arrow)?void 0:_ref8.className)}),ownerState);return(0,jsx_runtime.jsxs)(react.Fragment,{children:[react.cloneElement(children,childrenProps),(0,jsx_runtime.jsx)(PopperComponent,(0,esm_extends.A)({as:null!=PopperComponentProp?PopperComponentProp:material_Popper_Popper,placement,anchorEl:followCursor?{getBoundingClientRect:()=>({top:cursorPosition.y,left:cursorPosition.x,right:cursorPosition.x,bottom:cursorPosition.y,width:0,height:0})}:childNode,popperRef,open:!!childNode&&open,id,transition:!0},interactiveWrapperListeners,popperProps,{popperOptions,children:({TransitionProps:TransitionPropsInner})=>(0,jsx_runtime.jsx)(TransitionComponent,(0,esm_extends.A)({timeout:theme.transitions.duration.shorter},TransitionPropsInner,transitionProps,{children:(0,jsx_runtime.jsxs)(TooltipComponent,(0,esm_extends.A)({},tooltipProps,{children:[title,arrow?(0,jsx_runtime.jsx)(ArrowComponent,(0,esm_extends.A)({},tooltipArrowProps,{ref:setArrowRef})):null]}))}))}))]})})),Tooltip_Tooltip=Tooltip},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/ThemeProvider.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>styles_ThemeProvider_ThemeProvider});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");const useTheme_ThemeContext=react.createContext(null);function useTheme(){return react.useContext(useTheme_ThemeContext)}const nested="function"==typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__";var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const ThemeProvider_ThemeProvider=function ThemeProvider(props){const{children,theme:localTheme}=props,outerTheme=useTheme(),theme=react.useMemo((()=>{const output=null===outerTheme?localTheme:function mergeOuterLocalTheme(outerTheme,localTheme){if("function"==typeof localTheme)return localTheme(outerTheme);return(0,esm_extends.A)({},outerTheme,localTheme)}(outerTheme,localTheme);return null!=output&&(output[nested]=null!==outerTheme),output}),[localTheme,outerTheme]);return(0,jsx_runtime.jsx)(useTheme_ThemeContext.Provider,{value:theme,children})};var emotion_element_43c6fea0_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-element-43c6fea0.browser.esm.js"),useThemeWithoutDefault=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useThemeWithoutDefault.js"),RtlProvider=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/RtlProvider/index.js");const EMPTY_THEME={};function useThemeScoping(themeId,upperTheme,localTheme,isPrivate=!1){return react.useMemo((()=>{const resolvedTheme=themeId&&upperTheme[themeId]||upperTheme;if("function"==typeof localTheme){const mergedTheme=localTheme(resolvedTheme),result=themeId?(0,esm_extends.A)({},upperTheme,{[themeId]:mergedTheme}):mergedTheme;return isPrivate?()=>result:result}return themeId?(0,esm_extends.A)({},upperTheme,{[themeId]:localTheme}):(0,esm_extends.A)({},upperTheme,localTheme)}),[themeId,upperTheme,localTheme,isPrivate])}const esm_ThemeProvider_ThemeProvider=function ThemeProvider_ThemeProvider_ThemeProvider(props){const{children,theme:localTheme,themeId}=props,upperTheme=(0,useThemeWithoutDefault.A)(EMPTY_THEME),upperPrivateTheme=useTheme()||EMPTY_THEME,engineTheme=useThemeScoping(themeId,upperTheme,localTheme),privateTheme=useThemeScoping(themeId,upperPrivateTheme,localTheme,!0),rtlValue="rtl"===engineTheme.direction;return(0,jsx_runtime.jsx)(ThemeProvider_ThemeProvider,{theme:privateTheme,children:(0,jsx_runtime.jsx)(emotion_element_43c6fea0_browser_esm.T.Provider,{value:engineTheme,children:(0,jsx_runtime.jsx)(RtlProvider.A,{value:rtlValue,children})})})};var identifier=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js");const _excluded=["theme"];function styles_ThemeProvider_ThemeProvider(_ref){let{theme:themeInput}=_ref,props=(0,objectWithoutPropertiesLoose.A)(_ref,_excluded);const scopedTheme=themeInput[identifier.A];return(0,jsx_runtime.jsx)(esm_ThemeProvider_ThemeProvider,(0,esm_extends.A)({},props,{themeId:scopedTheme?identifier.A:void 0,theme:scopedTheme||themeInput}))}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/createTheme.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>styles_createTheme});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),formatMuiErrorMessage=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/formatMuiErrorMessage.js"),deepmerge=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js"),defaultSxConfig=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js"),styleFunctionSx=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js"),createTheme=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createTheme.js");var colorManipulator=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js");const colors_common={black:"#000",white:"#fff"},colors_grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},colors_purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},colors_red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},colors_orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},colors_blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},colors_lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},colors_green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},_excluded=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:colors_common.white,default:colors_common.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:colors_common.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:colors_common.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(intent,direction,shade,tonalOffset){const tonalOffsetLight=tonalOffset.light||tonalOffset,tonalOffsetDark=tonalOffset.dark||1.5*tonalOffset;intent[direction]||(intent.hasOwnProperty(shade)?intent[direction]=intent[shade]:"light"===direction?intent.light=(0,colorManipulator.a)(intent.main,tonalOffsetLight):"dark"===direction&&(intent.dark=(0,colorManipulator.e$)(intent.main,tonalOffsetDark)))}function createPalette(palette){const{mode="light",contrastThreshold=3,tonalOffset=.2}=palette,other=(0,objectWithoutPropertiesLoose.A)(palette,_excluded),primary=palette.primary||function getDefaultPrimary(mode="light"){return"dark"===mode?{main:colors_blue[200],light:colors_blue[50],dark:colors_blue[400]}:{main:colors_blue[700],light:colors_blue[400],dark:colors_blue[800]}}(mode),secondary=palette.secondary||function getDefaultSecondary(mode="light"){return"dark"===mode?{main:colors_purple[200],light:colors_purple[50],dark:colors_purple[400]}:{main:colors_purple[500],light:colors_purple[300],dark:colors_purple[700]}}(mode),error=palette.error||function getDefaultError(mode="light"){return"dark"===mode?{main:colors_red[500],light:colors_red[300],dark:colors_red[700]}:{main:colors_red[700],light:colors_red[400],dark:colors_red[800]}}(mode),info=palette.info||function getDefaultInfo(mode="light"){return"dark"===mode?{main:colors_lightBlue[400],light:colors_lightBlue[300],dark:colors_lightBlue[700]}:{main:colors_lightBlue[700],light:colors_lightBlue[500],dark:colors_lightBlue[900]}}(mode),success=palette.success||function getDefaultSuccess(mode="light"){return"dark"===mode?{main:colors_green[400],light:colors_green[300],dark:colors_green[700]}:{main:colors_green[800],light:colors_green[500],dark:colors_green[900]}}(mode),warning=palette.warning||function getDefaultWarning(mode="light"){return"dark"===mode?{main:colors_orange[400],light:colors_orange[300],dark:colors_orange[700]}:{main:"#ed6c02",light:colors_orange[500],dark:colors_orange[900]}}(mode);function getContrastText(background){return(0,colorManipulator.eM)(background,dark.text.primary)>=contrastThreshold?dark.text.primary:light.text.primary}const augmentColor=({color,name,mainShade=500,lightShade=300,darkShade=700})=>{if(!(color=(0,esm_extends.A)({},color)).main&&color[mainShade]&&(color.main=color[mainShade]),!color.hasOwnProperty("main"))throw new Error((0,formatMuiErrorMessage.A)(11,name?` (${name})`:"",mainShade));if("string"!=typeof color.main)throw new Error((0,formatMuiErrorMessage.A)(12,name?` (${name})`:"",JSON.stringify(color.main)));return addLightOrDark(color,"light",lightShade,tonalOffset),addLightOrDark(color,"dark",darkShade,tonalOffset),color.contrastText||(color.contrastText=getContrastText(color.main)),color},modes={dark,light};return(0,deepmerge.A)((0,esm_extends.A)({common:(0,esm_extends.A)({},colors_common),mode,primary:augmentColor({color:primary,name:"primary"}),secondary:augmentColor({color:secondary,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:augmentColor({color:error,name:"error"}),warning:augmentColor({color:warning,name:"warning"}),info:augmentColor({color:info,name:"info"}),success:augmentColor({color:success,name:"success"}),grey:colors_grey,contrastThreshold,getContrastText,augmentColor,tonalOffset},modes[mode]),other)}const createTypography_excluded=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(palette,typography){const _ref="function"==typeof typography?typography(palette):typography,{fontFamily=defaultFontFamily,fontSize=14,fontWeightLight=300,fontWeightRegular=400,fontWeightMedium=500,fontWeightBold=700,htmlFontSize=16,allVariants,pxToRem:pxToRem2}=_ref,other=(0,objectWithoutPropertiesLoose.A)(_ref,createTypography_excluded);const coef=fontSize/14,pxToRem=pxToRem2||(size=>size/htmlFontSize*coef+"rem"),buildVariant=(fontWeight,size,lineHeight,letterSpacing,casing)=>{return(0,esm_extends.A)({fontFamily,fontWeight,fontSize:pxToRem(size),lineHeight},fontFamily===defaultFontFamily?{letterSpacing:(value=letterSpacing/size,Math.round(1e5*value)/1e5)+"em"}:{},casing,allVariants);var value},variants={h1:buildVariant(fontWeightLight,96,1.167,-1.5),h2:buildVariant(fontWeightLight,60,1.2,-.5),h3:buildVariant(fontWeightRegular,48,1.167,0),h4:buildVariant(fontWeightRegular,34,1.235,.25),h5:buildVariant(fontWeightRegular,24,1.334,0),h6:buildVariant(fontWeightMedium,20,1.6,.15),subtitle1:buildVariant(fontWeightRegular,16,1.75,.15),subtitle2:buildVariant(fontWeightMedium,14,1.57,.1),body1:buildVariant(fontWeightRegular,16,1.5,.15),body2:buildVariant(fontWeightRegular,14,1.43,.15),button:buildVariant(fontWeightMedium,14,1.75,.4,caseAllCaps),caption:buildVariant(fontWeightRegular,12,1.66,.4),overline:buildVariant(fontWeightRegular,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,deepmerge.A)((0,esm_extends.A)({htmlFontSize,pxToRem,fontFamily,fontSize,fontWeightLight,fontWeightRegular,fontWeightMedium,fontWeightBold},variants),other,{clone:!1})}function createShadow(...px){return[`${px[0]}px ${px[1]}px ${px[2]}px ${px[3]}px rgba(0,0,0,0.2)`,`${px[4]}px ${px[5]}px ${px[6]}px ${px[7]}px rgba(0,0,0,0.14)`,`${px[8]}px ${px[9]}px ${px[10]}px ${px[11]}px rgba(0,0,0,0.12)`].join(",")}const styles_shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],createTransitions_excluded=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(milliseconds){return`${Math.round(milliseconds)}ms`}function getAutoHeightDuration(height){if(!height)return 0;const constant=height/36;return Math.round(10*(4+15*constant**.25+constant/5))}function createTransitions(inputTransitions){const mergedEasing=(0,esm_extends.A)({},easing,inputTransitions.easing),mergedDuration=(0,esm_extends.A)({},duration,inputTransitions.duration);return(0,esm_extends.A)({getAutoHeightDuration,create:(props=["all"],options={})=>{const{duration:durationOption=mergedDuration.standard,easing:easingOption=mergedEasing.easeInOut,delay=0}=options;(0,objectWithoutPropertiesLoose.A)(options,createTransitions_excluded);return(Array.isArray(props)?props:[props]).map((animatedProp=>`${animatedProp} ${"string"==typeof durationOption?durationOption:formatMs(durationOption)} ${easingOption} ${"string"==typeof delay?delay:formatMs(delay)}`)).join(",")}},inputTransitions,{easing:mergedEasing,duration:mergedDuration})}const styles_zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},createTheme_excluded=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme_createTheme(options={},...args){const{mixins:mixinsInput={},palette:paletteInput={},transitions:transitionsInput={},typography:typographyInput={}}=options,other=(0,objectWithoutPropertiesLoose.A)(options,createTheme_excluded);if(options.vars)throw new Error((0,formatMuiErrorMessage.A)(18));const palette=createPalette(paletteInput),systemTheme=(0,createTheme.A)(options);let muiTheme=(0,deepmerge.A)(systemTheme,{mixins:(breakpoints=systemTheme.breakpoints,mixins=mixinsInput,(0,esm_extends.A)({toolbar:{minHeight:56,[breakpoints.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[breakpoints.up("sm")]:{minHeight:64}}},mixins)),palette,shadows:styles_shadows.slice(),typography:createTypography(palette,typographyInput),transitions:createTransitions(transitionsInput),zIndex:(0,esm_extends.A)({},styles_zIndex)});var breakpoints,mixins;return muiTheme=(0,deepmerge.A)(muiTheme,other),muiTheme=args.reduce(((acc,argument)=>(0,deepmerge.A)(acc,argument)),muiTheme),muiTheme.unstable_sxConfig=(0,esm_extends.A)({},defaultSxConfig.A,null==other?void 0:other.unstable_sxConfig),muiTheme.unstable_sx=function sx(props){return(0,styleFunctionSx.A)({sx:props,theme:this})},muiTheme}const styles_createTheme=createTheme_createTheme},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/defaultTheme.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=(0,__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/createTheme.js").A)()},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__="$$material"},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/rootShouldForwardProp.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>styles_rootShouldForwardProp});const styles_slotShouldForwardProp=function slotShouldForwardProp(prop){return"ownerState"!==prop&&"theme"!==prop&&"sx"!==prop&&"as"!==prop},styles_rootShouldForwardProp=prop=>styles_slotShouldForwardProp(prop)&&"classes"!==prop},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__});var _mui_system_createStyled__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/createStyled.js"),_defaultTheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/defaultTheme.js"),_identifier__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js"),_rootShouldForwardProp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/rootShouldForwardProp.js");const __WEBPACK_DEFAULT_EXPORT__=(0,_mui_system_createStyled__WEBPACK_IMPORTED_MODULE_0__.Ay)({themeId:_identifier__WEBPACK_IMPORTED_MODULE_1__.A,defaultTheme:_defaultTheme__WEBPACK_IMPORTED_MODULE_2__.A,rootShouldForwardProp:_rootShouldForwardProp__WEBPACK_IMPORTED_MODULE_3__.A})},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useTheme.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useTheme});__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");var _mui_system__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useTheme.js"),_defaultTheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/defaultTheme.js"),_identifier__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js");function useTheme(){const theme=(0,_mui_system__WEBPACK_IMPORTED_MODULE_1__.A)(_defaultTheme__WEBPACK_IMPORTED_MODULE_2__.A);return theme[_identifier__WEBPACK_IMPORTED_MODULE_3__.A]||theme}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useThemeProps_useThemeProps});var resolveProps=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/resolveProps/resolveProps.js");var useTheme=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useTheme.js");function useThemeProps({props,name,defaultTheme,themeId}){let theme=(0,useTheme.A)(defaultTheme);themeId&&(theme=theme[themeId]||theme);const mergedProps=function getThemeProps(params){const{theme,name,props}=params;return theme&&theme.components&&theme.components[name]&&theme.components[name].defaultProps?(0,resolveProps.A)(theme.components[name].defaultProps,props):props}({theme,name,props});return mergedProps}var defaultTheme=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/defaultTheme.js"),identifier=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/identifier.js");function useThemeProps_useThemeProps({props,name}){return useThemeProps({props,name,defaultTheme:defaultTheme.A,themeId:identifier.A})}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/transitions/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>getTransitionProps,q:()=>reflow});const reflow=node=>node.scrollTop;function getTransitionProps(props,options){var _style$transitionDura,_style$transitionTimi;const{timeout,easing,style={}}=props;return{duration:null!=(_style$transitionDura=style.transitionDuration)?_style$transitionDura:"number"==typeof timeout?timeout:timeout[options.mode]||0,easing:null!=(_style$transitionTimi=style.transitionTimingFunction)?_style$transitionTimi:"object"==typeof easing?easing[options.mode]:easing,delay:style.transitionDelay}}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/capitalize.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/debounce.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>utils_debounce});const utils_debounce=function debounce(func,wait=166){let timeout;function debounced(...args){clearTimeout(timeout),timeout=setTimeout((()=>{func.apply(this,args)}),wait)}return debounced.clear=()=>{clearTimeout(timeout)},debounced}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{capitalize:()=>capitalize.A,createChainedFunction:()=>utils_createChainedFunction,createSvgIcon:()=>createSvgIcon,debounce:()=>debounce.A,deprecatedPropType:()=>utils_deprecatedPropType,isMuiElement:()=>utils_isMuiElement,ownerDocument:()=>ownerDocument.A,ownerWindow:()=>ownerWindow.A,requirePropFactory:()=>utils_requirePropFactory,setRef:()=>utils_setRef,unstable_ClassNameGenerator:()=>unstable_ClassNameGenerator,unstable_useEnhancedEffect:()=>useEnhancedEffect.A,unstable_useId:()=>useId.A,unsupportedProp:()=>utils_unsupportedProp,useControlled:()=>useControlled.A,useEventCallback:()=>useEventCallback.A,useForkRef:()=>useForkRef.A,useIsFocusVisible:()=>useIsFocusVisible.A});var ClassNameGenerator=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ClassNameGenerator/ClassNameGenerator.js"),capitalize=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/capitalize.js");const utils_createChainedFunction=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/createChainedFunction/createChainedFunction.js").A;var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),clsx=__webpack_require__("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),composeClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js"),useThemeProps=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/useThemeProps.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/styles/styled.js"),generateUtilityClasses=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js"),generateUtilityClass=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function getSvgIconUtilityClass(slot){return(0,generateUtilityClass.Ay)("MuiSvgIcon",slot)}(0,generateUtilityClasses.A)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],SvgIconRoot=(0,styled.Ay)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(props,styles)=>{const{ownerState}=props;return[styles.root,"inherit"!==ownerState.color&&styles[`color${(0,capitalize.A)(ownerState.color)}`],styles[`fontSize${(0,capitalize.A)(ownerState.fontSize)}`]]}})((({theme,ownerState})=>{var _theme$transitions,_theme$transitions$cr,_theme$transitions2,_theme$typography,_theme$typography$pxT,_theme$typography2,_theme$typography2$px,_theme$typography3,_theme$typography3$px,_palette$ownerState$c,_palette,_palette2,_palette3;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:ownerState.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(_theme$transitions=theme.transitions)||null==(_theme$transitions$cr=_theme$transitions.create)?void 0:_theme$transitions$cr.call(_theme$transitions,"fill",{duration:null==(_theme$transitions2=theme.transitions)||null==(_theme$transitions2=_theme$transitions2.duration)?void 0:_theme$transitions2.shorter}),fontSize:{inherit:"inherit",small:(null==(_theme$typography=theme.typography)||null==(_theme$typography$pxT=_theme$typography.pxToRem)?void 0:_theme$typography$pxT.call(_theme$typography,20))||"1.25rem",medium:(null==(_theme$typography2=theme.typography)||null==(_theme$typography2$px=_theme$typography2.pxToRem)?void 0:_theme$typography2$px.call(_theme$typography2,24))||"1.5rem",large:(null==(_theme$typography3=theme.typography)||null==(_theme$typography3$px=_theme$typography3.pxToRem)?void 0:_theme$typography3$px.call(_theme$typography3,35))||"2.1875rem"}[ownerState.fontSize],color:null!=(_palette$ownerState$c=null==(_palette=(theme.vars||theme).palette)||null==(_palette=_palette[ownerState.color])?void 0:_palette.main)?_palette$ownerState$c:{action:null==(_palette2=(theme.vars||theme).palette)||null==(_palette2=_palette2.action)?void 0:_palette2.active,disabled:null==(_palette3=(theme.vars||theme).palette)||null==(_palette3=_palette3.action)?void 0:_palette3.disabled,inherit:void 0}[ownerState.color]}})),SvgIcon=react.forwardRef((function SvgIcon(inProps,ref){const props=(0,useThemeProps.A)({props:inProps,name:"MuiSvgIcon"}),{children,className,color="inherit",component="svg",fontSize="medium",htmlColor,inheritViewBox=!1,titleAccess,viewBox="0 0 24 24"}=props,other=(0,objectWithoutPropertiesLoose.A)(props,_excluded),hasSvgAsChild=react.isValidElement(children)&&"svg"===children.type,ownerState=(0,esm_extends.A)({},props,{color,component,fontSize,instanceFontSize:inProps.fontSize,inheritViewBox,viewBox,hasSvgAsChild}),more={};inheritViewBox||(more.viewBox=viewBox);const classes=(ownerState=>{const{color,fontSize,classes}=ownerState,slots={root:["root","inherit"!==color&&`color${(0,capitalize.A)(color)}`,`fontSize${(0,capitalize.A)(fontSize)}`]};return(0,composeClasses.A)(slots,getSvgIconUtilityClass,classes)})(ownerState);return(0,jsx_runtime.jsxs)(SvgIconRoot,(0,esm_extends.A)({as:component,className:(0,clsx.A)(classes.root,className),focusable:"false",color:htmlColor,"aria-hidden":!titleAccess||void 0,role:titleAccess?"img":void 0,ref},more,other,hasSvgAsChild&&children.props,{ownerState,children:[hasSvgAsChild?children.props.children:children,titleAccess?(0,jsx_runtime.jsx)("title",{children:titleAccess}):null]}))}));SvgIcon.muiName="SvgIcon";const SvgIcon_SvgIcon=SvgIcon;function createSvgIcon(path,displayName){function Component(props,ref){return(0,jsx_runtime.jsx)(SvgIcon_SvgIcon,(0,esm_extends.A)({"data-testid":`${displayName}Icon`,ref},props,{children:path}))}return Component.muiName=SvgIcon_SvgIcon.muiName,react.memo(react.forwardRef(Component))}var debounce=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/debounce.js");const utils_deprecatedPropType=function deprecatedPropType(validator,reason){return()=>null};const utils_isMuiElement=function isMuiElement(element,muiNames){var _muiName,_element$type;return react.isValidElement(element)&&-1!==muiNames.indexOf(null!=(_muiName=element.type.muiName)?_muiName:null==(_element$type=element.type)||null==(_element$type=_element$type._payload)||null==(_element$type=_element$type.value)?void 0:_element$type.muiName)};var ownerDocument=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerDocument.js"),ownerWindow=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerWindow.js");const utils_requirePropFactory=function requirePropFactory(componentNameInError,Component){return()=>null};const utils_setRef=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/setRef/setRef.js").A;var useEnhancedEffect=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEnhancedEffect.js"),useId=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useId.js");const utils_unsupportedProp=function unsupportedProp(props,propName,componentName,location,propFullName){return null};var useControlled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useControlled.js"),useEventCallback=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEventCallback.js"),useForkRef=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js"),useIsFocusVisible=__webpack_require__("./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useIsFocusVisible.js");const unstable_ClassNameGenerator={configure:generator=>{ClassNameGenerator.A.configure(generator)}}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerDocument.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/ownerWindow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerWindow/ownerWindow.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useControlled.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>utils_useControlled});var react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");const utils_useControlled=function useControlled({controlled,default:defaultProp,name,state="value"}){const{current:isControlled}=react.useRef(void 0!==controlled),[valueState,setValue]=react.useState(defaultProp);return[isControlled?controlled:valueState,react.useCallback((newValue=>{isControlled||setValue(newValue)}),[])]}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEnhancedEffect.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEnhancedEffect/useEnhancedEffect.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useEventCallback.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEventCallback/useEventCallback.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useForkRef.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js").A},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useId.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>utils_useId});var react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");let globalId=0;const maybeReactUseId=__webpack_require__.t(react,2)["useId".toString()];const utils_useId=function useId(idOverride){if(void 0!==maybeReactUseId){const reactId=maybeReactUseId();return null!=idOverride?idOverride:reactId}return function useGlobalId(idOverride){const[defaultId,setDefaultId]=react.useState(idOverride),id=idOverride||defaultId;return react.useEffect((()=>{null==defaultId&&(globalId+=1,setDefaultId(`mui-${globalId}`))}),[defaultId]),id}(idOverride)}},"./node_modules/.pnpm/@mui+material@5.15.19_akggjhmfkycascbve4aj7adzla/node_modules/@mui/material/utils/useIsFocusVisible.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>utils_useIsFocusVisible});var react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),useTimeout=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js");let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1;const hadFocusVisibleRecentlyTimeout=new useTimeout.E,inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function handleKeyDown(event){event.metaKey||event.altKey||event.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){"hidden"===this.visibilityState&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function isFocusVisible(event){const{target}=event;try{return target.matches(":focus-visible")}catch(error){}return hadKeyboardEvent||function focusTriggersKeyboardModality(node){const{type,tagName}=node;return!("INPUT"!==tagName||!inputTypesWhitelist[type]||node.readOnly)||"TEXTAREA"===tagName&&!node.readOnly||!!node.isContentEditable}(target)}const utils_useIsFocusVisible=function useIsFocusVisible(){const ref=react.useCallback((node=>{null!=node&&function prepare(doc){doc.addEventListener("keydown",handleKeyDown,!0),doc.addEventListener("mousedown",handlePointerDown,!0),doc.addEventListener("pointerdown",handlePointerDown,!0),doc.addEventListener("touchstart",handlePointerDown,!0),doc.addEventListener("visibilitychange",handleVisibilityChange,!0)}(node.ownerDocument)}),[]),isFocusVisibleRef=react.useRef(!1);return{isFocusVisibleRef,onFocus:function handleFocusVisible(event){return!!isFocusVisible(event)&&(isFocusVisibleRef.current=!0,!0)},onBlur:function handleBlurVisible(){return!!isFocusVisibleRef.current&&(hadFocusVisibleRecently=!0,hadFocusVisibleRecentlyTimeout.start(100,(()=>{hadFocusVisibleRecently=!1})),isFocusVisibleRef.current=!1,!0)},ref}}},"./node_modules/.pnpm/@mui+styled-engine@5.15.14_hj6yibkjkhvdx4xakusaw2oiva/node_modules/@mui/styled-engine/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{GlobalStyles:()=>GlobalStyles,StyledEngineProvider:()=>StyledEngineProvider,ThemeContext:()=>emotion_element_43c6fea0_browser_esm.T,css:()=>emotion_react_browser_esm.AH,default:()=>styled,internal_processStyles:()=>internal_processStyles,keyframes:()=>emotion_react_browser_esm.i7});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),emotion_memoize_esm=__webpack_require__("./node_modules/.pnpm/@emotion+memoize@0.8.1/node_modules/@emotion/memoize/dist/emotion-memoize.esm.js"),reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=(0,emotion_memoize_esm.A)((function(prop){return reactPropsRegex.test(prop)||111===prop.charCodeAt(0)&&110===prop.charCodeAt(1)&&prop.charCodeAt(2)<91})),emotion_element_43c6fea0_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-element-43c6fea0.browser.esm.js"),emotion_utils_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+utils@1.2.1/node_modules/@emotion/utils/dist/emotion-utils.browser.esm.js"),emotion_serialize_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+serialize@1.1.4/node_modules/@emotion/serialize/dist/emotion-serialize.browser.esm.js"),emotion_use_insertion_effect_with_fallbacks_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+use-insertion-effect-with-fallbacks@1.0.1_react@17.0.2/node_modules/@emotion/use-insertion-effect-with-fallbacks/dist/emotion-use-insertion-effect-with-fallbacks.browser.esm.js"),testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function testOmitPropsOnComponent(key){return"theme"!==key},getDefaultShouldForwardProp=function getDefaultShouldForwardProp(tag){return"string"==typeof tag&&tag.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function composeShouldForwardProps(tag,options,isReal){var shouldForwardProp;if(options){var optionsShouldForwardProp=options.shouldForwardProp;shouldForwardProp=tag.__emotion_forwardProp&&optionsShouldForwardProp?function(propName){return tag.__emotion_forwardProp(propName)&&optionsShouldForwardProp(propName)}:optionsShouldForwardProp}return"function"!=typeof shouldForwardProp&&isReal&&(shouldForwardProp=tag.__emotion_forwardProp),shouldForwardProp},Insertion=function Insertion(_ref){var cache=_ref.cache,serialized=_ref.serialized,isStringTag=_ref.isStringTag;return(0,emotion_utils_browser_esm.SF)(cache,serialized,isStringTag),(0,emotion_use_insertion_effect_with_fallbacks_browser_esm.s)((function(){return(0,emotion_utils_browser_esm.sk)(cache,serialized,isStringTag)})),null},newStyled=function createStyled(tag,options){var identifierName,targetClassName,isReal=tag.__emotion_real===tag,baseTag=isReal&&tag.__emotion_base||tag;void 0!==options&&(identifierName=options.label,targetClassName=options.target);var shouldForwardProp=composeShouldForwardProps(tag,options,isReal),defaultShouldForwardProp=shouldForwardProp||getDefaultShouldForwardProp(baseTag),shouldUseAs=!defaultShouldForwardProp("as");return function(){var args=arguments,styles=isReal&&void 0!==tag.__emotion_styles?tag.__emotion_styles.slice(0):[];if(void 0!==identifierName&&styles.push("label:"+identifierName+";"),null==args[0]||void 0===args[0].raw)styles.push.apply(styles,args);else{0,styles.push(args[0][0]);for(var len=args.length,i=1;i<len;i++)styles.push(args[i],args[0][i])}var Styled=(0,emotion_element_43c6fea0_browser_esm.w)((function(props,cache,ref){var FinalTag=shouldUseAs&&props.as||baseTag,className="",classInterpolations=[],mergedProps=props;if(null==props.theme){for(var key in mergedProps={},props)mergedProps[key]=props[key];mergedProps.theme=react.useContext(emotion_element_43c6fea0_browser_esm.T)}"string"==typeof props.className?className=(0,emotion_utils_browser_esm.Rk)(cache.registered,classInterpolations,props.className):null!=props.className&&(className=props.className+" ");var serialized=(0,emotion_serialize_browser_esm.J)(styles.concat(classInterpolations),cache.registered,mergedProps);className+=cache.key+"-"+serialized.name,void 0!==targetClassName&&(className+=" "+targetClassName);var finalShouldForwardProp=shouldUseAs&&void 0===shouldForwardProp?getDefaultShouldForwardProp(FinalTag):defaultShouldForwardProp,newProps={};for(var _key in props)shouldUseAs&&"as"===_key||finalShouldForwardProp(_key)&&(newProps[_key]=props[_key]);return newProps.className=className,newProps.ref=ref,react.createElement(react.Fragment,null,react.createElement(Insertion,{cache,serialized,isStringTag:"string"==typeof FinalTag}),react.createElement(FinalTag,newProps))}));return Styled.displayName=void 0!==identifierName?identifierName:"Styled("+("string"==typeof baseTag?baseTag:baseTag.displayName||baseTag.name||"Component")+")",Styled.defaultProps=tag.defaultProps,Styled.__emotion_real=Styled,Styled.__emotion_base=baseTag,Styled.__emotion_styles=styles,Styled.__emotion_forwardProp=shouldForwardProp,Object.defineProperty(Styled,"toString",{value:function value(){return"."+targetClassName}}),Styled.withComponent=function(nextTag,nextOptions){return createStyled(nextTag,(0,esm_extends.A)({},options,nextOptions,{shouldForwardProp:composeShouldForwardProps(Styled,nextOptions,!0)})).apply(void 0,styles)},Styled}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(tagName){newStyled[tagName]=newStyled(tagName)}));var emotion_react_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),emotion_cache_browser_esm=__webpack_require__("./node_modules/.pnpm/@emotion+cache@11.11.0/node_modules/@emotion/cache/dist/emotion-cache.browser.esm.js"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");let cache;function StyledEngineProvider(props){const{injectFirst,children}=props;return injectFirst&&cache?(0,jsx_runtime.jsx)(emotion_element_43c6fea0_browser_esm.C,{value:cache,children}):children}function GlobalStyles(props){const{styles,defaultTheme={}}=props,globalStyles="function"==typeof styles?themeInput=>styles(function isEmpty(obj){return null==obj||0===Object.keys(obj).length}(themeInput)?defaultTheme:themeInput):styles;return(0,jsx_runtime.jsx)(emotion_react_browser_esm.mL,{styles:globalStyles})}function styled(tag,options){return newStyled(tag,options)}"object"==typeof document&&(cache=(0,emotion_cache_browser_esm.A)({key:"css",prepend:!0}));const internal_processStyles=(tag,processor)=>{Array.isArray(tag.__emotion_styles)&&(tag.__emotion_styles=processor(tag.__emotion_styles))}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/colorManipulator.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.X4=alpha,exports.e$=darken,exports.tL=emphasize,exports.eM=function getContrastRatio(foreground,background){const lumA=getLuminance(foreground),lumB=getLuminance(background);return(Math.max(lumA,lumB)+.05)/(Math.min(lumA,lumB)+.05)},exports.a=lighten;var _formatMuiErrorMessage2=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/index.js")),_clamp=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/clamp/index.js"));function clampWrapper(value,min=0,max=1){return(0,_clamp.default)(value,min,max)}function hexToRgb(color){color=color.slice(1);const re=new RegExp(`.{1,${color.length>=6?2:1}}`,"g");let colors=color.match(re);return colors&&1===colors[0].length&&(colors=colors.map((n=>n+n))),colors?`rgb${4===colors.length?"a":""}(${colors.map(((n,index)=>index<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3)).join(", ")})`:""}function decomposeColor(color){if(color.type)return color;if("#"===color.charAt(0))return decomposeColor(hexToRgb(color));const marker=color.indexOf("("),type=color.substring(0,marker);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(type))throw new Error((0,_formatMuiErrorMessage2.default)(9,color));let colorSpace,values=color.substring(marker+1,color.length-1);if("color"===type){if(values=values.split(" "),colorSpace=values.shift(),4===values.length&&"/"===values[3].charAt(0)&&(values[3]=values[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(colorSpace))throw new Error((0,_formatMuiErrorMessage2.default)(10,colorSpace))}else values=values.split(",");return values=values.map((value=>parseFloat(value))),{type,values,colorSpace}}const colorChannel=color=>{const decomposedColor=decomposeColor(color);return decomposedColor.values.slice(0,3).map(((val,idx)=>-1!==decomposedColor.type.indexOf("hsl")&&0!==idx?`${val}%`:val)).join(" ")};function recomposeColor(color){const{type,colorSpace}=color;let{values}=color;return-1!==type.indexOf("rgb")?values=values.map(((n,i)=>i<3?parseInt(n,10):n)):-1!==type.indexOf("hsl")&&(values[1]=`${values[1]}%`,values[2]=`${values[2]}%`),values=-1!==type.indexOf("color")?`${colorSpace} ${values.join(" ")}`:`${values.join(", ")}`,`${type}(${values})`}function hslToRgb(color){color=decomposeColor(color);const{values}=color,h=values[0],s=values[1]/100,l=values[2]/100,a=s*Math.min(l,1-l),f=(n,k=(n+h/30)%12)=>l-a*Math.max(Math.min(k-3,9-k,1),-1);let type="rgb";const rgb=[Math.round(255*f(0)),Math.round(255*f(8)),Math.round(255*f(4))];return"hsla"===color.type&&(type+="a",rgb.push(values[3])),recomposeColor({type,values:rgb})}function getLuminance(color){let rgb="hsl"===(color=decomposeColor(color)).type||"hsla"===color.type?decomposeColor(hslToRgb(color)).values:color.values;return rgb=rgb.map((val=>("color"!==color.type&&(val/=255),val<=.03928?val/12.92:((val+.055)/1.055)**2.4))),Number((.2126*rgb[0]+.7152*rgb[1]+.0722*rgb[2]).toFixed(3))}function alpha(color,value){return color=decomposeColor(color),value=clampWrapper(value),"rgb"!==color.type&&"hsl"!==color.type||(color.type+="a"),"color"===color.type?color.values[3]=`/${value}`:color.values[3]=value,recomposeColor(color)}function darken(color,coefficient){if(color=decomposeColor(color),coefficient=clampWrapper(coefficient),-1!==color.type.indexOf("hsl"))color.values[2]*=1-coefficient;else if(-1!==color.type.indexOf("rgb")||-1!==color.type.indexOf("color"))for(let i=0;i<3;i+=1)color.values[i]*=1-coefficient;return recomposeColor(color)}function lighten(color,coefficient){if(color=decomposeColor(color),coefficient=clampWrapper(coefficient),-1!==color.type.indexOf("hsl"))color.values[2]+=(100-color.values[2])*coefficient;else if(-1!==color.type.indexOf("rgb"))for(let i=0;i<3;i+=1)color.values[i]+=(255-color.values[i])*coefficient;else if(-1!==color.type.indexOf("color"))for(let i=0;i<3;i+=1)color.values[i]+=(1-color.values[i])*coefficient;return recomposeColor(color)}function emphasize(color,coefficient=.15){return getLuminance(color)>.5?darken(color,coefficient):lighten(color,coefficient)}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/createStyled.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var _interopRequireDefault=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/interopRequireDefault.js");exports.Ay=function createStyled(input={}){const{themeId,defaultTheme=systemDefaultTheme,rootShouldForwardProp=shouldForwardProp,slotShouldForwardProp=shouldForwardProp}=input,systemSx=props=>(0,_styleFunctionSx.default)((0,_extends2.default)({},props,{theme:resolveTheme((0,_extends2.default)({},props,{defaultTheme,themeId}))}));return systemSx.__mui_systemSx=!0,(tag,inputOptions={})=>{(0,_styledEngine.internal_processStyles)(tag,(styles=>styles.filter((style=>!(null!=style&&style.__mui_systemSx)))));const{name:componentName,slot:componentSlot,skipVariantsResolver:inputSkipVariantsResolver,skipSx:inputSkipSx,overridesResolver=defaultOverridesResolver(lowercaseFirstLetter(componentSlot))}=inputOptions,options=(0,_objectWithoutPropertiesLoose2.default)(inputOptions,_excluded3),skipVariantsResolver=void 0!==inputSkipVariantsResolver?inputSkipVariantsResolver:componentSlot&&"Root"!==componentSlot&&"root"!==componentSlot||!1,skipSx=inputSkipSx||!1;let shouldForwardPropOption=shouldForwardProp;"Root"===componentSlot||"root"===componentSlot?shouldForwardPropOption=rootShouldForwardProp:componentSlot?shouldForwardPropOption=slotShouldForwardProp:function isStringTag(tag){return"string"==typeof tag&&tag.charCodeAt(0)>96}(tag)&&(shouldForwardPropOption=void 0);const defaultStyledResolver=(0,_styledEngine.default)(tag,(0,_extends2.default)({shouldForwardProp:shouldForwardPropOption,label:undefined},options)),transformStyleArg=stylesArg=>"function"==typeof stylesArg&&stylesArg.__emotion_real!==stylesArg||(0,_deepmerge.isPlainObject)(stylesArg)?props=>processStyleArg(stylesArg,(0,_extends2.default)({},props,{theme:resolveTheme({theme:props.theme,defaultTheme,themeId})})):stylesArg,muiStyledResolver=(styleArg,...expressions)=>{let transformedStyleArg=transformStyleArg(styleArg);const expressionsWithDefaultTheme=expressions?expressions.map(transformStyleArg):[];componentName&&overridesResolver&&expressionsWithDefaultTheme.push((props=>{const theme=resolveTheme((0,_extends2.default)({},props,{defaultTheme,themeId}));if(!theme.components||!theme.components[componentName]||!theme.components[componentName].styleOverrides)return null;const styleOverrides=theme.components[componentName].styleOverrides,resolvedStyleOverrides={};return Object.entries(styleOverrides).forEach((([slotKey,slotStyle])=>{resolvedStyleOverrides[slotKey]=processStyleArg(slotStyle,(0,_extends2.default)({},props,{theme}))})),overridesResolver(props,resolvedStyleOverrides)})),componentName&&!skipVariantsResolver&&expressionsWithDefaultTheme.push((props=>{var _theme$components;const theme=resolveTheme((0,_extends2.default)({},props,{defaultTheme,themeId}));return processStyleArg({variants:null==theme||null==(_theme$components=theme.components)||null==(_theme$components=_theme$components[componentName])?void 0:_theme$components.variants},(0,_extends2.default)({},props,{theme}))})),skipSx||expressionsWithDefaultTheme.push(systemSx);const numOfCustomFnsApplied=expressionsWithDefaultTheme.length-expressions.length;if(Array.isArray(styleArg)&&numOfCustomFnsApplied>0){const placeholders=new Array(numOfCustomFnsApplied).fill("");transformedStyleArg=[...styleArg,...placeholders],transformedStyleArg.raw=[...styleArg.raw,...placeholders]}const Component=defaultStyledResolver(transformedStyleArg,...expressionsWithDefaultTheme);return tag.muiName&&(Component.muiName=tag.muiName),Component};return defaultStyledResolver.withConfig&&(muiStyledResolver.withConfig=defaultStyledResolver.withConfig),muiStyledResolver}};var _extends2=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/extends.js")),_objectWithoutPropertiesLoose2=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js")),_styledEngine=function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(__webpack_require__("./node_modules/.pnpm/@mui+styled-engine@5.15.14_hj6yibkjkhvdx4xakusaw2oiva/node_modules/@mui/styled-engine/index.js")),_deepmerge=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/index.js"),_createTheme=(_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/index.js")),_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/getDisplayName/index.js")),_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/index.js"))),_styleFunctionSx=_interopRequireDefault(__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/index.js"));const _excluded=["ownerState"],_excluded2=["variants"],_excluded3=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function shouldForwardProp(prop){return"ownerState"!==prop&&"theme"!==prop&&"sx"!==prop&&"as"!==prop}const systemDefaultTheme=(0,_createTheme.default)(),lowercaseFirstLetter=string=>string?string.charAt(0).toLowerCase()+string.slice(1):string;function resolveTheme({defaultTheme,theme,themeId}){return function isEmpty(obj){return 0===Object.keys(obj).length}(theme)?defaultTheme:theme[themeId]||theme}function defaultOverridesResolver(slot){return slot?(props,styles)=>styles[slot]:null}function processStyleArg(callableStyle,_ref){let{ownerState}=_ref,props=(0,_objectWithoutPropertiesLoose2.default)(_ref,_excluded);const resolvedStylesArg="function"==typeof callableStyle?callableStyle((0,_extends2.default)({ownerState},props)):callableStyle;if(Array.isArray(resolvedStylesArg))return resolvedStylesArg.flatMap((resolvedStyle=>processStyleArg(resolvedStyle,(0,_extends2.default)({ownerState},props))));if(resolvedStylesArg&&"object"==typeof resolvedStylesArg&&Array.isArray(resolvedStylesArg.variants)){const{variants=[]}=resolvedStylesArg;let result=(0,_objectWithoutPropertiesLoose2.default)(resolvedStylesArg,_excluded2);return variants.forEach((variant=>{let isMatch=!0;"function"==typeof variant.props?isMatch=variant.props((0,_extends2.default)({ownerState},props,ownerState)):Object.keys(variant.props).forEach((key=>{(null==ownerState?void 0:ownerState[key])!==variant.props[key]&&props[key]!==variant.props[key]&&(isMatch=!1)})),isMatch&&(Array.isArray(result)||(result=[result]),result.push("function"==typeof variant.style?variant.style((0,_extends2.default)({ownerState},props,ownerState)):variant.style))})),result}return resolvedStylesArg}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/RtlProvider/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,I:()=>useRtl});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const _excluded=["value"],RtlContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext();const useRtl=()=>{const value=react__WEBPACK_IMPORTED_MODULE_0__.useContext(RtlContext);return null!=value&&value},__WEBPACK_DEFAULT_EXPORT__=function RtlProvider(_ref){let{value}=_ref,props=(0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_2__.A)(_ref,_excluded);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(RtlContext.Provider,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__.A)({value:null==value||value},props))}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/breakpoints.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{EU:()=>createEmptyBreakpointObject,NI:()=>handleBreakpoints,kW:()=>resolveBreakpointValues,vf:()=>removeUnusedBreakpoints,zu:()=>values});const values={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:key=>`@media (min-width:${values[key]}px)`};function handleBreakpoints(props,propValue,styleFromPropValue){const theme=props.theme||{};if(Array.isArray(propValue)){const themeBreakpoints=theme.breakpoints||defaultBreakpoints;return propValue.reduce(((acc,item,index)=>(acc[themeBreakpoints.up(themeBreakpoints.keys[index])]=styleFromPropValue(propValue[index]),acc)),{})}if("object"==typeof propValue){const themeBreakpoints=theme.breakpoints||defaultBreakpoints;return Object.keys(propValue).reduce(((acc,breakpoint)=>{if(-1!==Object.keys(themeBreakpoints.values||values).indexOf(breakpoint)){acc[themeBreakpoints.up(breakpoint)]=styleFromPropValue(propValue[breakpoint],breakpoint)}else{const cssKey=breakpoint;acc[cssKey]=propValue[cssKey]}return acc}),{})}return styleFromPropValue(propValue)}function createEmptyBreakpointObject(breakpointsInput={}){var _breakpointsInput$key;return(null==(_breakpointsInput$key=breakpointsInput.keys)?void 0:_breakpointsInput$key.reduce(((acc,key)=>(acc[breakpointsInput.up(key)]={},acc)),{}))||{}}function removeUnusedBreakpoints(breakpointKeys,style){return breakpointKeys.reduce(((acc,key)=>{const breakpointOutput=acc[key];return(!breakpointOutput||0===Object.keys(breakpointOutput).length)&&delete acc[key],acc}),style)}function resolveBreakpointValues({values:breakpointValues,breakpoints:themeBreakpoints,base:customBase}){const base=customBase||function computeBreakpointsBase(breakpointValues,themeBreakpoints){if("object"!=typeof breakpointValues)return{};const base={},breakpointsKeys=Object.keys(themeBreakpoints);return Array.isArray(breakpointValues)?breakpointsKeys.forEach(((breakpoint,i)=>{i<breakpointValues.length&&(base[breakpoint]=!0)})):breakpointsKeys.forEach((breakpoint=>{null!=breakpointValues[breakpoint]&&(base[breakpoint]=!0)})),base}(breakpointValues,themeBreakpoints),keys=Object.keys(base);if(0===keys.length)return breakpointValues;let previous;return keys.reduce(((acc,breakpoint,i)=>(Array.isArray(breakpointValues)?(acc[breakpoint]=null!=breakpointValues[i]?breakpointValues[i]:breakpointValues[previous],previous=i):"object"==typeof breakpointValues?(acc[breakpoint]=null!=breakpointValues[breakpoint]?breakpointValues[breakpoint]:breakpointValues[previous],previous=breakpoint):acc[breakpoint]=breakpointValues,acc)),{})}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/applyStyles.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function applyStyles(key,styles){const theme=this;if(theme.vars&&"function"==typeof theme.getColorSchemeSelector){const selector=theme.getColorSchemeSelector(key).replace(/(\[[^\]]+\])/,"*:where($1)");return{[selector]:styles}}return theme.palette.mode===key?styles:{}}__webpack_require__.d(__webpack_exports__,{A:()=>applyStyles})},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createBreakpoints.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>createBreakpoints});var _babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js");const _excluded=["values","unit","step"],sortBreakpointsValues=values=>{const breakpointsAsArray=Object.keys(values).map((key=>({key,val:values[key]})))||[];return breakpointsAsArray.sort(((breakpoint1,breakpoint2)=>breakpoint1.val-breakpoint2.val)),breakpointsAsArray.reduce(((acc,obj)=>(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({},acc,{[obj.key]:obj.val})),{})};function createBreakpoints(breakpoints){const{values={xs:0,sm:600,md:900,lg:1200,xl:1536},unit="px",step=5}=breakpoints,other=(0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__.A)(breakpoints,_excluded),sortedValues=sortBreakpointsValues(values),keys=Object.keys(sortedValues);function up(key){return`@media (min-width:${"number"==typeof values[key]?values[key]:key}${unit})`}function down(key){return`@media (max-width:${("number"==typeof values[key]?values[key]:key)-step/100}${unit})`}function between(start,end){const endIndex=keys.indexOf(end);return`@media (min-width:${"number"==typeof values[start]?values[start]:start}${unit}) and (max-width:${(-1!==endIndex&&"number"==typeof values[keys[endIndex]]?values[keys[endIndex]]:end)-step/100}${unit})`}return(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({keys,values:sortedValues,up,down,between,only:function only(key){return keys.indexOf(key)+1<keys.length?between(key,keys[keys.indexOf(key)+1]):up(key)},not:function not(key){const keyIndex=keys.indexOf(key);return 0===keyIndex?up(keys[1]):keyIndex===keys.length-1?down(keys[keyIndex]):between(key,keys[keys.indexOf(key)+1]).replace("@media","@media not all and")},unit},other)}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createTheme.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>createTheme_createTheme});var esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),deepmerge=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js"),createBreakpoints=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createBreakpoints.js");const createTheme_shape={borderRadius:4};var esm_spacing=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/spacing.js");var styleFunctionSx=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js"),defaultSxConfig=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js"),applyStyles=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/applyStyles.js");const _excluded=["breakpoints","palette","spacing","shape"];const createTheme_createTheme=function createTheme(options={},...args){const{breakpoints:breakpointsInput={},palette:paletteInput={},spacing:spacingInput,shape:shapeInput={}}=options,other=(0,objectWithoutPropertiesLoose.A)(options,_excluded),breakpoints=(0,createBreakpoints.A)(breakpointsInput),spacing=function createSpacing(spacingInput=8){if(spacingInput.mui)return spacingInput;const transform=(0,esm_spacing.LX)({spacing:spacingInput}),spacing=(...argsInput)=>(0===argsInput.length?[1]:argsInput).map((argument=>{const output=transform(argument);return"number"==typeof output?`${output}px`:output})).join(" ");return spacing.mui=!0,spacing}(spacingInput);let muiTheme=(0,deepmerge.A)({breakpoints,direction:"ltr",components:{},palette:(0,esm_extends.A)({mode:"light"},paletteInput),spacing,shape:(0,esm_extends.A)({},createTheme_shape,shapeInput)},other);return muiTheme.applyStyles=applyStyles.A,muiTheme=args.reduce(((acc,argument)=>(0,deepmerge.A)(acc,argument)),muiTheme),muiTheme.unstable_sxConfig=(0,esm_extends.A)({},defaultSxConfig.A,null==other?void 0:other.unstable_sxConfig),muiTheme.unstable_sx=function sx(props){return(0,styleFunctionSx.A)({sx:props,theme:this})},muiTheme}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_createTheme__WEBPACK_IMPORTED_MODULE_0__.A,private_createBreakpoints:()=>_createBreakpoints__WEBPACK_IMPORTED_MODULE_1__.A,unstable_applyStyles:()=>_applyStyles__WEBPACK_IMPORTED_MODULE_2__.A});var _createTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createTheme.js"),_createBreakpoints__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createBreakpoints.js"),_applyStyles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/applyStyles.js")},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/merge.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _mui_utils_deepmerge__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js");const __WEBPACK_DEFAULT_EXPORT__=function merge(acc,item){return item?(0,_mui_utils_deepmerge__WEBPACK_IMPORTED_MODULE_0__.A)(acc,item,{clone:!1}):acc}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/spacing.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{LX:()=>createUnarySpacing,MA:()=>createUnaryUnit,_W:()=>getValue,Lc:()=>margin,Ms:()=>padding});var breakpoints=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/breakpoints.js"),style=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/style.js"),merge=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/merge.js");const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=function memoize(fn){const cache={};return arg=>(void 0===cache[arg]&&(cache[arg]=fn(arg)),cache[arg])}((prop=>{if(prop.length>2){if(!aliases[prop])return[prop];prop=aliases[prop]}const[a,b]=prop.split(""),property=properties[a],direction=directions[b]||"";return Array.isArray(direction)?direction.map((dir=>property+dir)):[property+direction]})),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],spacingKeys=[...marginKeys,...paddingKeys];function createUnaryUnit(theme,themeKey,defaultValue,propName){var _getPath;const themeSpacing=null!=(_getPath=(0,style.Yn)(theme,themeKey,!1))?_getPath:defaultValue;return"number"==typeof themeSpacing?abs=>"string"==typeof abs?abs:themeSpacing*abs:Array.isArray(themeSpacing)?abs=>"string"==typeof abs?abs:themeSpacing[abs]:"function"==typeof themeSpacing?themeSpacing:()=>{}}function createUnarySpacing(theme){return createUnaryUnit(theme,"spacing",8)}function getValue(transformer,propValue){if("string"==typeof propValue||null==propValue)return propValue;const transformed=transformer(Math.abs(propValue));return propValue>=0?transformed:"number"==typeof transformed?-transformed:`-${transformed}`}function resolveCssProperty(props,keys,prop,transformer){if(-1===keys.indexOf(prop))return null;const styleFromPropValue=function getStyleFromPropValue(cssProperties,transformer){return propValue=>cssProperties.reduce(((acc,cssProperty)=>(acc[cssProperty]=getValue(transformer,propValue),acc)),{})}(getCssProperties(prop),transformer),propValue=props[prop];return(0,breakpoints.NI)(props,propValue,styleFromPropValue)}function spacing_style(props,keys){const transformer=createUnarySpacing(props.theme);return Object.keys(props).map((prop=>resolveCssProperty(props,keys,prop,transformer))).reduce(merge.A,{})}function margin(props){return spacing_style(props,marginKeys)}function padding(props){return spacing_style(props,paddingKeys)}function spacing(props){return spacing_style(props,spacingKeys)}margin.propTypes={},margin.filterProps=marginKeys,padding.propTypes={},padding.filterProps=paddingKeys,spacing.propTypes={},spacing.filterProps=spacingKeys},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/style.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>__WEBPACK_DEFAULT_EXPORT__,BO:()=>getStyleValue,Yn:()=>getPath});var _mui_utils_capitalize__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/capitalize.js"),_breakpoints__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/breakpoints.js");function getPath(obj,path,checkVars=!0){if(!path||"string"!=typeof path)return null;if(obj&&obj.vars&&checkVars){const val=`vars.${path}`.split(".").reduce(((acc,item)=>acc&&acc[item]?acc[item]:null),obj);if(null!=val)return val}return path.split(".").reduce(((acc,item)=>acc&&null!=acc[item]?acc[item]:null),obj)}function getStyleValue(themeMapping,transform,propValueFinal,userValue=propValueFinal){let value;return value="function"==typeof themeMapping?themeMapping(propValueFinal):Array.isArray(themeMapping)?themeMapping[propValueFinal]||userValue:getPath(themeMapping,propValueFinal)||userValue,transform&&(value=transform(value,userValue,themeMapping)),value}const __WEBPACK_DEFAULT_EXPORT__=function style(options){const{prop,cssProperty=options.prop,themeKey,transform}=options,fn=props=>{if(null==props[prop])return null;const propValue=props[prop],themeMapping=getPath(props.theme,themeKey)||{};return(0,_breakpoints__WEBPACK_IMPORTED_MODULE_1__.NI)(props,propValue,(propValueFinal=>{let value=getStyleValue(themeMapping,transform,propValueFinal);return propValueFinal===value&&"string"==typeof propValueFinal&&(value=getStyleValue(themeMapping,transform,`${prop}${"default"===propValueFinal?"":(0,_mui_utils_capitalize__WEBPACK_IMPORTED_MODULE_0__.A)(propValueFinal)}`,propValueFinal)),!1===cssProperty?value:{[cssProperty]:value}}))};return fn.propTypes={},fn.filterProps=[prop],fn}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>styleFunctionSx_defaultSxConfig});var spacing=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/spacing.js"),style=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/style.js"),merge=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/merge.js");const esm_compose=function compose(...styles){const handlers=styles.reduce(((acc,style)=>(style.filterProps.forEach((prop=>{acc[prop]=style})),acc)),{}),fn=props=>Object.keys(props).reduce(((acc,prop)=>handlers[prop]?(0,merge.A)(acc,handlers[prop](props)):acc),{});return fn.propTypes={},fn.filterProps=styles.reduce(((acc,style)=>acc.concat(style.filterProps)),[]),fn};var breakpoints=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/breakpoints.js");function borderTransform(value){return"number"!=typeof value?value:`${value}px solid`}function createBorderStyle(prop,transform){return(0,style.Ay)({prop,themeKey:"borders",transform})}const border=createBorderStyle("border",borderTransform),borderTop=createBorderStyle("borderTop",borderTransform),borderRight=createBorderStyle("borderRight",borderTransform),borderBottom=createBorderStyle("borderBottom",borderTransform),borderLeft=createBorderStyle("borderLeft",borderTransform),borderColor=createBorderStyle("borderColor"),borderTopColor=createBorderStyle("borderTopColor"),borderRightColor=createBorderStyle("borderRightColor"),borderBottomColor=createBorderStyle("borderBottomColor"),borderLeftColor=createBorderStyle("borderLeftColor"),outline=createBorderStyle("outline",borderTransform),outlineColor=createBorderStyle("outlineColor"),borderRadius=props=>{if(void 0!==props.borderRadius&&null!==props.borderRadius){const transformer=(0,spacing.MA)(props.theme,"shape.borderRadius",4,"borderRadius"),styleFromPropValue=propValue=>({borderRadius:(0,spacing._W)(transformer,propValue)});return(0,breakpoints.NI)(props,props.borderRadius,styleFromPropValue)}return null};borderRadius.propTypes={},borderRadius.filterProps=["borderRadius"];esm_compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius,outline,outlineColor);const gap=props=>{if(void 0!==props.gap&&null!==props.gap){const transformer=(0,spacing.MA)(props.theme,"spacing",8,"gap"),styleFromPropValue=propValue=>({gap:(0,spacing._W)(transformer,propValue)});return(0,breakpoints.NI)(props,props.gap,styleFromPropValue)}return null};gap.propTypes={},gap.filterProps=["gap"];const columnGap=props=>{if(void 0!==props.columnGap&&null!==props.columnGap){const transformer=(0,spacing.MA)(props.theme,"spacing",8,"columnGap"),styleFromPropValue=propValue=>({columnGap:(0,spacing._W)(transformer,propValue)});return(0,breakpoints.NI)(props,props.columnGap,styleFromPropValue)}return null};columnGap.propTypes={},columnGap.filterProps=["columnGap"];const rowGap=props=>{if(void 0!==props.rowGap&&null!==props.rowGap){const transformer=(0,spacing.MA)(props.theme,"spacing",8,"rowGap"),styleFromPropValue=propValue=>({rowGap:(0,spacing._W)(transformer,propValue)});return(0,breakpoints.NI)(props,props.rowGap,styleFromPropValue)}return null};rowGap.propTypes={},rowGap.filterProps=["rowGap"];esm_compose(gap,columnGap,rowGap,(0,style.Ay)({prop:"gridColumn"}),(0,style.Ay)({prop:"gridRow"}),(0,style.Ay)({prop:"gridAutoFlow"}),(0,style.Ay)({prop:"gridAutoColumns"}),(0,style.Ay)({prop:"gridAutoRows"}),(0,style.Ay)({prop:"gridTemplateColumns"}),(0,style.Ay)({prop:"gridTemplateRows"}),(0,style.Ay)({prop:"gridTemplateAreas"}),(0,style.Ay)({prop:"gridArea"}));function paletteTransform(value,userValue){return"grey"===userValue?userValue:value}esm_compose((0,style.Ay)({prop:"color",themeKey:"palette",transform:paletteTransform}),(0,style.Ay)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),(0,style.Ay)({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform}));function sizingTransform(value){return value<=1&&0!==value?100*value+"%":value}const width=(0,style.Ay)({prop:"width",transform:sizingTransform}),maxWidth=props=>{if(void 0!==props.maxWidth&&null!==props.maxWidth){const styleFromPropValue=propValue=>{var _props$theme,_props$theme2;const breakpoint=(null==(_props$theme=props.theme)||null==(_props$theme=_props$theme.breakpoints)||null==(_props$theme=_props$theme.values)?void 0:_props$theme[propValue])||breakpoints.zu[propValue];return breakpoint?"px"!==(null==(_props$theme2=props.theme)||null==(_props$theme2=_props$theme2.breakpoints)?void 0:_props$theme2.unit)?{maxWidth:`${breakpoint}${props.theme.breakpoints.unit}`}:{maxWidth:breakpoint}:{maxWidth:sizingTransform(propValue)}};return(0,breakpoints.NI)(props,props.maxWidth,styleFromPropValue)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=(0,style.Ay)({prop:"minWidth",transform:sizingTransform}),height=(0,style.Ay)({prop:"height",transform:sizingTransform}),maxHeight=(0,style.Ay)({prop:"maxHeight",transform:sizingTransform}),minHeight=(0,style.Ay)({prop:"minHeight",transform:sizingTransform}),styleFunctionSx_defaultSxConfig=((0,style.Ay)({prop:"size",cssProperty:"width",transform:sizingTransform}),(0,style.Ay)({prop:"size",cssProperty:"height",transform:sizingTransform}),esm_compose(width,maxWidth,minWidth,height,maxHeight,minHeight,(0,style.Ay)({prop:"boxSizing"})),{border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:borderTransform},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:spacing.Ms},pt:{style:spacing.Ms},pr:{style:spacing.Ms},pb:{style:spacing.Ms},pl:{style:spacing.Ms},px:{style:spacing.Ms},py:{style:spacing.Ms},padding:{style:spacing.Ms},paddingTop:{style:spacing.Ms},paddingRight:{style:spacing.Ms},paddingBottom:{style:spacing.Ms},paddingLeft:{style:spacing.Ms},paddingX:{style:spacing.Ms},paddingY:{style:spacing.Ms},paddingInline:{style:spacing.Ms},paddingInlineStart:{style:spacing.Ms},paddingInlineEnd:{style:spacing.Ms},paddingBlock:{style:spacing.Ms},paddingBlockStart:{style:spacing.Ms},paddingBlockEnd:{style:spacing.Ms},m:{style:spacing.Lc},mt:{style:spacing.Lc},mr:{style:spacing.Lc},mb:{style:spacing.Lc},ml:{style:spacing.Lc},mx:{style:spacing.Lc},my:{style:spacing.Lc},margin:{style:spacing.Lc},marginTop:{style:spacing.Lc},marginRight:{style:spacing.Lc},marginBottom:{style:spacing.Lc},marginLeft:{style:spacing.Lc},marginX:{style:spacing.Lc},marginY:{style:spacing.Lc},marginInline:{style:spacing.Lc},marginInlineStart:{style:spacing.Lc},marginInlineEnd:{style:spacing.Lc},marginBlock:{style:spacing.Lc},marginBlockStart:{style:spacing.Lc},marginBlockEnd:{style:spacing.Lc},displayPrint:{cssProperty:!1,transform:value=>({"@media print":{display:value}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}})},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/extendSxProp.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>extendSxProp});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js"),_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),_mui_utils_deepmerge__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js"),_defaultSxConfig__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js");const _excluded=["sx"],splitProps=props=>{var _props$theme$unstable,_props$theme;const result={systemProps:{},otherProps:{}},config=null!=(_props$theme$unstable=null==props||null==(_props$theme=props.theme)?void 0:_props$theme.unstable_sxConfig)?_props$theme$unstable:_defaultSxConfig__WEBPACK_IMPORTED_MODULE_0__.A;return Object.keys(props).forEach((prop=>{config[prop]?result.systemProps[prop]=props[prop]:result.otherProps[prop]=props[prop]})),result};function extendSxProp(props){const{sx:inSx}=props,other=(0,_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__.A)(props,_excluded),{systemProps,otherProps}=splitProps(other);let finalSx;return finalSx=Array.isArray(inSx)?[systemProps,...inSx]:"function"==typeof inSx?(...args)=>{const result=inSx(...args);return(0,_mui_utils_deepmerge__WEBPACK_IMPORTED_MODULE_2__.Q)(result)?(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__.A)({},systemProps,result):systemProps}:(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__.A)({},systemProps,inSx),(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_3__.A)({},otherProps,{sx:finalSx})}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_styleFunctionSx__WEBPACK_IMPORTED_MODULE_0__.A,extendSxProp:()=>_extendSxProp__WEBPACK_IMPORTED_MODULE_1__.A,unstable_createStyleFunctionSx:()=>_styleFunctionSx__WEBPACK_IMPORTED_MODULE_0__.k,unstable_defaultSxConfig:()=>_defaultSxConfig__WEBPACK_IMPORTED_MODULE_2__.A});var _styleFunctionSx__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js"),_extendSxProp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/extendSxProp.js"),_defaultSxConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js")},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/styleFunctionSx.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__,k:()=>unstable_createStyleFunctionSx});var _mui_utils_capitalize__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/capitalize.js"),_merge__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/merge.js"),_style__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/style.js"),_breakpoints__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/breakpoints.js"),_defaultSxConfig__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/styleFunctionSx/defaultSxConfig.js");function unstable_createStyleFunctionSx(){function getThemeValue(prop,val,theme,config){const props={[prop]:val,theme},options=config[prop];if(!options)return{[prop]:val};const{cssProperty=prop,themeKey,transform,style}=options;if(null==val)return null;if("typography"===themeKey&&"inherit"===val)return{[prop]:val};const themeMapping=(0,_style__WEBPACK_IMPORTED_MODULE_0__.Yn)(theme,themeKey)||{};if(style)return style(props);return(0,_breakpoints__WEBPACK_IMPORTED_MODULE_2__.NI)(props,val,(propValueFinal=>{let value=(0,_style__WEBPACK_IMPORTED_MODULE_0__.BO)(themeMapping,transform,propValueFinal);return propValueFinal===value&&"string"==typeof propValueFinal&&(value=(0,_style__WEBPACK_IMPORTED_MODULE_0__.BO)(themeMapping,transform,`${prop}${"default"===propValueFinal?"":(0,_mui_utils_capitalize__WEBPACK_IMPORTED_MODULE_1__.A)(propValueFinal)}`,propValueFinal)),!1===cssProperty?value:{[cssProperty]:value}}))}return function styleFunctionSx(props){var _theme$unstable_sxCon;const{sx,theme={}}=props||{};if(!sx)return null;const config=null!=(_theme$unstable_sxCon=theme.unstable_sxConfig)?_theme$unstable_sxCon:_defaultSxConfig__WEBPACK_IMPORTED_MODULE_3__.A;function traverse(sxInput){let sxObject=sxInput;if("function"==typeof sxInput)sxObject=sxInput(theme);else if("object"!=typeof sxInput)return sxInput;if(!sxObject)return null;const emptyBreakpoints=(0,_breakpoints__WEBPACK_IMPORTED_MODULE_2__.EU)(theme.breakpoints),breakpointsKeys=Object.keys(emptyBreakpoints);let css=emptyBreakpoints;return Object.keys(sxObject).forEach((styleKey=>{const value=function callIfFn(maybeFn,arg){return"function"==typeof maybeFn?maybeFn(arg):maybeFn}(sxObject[styleKey],theme);if(null!=value)if("object"==typeof value)if(config[styleKey])css=(0,_merge__WEBPACK_IMPORTED_MODULE_4__.A)(css,getThemeValue(styleKey,value,theme,config));else{const breakpointsValues=(0,_breakpoints__WEBPACK_IMPORTED_MODULE_2__.NI)({theme},value,(x=>({[styleKey]:x})));!function objectsHaveSameKeys(...objects){const allKeys=objects.reduce(((keys,object)=>keys.concat(Object.keys(object))),[]),union=new Set(allKeys);return objects.every((object=>union.size===Object.keys(object).length))}(breakpointsValues,value)?css=(0,_merge__WEBPACK_IMPORTED_MODULE_4__.A)(css,breakpointsValues):css[styleKey]=styleFunctionSx({sx:value,theme})}else css=(0,_merge__WEBPACK_IMPORTED_MODULE_4__.A)(css,getThemeValue(styleKey,value,theme,config))})),(0,_breakpoints__WEBPACK_IMPORTED_MODULE_2__.vf)(breakpointsKeys,css)}return Array.isArray(sx)?sx.map(traverse):traverse(sx)}}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const __WEBPACK_DEFAULT_EXPORT__=styleFunctionSx},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useTheme.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _createTheme__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/createTheme/createTheme.js"),_useThemeWithoutDefault__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useThemeWithoutDefault.js");const systemDefaultTheme=(0,_createTheme__WEBPACK_IMPORTED_MODULE_0__.A)();const __WEBPACK_DEFAULT_EXPORT__=function useTheme(defaultTheme=systemDefaultTheme){return(0,_useThemeWithoutDefault__WEBPACK_IMPORTED_MODULE_1__.A)(defaultTheme)}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/esm/useThemeWithoutDefault.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_mui_styled_engine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@emotion+react@11.11.4_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@emotion/react/dist/emotion-element-43c6fea0.browser.esm.js");const __WEBPACK_DEFAULT_EXPORT__=function useTheme(defaultTheme=null){const contextTheme=react__WEBPACK_IMPORTED_MODULE_0__.useContext(_mui_styled_engine__WEBPACK_IMPORTED_MODULE_1__.T);return!contextTheme||function isObjectEmpty(obj){return 0===Object.keys(obj).length}(contextTheme)?defaultTheme:contextTheme}},"./node_modules/.pnpm/@mui+system@5.15.15_nu2cdwjhrwbbyxy3xmlh4k7q7q/node_modules/@mui/system/useThemeWithoutDefault.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";exports.A=void 0;var React=function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}(__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js")),_styledEngine=__webpack_require__("./node_modules/.pnpm/@mui+styled-engine@5.15.14_hj6yibkjkhvdx4xakusaw2oiva/node_modules/@mui/styled-engine/index.js");function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}exports.A=function useTheme(defaultTheme=null){const contextTheme=React.useContext(_styledEngine.ThemeContext);return!contextTheme||function isObjectEmpty(obj){return 0===Object.keys(obj).length}(contextTheme)?defaultTheme:contextTheme}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ClassNameGenerator/ClassNameGenerator.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const defaultGenerator=componentName=>componentName,__WEBPACK_DEFAULT_EXPORT__=(()=>{let generate=defaultGenerator;return{configure(generator){generate=generator},generate:componentName=>generate(componentName),reset(){generate=defaultGenerator}}})()},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/capitalize.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>capitalize});var _mui_utils_formatMuiErrorMessage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/formatMuiErrorMessage.js");function capitalize(string){if("string"!=typeof string)throw new Error((0,_mui_utils_formatMuiErrorMessage__WEBPACK_IMPORTED_MODULE_0__.A)(7));return string.charAt(0).toUpperCase()+string.slice(1)}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_capitalize__WEBPACK_IMPORTED_MODULE_0__.A});var _capitalize__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/capitalize/capitalize.js")},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/clamp/clamp.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function clamp(val,min=Number.MIN_SAFE_INTEGER,max=Number.MAX_SAFE_INTEGER){return Math.max(min,Math.min(val,max))}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/clamp/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_clamp__WEBPACK_IMPORTED_MODULE_0__.A});var _clamp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/clamp/clamp.js")},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/composeClasses/composeClasses.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function composeClasses(slots,getUtilityClass,classes=void 0){const output={};return Object.keys(slots).forEach((slot=>{output[slot]=slots[slot].reduce(((acc,key)=>{if(key){const utilityClass=getUtilityClass(key);""!==utilityClass&&acc.push(utilityClass),classes&&classes[key]&&acc.push(classes[key])}return acc}),[]).join(" ")})),output}__webpack_require__.d(__webpack_exports__,{A:()=>composeClasses})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/createChainedFunction/createChainedFunction.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function createChainedFunction(...funcs){return funcs.reduce(((acc,func)=>null==func?acc:function chainedFunction(...args){acc.apply(this,args),func.apply(this,args)}),(()=>{}))}__webpack_require__.d(__webpack_exports__,{A:()=>createChainedFunction})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>deepmerge,Q:()=>isPlainObject});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js");function isPlainObject(item){if("object"!=typeof item||null===item)return!1;const prototype=Object.getPrototypeOf(item);return!(null!==prototype&&prototype!==Object.prototype&&null!==Object.getPrototypeOf(prototype)||Symbol.toStringTag in item||Symbol.iterator in item)}function deepClone(source){if(!isPlainObject(source))return source;const output={};return Object.keys(source).forEach((key=>{output[key]=deepClone(source[key])})),output}function deepmerge(target,source,options={clone:!0}){const output=options.clone?(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({},target):target;return isPlainObject(target)&&isPlainObject(source)&&Object.keys(source).forEach((key=>{"__proto__"!==key&&(isPlainObject(source[key])&&key in target&&isPlainObject(target[key])?output[key]=deepmerge(target[key],source[key],options):options.clone?output[key]=isPlainObject(source[key])?deepClone(source[key]):source[key]:output[key]=source[key])})),output}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_deepmerge__WEBPACK_IMPORTED_MODULE_0__.A,isPlainObject:()=>_deepmerge__WEBPACK_IMPORTED_MODULE_0__.Q});var _deepmerge__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/deepmerge/deepmerge.js")},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/formatMuiErrorMessage.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function formatMuiErrorMessage(code){let url="https://mui.com/production-error/?code="+code;for(let i=1;i<arguments.length;i+=1)url+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+code+"; visit "+url+" for the full message."}__webpack_require__.d(__webpack_exports__,{A:()=>formatMuiErrorMessage})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>_formatMuiErrorMessage__WEBPACK_IMPORTED_MODULE_0__.A});var _formatMuiErrorMessage__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/formatMuiErrorMessage/formatMuiErrorMessage.js")},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>generateUtilityClass,li:()=>globalStateClasses});var _ClassNameGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ClassNameGenerator/ClassNameGenerator.js");const globalStateClasses={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function generateUtilityClass(componentName,slot,globalStatePrefix="Mui"){const globalStateClass=globalStateClasses[slot];return globalStateClass?`${globalStatePrefix}-${globalStateClass}`:`${_ClassNameGenerator__WEBPACK_IMPORTED_MODULE_0__.A.generate(componentName)}-${slot}`}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClasses/generateUtilityClasses.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>generateUtilityClasses});var _generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/generateUtilityClass/generateUtilityClass.js");function generateUtilityClasses(componentName,slots,globalStatePrefix="Mui"){const result={};return slots.forEach((slot=>{result[slot]=(0,_generateUtilityClass__WEBPACK_IMPORTED_MODULE_0__.Ay)(componentName,slot,globalStatePrefix)})),result}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/getDisplayName/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>getDisplayName,getFunctionName:()=>getFunctionName});var react_is=__webpack_require__("./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/index.js");const fnNameMatchRegex=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function getFunctionName(fn){const match=`${fn}`.match(fnNameMatchRegex);return match&&match[1]||""}function getFunctionComponentName(Component,fallback=""){return Component.displayName||Component.name||getFunctionName(Component)||fallback}function getWrappedName(outerType,innerType,wrapperName){const functionName=getFunctionComponentName(innerType);return outerType.displayName||(""!==functionName?`${wrapperName}(${functionName})`:wrapperName)}function getDisplayName(Component){if(null!=Component){if("string"==typeof Component)return Component;if("function"==typeof Component)return getFunctionComponentName(Component,"Component");if("object"==typeof Component)switch(Component.$$typeof){case react_is.ForwardRef:return getWrappedName(Component,Component.render,"ForwardRef");case react_is.Memo:return getWrappedName(Component,Component.type,"memo");default:return}}}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/getScrollbarSize/getScrollbarSize.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function getScrollbarSize(doc){const documentWidth=doc.documentElement.clientWidth;return Math.abs(window.innerWidth-documentWidth)}__webpack_require__.d(__webpack_exports__,{A:()=>getScrollbarSize})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function ownerDocument(node){return node&&node.ownerDocument||document}__webpack_require__.d(__webpack_exports__,{A:()=>ownerDocument})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerWindow/ownerWindow.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>ownerWindow});var _ownerDocument__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/ownerDocument/ownerDocument.js");function ownerWindow(node){return(0,_ownerDocument__WEBPACK_IMPORTED_MODULE_0__.A)(node).defaultView||window}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/resolveProps/resolveProps.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>resolveProps});var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/extends.js");function resolveProps(defaultProps,props){const output=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({},props);return Object.keys(defaultProps).forEach((propName=>{if(propName.toString().match(/^(components|slots)$/))output[propName]=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({},defaultProps[propName],output[propName]);else if(propName.toString().match(/^(componentsProps|slotProps)$/)){const defaultSlotProps=defaultProps[propName]||{},slotProps=props[propName];output[propName]={},slotProps&&Object.keys(slotProps)?defaultSlotProps&&Object.keys(defaultSlotProps)?(output[propName]=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.A)({},slotProps),Object.keys(defaultSlotProps).forEach((slotPropName=>{output[propName][slotPropName]=resolveProps(defaultSlotProps[slotPropName],slotProps[slotPropName])}))):output[propName]=slotProps:output[propName]=defaultSlotProps}else void 0===output[propName]&&(output[propName]=defaultProps[propName])})),output}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/setRef/setRef.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function setRef(ref,value){"function"==typeof ref?ref(value):ref&&(ref.current=value)}__webpack_require__.d(__webpack_exports__,{A:()=>setRef})},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEnhancedEffect/useEnhancedEffect.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");const __WEBPACK_DEFAULT_EXPORT__="undefined"!=typeof window?react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect:react__WEBPACK_IMPORTED_MODULE_0__.useEffect},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEventCallback/useEventCallback.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_useEnhancedEffect__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useEnhancedEffect/useEnhancedEffect.js");const __WEBPACK_DEFAULT_EXPORT__=function useEventCallback(fn){const ref=react__WEBPACK_IMPORTED_MODULE_0__.useRef(fn);return(0,_useEnhancedEffect__WEBPACK_IMPORTED_MODULE_1__.A)((()=>{ref.current=fn})),react__WEBPACK_IMPORTED_MODULE_0__.useRef(((...args)=>(0,ref.current)(...args))).current}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useForkRef/useForkRef.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>useForkRef});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),_setRef__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/setRef/setRef.js");function useForkRef(...refs){return react__WEBPACK_IMPORTED_MODULE_0__.useMemo((()=>refs.every((ref=>null==ref))?null:instance=>{refs.forEach((ref=>{(0,_setRef__WEBPACK_IMPORTED_MODULE_1__.A)(ref,instance)}))}),refs)}},"./node_modules/.pnpm/@mui+utils@5.15.14_hqp5somsn7eiiofz7xtfzylpfm/node_modules/@mui/utils/useTimeout/useTimeout.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E:()=>Timeout,A:()=>useTimeout});var react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");const UNINITIALIZED={};const EMPTY=[];class Timeout{constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Timeout}start(delay,fn){this.clear(),this.currentId=setTimeout((()=>{this.currentId=null,fn()}),delay)}}function useTimeout(){const timeout=function useLazyRef(init,initArg){const ref=react.useRef(UNINITIALIZED);return ref.current===UNINITIALIZED&&(ref.current=init(initArg)),ref}(Timeout.create).current;return function useOnMount(fn){react.useEffect(fn,EMPTY)}(timeout.disposeEffect),timeout}},"./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f)}else for(f in e)e[f]&&(n&&(n+=" "),n+=f);return n}__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function clsx(){for(var e,t,f=0,n="",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}},"./node_modules/.pnpm/hls.js@1.5.11/node_modules/hls.js/dist/hls.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}__webpack_require__.d(__webpack_exports__,{Ay:()=>Hls});var URL_REGEX,FIRST_SEGMENT_REGEX,SLASH_DOT_REGEX,SLASH_DOT_DOT_REGEX,URLToolkit,urlToolkit={exports:{}};URL_REGEX=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,FIRST_SEGMENT_REGEX=/^(?=([^\/?#]*))\1([^]*)$/,SLASH_DOT_REGEX=/(?:\/|^)\.(?=\/)/g,SLASH_DOT_DOT_REGEX=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,urlToolkit.exports=URLToolkit={buildAbsoluteURL:function(baseURL,relativeURL,opts){if(opts=opts||{},baseURL=baseURL.trim(),!(relativeURL=relativeURL.trim())){if(!opts.alwaysNormalize)return baseURL;var basePartsForNormalise=URLToolkit.parseURL(baseURL);if(!basePartsForNormalise)throw new Error("Error trying to parse base URL.");return basePartsForNormalise.path=URLToolkit.normalizePath(basePartsForNormalise.path),URLToolkit.buildURLFromParts(basePartsForNormalise)}var relativeParts=URLToolkit.parseURL(relativeURL);if(!relativeParts)throw new Error("Error trying to parse relative URL.");if(relativeParts.scheme)return opts.alwaysNormalize?(relativeParts.path=URLToolkit.normalizePath(relativeParts.path),URLToolkit.buildURLFromParts(relativeParts)):relativeURL;var baseParts=URLToolkit.parseURL(baseURL);if(!baseParts)throw new Error("Error trying to parse base URL.");if(!baseParts.netLoc&&baseParts.path&&"/"!==baseParts.path[0]){var pathParts=FIRST_SEGMENT_REGEX.exec(baseParts.path);baseParts.netLoc=pathParts[1],baseParts.path=pathParts[2]}baseParts.netLoc&&!baseParts.path&&(baseParts.path="/");var builtParts={scheme:baseParts.scheme,netLoc:relativeParts.netLoc,path:null,params:relativeParts.params,query:relativeParts.query,fragment:relativeParts.fragment};if(!relativeParts.netLoc&&(builtParts.netLoc=baseParts.netLoc,"/"!==relativeParts.path[0]))if(relativeParts.path){var baseURLPath=baseParts.path,newPath=baseURLPath.substring(0,baseURLPath.lastIndexOf("/")+1)+relativeParts.path;builtParts.path=URLToolkit.normalizePath(newPath)}else builtParts.path=baseParts.path,relativeParts.params||(builtParts.params=baseParts.params,relativeParts.query||(builtParts.query=baseParts.query));return null===builtParts.path&&(builtParts.path=opts.alwaysNormalize?URLToolkit.normalizePath(relativeParts.path):relativeParts.path),URLToolkit.buildURLFromParts(builtParts)},parseURL:function(url){var parts=URL_REGEX.exec(url);return parts?{scheme:parts[1]||"",netLoc:parts[2]||"",path:parts[3]||"",params:parts[4]||"",query:parts[5]||"",fragment:parts[6]||""}:null},normalizePath:function(path){for(path=path.split("").reverse().join("").replace(SLASH_DOT_REGEX,"");path.length!==(path=path.replace(SLASH_DOT_DOT_REGEX,"")).length;);return path.split("").reverse().join("")},buildURLFromParts:function(parts){return parts.scheme+parts.netLoc+parts.path+parts.params+parts.query+parts.fragment}};var urlToolkitExports=urlToolkit.exports;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:String(i)}function _defineProperty(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const isFiniteNumber=Number.isFinite||function(value){return"number"==typeof value&&isFinite(value)},isSafeInteger=Number.isSafeInteger||function(value){return"number"==typeof value&&Math.abs(value)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;let Events=function(Events){return Events.MEDIA_ATTACHING="hlsMediaAttaching",Events.MEDIA_ATTACHED="hlsMediaAttached",Events.MEDIA_DETACHING="hlsMediaDetaching",Events.MEDIA_DETACHED="hlsMediaDetached",Events.BUFFER_RESET="hlsBufferReset",Events.BUFFER_CODECS="hlsBufferCodecs",Events.BUFFER_CREATED="hlsBufferCreated",Events.BUFFER_APPENDING="hlsBufferAppending",Events.BUFFER_APPENDED="hlsBufferAppended",Events.BUFFER_EOS="hlsBufferEos",Events.BUFFER_FLUSHING="hlsBufferFlushing",Events.BUFFER_FLUSHED="hlsBufferFlushed",Events.MANIFEST_LOADING="hlsManifestLoading",Events.MANIFEST_LOADED="hlsManifestLoaded",Events.MANIFEST_PARSED="hlsManifestParsed",Events.LEVEL_SWITCHING="hlsLevelSwitching",Events.LEVEL_SWITCHED="hlsLevelSwitched",Events.LEVEL_LOADING="hlsLevelLoading",Events.LEVEL_LOADED="hlsLevelLoaded",Events.LEVEL_UPDATED="hlsLevelUpdated",Events.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",Events.LEVELS_UPDATED="hlsLevelsUpdated",Events.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",Events.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",Events.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",Events.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",Events.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",Events.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",Events.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",Events.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",Events.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",Events.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",Events.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",Events.CUES_PARSED="hlsCuesParsed",Events.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",Events.INIT_PTS_FOUND="hlsInitPtsFound",Events.FRAG_LOADING="hlsFragLoading",Events.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",Events.FRAG_LOADED="hlsFragLoaded",Events.FRAG_DECRYPTED="hlsFragDecrypted",Events.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",Events.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",Events.FRAG_PARSING_METADATA="hlsFragParsingMetadata",Events.FRAG_PARSED="hlsFragParsed",Events.FRAG_BUFFERED="hlsFragBuffered",Events.FRAG_CHANGED="hlsFragChanged",Events.FPS_DROP="hlsFpsDrop",Events.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",Events.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",Events.ERROR="hlsError",Events.DESTROYING="hlsDestroying",Events.KEY_LOADING="hlsKeyLoading",Events.KEY_LOADED="hlsKeyLoaded",Events.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",Events.BACK_BUFFER_REACHED="hlsBackBufferReached",Events.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",Events}({}),ErrorTypes=function(ErrorTypes){return ErrorTypes.NETWORK_ERROR="networkError",ErrorTypes.MEDIA_ERROR="mediaError",ErrorTypes.KEY_SYSTEM_ERROR="keySystemError",ErrorTypes.MUX_ERROR="muxError",ErrorTypes.OTHER_ERROR="otherError",ErrorTypes}({}),ErrorDetails=function(ErrorDetails){return ErrorDetails.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",ErrorDetails.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",ErrorDetails.KEY_SYSTEM_NO_SESSION="keySystemNoSession",ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",ErrorDetails.MANIFEST_LOAD_ERROR="manifestLoadError",ErrorDetails.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",ErrorDetails.MANIFEST_PARSING_ERROR="manifestParsingError",ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",ErrorDetails.LEVEL_EMPTY_ERROR="levelEmptyError",ErrorDetails.LEVEL_LOAD_ERROR="levelLoadError",ErrorDetails.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",ErrorDetails.LEVEL_PARSING_ERROR="levelParsingError",ErrorDetails.LEVEL_SWITCH_ERROR="levelSwitchError",ErrorDetails.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",ErrorDetails.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",ErrorDetails.FRAG_LOAD_ERROR="fragLoadError",ErrorDetails.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",ErrorDetails.FRAG_DECRYPT_ERROR="fragDecryptError",ErrorDetails.FRAG_PARSING_ERROR="fragParsingError",ErrorDetails.FRAG_GAP="fragGap",ErrorDetails.REMUX_ALLOC_ERROR="remuxAllocError",ErrorDetails.KEY_LOAD_ERROR="keyLoadError",ErrorDetails.KEY_LOAD_TIMEOUT="keyLoadTimeOut",ErrorDetails.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",ErrorDetails.BUFFER_APPEND_ERROR="bufferAppendError",ErrorDetails.BUFFER_APPENDING_ERROR="bufferAppendingError",ErrorDetails.BUFFER_STALLED_ERROR="bufferStalledError",ErrorDetails.BUFFER_FULL_ERROR="bufferFullError",ErrorDetails.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",ErrorDetails.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",ErrorDetails.INTERNAL_EXCEPTION="internalException",ErrorDetails.INTERNAL_ABORTED="aborted",ErrorDetails.UNKNOWN="unknown",ErrorDetails}({});const noop=function noop(){},fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop};let exportedLogger=fakeLogger;function exportLoggerFunctions(debugConfig,...functions){functions.forEach((function(type){exportedLogger[type]=debugConfig[type]?debugConfig[type].bind(debugConfig):function consolePrintFn(type){const func=self.console[type];return func?func.bind(self.console,`[${type}] >`):noop}(type)}))}const logger=exportedLogger,DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(attrs){"string"==typeof attrs&&(attrs=AttrList.parseAttrList(attrs)),_extends(this,attrs)}get clientAttrs(){return Object.keys(this).filter((attr=>"X-"===attr.substring(0,2)))}decimalInteger(attrName){const intValue=parseInt(this[attrName],10);return intValue>Number.MAX_SAFE_INTEGER?1/0:intValue}hexadecimalInteger(attrName){if(this[attrName]){let stringValue=(this[attrName]||"0x").slice(2);stringValue=(1&stringValue.length?"0":"")+stringValue;const value=new Uint8Array(stringValue.length/2);for(let i=0;i<stringValue.length/2;i++)value[i]=parseInt(stringValue.slice(2*i,2*i+2),16);return value}return null}hexadecimalIntegerAsNumber(attrName){const intValue=parseInt(this[attrName],16);return intValue>Number.MAX_SAFE_INTEGER?1/0:intValue}decimalFloatingPoint(attrName){return parseFloat(this[attrName])}optionalFloat(attrName,defaultValue){const value=this[attrName];return value?parseFloat(value):defaultValue}enumeratedString(attrName){return this[attrName]}bool(attrName){return"YES"===this[attrName]}decimalResolution(attrName){const res=DECIMAL_RESOLUTION_REGEX.exec(this[attrName]);if(null!==res)return{width:parseInt(res[1],10),height:parseInt(res[2],10)}}static parseAttrList(input){let match;const attrs={};for(ATTR_LIST_REGEX.lastIndex=0;null!==(match=ATTR_LIST_REGEX.exec(input));){let value=match[2];0===value.indexOf('"')&&value.lastIndexOf('"')===value.length-1&&(value=value.slice(1,-1));attrs[match[1].trim()]=value}return attrs}}function isSCTE35Attribute(attrName){return"SCTE35-OUT"===attrName||"SCTE35-IN"===attrName}class DateRange{constructor(dateRangeAttr,dateRangeWithSameId){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,dateRangeWithSameId){const previousAttr=dateRangeWithSameId.attr;for(const key in previousAttr)if(Object.prototype.hasOwnProperty.call(dateRangeAttr,key)&&dateRangeAttr[key]!==previousAttr[key]){logger.warn(`DATERANGE tag attribute: "${key}" does not match for tags with ID: "${dateRangeAttr.ID}"`),this._badValueForSameId=key;break}dateRangeAttr=_extends(new AttrList({}),previousAttr,dateRangeAttr)}if(this.attr=dateRangeAttr,this._startDate=new Date(dateRangeAttr["START-DATE"]),"END-DATE"in this.attr){const endDate=new Date(this.attr["END-DATE"]);isFiniteNumber(endDate.getTime())&&(this._endDate=endDate)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const duration=this.duration;return null!==duration?new Date(this._startDate.getTime()+1e3*duration):null}get duration(){if("DURATION"in this.attr){const duration=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(duration))return duration}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes_AUDIO="audio",ElementaryStreamTypes_VIDEO="video",ElementaryStreamTypes_AUDIOVIDEO="audiovideo";class BaseSegment{constructor(baseurl){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ElementaryStreamTypes_AUDIO]:null,[ElementaryStreamTypes_VIDEO]:null,[ElementaryStreamTypes_AUDIOVIDEO]:null},this.baseurl=baseurl}setByteRange(value,previous){const params=value.split("@",2);let start;start=1===params.length?(null==previous?void 0:previous.byteRangeEndOffset)||0:parseInt(params[1]),this._byteRange=[start,parseInt(params[0])+start]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(value){this._url=value}}class Fragment extends BaseSegment{constructor(type,baseurl){super(baseurl),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new LoadStats,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=type}get decryptdata(){const{levelkeys}=this;if(!levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const key=this.levelkeys.identity;if(key)this._decryptdata=key.getDecryptData(this.sn);else{const keyFormats=Object.keys(this.levelkeys);if(1===keyFormats.length)return this._decryptdata=this.levelkeys[keyFormats[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!isFiniteNumber(this.programDateTime))return null;const duration=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+1e3*duration}get encrypted(){var _this$_decryptdata;if(null!=(_this$_decryptdata=this._decryptdata)&&_this$_decryptdata.encrypted)return!0;if(this.levelkeys){const keyFormats=Object.keys(this.levelkeys),len=keyFormats.length;if(len>1||1===len&&this.levelkeys[keyFormats[0]].encrypted)return!0}return!1}setKeyFormat(keyFormat){if(this.levelkeys){const key=this.levelkeys[keyFormat];key&&!this._decryptdata&&(this._decryptdata=key.getDecryptData(this.sn))}}abortRequests(){var _this$loader,_this$keyLoader;null==(_this$loader=this.loader)||_this$loader.abort(),null==(_this$keyLoader=this.keyLoader)||_this$keyLoader.abort()}setElementaryStreamInfo(type,startPTS,endPTS,startDTS,endDTS,partial=!1){const{elementaryStreams}=this,info=elementaryStreams[type];info?(info.startPTS=Math.min(info.startPTS,startPTS),info.endPTS=Math.max(info.endPTS,endPTS),info.startDTS=Math.min(info.startDTS,startDTS),info.endDTS=Math.max(info.endDTS,endDTS)):elementaryStreams[type]={startPTS,endPTS,startDTS,endDTS,partial}}clearElementaryStreamInfo(){const{elementaryStreams}=this;elementaryStreams[ElementaryStreamTypes_AUDIO]=null,elementaryStreams[ElementaryStreamTypes_VIDEO]=null,elementaryStreams[ElementaryStreamTypes_AUDIOVIDEO]=null}}class Part extends BaseSegment{constructor(partAttrs,frag,baseurl,index,previous){super(baseurl),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new LoadStats,this.duration=partAttrs.decimalFloatingPoint("DURATION"),this.gap=partAttrs.bool("GAP"),this.independent=partAttrs.bool("INDEPENDENT"),this.relurl=partAttrs.enumeratedString("URI"),this.fragment=frag,this.index=index;const byteRange=partAttrs.enumeratedString("BYTERANGE");byteRange&&this.setByteRange(byteRange,previous),previous&&(this.fragOffset=previous.fragOffset+previous.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams}=this;return!!(elementaryStreams.audio||elementaryStreams.video||elementaryStreams.audiovideo)}}class LevelDetails{constructor(baseUrl){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=baseUrl}reloaded(previous){if(!previous)return this.advanced=!0,void(this.updated=!0);const partSnDiff=this.lastPartSn-previous.lastPartSn,partIndexDiff=this.lastPartIndex-previous.lastPartIndex;this.updated=this.endSN!==previous.endSN||!!partIndexDiff||!!partSnDiff||!this.live,this.advanced=this.endSN>previous.endSN||partSnDiff>0||0===partSnDiff&&partIndexDiff>0,this.updated||this.advanced?this.misses=Math.floor(.6*previous.misses):this.misses=previous.misses+1,this.availabilityDelay=previous.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const runTime=this.driftEndTime-this.driftStartTime;if(runTime>0){return 1e3*(this.driftEnd-this.driftStart)/runTime}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var _this$partList;return null!=(_this$partList=this.partList)&&_this$partList.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var _this$fragments;return null!=(_this$fragments=this.fragments)&&_this$fragments.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var _this$partList2;return null!=(_this$partList2=this.partList)&&_this$partList2.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var _this$partList3;return null!=(_this$partList3=this.partList)&&_this$partList3.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function base64Decode(base64encodedStr){return Uint8Array.from(atob(base64encodedStr),(c=>c.charCodeAt(0)))}function convertDataUriToArrayBytes(uri){const colonsplit=uri.split(":");let keydata=null;if("data"===colonsplit[0]&&2===colonsplit.length){const semicolonsplit=colonsplit[1].split(";"),commasplit=semicolonsplit[semicolonsplit.length-1].split(",");if(2===commasplit.length){const isbase64="base64"===commasplit[0],data=commasplit[1];isbase64?(semicolonsplit.splice(-1,1),keydata=base64Decode(data)):keydata=function getKeyIdBytes(str){const keyIdbytes=strToUtf8array(str).subarray(0,16),paddedkeyIdbytes=new Uint8Array(16);return paddedkeyIdbytes.set(keyIdbytes,16-keyIdbytes.length),paddedkeyIdbytes}(data)}}return keydata}function strToUtf8array(str){return Uint8Array.from(unescape(encodeURIComponent(str)),(c=>c.charCodeAt(0)))}const optionalSelf="undefined"!=typeof self?self:void 0;var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats_CLEARKEY="org.w3.clearkey",KeySystemFormats_FAIRPLAY="com.apple.streamingkeydelivery",KeySystemFormats_PLAYREADY="com.microsoft.playready",KeySystemFormats_WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function keySystemFormatToKeySystemDomain(format){switch(format){case KeySystemFormats_FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats_PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats_WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats_CLEARKEY:return KeySystems.CLEARKEY}}var KeySystemIds_WIDEVINE="edef8ba979d64acea3c827dcd51d21ed";function keySystemDomainToKeySystemFormat(keySystem){switch(keySystem){case KeySystems.FAIRPLAY:return KeySystemFormats_FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats_PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats_WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats_CLEARKEY}}function getKeySystemsForConfig(config){const{drmSystems,widevineLicenseUrl}=config,keySystemsToAttempt=drmSystems?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter((keySystem=>!!drmSystems[keySystem])):[];return!keySystemsToAttempt[KeySystems.WIDEVINE]&&widevineLicenseUrl&&keySystemsToAttempt.push(KeySystems.WIDEVINE),keySystemsToAttempt}const requestMediaKeySystemAccess=null!=optionalSelf&&null!=(_optionalSelf$navigat=optionalSelf.navigator)&&_optionalSelf$navigat.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var _optionalSelf$navigat;function sliceUint8(array,start,end){return Uint8Array.prototype.slice?array.slice(start,end):new Uint8Array(Array.prototype.slice.call(array,start,end))}const isHeader$2=(data,offset)=>offset+10<=data.length&&73===data[offset]&&68===data[offset+1]&&51===data[offset+2]&&data[offset+3]<255&&data[offset+4]<255&&data[offset+6]<128&&data[offset+7]<128&&data[offset+8]<128&&data[offset+9]<128,isFooter=(data,offset)=>offset+10<=data.length&&51===data[offset]&&68===data[offset+1]&&73===data[offset+2]&&data[offset+3]<255&&data[offset+4]<255&&data[offset+6]<128&&data[offset+7]<128&&data[offset+8]<128&&data[offset+9]<128,getID3Data=(data,offset)=>{const front=offset;let length=0;for(;isHeader$2(data,offset);){length+=10;length+=readSize(data,offset+6),isFooter(data,offset+10)&&(length+=10),offset+=length}if(length>0)return data.subarray(front,front+length)},readSize=(data,offset)=>{let size=0;return size=(127&data[offset])<<21,size|=(127&data[offset+1])<<14,size|=(127&data[offset+2])<<7,size|=127&data[offset+3],size},canParse$2=(data,offset)=>isHeader$2(data,offset)&&readSize(data,offset+6)+10<=data.length-offset,getTimeStamp=data=>{const frames=getID3Frames(data);for(let i=0;i<frames.length;i++){const frame=frames[i];if(isTimeStampFrame(frame))return readTimeStamp(frame)}},isTimeStampFrame=frame=>frame&&"PRIV"===frame.key&&"com.apple.streaming.transportStreamTimestamp"===frame.info,getFrameData=data=>{const type=String.fromCharCode(data[0],data[1],data[2],data[3]),size=readSize(data,4);return{type,size,data:data.subarray(10,10+size)}},getID3Frames=id3Data=>{let offset=0;const frames=[];for(;isHeader$2(id3Data,offset);){const size=readSize(id3Data,offset+6);offset+=10;const end=offset+size;for(;offset+8<end;){const frameData=getFrameData(id3Data.subarray(offset)),frame=decodeFrame(frameData);frame&&frames.push(frame),offset+=frameData.size+10}isFooter(id3Data,offset)&&(offset+=10)}return frames},decodeFrame=frame=>"PRIV"===frame.type?decodePrivFrame(frame):"W"===frame.type[0]?decodeURLFrame(frame):decodeTextFrame(frame),decodePrivFrame=frame=>{if(frame.size<2)return;const owner=utf8ArrayToStr(frame.data,!0),privateData=new Uint8Array(frame.data.subarray(owner.length+1));return{key:frame.type,info:owner,data:privateData.buffer}},decodeTextFrame=frame=>{if(frame.size<2)return;if("TXXX"===frame.type){let index=1;const description=utf8ArrayToStr(frame.data.subarray(index),!0);index+=description.length+1;const value=utf8ArrayToStr(frame.data.subarray(index));return{key:frame.type,info:description,data:value}}const text=utf8ArrayToStr(frame.data.subarray(1));return{key:frame.type,data:text}},decodeURLFrame=frame=>{if("WXXX"===frame.type){if(frame.size<2)return;let index=1;const description=utf8ArrayToStr(frame.data.subarray(index),!0);index+=description.length+1;const value=utf8ArrayToStr(frame.data.subarray(index));return{key:frame.type,info:description,data:value}}const url=utf8ArrayToStr(frame.data);return{key:frame.type,data:url}},readTimeStamp=timeStampFrame=>{if(8===timeStampFrame.data.byteLength){const data=new Uint8Array(timeStampFrame.data),pts33Bit=1&data[3];let timestamp=(data[4]<<23)+(data[5]<<15)+(data[6]<<7)+data[7];return timestamp/=45,pts33Bit&&(timestamp+=47721858.84),Math.round(timestamp)}},utf8ArrayToStr=(array,exitOnNull=!1)=>{const decoder=getTextDecoder();if(decoder){const decoded=decoder.decode(array);if(exitOnNull){const idx=decoded.indexOf("\0");return-1!==idx?decoded.substring(0,idx):decoded}return decoded.replace(/\0/g,"")}const len=array.length;let c,char2,char3,out="",i=0;for(;i<len;){if(c=array[i++],0===c&&exitOnNull)return out;if(0!==c&&3!==c)switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=array[i++],out+=String.fromCharCode((31&c)<<6|63&char2);break;case 14:char2=array[i++],char3=array[i++],out+=String.fromCharCode((15&c)<<12|(63&char2)<<6|63&char3)}}return out};let decoder;function getTextDecoder(){if(!navigator.userAgent.includes("PlayStation 4"))return decoder||void 0===self.TextDecoder||(decoder=new self.TextDecoder("utf-8")),decoder}const Hex_hexDump=function(array){let str="";for(let i=0;i<array.length;i++){let h=array[i].toString(16);h.length<2&&(h="0"+h),str+=h}return str},UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(data){return String.fromCharCode.apply(null,data)}function readUint16(buffer,offset){const val=buffer[offset]<<8|buffer[offset+1];return val<0?65536+val:val}function readUint32(buffer,offset){const val=readSint32(buffer,offset);return val<0?4294967296+val:val}function readUint64(buffer,offset){let result=readUint32(buffer,offset);return result*=Math.pow(2,32),result+=readUint32(buffer,offset+4),result}function readSint32(buffer,offset){return buffer[offset]<<24|buffer[offset+1]<<16|buffer[offset+2]<<8|buffer[offset+3]}function writeUint32(buffer,offset,value){buffer[offset]=value>>24,buffer[offset+1]=value>>16&255,buffer[offset+2]=value>>8&255,buffer[offset+3]=255&value}function findBox(data,path){const results=[];if(!path.length)return results;const end=data.byteLength;for(let i=0;i<end;){const size=readUint32(data,i),endbox=size>1?i+size:end;if(bin2str(data.subarray(i+4,i+8))===path[0])if(1===path.length)results.push(data.subarray(i+8,endbox));else{const subresults=findBox(data.subarray(i+8,endbox),path.slice(1));subresults.length&&push.apply(results,subresults)}i=endbox}return results}function parseSegmentIndex(sidx){const references=[],version=sidx[0];let index=8;const timescale=readUint32(sidx,index);index+=4;let earliestPresentationTime=0,firstOffset=0;0===version?(earliestPresentationTime=readUint32(sidx,index),firstOffset=readUint32(sidx,index+4),index+=8):(earliestPresentationTime=readUint64(sidx,index),firstOffset=readUint64(sidx,index+8),index+=16),index+=2;let startByte=sidx.length+firstOffset;const referencesCount=readUint16(sidx,index);index+=2;for(let i=0;i<referencesCount;i++){let referenceIndex=index;const referenceInfo=readUint32(sidx,referenceIndex);referenceIndex+=4;const referenceSize=2147483647&referenceInfo;if(1===(2147483648&referenceInfo)>>>31)return logger.warn("SIDX has hierarchical references (not supported)"),null;const subsegmentDuration=readUint32(sidx,referenceIndex);referenceIndex+=4,references.push({referenceSize,subsegmentDuration,info:{duration:subsegmentDuration/timescale,start:startByte,end:startByte+referenceSize-1}}),startByte+=referenceSize,referenceIndex+=4,index=referenceIndex}return{earliestPresentationTime,timescale,version,referencesCount,references}}function parseInitSegment(initSegment){const result=[],traks=findBox(initSegment,["moov","trak"]);for(let i=0;i<traks.length;i++){const trak=traks[i],tkhd=findBox(trak,["tkhd"])[0];if(tkhd){let version=tkhd[0];const trackId=readUint32(tkhd,0===version?12:20),mdhd=findBox(trak,["mdia","mdhd"])[0];if(mdhd){version=mdhd[0];const timescale=readUint32(mdhd,0===version?12:20),hdlr=findBox(trak,["mdia","hdlr"])[0];if(hdlr){const hdlrType=bin2str(hdlr.subarray(8,12)),type={soun:ElementaryStreamTypes_AUDIO,vide:ElementaryStreamTypes_VIDEO}[hdlrType];if(type){const stsdData=parseStsd(findBox(trak,["mdia","minf","stbl","stsd"])[0]);result[trackId]={timescale,type},result[type]=_objectSpread2({timescale,id:trackId},stsdData)}}}}}return findBox(initSegment,["moov","mvex","trex"]).forEach((trex=>{const trackId=readUint32(trex,4),track=result[trackId];track&&(track.default={duration:readUint32(trex,12),flags:readUint32(trex,20)})})),result}function parseStsd(stsd){const sampleEntries=stsd.subarray(8),sampleEntriesEnd=sampleEntries.subarray(86),fourCC=bin2str(sampleEntries.subarray(4,8));let codec=fourCC;const encrypted="enca"===fourCC||"encv"===fourCC;if(encrypted){const encBox=findBox(sampleEntries,[fourCC])[0];findBox(encBox.subarray("enca"===fourCC?28:78),["sinf"]).forEach((sinf=>{const schm=findBox(sinf,["schm"])[0];if(schm){const scheme=bin2str(schm.subarray(4,8));if("cbcs"===scheme||"cenc"===scheme){const frma=findBox(sinf,["frma"])[0];frma&&(codec=bin2str(frma))}}}))}switch(codec){case"avc1":case"avc2":case"avc3":case"avc4":{const avcCBox=findBox(sampleEntriesEnd,["avcC"])[0];codec+="."+toHex(avcCBox[1])+toHex(avcCBox[2])+toHex(avcCBox[3]);break}case"mp4a":{const codecBox=findBox(sampleEntries,[fourCC])[0],esdsBox=findBox(codecBox.subarray(28),["esds"])[0];if(esdsBox&&esdsBox.length>12){let i=4;if(3!==esdsBox[i++])break;i=skipBERInteger(esdsBox,i),i+=2;const flags=esdsBox[i++];if(128&flags&&(i+=2),64&flags&&(i+=esdsBox[i++]),4!==esdsBox[i++])break;i=skipBERInteger(esdsBox,i);const objectType=esdsBox[i++];if(64!==objectType)break;if(codec+="."+toHex(objectType),i+=12,5!==esdsBox[i++])break;i=skipBERInteger(esdsBox,i);const firstByte=esdsBox[i++];let audioObjectType=(248&firstByte)>>3;31===audioObjectType&&(audioObjectType+=1+((7&firstByte)<<3)+((224&esdsBox[i])>>5)),codec+="."+audioObjectType}break}case"hvc1":case"hev1":{const hvcCBox=findBox(sampleEntriesEnd,["hvcC"])[0],profileByte=hvcCBox[1],profileSpace=["","A","B","C"][profileByte>>6],generalProfileIdc=31&profileByte,profileCompat=readUint32(hvcCBox,2),tierFlag=(32&profileByte)>>5?"H":"L",levelIDC=hvcCBox[12],constraintIndicator=hvcCBox.subarray(6,12);codec+="."+profileSpace+generalProfileIdc,codec+="."+profileCompat.toString(16).toUpperCase(),codec+="."+tierFlag+levelIDC;let constraintString="";for(let i=constraintIndicator.length;i--;){const byte=constraintIndicator[i];if(byte||constraintString){constraintString="."+byte.toString(16).toUpperCase()+constraintString}}codec+=constraintString;break}case"dvh1":case"dvhe":{const dvcCBox=findBox(sampleEntriesEnd,["dvcC"])[0],profile=dvcCBox[2]>>1&127,level=dvcCBox[2]<<5&32|dvcCBox[3]>>3&31;codec+="."+addLeadingZero(profile)+"."+addLeadingZero(level);break}case"vp09":{const vpcCBox=findBox(sampleEntriesEnd,["vpcC"])[0],profile=vpcCBox[4],level=vpcCBox[5],bitDepth=vpcCBox[6]>>4&15;codec+="."+addLeadingZero(profile)+"."+addLeadingZero(level)+"."+addLeadingZero(bitDepth);break}case"av01":{const av1CBox=findBox(sampleEntriesEnd,["av1C"])[0],profile=av1CBox[1]>>>5,level=31&av1CBox[1],tierFlag=av1CBox[2]>>>7?"H":"M",highBitDepth=(64&av1CBox[2])>>6,twelveBit=(32&av1CBox[2])>>5,bitDepth=2===profile&&highBitDepth?twelveBit?12:10:highBitDepth?10:8,monochrome=(16&av1CBox[2])>>4,chromaSubsamplingX=(8&av1CBox[2])>>3,chromaSubsamplingY=(4&av1CBox[2])>>2,chromaSamplePosition=3&av1CBox[2],colorPrimaries=1,transferCharacteristics=1,matrixCoefficients=1,videoFullRangeFlag=0;codec+="."+profile+"."+addLeadingZero(level)+tierFlag+"."+addLeadingZero(bitDepth)+"."+monochrome+"."+chromaSubsamplingX+chromaSubsamplingY+chromaSamplePosition+"."+addLeadingZero(colorPrimaries)+"."+addLeadingZero(transferCharacteristics)+"."+addLeadingZero(matrixCoefficients)+"."+videoFullRangeFlag;break}}return{codec,encrypted}}function skipBERInteger(bytes,i){const limit=i+5;for(;128&bytes[i++]&&i<limit;);return i}function toHex(x){return("0"+x.toString(16).toUpperCase()).slice(-2)}function addLeadingZero(num){return(num<10?"0":"")+num}function parseSinf(sinf){const schm=findBox(sinf,["schm"])[0];if(schm){const scheme=bin2str(schm.subarray(4,8));if("cbcs"===scheme||"cenc"===scheme)return findBox(sinf,["schi","tenc"])[0]}return logger.error("[eme] missing 'schm' box"),null}function computeRawDurationFromSamples(trun){const flags=readUint32(trun,0);let offset=8;1&flags&&(offset+=4),4&flags&&(offset+=4);let duration=0;const sampleCount=readUint32(trun,4);for(let i=0;i<sampleCount;i++){if(256&flags){duration+=readUint32(trun,offset),offset+=4}512&flags&&(offset+=4),1024&flags&&(offset+=4),2048&flags&&(offset+=4)}return duration}function appendUint8Array(data1,data2){const temp=new Uint8Array(data1.length+data2.length);return temp.set(data1),temp.set(data2,data1.length),temp}function parseSamples(timeOffset,track){const seiSamples=[],videoData=track.samples,timescale=track.timescale,trackId=track.id;let isHEVCFlavor=!1;return findBox(videoData,["moof"]).map((moof=>{const moofOffset=moof.byteOffset-8;findBox(moof,["traf"]).map((traf=>{const baseTime=findBox(traf,["tfdt"]).map((tfdt=>{const version=tfdt[0];let result=readUint32(tfdt,4);return 1===version&&(result*=Math.pow(2,32),result+=readUint32(tfdt,8)),result/timescale}))[0];return void 0!==baseTime&&(timeOffset=baseTime),findBox(traf,["tfhd"]).map((tfhd=>{const id=readUint32(tfhd,4),tfhdFlags=16777215&readUint32(tfhd,0);let defaultSampleDuration=0;const defaultSampleSizePresent=!!(16&tfhdFlags);let defaultSampleSize=0;const defaultSampleFlagsPresent=!!(32&tfhdFlags);let tfhdOffset=8;id===trackId&&(!!(1&tfhdFlags)&&(tfhdOffset+=8),!!(2&tfhdFlags)&&(tfhdOffset+=4),!!(8&tfhdFlags)&&(defaultSampleDuration=readUint32(tfhd,tfhdOffset),tfhdOffset+=4),defaultSampleSizePresent&&(defaultSampleSize=readUint32(tfhd,tfhdOffset),tfhdOffset+=4),defaultSampleFlagsPresent&&(tfhdOffset+=4),"video"===track.type&&(isHEVCFlavor=function isHEVC(codec){if(!codec)return!1;const delimit=codec.indexOf("."),baseCodec=delimit<0?codec:codec.substring(0,delimit);return"hvc1"===baseCodec||"hev1"===baseCodec||"dvh1"===baseCodec||"dvhe"===baseCodec}(track.codec)),findBox(traf,["trun"]).map((trun=>{const version=trun[0],flags=16777215&readUint32(trun,0),dataOffsetPresent=!!(1&flags);let dataOffset=0;const firstSampleFlagsPresent=!!(4&flags),sampleDurationPresent=!!(256&flags);let sampleDuration=0;const sampleSizePresent=!!(512&flags);let sampleSize=0;const sampleFlagsPresent=!!(1024&flags),sampleCompositionOffsetsPresent=!!(2048&flags);let compositionOffset=0;const sampleCount=readUint32(trun,4);let trunOffset=8;dataOffsetPresent&&(dataOffset=readUint32(trun,trunOffset),trunOffset+=4),firstSampleFlagsPresent&&(trunOffset+=4);let sampleOffset=dataOffset+moofOffset;for(let ix=0;ix<sampleCount;ix++){if(sampleDurationPresent?(sampleDuration=readUint32(trun,trunOffset),trunOffset+=4):sampleDuration=defaultSampleDuration,sampleSizePresent?(sampleSize=readUint32(trun,trunOffset),trunOffset+=4):sampleSize=defaultSampleSize,sampleFlagsPresent&&(trunOffset+=4),sampleCompositionOffsetsPresent&&(compositionOffset=0===version?readUint32(trun,trunOffset):readSint32(trun,trunOffset),trunOffset+=4),track.type===ElementaryStreamTypes_VIDEO){let naluTotalSize=0;for(;naluTotalSize<sampleSize;){const naluSize=readUint32(videoData,sampleOffset);if(sampleOffset+=4,isSEIMessage(isHEVCFlavor,videoData[sampleOffset])){parseSEIMessageFromNALu(videoData.subarray(sampleOffset,sampleOffset+naluSize),isHEVCFlavor?2:1,timeOffset+compositionOffset/timescale,seiSamples)}sampleOffset+=naluSize,naluTotalSize+=naluSize+4}}timeOffset+=sampleDuration/timescale}})))}))}))})),seiSamples}function isSEIMessage(isHEVCFlavor,naluHeader){if(isHEVCFlavor){const naluType=naluHeader>>1&63;return 39===naluType||40===naluType}return 6===(31&naluHeader)}function parseSEIMessageFromNALu(unescapedData,headerSize,pts,samples){const data=discardEPB(unescapedData);let seiPtr=0;seiPtr+=headerSize;let payloadType=0,payloadSize=0,b=0;for(;seiPtr<data.length;){payloadType=0;do{if(seiPtr>=data.length)break;b=data[seiPtr++],payloadType+=b}while(255===b);payloadSize=0;do{if(seiPtr>=data.length)break;b=data[seiPtr++],payloadSize+=b}while(255===b);const leftOver=data.length-seiPtr;let payPtr=seiPtr;if(payloadSize<leftOver)seiPtr+=payloadSize;else if(payloadSize>leftOver){logger.error(`Malformed SEI payload. ${payloadSize} is too small, only ${leftOver} bytes left to parse.`);break}if(4===payloadType){if(181===data[payPtr++]){const providerCode=readUint16(data,payPtr);if(payPtr+=2,49===providerCode){const userStructure=readUint32(data,payPtr);if(payPtr+=4,1195456820===userStructure){const userDataType=data[payPtr++];if(3===userDataType){const firstByte=data[payPtr++],enabled=64&firstByte,totalBytes=enabled?2+3*(31&firstByte):0,byteArray=new Uint8Array(totalBytes);if(enabled){byteArray[0]=firstByte;for(let i=1;i<totalBytes;i++)byteArray[i]=data[payPtr++]}samples.push({type:userDataType,payloadType,pts,bytes:byteArray})}}}}}else if(5===payloadType&&payloadSize>16){const uuidStrArray=[];for(let i=0;i<16;i++){const _b=data[payPtr++].toString(16);uuidStrArray.push(1==_b.length?"0"+_b:_b),3!==i&&5!==i&&7!==i&&9!==i||uuidStrArray.push("-")}const length=payloadSize-16,userDataBytes=new Uint8Array(length);for(let i=0;i<length;i++)userDataBytes[i]=data[payPtr++];samples.push({payloadType,pts,uuid:uuidStrArray.join(""),userData:utf8ArrayToStr(userDataBytes),userDataBytes})}}}function discardEPB(data){const length=data.byteLength,EPBPositions=[];let i=1;for(;i<length-2;)0===data[i]&&0===data[i+1]&&3===data[i+2]?(EPBPositions.push(i+2),i+=2):i++;if(0===EPBPositions.length)return data;const newLength=length-EPBPositions.length,newData=new Uint8Array(newLength);let sourceIndex=0;for(i=0;i<newLength;sourceIndex++,i++)sourceIndex===EPBPositions[0]&&(sourceIndex++,EPBPositions.shift()),newData[i]=data[sourceIndex];return newData}function mp4pssh(systemId,keyids,data){if(16!==systemId.byteLength)throw new RangeError("Invalid system id");let version,kids,kidCount;if(keyids){version=1,kids=new Uint8Array(16*keyids.length);for(let ix=0;ix<keyids.length;ix++){const k=keyids[ix];if(16!==k.byteLength)throw new RangeError("Invalid key");kids.set(k,16*ix)}}else version=0,kids=new Uint8Array;version>0?(kidCount=new Uint8Array(4),keyids.length>0&&new DataView(kidCount.buffer).setUint32(0,keyids.length,!1)):kidCount=new Uint8Array;const dataSize=new Uint8Array(4);return data&&data.byteLength>0&&new DataView(dataSize.buffer).setUint32(0,data.byteLength,!1),function mp4Box(type,...payload){const len=payload.length;let size=8,i=len;for(;i--;)size+=payload[i].byteLength;const result=new Uint8Array(size);for(result[0]=size>>24&255,result[1]=size>>16&255,result[2]=size>>8&255,result[3]=255&size,result.set(type,4),i=0,size=8;i<len;i++)result.set(payload[i],size),size+=payload[i].byteLength;return result}([112,115,115,104],new Uint8Array([version,0,0,0]),systemId,kidCount,kids,dataSize,data||new Uint8Array)}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}constructor(method,uri,format,formatversions=[1],iv=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=method,this.uri=uri,this.keyFormat=format,this.keyFormatVersions=formatversions,this.iv=iv,this.encrypted=!!method&&"NONE"!==method,this.isCommonEncryption=this.encrypted&&"AES-128"!==method}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case KeySystemFormats_FAIRPLAY:case KeySystemFormats_WIDEVINE:case KeySystemFormats_PLAYREADY:case KeySystemFormats_CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(sn){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof sn&&("AES-128"!==this.method||this.iv||logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),sn=0);const iv=function createInitializationVector(segmentNumber){const uint8View=new Uint8Array(16);for(let i=12;i<16;i++)uint8View[i]=segmentNumber>>8*(15-i)&255;return uint8View}(sn);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,iv)}const keyBytes=convertDataUriToArrayBytes(this.uri);if(keyBytes)switch(this.keyFormat){case KeySystemFormats_WIDEVINE:this.pssh=keyBytes,keyBytes.length>=22&&(this.keyId=keyBytes.subarray(keyBytes.length-22,keyBytes.length-6));break;case KeySystemFormats_PLAYREADY:{const PlayReadyKeySystemUUID=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(PlayReadyKeySystemUUID,null,keyBytes);const keyBytesUtf16=new Uint16Array(keyBytes.buffer,keyBytes.byteOffset,keyBytes.byteLength/2),keyByteStr=String.fromCharCode.apply(null,Array.from(keyBytesUtf16)),xmlKeyBytes=keyByteStr.substring(keyByteStr.indexOf("<"),keyByteStr.length),keyData=(new DOMParser).parseFromString(xmlKeyBytes,"text/xml").getElementsByTagName("KID")[0];if(keyData){const keyId=keyData.childNodes[0]?keyData.childNodes[0].nodeValue:keyData.getAttribute("VALUE");if(keyId){const keyIdArray=base64Decode(keyId).subarray(0,16);!function changeEndianness(keyId){const swap=function swap(array,from,to){const cur=array[from];array[from]=array[to],array[to]=cur};swap(keyId,0,3),swap(keyId,1,2),swap(keyId,4,5),swap(keyId,6,7)}(keyIdArray),this.keyId=keyIdArray}}break}default:{let keydata=keyBytes.subarray(0,16);if(16!==keydata.length){const padded=new Uint8Array(16);padded.set(keydata,16-keydata.length),keydata=padded}this.keyId=keydata;break}}if(!this.keyId||16!==this.keyId.byteLength){let keyId=keyUriToKeyIdMap[this.uri];if(!keyId){const val=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;keyId=new Uint8Array(16);new DataView(keyId.buffer,12,4).setUint32(0,val),keyUriToKeyIdMap[this.uri]=keyId}this.keyId=keyId}return this}}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(str){return VARIABLE_REPLACEMENT_REGEX.test(str)}function substituteVariablesInAttributes(parsed,attr,attributeNames){if(null!==parsed.variableList||parsed.hasVariableRefs)for(let i=attributeNames.length;i--;){const name=attributeNames[i],value=attr[name];value&&(attr[name]=substituteVariables(parsed,value))}}function substituteVariables(parsed,value){if(null!==parsed.variableList||parsed.hasVariableRefs){const variableList=parsed.variableList;return value.replace(VARIABLE_REPLACEMENT_REGEX,(variableReference=>{const variableName=variableReference.substring(2,variableReference.length-1),variableValue=null==variableList?void 0:variableList[variableName];return void 0===variableValue?(parsed.playlistParsingError||(parsed.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${variableName}"`)),variableReference):variableValue}))}return value}function addVariableDefinition(parsed,attr,parentUrl){let NAME,VALUE,variableList=parsed.variableList;if(variableList||(parsed.variableList=variableList={}),"QUERYPARAM"in attr){NAME=attr.QUERYPARAM;try{const searchParams=new self.URL(parentUrl).searchParams;if(!searchParams.has(NAME))throw new Error(`"${NAME}" does not match any query parameter in URI: "${parentUrl}"`);VALUE=searchParams.get(NAME)}catch(error){parsed.playlistParsingError||(parsed.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${error.message}`))}}else NAME=attr.NAME,VALUE=attr.VALUE;NAME in variableList?parsed.playlistParsingError||(parsed.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${NAME}"`)):variableList[NAME]=VALUE||""}function importVariableDefinition(parsed,attr,sourceVariableList){const IMPORT=attr.IMPORT;if(sourceVariableList&&IMPORT in sourceVariableList){let variableList=parsed.variableList;variableList||(parsed.variableList=variableList={}),variableList[IMPORT]=sourceVariableList[IMPORT]}else parsed.playlistParsingError||(parsed.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${IMPORT}"`))}function getMediaSource(preferManagedMediaSource=!0){if("undefined"==typeof self)return;return(preferManagedMediaSource||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const sampleEntryCodesISO={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function areCodecsMediaSourceSupported(codecs,type,preferManagedMediaSource=!0){return!codecs.split(",").some((codec=>!isCodecMediaSourceSupported(codec,type,preferManagedMediaSource)))}function isCodecMediaSourceSupported(codec,type,preferManagedMediaSource=!0){var _MediaSource$isTypeSu;const MediaSource=getMediaSource(preferManagedMediaSource);return null!=(_MediaSource$isTypeSu=null==MediaSource?void 0:MediaSource.isTypeSupported(mimeTypeForCodec(codec,type)))&&_MediaSource$isTypeSu}function mimeTypeForCodec(codec,type){return`${type}/mp4;codecs="${codec}"`}function videoCodecPreferenceValue(videoCodec){if(videoCodec){const fourCC=videoCodec.substring(0,4);return sampleEntryCodesISO.video[fourCC]}return 2}function codecsSetSelectionPreferenceValue(codecSet){return codecSet.split(",").reduce(((num,fourCC)=>{const preferenceValue=sampleEntryCodesISO.video[fourCC];return preferenceValue?(2*preferenceValue+num)/(num?3:2):(sampleEntryCodesISO.audio[fourCC]+num)/(num?2:1)}),0)}const CODEC_COMPATIBLE_NAMES={};const AUDIO_CODEC_REGEXP=/flac|opus/i;function getCodecCompatibleName(codec,preferManagedMediaSource=!0){return codec.replace(AUDIO_CODEC_REGEXP,(m=>function getCodecCompatibleNameLower(lowerCaseCodec,preferManagedMediaSource=!0){if(CODEC_COMPATIBLE_NAMES[lowerCaseCodec])return CODEC_COMPATIBLE_NAMES[lowerCaseCodec];const codecsToCheck={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[lowerCaseCodec];for(let i=0;i<codecsToCheck.length;i++)if(isCodecMediaSourceSupported(codecsToCheck[i],"audio",preferManagedMediaSource))return CODEC_COMPATIBLE_NAMES[lowerCaseCodec]=codecsToCheck[i],codecsToCheck[i];return lowerCaseCodec}(m.toLowerCase(),preferManagedMediaSource)))}function pickMostCompleteCodecName(parsedCodec,levelCodec){return parsedCodec&&"mp4a"!==parsedCodec?parsedCodec:levelCodec?levelCodec.split(",")[0]:levelCodec}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(groups,mediaGroupId){for(let i=0;i<groups.length;i++){const group=groups[i];if(group.id===mediaGroupId)return group}}static resolve(url,baseUrl){return urlToolkitExports.buildAbsoluteURL(baseUrl,url,{alwaysNormalize:!0})}static isMediaPlaylist(str){return IS_MEDIA_PLAYLIST.test(str)}static parseMasterPlaylist(string,baseurl){const parsed={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:hasVariableReferences(string)},levelsWithKnownCodecs=[];let result;for(MASTER_PLAYLIST_REGEX.lastIndex=0;null!=(result=MASTER_PLAYLIST_REGEX.exec(string));)if(result[1]){var _level$unknownCodecs;const attrs=new AttrList(result[1]);substituteVariablesInAttributes(parsed,attrs,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const uri=substituteVariables(parsed,result[2]),level={attrs,bitrate:attrs.decimalInteger("BANDWIDTH")||attrs.decimalInteger("AVERAGE-BANDWIDTH"),name:attrs.NAME,url:M3U8Parser.resolve(uri,baseurl)},resolution=attrs.decimalResolution("RESOLUTION");resolution&&(level.width=resolution.width,level.height=resolution.height),setCodecs(attrs.CODECS,level),null!=(_level$unknownCodecs=level.unknownCodecs)&&_level$unknownCodecs.length||levelsWithKnownCodecs.push(level),parsed.levels.push(level)}else if(result[3]){const tag=result[3],attributes=result[4];switch(tag){case"SESSION-DATA":{const sessionAttrs=new AttrList(attributes);substituteVariablesInAttributes(parsed,sessionAttrs,["DATA-ID","LANGUAGE","VALUE","URI"]);const dataId=sessionAttrs["DATA-ID"];dataId&&(null===parsed.sessionData&&(parsed.sessionData={}),parsed.sessionData[dataId]=sessionAttrs);break}case"SESSION-KEY":{const sessionKey=parseKey(attributes,baseurl,parsed);sessionKey.encrypted&&sessionKey.isSupported()?(null===parsed.sessionKeys&&(parsed.sessionKeys=[]),parsed.sessionKeys.push(sessionKey)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${attributes}"`);break}case"DEFINE":{const variableAttributes=new AttrList(attributes);substituteVariablesInAttributes(parsed,variableAttributes,["NAME","VALUE","QUERYPARAM"]),addVariableDefinition(parsed,variableAttributes,baseurl)}break;case"CONTENT-STEERING":{const contentSteeringAttributes=new AttrList(attributes);substituteVariablesInAttributes(parsed,contentSteeringAttributes,["SERVER-URI","PATHWAY-ID"]),parsed.contentSteering={uri:M3U8Parser.resolve(contentSteeringAttributes["SERVER-URI"],baseurl),pathwayId:contentSteeringAttributes["PATHWAY-ID"]||"."};break}case"START":parsed.startTimeOffset=parseStartTimeOffset(attributes)}}const stripUnknownCodecLevels=levelsWithKnownCodecs.length>0&&levelsWithKnownCodecs.length<parsed.levels.length;return parsed.levels=stripUnknownCodecLevels?levelsWithKnownCodecs:parsed.levels,0===parsed.levels.length&&(parsed.playlistParsingError=new Error("no levels found in manifest")),parsed}static parseMasterPlaylistMedia(string,baseurl,parsed){let result;const results={},levels=parsed.levels,groupsByType={AUDIO:levels.map((level=>({id:level.attrs.AUDIO,audioCodec:level.audioCodec}))),SUBTITLES:levels.map((level=>({id:level.attrs.SUBTITLES,textCodec:level.textCodec}))),"CLOSED-CAPTIONS":[]};let id=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;null!==(result=MASTER_PLAYLIST_MEDIA_REGEX.exec(string));){const attrs=new AttrList(result[1]),type=attrs.TYPE;if(type){const groups=groupsByType[type],medias=results[type]||[];results[type]=medias,substituteVariablesInAttributes(parsed,attrs,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const lang=attrs.LANGUAGE,assocLang=attrs["ASSOC-LANGUAGE"],channels=attrs.CHANNELS,characteristics=attrs.CHARACTERISTICS,instreamId=attrs["INSTREAM-ID"],media={attrs,bitrate:0,id:id++,groupId:attrs["GROUP-ID"]||"",name:attrs.NAME||lang||"",type,default:attrs.bool("DEFAULT"),autoselect:attrs.bool("AUTOSELECT"),forced:attrs.bool("FORCED"),lang,url:attrs.URI?M3U8Parser.resolve(attrs.URI,baseurl):""};if(assocLang&&(media.assocLang=assocLang),channels&&(media.channels=channels),characteristics&&(media.characteristics=characteristics),instreamId&&(media.instreamId=instreamId),null!=groups&&groups.length){const groupCodec=M3U8Parser.findGroup(groups,media.groupId)||groups[0];assignCodec(media,groupCodec,"audioCodec"),assignCodec(media,groupCodec,"textCodec")}medias.push(media)}}return results}static parseLevelPlaylist(string,baseurl,id,type,levelUrlId,multivariantVariableList){const level=new LevelDetails(baseurl),fragments=level.fragments;let result,i,levelkeys,currentInitSegment=null,currentSN=0,currentPart=0,totalduration=0,discontinuityCounter=0,prevFrag=null,frag=new Fragment(type,baseurl),firstPdtIndex=-1,createNextFrag=!1,nextByteRange=null;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,level.m3u8=string,level.hasVariableRefs=hasVariableReferences(string);null!==(result=LEVEL_PLAYLIST_REGEX_FAST.exec(string));){createNextFrag&&(createNextFrag=!1,frag=new Fragment(type,baseurl),frag.start=totalduration,frag.sn=currentSN,frag.cc=discontinuityCounter,frag.level=id,currentInitSegment&&(frag.initSegment=currentInitSegment,frag.rawProgramDateTime=currentInitSegment.rawProgramDateTime,currentInitSegment.rawProgramDateTime=null,nextByteRange&&(frag.setByteRange(nextByteRange),nextByteRange=null)));const duration=result[1];if(duration){frag.duration=parseFloat(duration);const title=(" "+result[2]).slice(1);frag.title=title||null,frag.tagList.push(title?["INF",duration,title]:["INF",duration])}else if(result[3]){if(isFiniteNumber(frag.duration)){frag.start=totalduration,levelkeys&&setFragLevelKeys(frag,levelkeys,level),frag.sn=currentSN,frag.level=id,frag.cc=discontinuityCounter,fragments.push(frag);const uri=(" "+result[3]).slice(1);frag.relurl=substituteVariables(level,uri),assignProgramDateTime(frag,prevFrag),prevFrag=frag,totalduration+=frag.duration,currentSN++,currentPart=0,createNextFrag=!0}}else if(result[4]){const data=(" "+result[4]).slice(1);prevFrag?frag.setByteRange(data,prevFrag):frag.setByteRange(data)}else if(result[5])frag.rawProgramDateTime=(" "+result[5]).slice(1),frag.tagList.push(["PROGRAM-DATE-TIME",frag.rawProgramDateTime]),-1===firstPdtIndex&&(firstPdtIndex=fragments.length);else{if(result=result[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!result){logger.warn("No matches on slow regex match for level playlist!");continue}for(i=1;i<result.length&&void 0===result[i];i++);const tag=(" "+result[i]).slice(1),value1=(" "+result[i+1]).slice(1),value2=result[i+2]?(" "+result[i+2]).slice(1):"";switch(tag){case"PLAYLIST-TYPE":level.type=value1.toUpperCase();break;case"MEDIA-SEQUENCE":currentSN=level.startSN=parseInt(value1);break;case"SKIP":{const skipAttrs=new AttrList(value1);substituteVariablesInAttributes(level,skipAttrs,["RECENTLY-REMOVED-DATERANGES"]);const skippedSegments=skipAttrs.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(skippedSegments)){level.skippedSegments=skippedSegments;for(let _i=skippedSegments;_i--;)fragments.unshift(null);currentSN+=skippedSegments}const recentlyRemovedDateranges=skipAttrs.enumeratedString("RECENTLY-REMOVED-DATERANGES");recentlyRemovedDateranges&&(level.recentlyRemovedDateranges=recentlyRemovedDateranges.split("\t"));break}case"TARGETDURATION":level.targetduration=Math.max(parseInt(value1),1);break;case"VERSION":level.version=parseInt(value1);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":level.live=!1;break;case"#":(value1||value2)&&frag.tagList.push(value2?[value1,value2]:[value1]);break;case"DISCONTINUITY":discontinuityCounter++,frag.tagList.push(["DIS"]);break;case"GAP":frag.gap=!0,frag.tagList.push([tag]);break;case"BITRATE":frag.tagList.push([tag,value1]);break;case"DATERANGE":{const dateRangeAttr=new AttrList(value1);substituteVariablesInAttributes(level,dateRangeAttr,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),substituteVariablesInAttributes(level,dateRangeAttr,dateRangeAttr.clientAttrs);const dateRange=new DateRange(dateRangeAttr,level.dateRanges[dateRangeAttr.ID]);dateRange.isValid||level.skippedSegments?level.dateRanges[dateRange.id]=dateRange:logger.warn(`Ignoring invalid DATERANGE tag: "${value1}"`),frag.tagList.push(["EXT-X-DATERANGE",value1]);break}case"DEFINE":{const variableAttributes=new AttrList(value1);substituteVariablesInAttributes(level,variableAttributes,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in variableAttributes?importVariableDefinition(level,variableAttributes,multivariantVariableList):addVariableDefinition(level,variableAttributes,baseurl)}break;case"DISCONTINUITY-SEQUENCE":discontinuityCounter=parseInt(value1);break;case"KEY":{const levelKey=parseKey(value1,baseurl,level);if(levelKey.isSupported()){if("NONE"===levelKey.method){levelkeys=void 0;break}levelkeys||(levelkeys={}),levelkeys[levelKey.keyFormat]&&(levelkeys=_extends({},levelkeys)),levelkeys[levelKey.keyFormat]=levelKey}else logger.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${value1}"`);break}case"START":level.startTimeOffset=parseStartTimeOffset(value1);break;case"MAP":{const mapAttrs=new AttrList(value1);if(substituteVariablesInAttributes(level,mapAttrs,["BYTERANGE","URI"]),frag.duration){const init=new Fragment(type,baseurl);setInitSegment(init,mapAttrs,id,levelkeys),currentInitSegment=init,frag.initSegment=currentInitSegment,currentInitSegment.rawProgramDateTime&&!frag.rawProgramDateTime&&(frag.rawProgramDateTime=currentInitSegment.rawProgramDateTime)}else{const end=frag.byteRangeEndOffset;if(end){const start=frag.byteRangeStartOffset;nextByteRange=`${end-start}@${start}`}else nextByteRange=null;setInitSegment(frag,mapAttrs,id,levelkeys),currentInitSegment=frag,createNextFrag=!0}break}case"SERVER-CONTROL":{const serverControlAttrs=new AttrList(value1);level.canBlockReload=serverControlAttrs.bool("CAN-BLOCK-RELOAD"),level.canSkipUntil=serverControlAttrs.optionalFloat("CAN-SKIP-UNTIL",0),level.canSkipDateRanges=level.canSkipUntil>0&&serverControlAttrs.bool("CAN-SKIP-DATERANGES"),level.partHoldBack=serverControlAttrs.optionalFloat("PART-HOLD-BACK",0),level.holdBack=serverControlAttrs.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const partInfAttrs=new AttrList(value1);level.partTarget=partInfAttrs.decimalFloatingPoint("PART-TARGET");break}case"PART":{let partList=level.partList;partList||(partList=level.partList=[]);const previousFragmentPart=currentPart>0?partList[partList.length-1]:void 0,index=currentPart++,partAttrs=new AttrList(value1);substituteVariablesInAttributes(level,partAttrs,["BYTERANGE","URI"]);const part=new Part(partAttrs,frag,baseurl,index,previousFragmentPart);partList.push(part),frag.duration+=part.duration;break}case"PRELOAD-HINT":{const preloadHintAttrs=new AttrList(value1);substituteVariablesInAttributes(level,preloadHintAttrs,["URI"]),level.preloadHint=preloadHintAttrs;break}case"RENDITION-REPORT":{const renditionReportAttrs=new AttrList(value1);substituteVariablesInAttributes(level,renditionReportAttrs,["URI"]),level.renditionReports=level.renditionReports||[],level.renditionReports.push(renditionReportAttrs);break}default:logger.warn(`line parsed but not handled: ${result}`)}}}prevFrag&&!prevFrag.relurl?(fragments.pop(),totalduration-=prevFrag.duration,level.partList&&(level.fragmentHint=prevFrag)):level.partList&&(assignProgramDateTime(frag,prevFrag),frag.cc=discontinuityCounter,level.fragmentHint=frag,levelkeys&&setFragLevelKeys(frag,levelkeys,level));const fragmentLength=fragments.length,firstFragment=fragments[0],lastFragment=fragments[fragmentLength-1];if(totalduration+=level.skippedSegments*level.targetduration,totalduration>0&&fragmentLength&&lastFragment){level.averagetargetduration=totalduration/fragmentLength;const lastSn=lastFragment.sn;level.endSN="initSegment"!==lastSn?lastSn:0,level.live||(lastFragment.endList=!0),firstFragment&&(level.startCC=firstFragment.cc)}else level.endSN=0,level.startCC=0;return level.fragmentHint&&(totalduration+=level.fragmentHint.duration),level.totalduration=totalduration,level.endCC=discontinuityCounter,firstPdtIndex>0&&function backfillProgramDateTimes(fragments,firstPdtIndex){let fragPrev=fragments[firstPdtIndex];for(let i=firstPdtIndex;i--;){const frag=fragments[i];if(!frag)return;frag.programDateTime=fragPrev.programDateTime-1e3*frag.duration,fragPrev=frag}}(fragments,firstPdtIndex),level}}function parseKey(keyTagAttributes,baseurl,parsed){var _keyAttrs$METHOD,_keyAttrs$KEYFORMAT;const keyAttrs=new AttrList(keyTagAttributes);substituteVariablesInAttributes(parsed,keyAttrs,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const decryptmethod=null!=(_keyAttrs$METHOD=keyAttrs.METHOD)?_keyAttrs$METHOD:"",decrypturi=keyAttrs.URI,decryptiv=keyAttrs.hexadecimalInteger("IV"),decryptkeyformatversions=keyAttrs.KEYFORMATVERSIONS,decryptkeyformat=null!=(_keyAttrs$KEYFORMAT=keyAttrs.KEYFORMAT)?_keyAttrs$KEYFORMAT:"identity";decrypturi&&keyAttrs.IV&&!decryptiv&&logger.error(`Invalid IV: ${keyAttrs.IV}`);const resolvedUri=decrypturi?M3U8Parser.resolve(decrypturi,baseurl):"",keyFormatVersions=(decryptkeyformatversions||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(decryptmethod,resolvedUri,decryptkeyformat,keyFormatVersions,decryptiv)}function parseStartTimeOffset(startAttributes){const startTimeOffset=new AttrList(startAttributes).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(startTimeOffset)?startTimeOffset:null}function setCodecs(codecsAttributeValue,level){let codecs=(codecsAttributeValue||"").split(/[ ,]+/).filter((c=>c));["video","audio","text"].forEach((type=>{const filtered=codecs.filter((codec=>function isCodecType(codec,type){const typeCodes=sampleEntryCodesISO[type];return!!typeCodes&&!!typeCodes[codec.slice(0,4)]}(codec,type)));filtered.length&&(level[`${type}Codec`]=filtered.join(","),codecs=codecs.filter((codec=>-1===filtered.indexOf(codec))))})),level.unknownCodecs=codecs}function assignCodec(media,groupItem,codecProperty){const codecValue=groupItem[codecProperty];codecValue&&(media[codecProperty]=codecValue)}function assignProgramDateTime(frag,prevFrag){frag.rawProgramDateTime?frag.programDateTime=Date.parse(frag.rawProgramDateTime):null!=prevFrag&&prevFrag.programDateTime&&(frag.programDateTime=prevFrag.endProgramDateTime),isFiniteNumber(frag.programDateTime)||(frag.programDateTime=null,frag.rawProgramDateTime=null)}function setInitSegment(frag,mapAttrs,id,levelkeys){frag.relurl=mapAttrs.URI,mapAttrs.BYTERANGE&&frag.setByteRange(mapAttrs.BYTERANGE),frag.level=id,frag.sn="initSegment",levelkeys&&(frag.levelkeys=levelkeys),frag.initSegment=null}function setFragLevelKeys(frag,levelkeys,level){frag.levelkeys=levelkeys;const{encryptedFragments}=level;encryptedFragments.length&&encryptedFragments[encryptedFragments.length-1].levelkeys===levelkeys||!Object.keys(levelkeys).some((format=>levelkeys[format].isCommonEncryption))||encryptedFragments.push(frag)}var PlaylistContextType_MANIFEST="manifest",PlaylistContextType_LEVEL="level",PlaylistContextType_AUDIO_TRACK="audioTrack",PlaylistContextType_SUBTITLE_TRACK="subtitleTrack",PlaylistLevelType_MAIN="main",PlaylistLevelType_AUDIO="audio",PlaylistLevelType_SUBTITLE="subtitle";function mapContextToLevelType(context){const{type}=context;switch(type){case PlaylistContextType_AUDIO_TRACK:return PlaylistLevelType_AUDIO;case PlaylistContextType_SUBTITLE_TRACK:return PlaylistLevelType_SUBTITLE;default:return PlaylistLevelType_MAIN}}function getResponseUrl(response,context){let url=response.url;return void 0!==url&&0!==url.indexOf("data:")||(url=context.url),url}class PlaylistLoader{constructor(hls){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=hls,this.registerListeners()}startLoad(startPosition){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls}=this;hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),hls.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls}=this;hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),hls.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(context){const config=this.hls.config,PLoader=config.pLoader,Loader=config.loader,loader=new(PLoader||Loader)(config);return this.loaders[context.type]=loader,loader}getInternalLoader(context){return this.loaders[context.type]}resetInternalLoader(contextType){this.loaders[contextType]&&delete this.loaders[contextType]}destroyInternalLoaders(){for(const contextType in this.loaders){const loader=this.loaders[contextType];loader&&loader.destroy(),this.resetInternalLoader(contextType)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(event,data){const{url}=data;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType_MANIFEST,url,deliveryDirectives:null})}onLevelLoading(event,data){const{id,level,pathwayId,url,deliveryDirectives}=data;this.load({id,level,pathwayId,responseType:"text",type:PlaylistContextType_LEVEL,url,deliveryDirectives})}onAudioTrackLoading(event,data){const{id,groupId,url,deliveryDirectives}=data;this.load({id,groupId,level:null,responseType:"text",type:PlaylistContextType_AUDIO_TRACK,url,deliveryDirectives})}onSubtitleTrackLoading(event,data){const{id,groupId,url,deliveryDirectives}=data;this.load({id,groupId,level:null,responseType:"text",type:PlaylistContextType_SUBTITLE_TRACK,url,deliveryDirectives})}load(context){var _context$deliveryDire;const config=this.hls.config;let loadPolicy,loader=this.getInternalLoader(context);if(loader){const loaderContext=loader.context;if(loaderContext&&loaderContext.url===context.url&&loaderContext.level===context.level)return void logger.trace("[playlist-loader]: playlist request ongoing");logger.log(`[playlist-loader]: aborting previous loader for type: ${context.type}`),loader.abort()}if(loadPolicy=context.type===PlaylistContextType_MANIFEST?config.manifestLoadPolicy.default:_extends({},config.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),loader=this.createInternalLoader(context),isFiniteNumber(null==(_context$deliveryDire=context.deliveryDirectives)?void 0:_context$deliveryDire.part)){let levelDetails;if(context.type===PlaylistContextType_LEVEL&&null!==context.level?levelDetails=this.hls.levels[context.level].details:context.type===PlaylistContextType_AUDIO_TRACK&&null!==context.id?levelDetails=this.hls.audioTracks[context.id].details:context.type===PlaylistContextType_SUBTITLE_TRACK&&null!==context.id&&(levelDetails=this.hls.subtitleTracks[context.id].details),levelDetails){const partTarget=levelDetails.partTarget,targetDuration=levelDetails.targetduration;if(partTarget&&targetDuration){const maxLowLatencyPlaylistRefresh=1e3*Math.max(3*partTarget,.8*targetDuration);loadPolicy=_extends({},loadPolicy,{maxTimeToFirstByteMs:Math.min(maxLowLatencyPlaylistRefresh,loadPolicy.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(maxLowLatencyPlaylistRefresh,loadPolicy.maxTimeToFirstByteMs)})}}}const legacyRetryCompatibility=loadPolicy.errorRetry||loadPolicy.timeoutRetry||{},loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:legacyRetryCompatibility.maxNumRetry||0,retryDelay:legacyRetryCompatibility.retryDelayMs||0,maxRetryDelay:legacyRetryCompatibility.maxRetryDelayMs||0},loaderCallbacks={onSuccess:(response,stats,context,networkDetails)=>{const loader=this.getInternalLoader(context);this.resetInternalLoader(context.type);const string=response.data;0===string.indexOf("#EXTM3U")?(stats.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(string)?this.handleTrackOrLevelPlaylist(response,stats,context,networkDetails||null,loader):this.handleMasterPlaylist(response,stats,context,networkDetails)):this.handleManifestParsingError(response,context,new Error("no EXTM3U delimiter"),networkDetails||null,stats)},onError:(response,context,networkDetails,stats)=>{this.handleNetworkError(context,networkDetails,!1,response,stats)},onTimeout:(stats,context,networkDetails)=>{this.handleNetworkError(context,networkDetails,!0,void 0,stats)}};loader.load(context,loaderConfig,loaderCallbacks)}handleMasterPlaylist(response,stats,context,networkDetails){const hls=this.hls,string=response.data,url=getResponseUrl(response,context),parsedResult=M3U8Parser.parseMasterPlaylist(string,url);if(parsedResult.playlistParsingError)return void this.handleManifestParsingError(response,context,parsedResult.playlistParsingError,networkDetails,stats);const{contentSteering,levels,sessionData,sessionKeys,startTimeOffset,variableList}=parsedResult;this.variableList=variableList;const{AUDIO:audioTracks=[],SUBTITLES:subtitles,"CLOSED-CAPTIONS":captions}=M3U8Parser.parseMasterPlaylistMedia(string,url,parsedResult);if(audioTracks.length){audioTracks.some((audioTrack=>!audioTrack.url))||!levels[0].audioCodec||levels[0].attrs.AUDIO||(logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),audioTracks.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""}))}hls.trigger(Events.MANIFEST_LOADED,{levels,audioTracks,subtitles,captions,contentSteering,url,stats,networkDetails,sessionData,sessionKeys,startTimeOffset,variableList})}handleTrackOrLevelPlaylist(response,stats,context,networkDetails,loader){const hls=this.hls,{id,level,type}=context,url=getResponseUrl(response,context),levelId=isFiniteNumber(level)?level:isFiniteNumber(id)?id:0,levelType=mapContextToLevelType(context),levelDetails=M3U8Parser.parseLevelPlaylist(response.data,url,levelId,levelType,0,this.variableList);if(type===PlaylistContextType_MANIFEST){const singleLevel={attrs:new AttrList({}),bitrate:0,details:levelDetails,name:"",url};hls.trigger(Events.MANIFEST_LOADED,{levels:[singleLevel],audioTracks:[],url,stats,networkDetails,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}stats.parsing.end=performance.now(),context.levelDetails=levelDetails,this.handlePlaylistLoaded(levelDetails,response,stats,context,networkDetails,loader)}handleManifestParsingError(response,context,error,networkDetails,stats){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:context.type===PlaylistContextType_MANIFEST,url:response.url,err:error,error,reason:error.message,response,context,networkDetails,stats})}handleNetworkError(context,networkDetails,timeout=!1,response,stats){let message=`A network ${timeout?"timeout":"error"+(response?" (status "+response.code+")":"")} occurred while loading ${context.type}`;context.type===PlaylistContextType_LEVEL?message+=`: ${context.level} id: ${context.id}`:context.type!==PlaylistContextType_AUDIO_TRACK&&context.type!==PlaylistContextType_SUBTITLE_TRACK||(message+=` id: ${context.id} group-id: "${context.groupId}"`);const error=new Error(message);logger.warn(`[playlist-loader]: ${message}`);let details=ErrorDetails.UNKNOWN,fatal=!1;const loader=this.getInternalLoader(context);switch(context.type){case PlaylistContextType_MANIFEST:details=timeout?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,fatal=!0;break;case PlaylistContextType_LEVEL:details=timeout?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,fatal=!1;break;case PlaylistContextType_AUDIO_TRACK:details=timeout?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal=!1;break;case PlaylistContextType_SUBTITLE_TRACK:details=timeout?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,fatal=!1}loader&&this.resetInternalLoader(context.type);const errorData={type:ErrorTypes.NETWORK_ERROR,details,fatal,url:context.url,loader,context,error,networkDetails,stats};if(response){const url=(null==networkDetails?void 0:networkDetails.url)||context.url;errorData.response=_objectSpread2({url,data:void 0},response)}this.hls.trigger(Events.ERROR,errorData)}handlePlaylistLoaded(levelDetails,response,stats,context,networkDetails,loader){const hls=this.hls,{type,level,id,groupId,deliveryDirectives}=context,url=getResponseUrl(response,context),parent=mapContextToLevelType(context),levelIndex="number"==typeof context.level&&parent===PlaylistLevelType_MAIN?level:void 0;if(!levelDetails.fragments.length){const _error=new Error("No Segments found in Playlist");return void hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url,error:_error,reason:_error.message,response,context,level:levelIndex,parent,networkDetails,stats})}levelDetails.targetduration||(levelDetails.playlistParsingError=new Error("Missing Target Duration"));const error=levelDetails.playlistParsingError;if(error)hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url,error,reason:error.message,response,context,level:levelIndex,parent,networkDetails,stats});else switch(levelDetails.live&&loader&&(loader.getCacheAge&&(levelDetails.ageHeader=loader.getCacheAge()||0),loader.getCacheAge&&!isNaN(levelDetails.ageHeader)||(levelDetails.ageHeader=0)),type){case PlaylistContextType_MANIFEST:case PlaylistContextType_LEVEL:hls.trigger(Events.LEVEL_LOADED,{details:levelDetails,level:levelIndex||0,id:id||0,stats,networkDetails,deliveryDirectives});break;case PlaylistContextType_AUDIO_TRACK:hls.trigger(Events.AUDIO_TRACK_LOADED,{details:levelDetails,id:id||0,groupId:groupId||"",stats,networkDetails,deliveryDirectives});break;case PlaylistContextType_SUBTITLE_TRACK:hls.trigger(Events.SUBTITLE_TRACK_LOADED,{details:levelDetails,id:id||0,groupId:groupId||"",stats,networkDetails,deliveryDirectives})}}}function sendAddTrackEvent(track,videoEl){let event;try{event=new Event("addtrack")}catch(err){event=document.createEvent("Event"),event.initEvent("addtrack",!1,!1)}event.track=track,videoEl.dispatchEvent(event)}function addCueToTrack(track,cue){const mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues&&!track.cues.getCueById(cue.id))try{if(track.addCue(cue),!track.cues.getCueById(cue.id))throw new Error(`addCue is failed for: ${cue}`)}catch(err){logger.debug(`[texttrack-utils]: ${err}`);try{const textTrackCue=new self.TextTrackCue(cue.startTime,cue.endTime,cue.text);textTrackCue.id=cue.id,track.addCue(textTrackCue)}catch(err2){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${err2}`)}}"disabled"===mode&&(track.mode=mode)}function clearCurrentCues(track){const mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues)for(let i=track.cues.length;i--;)track.removeCue(track.cues[i]);"disabled"===mode&&(track.mode=mode)}function removeCuesInRange(track,start,end,predicate){const mode=track.mode;if("disabled"===mode&&(track.mode="hidden"),track.cues&&track.cues.length>0){const cues=function getCuesInRange(cues,start,end){const cuesFound=[],firstCueInRange=function getFirstCueIndexAfterTime(cues,time){if(time<cues[0].startTime)return 0;const len=cues.length-1;if(time>cues[len].endTime)return-1;let left=0,right=len;for(;left<=right;){const mid=Math.floor((right+left)/2);if(time<cues[mid].startTime)right=mid-1;else{if(!(time>cues[mid].startTime&&left<len))return mid;left=mid+1}}return cues[left].startTime-time<time-cues[right].startTime?left:right}(cues,start);if(firstCueInRange>-1)for(let i=firstCueInRange,len=cues.length;i<len;i++){const cue=cues[i];if(cue.startTime>=start&&cue.endTime<=end)cuesFound.push(cue);else if(cue.startTime>end)return cuesFound}return cuesFound}(track.cues,start,end);for(let i=0;i<cues.length;i++)predicate&&!predicate(cues[i])||track.removeCue(cues[i])}"disabled"===mode&&(track.mode=mode)}function filterSubtitleTracks(textTrackList){const tracks=[];for(let i=0;i<textTrackList.length;i++){const track=textTrackList[i];"subtitles"!==track.kind&&"captions"!==track.kind||!track.label||tracks.push(textTrackList[i])}return tracks}var MetadataSchema_audioId3="org.id3",MetadataSchema_dateRange="com.apple.quicktime.HLS",MetadataSchema_emsg="https://aomedia.org/emsg/ID3";function getCueClass(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function createCueWithDataFields(Cue,startTime,endTime,data,type){let cue=new Cue(startTime,endTime,"");try{cue.value=data,type&&(cue.type=type)}catch(e){cue=new Cue(startTime,endTime,JSON.stringify(type?_objectSpread2({type},data):data))}return cue}const MAX_CUE_ENDTIME=(()=>{const Cue=getCueClass();try{Cue&&new Cue(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function dateRangeDateToTimelineSeconds(date,offset){return date.getTime()/1e3-offset}class ID3TrackController{constructor(hls){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=hls,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),hls.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),hls.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(event,data){this.media=data.media}onMediaDetaching(){this.id3Track&&(clearCurrentCues(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(media){const track=this.getID3Track(media.textTracks);return track.mode="hidden",track}getID3Track(textTracks){if(this.media){for(let i=0;i<textTracks.length;i++){const textTrack=textTracks[i];if("metadata"===textTrack.kind&&"id3"===textTrack.label)return sendAddTrackEvent(textTrack,this.media),textTrack}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(event,data){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues,enableID3MetadataCues}}}=this;if(!enableEmsgMetadataCues&&!enableID3MetadataCues)return;const{samples}=data;this.id3Track||(this.id3Track=this.createTrack(this.media));const Cue=getCueClass();if(Cue)for(let i=0;i<samples.length;i++){const type=samples[i].type;if(type===MetadataSchema_emsg&&!enableEmsgMetadataCues||!enableID3MetadataCues)continue;const frames=getID3Frames(samples[i].data);if(frames){const startTime=samples[i].pts;let endTime=startTime+samples[i].duration;endTime>MAX_CUE_ENDTIME&&(endTime=MAX_CUE_ENDTIME);endTime-startTime<=0&&(endTime=startTime+.25);for(let j=0;j<frames.length;j++){const frame=frames[j];if(!isTimeStampFrame(frame)){this.updateId3CueEnds(startTime,type);const cue=createCueWithDataFields(Cue,startTime,endTime,frame,type);cue&&this.id3Track.addCue(cue)}}}}}updateId3CueEnds(startTime,type){var _this$id3Track;const cues=null==(_this$id3Track=this.id3Track)?void 0:_this$id3Track.cues;if(cues)for(let i=cues.length;i--;){const cue=cues[i];cue.type===type&&cue.startTime<startTime&&cue.endTime===MAX_CUE_ENDTIME&&(cue.endTime=startTime)}}onBufferFlushing(event,{startOffset,endOffset,type}){const{id3Track,hls}=this;if(!hls)return;const{config:{enableEmsgMetadataCues,enableID3MetadataCues}}=hls;if(id3Track&&(enableEmsgMetadataCues||enableID3MetadataCues)){let predicate;predicate="audio"===type?cue=>cue.type===MetadataSchema_audioId3&&enableID3MetadataCues:"video"===type?cue=>cue.type===MetadataSchema_emsg&&enableEmsgMetadataCues:cue=>cue.type===MetadataSchema_audioId3&&enableID3MetadataCues||cue.type===MetadataSchema_emsg&&enableEmsgMetadataCues,removeCuesInRange(id3Track,startOffset,endOffset,predicate)}}onLevelUpdated(event,{details}){if(!this.media||!details.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended,id3Track}=this,{dateRanges}=details,ids=Object.keys(dateRanges);if(id3Track){const idsToRemove=Object.keys(dateRangeCuesAppended).filter((id=>!ids.includes(id)));for(let i=idsToRemove.length;i--;){const id=idsToRemove[i];Object.keys(dateRangeCuesAppended[id].cues).forEach((key=>{id3Track.removeCue(dateRangeCuesAppended[id].cues[key])})),delete dateRangeCuesAppended[id]}}const lastFragment=details.fragments[details.fragments.length-1];if(0===ids.length||!isFiniteNumber(null==lastFragment?void 0:lastFragment.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const dateTimeOffset=lastFragment.programDateTime/1e3-lastFragment.start,Cue=getCueClass();for(let i=0;i<ids.length;i++){const id=ids[i],dateRange=dateRanges[id],startTime=dateRangeDateToTimelineSeconds(dateRange.startDate,dateTimeOffset),appendedDateRangeCues=dateRangeCuesAppended[id],cues=(null==appendedDateRangeCues?void 0:appendedDateRangeCues.cues)||{};let durationKnown=(null==appendedDateRangeCues?void 0:appendedDateRangeCues.durationKnown)||!1,endTime=MAX_CUE_ENDTIME;const endDate=dateRange.endDate;if(endDate)endTime=dateRangeDateToTimelineSeconds(endDate,dateTimeOffset),durationKnown=!0;else if(dateRange.endOnNext&&!durationKnown){const nextDateRangeWithSameClass=ids.reduce(((candidateDateRange,id)=>{if(id!==dateRange.id){const otherDateRange=dateRanges[id];if(otherDateRange.class===dateRange.class&&otherDateRange.startDate>dateRange.startDate&&(!candidateDateRange||dateRange.startDate<candidateDateRange.startDate))return otherDateRange}return candidateDateRange}),null);nextDateRangeWithSameClass&&(endTime=dateRangeDateToTimelineSeconds(nextDateRangeWithSameClass.startDate,dateTimeOffset),durationKnown=!0)}const attributes=Object.keys(dateRange.attr);for(let j=0;j<attributes.length;j++){const key=attributes[j];if("ID"===(attrName=key)||"CLASS"===attrName||"START-DATE"===attrName||"DURATION"===attrName||"END-DATE"===attrName||"END-ON-NEXT"===attrName)continue;const cue=cues[key];if(cue)durationKnown&&!appendedDateRangeCues.durationKnown&&(cue.endTime=endTime);else if(Cue){let data=dateRange.attr[key];isSCTE35Attribute(key)&&(str=data,data=Uint8Array.from(str.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);const _cue=createCueWithDataFields(Cue,startTime,endTime,{key,data},MetadataSchema_dateRange);_cue&&(_cue.id=id,this.id3Track.addCue(_cue),cues[key]=_cue)}}dateRangeCuesAppended[id]={cues,dateRange,durationKnown}}var str,attrName}}class LatencyController{constructor(hls){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=hls,this.config=hls.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config,levelDetails}=this;return void 0!==config.liveMaxLatencyDuration?config.liveMaxLatencyDuration:levelDetails?config.liveMaxLatencyDurationCount*levelDetails.targetduration:0}get targetLatency(){const{levelDetails}=this;if(null===levelDetails)return null;const{holdBack,partHoldBack,targetduration}=levelDetails,{liveSyncDuration,liveSyncDurationCount,lowLatencyMode}=this.config,userConfig=this.hls.userConfig;let targetLatency=lowLatencyMode&&partHoldBack||holdBack;(userConfig.liveSyncDuration||userConfig.liveSyncDurationCount||0===targetLatency)&&(targetLatency=void 0!==liveSyncDuration?liveSyncDuration:liveSyncDurationCount*targetduration);const maxLiveSyncOnStallIncrease=targetduration;return targetLatency+Math.min(1*this.stallCount,maxLiveSyncOnStallIncrease)}get liveSyncPosition(){const liveEdge=this.estimateLiveEdge(),targetLatency=this.targetLatency,levelDetails=this.levelDetails;if(null===liveEdge||null===targetLatency||null===levelDetails)return null;const edge=levelDetails.edge,syncPosition=liveEdge-targetLatency-this.edgeStalled,min=edge-levelDetails.totalduration,max=edge-(this.config.lowLatencyMode&&levelDetails.partTarget||levelDetails.targetduration);return Math.min(Math.max(min,syncPosition),max)}get drift(){const{levelDetails}=this;return null===levelDetails?1:levelDetails.drift}get edgeStalled(){const{levelDetails}=this;if(null===levelDetails)return 0;const maxLevelUpdateAge=3*(this.config.lowLatencyMode&&levelDetails.partTarget||levelDetails.targetduration);return Math.max(levelDetails.age-maxLevelUpdateAge,0)}get forwardBufferLength(){const{media,levelDetails}=this;if(!media||!levelDetails)return 0;const bufferedRanges=media.buffered.length;return(bufferedRanges?media.buffered.end(bufferedRanges-1):levelDetails.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Events.ERROR,this.onError,this)}onMediaAttached(event,data){this.media=data.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(event,{details}){this.levelDetails=details,details.advanced&&this.timeupdate(),!details.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(event,data){var _this$levelDetails;data.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(_this$levelDetails=this.levelDetails)&&_this$levelDetails.live&&logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media,levelDetails}=this;if(!media||!levelDetails)return;this.currentTime=media.currentTime;const latency=this.computeLatency();if(null===latency)return;this._latency=latency;const{lowLatencyMode,maxLiveSyncPlaybackRate}=this.config;if(!lowLatencyMode||1===maxLiveSyncPlaybackRate||!levelDetails.live)return;const targetLatency=this.targetLatency;if(null===targetLatency)return;const distanceFromTarget=latency-targetLatency;if(distanceFromTarget<Math.min(this.maxLatency,targetLatency+levelDetails.targetduration)&&distanceFromTarget>.05&&this.forwardBufferLength>1){const max=Math.min(2,Math.max(1,maxLiveSyncPlaybackRate)),rate=Math.round(2/(1+Math.exp(-.75*distanceFromTarget-this.edgeStalled))*20)/20;media.playbackRate=Math.min(max,Math.max(1,rate))}else 1!==media.playbackRate&&0!==media.playbackRate&&(media.playbackRate=1)}estimateLiveEdge(){const{levelDetails}=this;return null===levelDetails?null:levelDetails.edge+levelDetails.age}computeLatency(){const liveEdge=this.estimateLiveEdge();return null===liveEdge?null:liveEdge-this.currentTime}}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];const VideoRangeValues=["SDR","PQ","HLG"];var HlsSkip_No="",HlsSkip_Yes="YES",HlsSkip_v2="v2";function getSkipValue(details){const{canSkipUntil,canSkipDateRanges,age}=details;return canSkipUntil&&age<canSkipUntil/2?canSkipDateRanges?HlsSkip_v2:HlsSkip_Yes:HlsSkip_No}class HlsUrlParameters{constructor(msn,part,skip){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=msn,this.part=part,this.skip=skip}addDirectives(uri){const url=new self.URL(uri);return void 0!==this.msn&&url.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&url.searchParams.set("_HLS_part",this.part.toString()),this.skip&&url.searchParams.set("_HLS_skip",this.skip),url.href}}class Level{constructor(data){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[data.url],this._attrs=[data.attrs],this.bitrate=data.bitrate,data.details&&(this.details=data.details),this.id=data.id||0,this.name=data.name,this.width=data.width||0,this.height=data.height||0,this.frameRate=data.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=data.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=data.audioCodec,this.videoCodec=data.videoCodec,this.codecSet=[data.videoCodec,data.audioCodec].filter((c=>!!c)).map((s=>s.substring(0,4))).join(","),this.addGroupId("audio",data.attrs.AUDIO),this.addGroupId("text",data.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(groupId){return hasGroup(this._audioGroups,groupId)}hasSubtitleGroup(groupId){return hasGroup(this._subtitleGroups,groupId)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(type,groupId){if(groupId)if("audio"===type){let audioGroups=this._audioGroups;audioGroups||(audioGroups=this._audioGroups=[]),-1===audioGroups.indexOf(groupId)&&audioGroups.push(groupId)}else if("text"===type){let subtitleGroups=this._subtitleGroups;subtitleGroups||(subtitleGroups=this._subtitleGroups=[]),-1===subtitleGroups.indexOf(groupId)&&subtitleGroups.push(groupId)}}get urlId(){return 0}set urlId(value){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var _this$audioGroups;return null==(_this$audioGroups=this.audioGroups)?void 0:_this$audioGroups[0]}get textGroupId(){var _this$subtitleGroups;return null==(_this$subtitleGroups=this.subtitleGroups)?void 0:_this$subtitleGroups[0]}addFallback(){}}function hasGroup(groups,groupId){return!(!groupId||!groups)&&-1!==groups.indexOf(groupId)}function updateFromToPTS(fragFrom,fragTo){const fragToPTS=fragTo.startPTS;if(isFiniteNumber(fragToPTS)){let frag,duration=0;fragTo.sn>fragFrom.sn?(duration=fragToPTS-fragFrom.start,frag=fragFrom):(duration=fragFrom.start-fragToPTS,frag=fragTo),frag.duration!==duration&&(frag.duration=duration)}else if(fragTo.sn>fragFrom.sn){fragFrom.cc===fragTo.cc&&fragFrom.minEndPTS?fragTo.start=fragFrom.start+(fragFrom.minEndPTS-fragFrom.start):fragTo.start=fragFrom.start+fragFrom.duration}else fragTo.start=Math.max(fragFrom.start-fragTo.duration,0)}function updateFragPTSDTS(details,frag,startPTS,endPTS,startDTS,endDTS){endPTS-startPTS<=0&&(logger.warn("Fragment should have a positive duration",frag),endPTS=startPTS+frag.duration,endDTS=startDTS+frag.duration);let maxStartPTS=startPTS,minEndPTS=endPTS;const fragStartPts=frag.startPTS,fragEndPts=frag.endPTS;if(isFiniteNumber(fragStartPts)){const deltaPTS=Math.abs(fragStartPts-startPTS);isFiniteNumber(frag.deltaPTS)?frag.deltaPTS=Math.max(deltaPTS,frag.deltaPTS):frag.deltaPTS=deltaPTS,maxStartPTS=Math.max(startPTS,fragStartPts),startPTS=Math.min(startPTS,fragStartPts),startDTS=Math.min(startDTS,frag.startDTS),minEndPTS=Math.min(endPTS,fragEndPts),endPTS=Math.max(endPTS,fragEndPts),endDTS=Math.max(endDTS,frag.endDTS)}const drift=startPTS-frag.start;0!==frag.start&&(frag.start=startPTS),frag.duration=endPTS-frag.start,frag.startPTS=startPTS,frag.maxStartPTS=maxStartPTS,frag.startDTS=startDTS,frag.endPTS=endPTS,frag.minEndPTS=minEndPTS,frag.endDTS=endDTS;const sn=frag.sn;if(!details||sn<details.startSN||sn>details.endSN)return 0;let i;const fragIdx=sn-details.startSN,fragments=details.fragments;for(fragments[fragIdx]=frag,i=fragIdx;i>0;i--)updateFromToPTS(fragments[i],fragments[i-1]);for(i=fragIdx;i<fragments.length-1;i++)updateFromToPTS(fragments[i],fragments[i+1]);return details.fragmentHint&&updateFromToPTS(fragments[fragments.length-1],details.fragmentHint),details.PTSKnown=details.alignedSliding=!0,drift}function mergeDetails(oldDetails,newDetails){let currentInitSegment=null;const oldFragments=oldDetails.fragments;for(let i=oldFragments.length-1;i>=0;i--){const oldInit=oldFragments[i].initSegment;if(oldInit){currentInitSegment=oldInit;break}}oldDetails.fragmentHint&&delete oldDetails.fragmentHint.endPTS;let PTSFrag,ccOffset=0;if(function mapFragmentIntersection(oldDetails,newDetails,intersectionFn){const skippedSegments=newDetails.skippedSegments,start=Math.max(oldDetails.startSN,newDetails.startSN)-newDetails.startSN,end=(oldDetails.fragmentHint?1:0)+(skippedSegments?newDetails.endSN:Math.min(oldDetails.endSN,newDetails.endSN))-newDetails.startSN,delta=newDetails.startSN-oldDetails.startSN,newFrags=newDetails.fragmentHint?newDetails.fragments.concat(newDetails.fragmentHint):newDetails.fragments,oldFrags=oldDetails.fragmentHint?oldDetails.fragments.concat(oldDetails.fragmentHint):oldDetails.fragments;for(let i=start;i<=end;i++){const oldFrag=oldFrags[delta+i];let newFrag=newFrags[i];skippedSegments&&!newFrag&&i<skippedSegments&&(newFrag=newDetails.fragments[i]=oldFrag),oldFrag&&newFrag&&intersectionFn(oldFrag,newFrag)}}(oldDetails,newDetails,((oldFrag,newFrag)=>{oldFrag.relurl&&(ccOffset=oldFrag.cc-newFrag.cc),isFiniteNumber(oldFrag.startPTS)&&isFiniteNumber(oldFrag.endPTS)&&(newFrag.start=newFrag.startPTS=oldFrag.startPTS,newFrag.startDTS=oldFrag.startDTS,newFrag.maxStartPTS=oldFrag.maxStartPTS,newFrag.endPTS=oldFrag.endPTS,newFrag.endDTS=oldFrag.endDTS,newFrag.minEndPTS=oldFrag.minEndPTS,newFrag.duration=oldFrag.endPTS-oldFrag.startPTS,newFrag.duration&&(PTSFrag=newFrag),newDetails.PTSKnown=newDetails.alignedSliding=!0),newFrag.elementaryStreams=oldFrag.elementaryStreams,newFrag.loader=oldFrag.loader,newFrag.stats=oldFrag.stats,oldFrag.initSegment&&(newFrag.initSegment=oldFrag.initSegment,currentInitSegment=oldFrag.initSegment)})),currentInitSegment){(newDetails.fragmentHint?newDetails.fragments.concat(newDetails.fragmentHint):newDetails.fragments).forEach((frag=>{var _currentInitSegment;!frag||frag.initSegment&&frag.initSegment.relurl!==(null==(_currentInitSegment=currentInitSegment)?void 0:_currentInitSegment.relurl)||(frag.initSegment=currentInitSegment)}))}if(newDetails.skippedSegments)if(newDetails.deltaUpdateFailed=newDetails.fragments.some((frag=>!frag)),newDetails.deltaUpdateFailed){logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let i=newDetails.skippedSegments;i--;)newDetails.fragments.shift();newDetails.startSN=newDetails.fragments[0].sn,newDetails.startCC=newDetails.fragments[0].cc}else newDetails.canSkipDateRanges&&(newDetails.dateRanges=function mergeDateRanges(oldDateRanges,deltaDateRanges,recentlyRemovedDateranges){const dateRanges=_extends({},oldDateRanges);recentlyRemovedDateranges&&recentlyRemovedDateranges.forEach((id=>{delete dateRanges[id]}));return Object.keys(deltaDateRanges).forEach((id=>{const dateRange=new DateRange(deltaDateRanges[id].attr,dateRanges[id]);dateRange.isValid?dateRanges[id]=dateRange:logger.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(deltaDateRanges[id].attr)}"`)})),dateRanges}(oldDetails.dateRanges,newDetails.dateRanges,newDetails.recentlyRemovedDateranges));const newFragments=newDetails.fragments;if(ccOffset){logger.warn("discontinuity sliding from playlist, take drift into account");for(let i=0;i<newFragments.length;i++)newFragments[i].cc+=ccOffset}newDetails.skippedSegments&&(newDetails.startCC=newDetails.fragments[0].cc),function mapPartIntersection(oldParts,newParts,intersectionFn){if(oldParts&&newParts){let delta=0;for(let i=0,len=oldParts.length;i<=len;i++){const oldPart=oldParts[i],newPart=newParts[i+delta];oldPart&&newPart&&oldPart.index===newPart.index&&oldPart.fragment.sn===newPart.fragment.sn?intersectionFn(oldPart,newPart):delta--}}}(oldDetails.partList,newDetails.partList,((oldPart,newPart)=>{newPart.elementaryStreams=oldPart.elementaryStreams,newPart.stats=oldPart.stats})),PTSFrag?updateFragPTSDTS(newDetails,PTSFrag,PTSFrag.startPTS,PTSFrag.endPTS,PTSFrag.startDTS,PTSFrag.endDTS):adjustSliding(oldDetails,newDetails),newFragments.length&&(newDetails.totalduration=newDetails.edge-newFragments[0].start),newDetails.driftStartTime=oldDetails.driftStartTime,newDetails.driftStart=oldDetails.driftStart;const advancedDateTime=newDetails.advancedDateTime;if(newDetails.advanced&&advancedDateTime){const edge=newDetails.edge;newDetails.driftStart||(newDetails.driftStartTime=advancedDateTime,newDetails.driftStart=edge),newDetails.driftEndTime=advancedDateTime,newDetails.driftEnd=edge}else newDetails.driftEndTime=oldDetails.driftEndTime,newDetails.driftEnd=oldDetails.driftEnd,newDetails.advancedDateTime=oldDetails.advancedDateTime}function adjustSliding(oldDetails,newDetails){const delta=newDetails.startSN+newDetails.skippedSegments-oldDetails.startSN,oldFragments=oldDetails.fragments;delta<0||delta>=oldFragments.length||addSliding(newDetails,oldFragments[delta].start)}function addSliding(details,start){if(start){const fragments=details.fragments;for(let i=details.skippedSegments;i<fragments.length;i++)fragments[i].start+=start;details.fragmentHint&&(details.fragmentHint.start+=start)}}function getPartWith(level,sn,partIndex){var _level$details;return null!=level&&level.details?findPart(null==(_level$details=level.details)?void 0:_level$details.partList,sn,partIndex):null}function findPart(partList,sn,partIndex){if(partList)for(let i=partList.length;i--;){const part=partList[i];if(part.index===partIndex&&part.fragment.sn===sn)return part}return null}function reassignFragmentLevelIndexes(levels){levels.forEach(((level,index)=>{const{details}=level;null!=details&&details.fragments&&details.fragments.forEach((fragment=>{fragment.level=index}))}))}function isTimeoutError(error){switch(error.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function getRetryConfig(loadPolicy,error){const isTimeout=isTimeoutError(error);return loadPolicy.default[(isTimeout?"timeout":"error")+"Retry"]}function getRetryDelay(retryConfig,retryCount){const backoffFactor="linear"===retryConfig.backoff?1:Math.pow(2,retryCount);return Math.min(backoffFactor*retryConfig.retryDelayMs,retryConfig.maxRetryDelayMs)}function getLoaderConfigWithoutReties(loderConfig){return _objectSpread2(_objectSpread2({},loderConfig),{errorRetry:null,timeoutRetry:null})}function shouldRetry(retryConfig,retryCount,isTimeout,loaderResponse){if(!retryConfig)return!1;const httpStatus=null==loaderResponse?void 0:loaderResponse.code,retry=retryCount<retryConfig.maxNumRetry&&(function retryForHttpStatus(httpStatus){return 0===httpStatus&&!1===navigator.onLine||!!httpStatus&&(httpStatus<400||httpStatus>499)}(httpStatus)||!!isTimeout);return retryConfig.shouldRetry?retryConfig.shouldRetry(retryConfig,retryCount,isTimeout,loaderResponse,retry):retry}const BinarySearch_search=function(list,comparisonFn){let minIndex=0,maxIndex=list.length-1,currentIndex=null,currentElement=null;for(;minIndex<=maxIndex;){currentIndex=(minIndex+maxIndex)/2|0,currentElement=list[currentIndex];const comparisonResult=comparisonFn(currentElement);if(comparisonResult>0)minIndex=currentIndex+1;else{if(!(comparisonResult<0))return currentElement;maxIndex=currentIndex-1}}return null};function findFragmentByPTS(fragPrevious,fragments,bufferEnd=0,maxFragLookUpTolerance=0,nextFragLookupTolerance=.005){let fragNext=null;if(fragPrevious){fragNext=fragments[fragPrevious.sn-fragments[0].sn+1]||null;const bufferEdgeError=fragPrevious.endDTS-bufferEnd;bufferEdgeError>0&&bufferEdgeError<15e-7&&(bufferEnd+=15e-7)}else 0===bufferEnd&&0===fragments[0].start&&(fragNext=fragments[0]);if(fragNext&&((!fragPrevious||fragPrevious.level===fragNext.level)&&0===fragmentWithinToleranceTest(bufferEnd,maxFragLookUpTolerance,fragNext)||function fragmentWithinFastStartSwitch(fragNext,fragPrevious,nextFragLookupTolerance){if(fragPrevious&&0===fragPrevious.start&&fragPrevious.level<fragNext.level&&(fragPrevious.endPTS||0)>0){const firstDuration=fragPrevious.tagList.reduce(((duration,tag)=>("INF"===tag[0]&&(duration+=parseFloat(tag[1])),duration)),nextFragLookupTolerance);return fragNext.start<=firstDuration}return!1}(fragNext,fragPrevious,Math.min(nextFragLookupTolerance,maxFragLookUpTolerance))))return fragNext;const foundFragment=BinarySearch_search(fragments,fragmentWithinToleranceTest.bind(null,bufferEnd,maxFragLookUpTolerance));return!foundFragment||foundFragment===fragPrevious&&fragNext?fragNext:foundFragment}function fragmentWithinToleranceTest(bufferEnd=0,maxFragLookUpTolerance=0,candidate){if(candidate.start<=bufferEnd&&candidate.start+candidate.duration>bufferEnd)return 0;const candidateLookupTolerance=Math.min(maxFragLookUpTolerance,candidate.duration+(candidate.deltaPTS?candidate.deltaPTS:0));return candidate.start+candidate.duration-candidateLookupTolerance<=bufferEnd?1:candidate.start-candidateLookupTolerance>bufferEnd&&candidate.start?-1:0}function pdtWithinToleranceTest(pdtBufferEnd,maxFragLookUpTolerance,candidate){const candidateLookupTolerance=1e3*Math.min(maxFragLookUpTolerance,candidate.duration+(candidate.deltaPTS?candidate.deltaPTS:0));return(candidate.endProgramDateTime||0)-candidateLookupTolerance>pdtBufferEnd}var NetworkErrorAction_DoNothing=0,NetworkErrorAction_SendAlternateToPenaltyBox=2,NetworkErrorAction_RemoveAlternatePermanently=3,NetworkErrorAction_RetryRequest=5,ErrorActionFlags_None=0,ErrorActionFlags_MoveAllAlternatesMatchingHost=1,ErrorActionFlags_MoveAllAlternatesMatchingHDCP=2;class BasePlaylistController{constructor(hls,logPrefix){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=logger.log.bind(logger,`${logPrefix}:`),this.warn=logger.warn.bind(logger,`${logPrefix}:`),this.hls=hls}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(playlistUri,previous,current){const renditionReports=null==previous?void 0:previous.renditionReports;if(renditionReports){let foundIndex=-1;for(let i=0;i<renditionReports.length;i++){const attr=renditionReports[i];let uri;try{uri=new self.URL(attr.URI,previous.url).href}catch(error){logger.warn(`Could not construct new URL for Rendition Report: ${error}`),uri=attr.URI||""}if(uri===playlistUri){foundIndex=i;break}uri===playlistUri.substring(0,uri.length)&&(foundIndex=i)}if(-1!==foundIndex){const attr=renditionReports[foundIndex],msn=parseInt(attr["LAST-MSN"])||(null==previous?void 0:previous.lastPartSn);let part=parseInt(attr["LAST-PART"])||(null==previous?void 0:previous.lastPartIndex);if(this.hls.config.lowLatencyMode){const currentGoal=Math.min(previous.age-previous.partTarget,previous.targetduration);part>=0&&currentGoal>previous.partTarget&&(part+=1)}const skip=current&&getSkipValue(current);return new HlsUrlParameters(msn,part>=0?part:void 0,skip)}}}loadPlaylist(hlsUrlParameters){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(playlist){return this.canLoad&&!!playlist&&!!playlist.url&&(!playlist.details||playlist.details.live)}shouldReloadPlaylist(playlist){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(playlist)}playlistLoaded(index,data,previousDetails){const{details,stats}=data,now=self.performance.now(),elapsed=stats.loading.first?Math.max(0,now-stats.loading.first):0;if(details.advancedDateTime=Date.now()-elapsed,details.live||null!=previousDetails&&previousDetails.live){if(details.reloaded(previousDetails),previousDetails&&this.log(`live playlist ${index} ${details.advanced?"REFRESHED "+details.lastPartSn+"-"+details.lastPartIndex:details.updated?"UPDATED":"MISSED"}`),previousDetails&&details.fragments.length>0&&mergeDetails(previousDetails,details),!this.canLoad||!details.live)return;let deliveryDirectives,msn,part;if(details.canBlockReload&&details.endSN&&details.advanced){const lowLatencyMode=this.hls.config.lowLatencyMode,lastPartSn=details.lastPartSn,endSn=details.endSN,lastPartIndex=details.lastPartIndex,lastPart=lastPartSn===endSn;-1!==lastPartIndex?(msn=lastPart?endSn+1:lastPartSn,part=lastPart?lowLatencyMode?0:lastPartIndex:lastPartIndex+1):msn=endSn+1;const lastAdvanced=details.age,cdnAge=lastAdvanced+details.ageHeader;let currentGoal=Math.min(cdnAge-details.partTarget,1.5*details.targetduration);if(currentGoal>0){if(previousDetails&&currentGoal>previousDetails.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${previousDetails.tuneInGoal} to: ${currentGoal} with playlist age: ${details.age}`),currentGoal=0;else{const segments=Math.floor(currentGoal/details.targetduration);if(msn+=segments,void 0!==part){part+=Math.round(currentGoal%details.targetduration/details.partTarget)}this.log(`CDN Tune-in age: ${details.ageHeader}s last advanced ${lastAdvanced.toFixed(2)}s goal: ${currentGoal} skip sn ${segments} to part ${part}`)}details.tuneInGoal=currentGoal}if(deliveryDirectives=this.getDeliveryDirectives(details,data.deliveryDirectives,msn,part),lowLatencyMode||!lastPart)return void this.loadPlaylist(deliveryDirectives)}else(details.canBlockReload||details.canSkipUntil)&&(deliveryDirectives=this.getDeliveryDirectives(details,data.deliveryDirectives,msn,part));const bufferInfo=this.hls.mainForwardBufferInfo,position=bufferInfo?bufferInfo.end-bufferInfo.len:0,reloadInterval=function computeReloadInterval(newDetails,distanceToLiveEdgeMs=1/0){let reloadInterval=1e3*newDetails.targetduration;if(newDetails.updated){const fragments=newDetails.fragments,liveEdgeMaxTargetDurations=4;if(fragments.length&&reloadInterval*liveEdgeMaxTargetDurations>distanceToLiveEdgeMs){const lastSegmentDuration=1e3*fragments[fragments.length-1].duration;lastSegmentDuration<reloadInterval&&(reloadInterval=lastSegmentDuration)}}else reloadInterval/=2;return Math.round(reloadInterval)}(details,1e3*(details.edge-position));details.updated&&now>this.requestScheduled+reloadInterval&&(this.requestScheduled=stats.loading.start),void 0!==msn&&details.canBlockReload?this.requestScheduled=stats.loading.first+reloadInterval-(1e3*details.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+reloadInterval<now?this.requestScheduled=now:this.requestScheduled-now<=0&&(this.requestScheduled+=reloadInterval);let estimatedTimeUntilUpdate=this.requestScheduled-now;estimatedTimeUntilUpdate=Math.max(0,estimatedTimeUntilUpdate),this.log(`reload live playlist ${index} in ${Math.round(estimatedTimeUntilUpdate)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(deliveryDirectives)),estimatedTimeUntilUpdate)}else this.clearTimer()}getDeliveryDirectives(details,previousDeliveryDirectives,msn,part){let skip=getSkipValue(details);return null!=previousDeliveryDirectives&&previousDeliveryDirectives.skip&&details.deltaUpdateFailed&&(msn=previousDeliveryDirectives.msn,part=previousDeliveryDirectives.part,skip=HlsSkip_No),new HlsUrlParameters(msn,part,skip)}checkRetry(errorEvent){const errorDetails=errorEvent.details,isTimeout=isTimeoutError(errorEvent),errorAction=errorEvent.errorAction,{action,retryCount=0,retryConfig}=errorAction||{},retry=!!errorAction&&!!retryConfig&&(action===NetworkErrorAction_RetryRequest||!errorAction.resolved&&action===NetworkErrorAction_SendAlternateToPenaltyBox);if(retry){var _errorEvent$context;if(this.requestScheduled=-1,retryCount>=retryConfig.maxNumRetry)return!1;if(isTimeout&&null!=(_errorEvent$context=errorEvent.context)&&_errorEvent$context.deliveryDirectives)this.warn(`Retrying playlist loading ${retryCount+1}/${retryConfig.maxNumRetry} after "${errorDetails}" without delivery-directives`),this.loadPlaylist();else{const delay=getRetryDelay(retryConfig,retryCount);this.timer=self.setTimeout((()=>this.loadPlaylist()),delay),this.warn(`Retrying playlist loading ${retryCount+1}/${retryConfig.maxNumRetry} after "${errorDetails}" in ${delay}ms`)}errorEvent.levelRetry=!0,errorAction.resolved=!0}return retry}}class EWMA{constructor(halfLife,estimate=0,weight=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=halfLife,this.alpha_=halfLife?Math.exp(Math.log(.5)/halfLife):0,this.estimate_=estimate,this.totalWeight_=weight}sample(weight,value){const adjAlpha=Math.pow(this.alpha_,weight);this.estimate_=value*(1-adjAlpha)+adjAlpha*this.estimate_,this.totalWeight_+=weight}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const zeroFactor=1-Math.pow(this.alpha_,this.totalWeight_);if(zeroFactor)return this.estimate_/zeroFactor}return this.estimate_}}class EwmaBandWidthEstimator{constructor(slow,fast,defaultEstimate,defaultTTFB=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=defaultEstimate,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(slow),this.fast_=new EWMA(fast),this.defaultTTFB_=defaultTTFB,this.ttfb_=new EWMA(slow)}update(slow,fast){const{slow_,fast_,ttfb_}=this;slow_.halfLife!==slow&&(this.slow_=new EWMA(slow,slow_.getEstimate(),slow_.getTotalWeight())),fast_.halfLife!==fast&&(this.fast_=new EWMA(fast,fast_.getEstimate(),fast_.getTotalWeight())),ttfb_.halfLife!==slow&&(this.ttfb_=new EWMA(slow,ttfb_.getEstimate(),ttfb_.getTotalWeight()))}sample(durationMs,numBytes){const durationS=(durationMs=Math.max(durationMs,this.minDelayMs_))/1e3,bandwidthInBps=8*numBytes/durationS;this.fast_.sample(durationS,bandwidthInBps),this.slow_.sample(durationS,bandwidthInBps)}sampleTTFB(ttfb){const seconds=ttfb/1e3,weight=Math.sqrt(2)*Math.exp(-Math.pow(seconds,2)/2);this.ttfb_.sample(weight,Math.max(ttfb,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const SUPPORTED_INFO_DEFAULT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},SUPPORTED_INFO_CACHE={};function requiresMediaCapabilitiesDecodingInfo(level,audioTracksByGroup,currentVideoRange,currentFrameRate,currentBw,audioPreference){const audioGroups=level.audioCodec?level.audioGroups:null,audioCodecPreference=null==audioPreference?void 0:audioPreference.audioCodec,channelsPreference=null==audioPreference?void 0:audioPreference.channels,maxChannels=channelsPreference?parseInt(channelsPreference):audioCodecPreference?1/0:2;let audioChannels=null;if(null!=audioGroups&&audioGroups.length)try{audioChannels=1===audioGroups.length&&audioGroups[0]?audioTracksByGroup.groups[audioGroups[0]].channels:audioGroups.reduce(((acc,groupId)=>{if(groupId){const audioTrackGroup=audioTracksByGroup.groups[groupId];if(!audioTrackGroup)throw new Error(`Audio track group ${groupId} not found`);Object.keys(audioTrackGroup.channels).forEach((key=>{acc[key]=(acc[key]||0)+audioTrackGroup.channels[key]}))}return acc}),{2:0})}catch(error){return!0}return void 0!==level.videoCodec&&(level.width>1920&&level.height>1088||level.height>1920&&level.width>1088||level.frameRate>Math.max(currentFrameRate,30)||"SDR"!==level.videoRange&&level.videoRange!==currentVideoRange||level.bitrate>Math.max(currentBw,8e6))||!!audioChannels&&isFiniteNumber(maxChannels)&&Object.keys(audioChannels).some((channels=>parseInt(channels)>maxChannels))}function getMediaDecodingInfoPromise(level,audioTracksByGroup,mediaCapabilities){const videoCodecs=level.videoCodec,audioCodecs=level.audioCodec;if(!videoCodecs||!audioCodecs||!mediaCapabilities)return Promise.resolve(SUPPORTED_INFO_DEFAULT);const baseVideoConfiguration={width:level.width,height:level.height,bitrate:Math.ceil(Math.max(.9*level.bitrate,level.averageBitrate)),framerate:level.frameRate||30},videoRange=level.videoRange;"SDR"!==videoRange&&(baseVideoConfiguration.transferFunction=videoRange.toLowerCase());const configurations=videoCodecs.split(",").map((videoCodec=>({type:"media-source",video:_objectSpread2(_objectSpread2({},baseVideoConfiguration),{},{contentType:mimeTypeForCodec(videoCodec,"video")})})));return audioCodecs&&level.audioGroups&&level.audioGroups.forEach((audioGroupId=>{var _audioTracksByGroup$g;audioGroupId&&(null==(_audioTracksByGroup$g=audioTracksByGroup.groups[audioGroupId])||_audioTracksByGroup$g.tracks.forEach((audioTrack=>{if(audioTrack.groupId===audioGroupId){const channels=audioTrack.channels||"",channelsNumber=parseFloat(channels);isFiniteNumber(channelsNumber)&&channelsNumber>2&&configurations.push.apply(configurations,audioCodecs.split(",").map((audioCodec=>({type:"media-source",audio:{contentType:mimeTypeForCodec(audioCodec,"audio"),channels:""+channelsNumber}}))))}})))})),Promise.all(configurations.map((configuration=>{const decodingInfoKey=function getMediaDecodingInfoKey(config){const{audio,video}=config,mediaConfig=video||audio;if(mediaConfig){const codec=mediaConfig.contentType.split('"')[1];if(video)return`r${video.height}x${video.width}f${Math.ceil(video.framerate)}${video.transferFunction||"sd"}_${codec}_${Math.ceil(video.bitrate/1e5)}`;if(audio)return`c${audio.channels}${audio.spatialRendering?"s":"n"}_${codec}`}return""}(configuration);return SUPPORTED_INFO_CACHE[decodingInfoKey]||(SUPPORTED_INFO_CACHE[decodingInfoKey]=mediaCapabilities.decodingInfo(configuration))}))).then((decodingInfoResults=>({supported:!decodingInfoResults.some((info=>!info.supported)),configurations,decodingInfoResults}))).catch((error=>({supported:!1,configurations,decodingInfoResults:[],error})))}function getVideoSelectionOptions(currentVideoRange,videoPreference){let preferHDR=!1,allowedVideoRanges=[];return currentVideoRange&&(preferHDR="SDR"!==currentVideoRange,allowedVideoRanges=[currentVideoRange]),videoPreference&&(allowedVideoRanges=videoPreference.allowedVideoRanges||VideoRangeValues.slice(0),preferHDR=void 0!==videoPreference.preferHDR?videoPreference.preferHDR:function isHdrSupported(){if("function"==typeof matchMedia){const mediaQueryList=matchMedia("(dynamic-range: high)"),badQuery=matchMedia("bad query");if(mediaQueryList.media!==badQuery.media)return!0===mediaQueryList.matches}return!1}(),allowedVideoRanges=preferHDR?allowedVideoRanges.filter((range=>"SDR"!==range)):["SDR"]),{preferHDR,allowedVideoRanges}}function logStartCodecCandidateIgnored(codeSet,reason){logger.log(`[abr] start candidates with "${codeSet}" ignored because ${reason}`)}function findMatchingOption(option,tracks,matchPredicate){if("attrs"in option){const index=tracks.indexOf(option);if(-1!==index)return index}for(let i=0;i<tracks.length;i++){if(matchesOption(option,tracks[i],matchPredicate))return i}return-1}function matchesOption(option,track,matchPredicate){const{groupId,name,lang,assocLang,characteristics,default:isDefault}=option,forced=option.forced;return(void 0===groupId||track.groupId===groupId)&&(void 0===name||track.name===name)&&(void 0===lang||track.lang===lang)&&(void 0===lang||track.assocLang===assocLang)&&(void 0===isDefault||track.default===isDefault)&&(void 0===forced||track.forced===forced)&&(void 0===characteristics||function characteristicsMatch(characteristicsA,characteristicsB=""){const arrA=characteristicsA.split(","),arrB=characteristicsB.split(",");return arrA.length===arrB.length&&!arrA.some((el=>-1===arrB.indexOf(el)))}(characteristics,track.characteristics))&&(void 0===matchPredicate||matchPredicate(option,track))}function audioMatchPredicate(option,track){const{audioCodec,channels}=option;return!(void 0!==audioCodec&&(track.audioCodec||"").substring(0,4)!==audioCodec.substring(0,4)||void 0!==channels&&channels!==(track.channels||"2"))}function searchDownAndUpList(arr,searchIndex,predicate){for(let i=searchIndex;i;i--)if(predicate(arr[i]))return i;for(let i=searchIndex+1;i<arr.length;i++)if(predicate(arr[i]))return i;return-1}class TaskLoop{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(millis){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,millis),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var FragmentState_NOT_LOADED="NOT_LOADED",FragmentState_APPENDING="APPENDING",FragmentState_PARTIAL="PARTIAL",FragmentState_OK="OK";class FragmentTracker{constructor(hls){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=hls,this._registerListeners()}_registerListeners(){const{hls}=this;hls.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.on(Events.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.off(Events.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(position,levelType){const activeParts=this.activePartLists[levelType];if(activeParts)for(let i=activeParts.length;i--;){const activePart=activeParts[i];if(!activePart)break;const appendedPTS=activePart.end;if(activePart.start<=position&&null!==appendedPTS&&position<=appendedPTS)return activePart}return this.getBufferedFrag(position,levelType)}getBufferedFrag(position,levelType){const{fragments}=this,keys=Object.keys(fragments);for(let i=keys.length;i--;){const fragmentEntity=fragments[keys[i]];if((null==fragmentEntity?void 0:fragmentEntity.body.type)===levelType&&fragmentEntity.buffered){const frag=fragmentEntity.body;if(frag.start<=position&&position<=frag.end)return frag}}return null}detectEvictedFragments(elementaryStream,timeRange,playlistType,appendedPart){this.timeRanges&&(this.timeRanges[elementaryStream]=timeRange);const appendedPartSn=(null==appendedPart?void 0:appendedPart.fragment.sn)||-1;Object.keys(this.fragments).forEach((key=>{const fragmentEntity=this.fragments[key];if(!fragmentEntity)return;if(appendedPartSn>=fragmentEntity.body.sn)return;if(!fragmentEntity.buffered&&!fragmentEntity.loaded)return void(fragmentEntity.body.type===playlistType&&this.removeFragment(fragmentEntity.body));const esData=fragmentEntity.range[elementaryStream];esData&&esData.time.some((time=>{const isNotBuffered=!this.isTimeBuffered(time.startPTS,time.endPTS,timeRange);return isNotBuffered&&this.removeFragment(fragmentEntity.body),isNotBuffered}))}))}detectPartialFragments(data){const timeRanges=this.timeRanges,{frag,part}=data;if(!timeRanges||"initSegment"===frag.sn)return;const fragKey=getFragmentKey(frag),fragmentEntity=this.fragments[fragKey];if(!fragmentEntity||fragmentEntity.buffered&&frag.gap)return;const isFragHint=!frag.relurl;if(Object.keys(timeRanges).forEach((elementaryStream=>{const streamInfo=frag.elementaryStreams[elementaryStream];if(!streamInfo)return;const timeRange=timeRanges[elementaryStream],partial=isFragHint||!0===streamInfo.partial;fragmentEntity.range[elementaryStream]=this.getBufferedTimes(frag,part,partial,timeRange)})),fragmentEntity.loaded=null,Object.keys(fragmentEntity.range).length){fragmentEntity.buffered=!0;(fragmentEntity.body.endList=frag.endList||fragmentEntity.body.endList)&&(this.endListFragments[fragmentEntity.body.type]=fragmentEntity),isPartial(fragmentEntity)||this.removeParts(frag.sn-1,frag.type)}else this.removeFragment(fragmentEntity.body)}removeParts(snToKeep,levelType){const activeParts=this.activePartLists[levelType];activeParts&&(this.activePartLists[levelType]=activeParts.filter((part=>part.fragment.sn>=snToKeep)))}fragBuffered(frag,force){const fragKey=getFragmentKey(frag);let fragmentEntity=this.fragments[fragKey];!fragmentEntity&&force&&(fragmentEntity=this.fragments[fragKey]={body:frag,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},frag.gap&&(this.hasGaps=!0)),fragmentEntity&&(fragmentEntity.loaded=null,fragmentEntity.buffered=!0)}getBufferedTimes(fragment,part,partial,timeRange){const buffered={time:[],partial},startPTS=fragment.start,endPTS=fragment.end,minEndPTS=fragment.minEndPTS||endPTS,maxStartPTS=fragment.maxStartPTS||startPTS;for(let i=0;i<timeRange.length;i++){const startTime=timeRange.start(i)-this.bufferPadding,endTime=timeRange.end(i)+this.bufferPadding;if(maxStartPTS>=startTime&&minEndPTS<=endTime){buffered.time.push({startPTS:Math.max(startPTS,timeRange.start(i)),endPTS:Math.min(endPTS,timeRange.end(i))});break}if(startPTS<endTime&&endPTS>startTime){const start=Math.max(startPTS,timeRange.start(i)),end=Math.min(endPTS,timeRange.end(i));end>start&&(buffered.partial=!0,buffered.time.push({startPTS:start,endPTS:end}))}else if(endPTS<=startTime)break}return buffered}getPartialFragment(time){let timePadding,startTime,endTime,bestFragment=null,bestOverlap=0;const{bufferPadding,fragments}=this;return Object.keys(fragments).forEach((key=>{const fragmentEntity=fragments[key];fragmentEntity&&isPartial(fragmentEntity)&&(startTime=fragmentEntity.body.start-bufferPadding,endTime=fragmentEntity.body.end+bufferPadding,time>=startTime&&time<=endTime&&(timePadding=Math.min(time-startTime,endTime-time),bestOverlap<=timePadding&&(bestFragment=fragmentEntity.body,bestOverlap=timePadding)))})),bestFragment}isEndListAppended(type){const lastFragmentEntity=this.endListFragments[type];return void 0!==lastFragmentEntity&&(lastFragmentEntity.buffered||isPartial(lastFragmentEntity))}getState(fragment){const fragKey=getFragmentKey(fragment),fragmentEntity=this.fragments[fragKey];return fragmentEntity?fragmentEntity.buffered?isPartial(fragmentEntity)?FragmentState_PARTIAL:FragmentState_OK:FragmentState_APPENDING:FragmentState_NOT_LOADED}isTimeBuffered(startPTS,endPTS,timeRange){let startTime,endTime;for(let i=0;i<timeRange.length;i++){if(startTime=timeRange.start(i)-this.bufferPadding,endTime=timeRange.end(i)+this.bufferPadding,startPTS>=startTime&&endPTS<=endTime)return!0;if(endPTS<=startTime)return!1}return!1}onFragLoaded(event,data){const{frag,part}=data;if("initSegment"===frag.sn||frag.bitrateTest)return;const loaded=part?null:data,fragKey=getFragmentKey(frag);this.fragments[fragKey]={body:frag,appendedPTS:null,loaded,buffered:!1,range:Object.create(null)}}onBufferAppended(event,data){const{frag,part,timeRanges}=data;if("initSegment"===frag.sn)return;const playlistType=frag.type;if(part){let activeParts=this.activePartLists[playlistType];activeParts||(this.activePartLists[playlistType]=activeParts=[]),activeParts.push(part)}this.timeRanges=timeRanges,Object.keys(timeRanges).forEach((elementaryStream=>{const timeRange=timeRanges[elementaryStream];this.detectEvictedFragments(elementaryStream,timeRange,playlistType,part)}))}onFragBuffered(event,data){this.detectPartialFragments(data)}hasFragment(fragment){const fragKey=getFragmentKey(fragment);return!!this.fragments[fragKey]}hasParts(type){var _this$activePartLists;return!(null==(_this$activePartLists=this.activePartLists[type])||!_this$activePartLists.length)}removeFragmentsInRange(start,end,playlistType,withGapOnly,unbufferedOnly){withGapOnly&&!this.hasGaps||Object.keys(this.fragments).forEach((key=>{const fragmentEntity=this.fragments[key];if(!fragmentEntity)return;const frag=fragmentEntity.body;frag.type!==playlistType||withGapOnly&&!frag.gap||frag.start<end&&frag.end>start&&(fragmentEntity.buffered||unbufferedOnly)&&this.removeFragment(frag)}))}removeFragment(fragment){const fragKey=getFragmentKey(fragment);fragment.stats.loaded=0,fragment.clearElementaryStreamInfo();const activeParts=this.activePartLists[fragment.type];if(activeParts){const snToRemove=fragment.sn;this.activePartLists[fragment.type]=activeParts.filter((part=>part.fragment.sn!==snToRemove))}delete this.fragments[fragKey],fragment.endList&&delete this.endListFragments[fragment.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function isPartial(fragmentEntity){var _fragmentEntity$range,_fragmentEntity$range2,_fragmentEntity$range3;return fragmentEntity.buffered&&(fragmentEntity.body.gap||(null==(_fragmentEntity$range=fragmentEntity.range.video)?void 0:_fragmentEntity$range.partial)||(null==(_fragmentEntity$range2=fragmentEntity.range.audio)?void 0:_fragmentEntity$range2.partial)||(null==(_fragmentEntity$range3=fragmentEntity.range.audiovideo)?void 0:_fragmentEntity$range3.partial))}function getFragmentKey(fragment){return`${fragment.type}_${fragment.level}_${fragment.sn}`}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(media,position){try{if(media){const buffered=BufferHelper.getBuffered(media);for(let i=0;i<buffered.length;i++)if(position>=buffered.start(i)&&position<=buffered.end(i))return!0}}catch(error){}return!1}static bufferInfo(media,pos,maxHoleDuration){try{if(media){const vbuffered=BufferHelper.getBuffered(media),buffered=[];let i;for(i=0;i<vbuffered.length;i++)buffered.push({start:vbuffered.start(i),end:vbuffered.end(i)});return this.bufferedInfo(buffered,pos,maxHoleDuration)}}catch(error){}return{len:0,start:pos,end:pos,nextStart:void 0}}static bufferedInfo(buffered,pos,maxHoleDuration){pos=Math.max(0,pos),buffered.sort((function(a,b){const diff=a.start-b.start;return diff||b.end-a.end}));let buffered2=[];if(maxHoleDuration)for(let i=0;i<buffered.length;i++){const buf2len=buffered2.length;if(buf2len){const buf2end=buffered2[buf2len-1].end;buffered[i].start-buf2end<maxHoleDuration?buffered[i].end>buf2end&&(buffered2[buf2len-1].end=buffered[i].end):buffered2.push(buffered[i])}else buffered2.push(buffered[i])}else buffered2=buffered;let bufferStartNext,bufferLen=0,bufferStart=pos,bufferEnd=pos;for(let i=0;i<buffered2.length;i++){const start=buffered2[i].start,end=buffered2[i].end;if(pos+maxHoleDuration>=start&&pos<end)bufferStart=start,bufferEnd=end,bufferLen=bufferEnd-pos;else if(pos+maxHoleDuration<start){bufferStartNext=start;break}}return{len:bufferLen,start:bufferStart||0,end:bufferEnd||0,nextStart:bufferStartNext}}static getBuffered(media){try{return media.buffered}catch(e){return logger.log("failed to get media.buffered",e),noopBuffered}}}class ChunkMetadata{constructor(level,sn,id,size=0,part=-1,partial=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=level,this.sn=sn,this.id=id,this.size=size,this.part=part,this.partial=partial}}function findFirstFragWithCC(fragments,cc){for(let i=0,len=fragments.length;i<len;i++){var _fragments$i;if((null==(_fragments$i=fragments[i])?void 0:_fragments$i.cc)===cc)return fragments[i]}return null}function adjustFragmentStart(frag,sliding){if(frag){const start=frag.start+sliding;frag.start=frag.startPTS=start,frag.endPTS=start+frag.duration}}function adjustSlidingStart(sliding,details){const fragments=details.fragments;for(let i=0,len=fragments.length;i<len;i++)adjustFragmentStart(fragments[i],sliding);details.fragmentHint&&adjustFragmentStart(details.fragmentHint,sliding),details.alignedSliding=!0}function alignStream(lastFrag,switchDetails,details){switchDetails&&(!function alignDiscontinuities(lastFrag,details,switchDetails){if(function shouldAlignOnDiscontinuities(lastFrag,switchDetails,details){return!(!switchDetails||!(details.endCC>details.startCC||lastFrag&&lastFrag.cc<details.startCC))}(lastFrag,switchDetails,details)){const referenceFrag=function findDiscontinuousReferenceFrag(prevDetails,curDetails){const prevFrags=prevDetails.fragments,curFrags=curDetails.fragments;if(!curFrags.length||!prevFrags.length)return void logger.log("No fragments to align");const prevStartFrag=findFirstFragWithCC(prevFrags,curFrags[0].cc);if(prevStartFrag&&(!prevStartFrag||prevStartFrag.startPTS))return prevStartFrag;logger.log("No frag in previous level to align on")}(switchDetails,details);referenceFrag&&isFiniteNumber(referenceFrag.start)&&(logger.log(`Adjusting PTS using last level due to CC increase within current level ${details.url}`),adjustSlidingStart(referenceFrag.start,details))}}(lastFrag,details,switchDetails),!details.alignedSliding&&switchDetails&&alignMediaPlaylistByPDT(details,switchDetails),details.alignedSliding||!switchDetails||details.skippedSegments||adjustSliding(switchDetails,details))}function alignMediaPlaylistByPDT(details,refDetails){if(!details.hasProgramDateTime||!refDetails.hasProgramDateTime)return;const fragments=details.fragments,refFragments=refDetails.fragments;if(!fragments.length||!refFragments.length)return;let refFrag,frag;const targetCC=Math.min(refDetails.endCC,details.endCC);refDetails.startCC<targetCC&&details.startCC<targetCC&&(refFrag=findFirstFragWithCC(refFragments,targetCC),frag=findFirstFragWithCC(fragments,targetCC)),refFrag&&frag||(refFrag=refFragments[Math.floor(refFragments.length/2)],frag=findFirstFragWithCC(fragments,refFrag.cc)||fragments[Math.floor(fragments.length/2)]);const refPDT=refFrag.programDateTime,targetPDT=frag.programDateTime;if(!refPDT||!targetPDT)return;adjustSlidingStart((targetPDT-refPDT)/1e3-(frag.start-refFrag.start),details)}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(config){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=config}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(frag,onProgress){const url=frag.url;if(!url)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag,error:new Error("Fragment does not have a "+(url?"part list":"url")),networkDetails:null}));this.abort();const config=this.config,FragmentILoader=config.fLoader,DefaultILoader=config.loader;return new Promise(((resolve,reject)=>{if(this.loader&&this.loader.destroy(),frag.gap){if(frag.tagList.some((tags=>"GAP"===tags[0])))return void reject(createGapLoadError(frag));frag.gap=!1}const loader=this.loader=frag.loader=FragmentILoader?new FragmentILoader(config):new DefaultILoader(config),loaderContext=createLoaderContext(frag),loadPolicy=getLoaderConfigWithoutReties(config.fragLoadPolicy.default),loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===frag.sn?1/0:MIN_CHUNK_SIZE};frag.stats=loader.stats,loader.load(loaderContext,loaderConfig,{onSuccess:(response,stats,context,networkDetails)=>{this.resetLoader(frag,loader);let payload=response.data;context.resetIV&&frag.decryptdata&&(frag.decryptdata.iv=new Uint8Array(payload.slice(0,16)),payload=payload.slice(16)),resolve({frag,part:null,payload,networkDetails})},onError:(response,context,networkDetails,stats)=>{this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag,response:_objectSpread2({url,data:void 0},response),error:new Error(`HTTP Error ${response.code} ${response.text}`),networkDetails,stats}))},onAbort:(stats,context,networkDetails)=>{this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag,error:new Error("Aborted"),networkDetails,stats}))},onTimeout:(stats,context,networkDetails)=>{this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag,error:new Error(`Timeout after ${loaderConfig.timeout}ms`),networkDetails,stats}))},onProgress:(stats,context,data,networkDetails)=>{onProgress&&onProgress({frag,part:null,payload:data,networkDetails})}})}))}loadPart(frag,part,onProgress){this.abort();const config=this.config,FragmentILoader=config.fLoader,DefaultILoader=config.loader;return new Promise(((resolve,reject)=>{if(this.loader&&this.loader.destroy(),frag.gap||part.gap)return void reject(createGapLoadError(frag,part));const loader=this.loader=frag.loader=FragmentILoader?new FragmentILoader(config):new DefaultILoader(config),loaderContext=createLoaderContext(frag,part),loadPolicy=getLoaderConfigWithoutReties(config.fragLoadPolicy.default),loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};part.stats=loader.stats,loader.load(loaderContext,loaderConfig,{onSuccess:(response,stats,context,networkDetails)=>{this.resetLoader(frag,loader),this.updateStatsFromPart(frag,part);const partLoadedData={frag,part,payload:response.data,networkDetails};onProgress(partLoadedData),resolve(partLoadedData)},onError:(response,context,networkDetails,stats)=>{this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag,part,response:_objectSpread2({url:loaderContext.url,data:void 0},response),error:new Error(`HTTP Error ${response.code} ${response.text}`),networkDetails,stats}))},onAbort:(stats,context,networkDetails)=>{frag.stats.aborted=part.stats.aborted,this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag,part,error:new Error("Aborted"),networkDetails,stats}))},onTimeout:(stats,context,networkDetails)=>{this.resetLoader(frag,loader),reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag,part,error:new Error(`Timeout after ${loaderConfig.timeout}ms`),networkDetails,stats}))}})}))}updateStatsFromPart(frag,part){const fragStats=frag.stats,partStats=part.stats,partTotal=partStats.total;if(fragStats.loaded+=partStats.loaded,partTotal){const estTotalParts=Math.round(frag.duration/part.duration),estLoadedParts=Math.min(Math.round(fragStats.loaded/partTotal),estTotalParts),estRemainingBytes=(estTotalParts-estLoadedParts)*Math.round(fragStats.loaded/estLoadedParts);fragStats.total=fragStats.loaded+estRemainingBytes}else fragStats.total=Math.max(fragStats.loaded,fragStats.total);const fragLoading=fragStats.loading,partLoading=partStats.loading;fragLoading.start?fragLoading.first+=partLoading.first-partLoading.start:(fragLoading.start=partLoading.start,fragLoading.first=partLoading.first),fragLoading.end=partLoading.end}resetLoader(frag,loader){frag.loader=null,this.loader===loader&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),loader.destroy()}}function createLoaderContext(frag,part=null){const segment=part||frag,loaderContext={frag,part,responseType:"arraybuffer",url:segment.url,headers:{},rangeStart:0,rangeEnd:0},start=segment.byteRangeStartOffset,end=segment.byteRangeEndOffset;if(isFiniteNumber(start)&&isFiniteNumber(end)){var _frag$decryptdata;let byteRangeStart=start,byteRangeEnd=end;if("initSegment"===frag.sn&&"AES-128"===(null==(_frag$decryptdata=frag.decryptdata)?void 0:_frag$decryptdata.method)){const fragmentLen=end-start;fragmentLen%16&&(byteRangeEnd=end+(16-fragmentLen%16)),0!==start&&(loaderContext.resetIV=!0,byteRangeStart=start-16)}loaderContext.rangeStart=byteRangeStart,loaderContext.rangeEnd=byteRangeEnd}return loaderContext}function createGapLoadError(frag,part){const error=new Error(`GAP ${frag.gap?"tag":"attribute"} found`),errorData={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag,error,networkDetails:null};return part&&(errorData.part=part),(part||frag).stats.aborted=!0,new LoadError(errorData)}class LoadError extends Error{constructor(data){super(data.error.message),this.data=void 0,this.data=data}}class AESCrypto{constructor(subtle,iv){this.subtle=void 0,this.aesIV=void 0,this.subtle=subtle,this.aesIV=iv}decrypt(data,key){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},key,data)}}class FastAESKey{constructor(subtle,key){this.subtle=void 0,this.key=void 0,this.subtle=subtle,this.key=key}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(arrayBuffer){const view=new DataView(arrayBuffer),newArray=new Uint32Array(4);for(let i=0;i<4;i++)newArray[i]=view.getUint32(4*i);return newArray}initTable(){const sBox=this.sBox,invSBox=this.invSBox,subMix=this.subMix,subMix0=subMix[0],subMix1=subMix[1],subMix2=subMix[2],subMix3=subMix[3],invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3],d=new Uint32Array(256);let x=0,xi=0,i=0;for(i=0;i<256;i++)d[i]=i<128?i<<1:i<<1^283;for(i=0;i<256;i++){let sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sx=sx>>>8^255&sx^99,sBox[x]=sx,invSBox[sx]=x;const x2=d[x],x4=d[x2],x8=d[x4];let t=257*d[sx]^16843008*sx;subMix0[x]=t<<24|t>>>8,subMix1[x]=t<<16|t>>>16,subMix2[x]=t<<8|t>>>24,subMix3[x]=t,t=16843009*x8^65537*x4^257*x2^16843008*x,invSubMix0[sx]=t<<24|t>>>8,invSubMix1[sx]=t<<16|t>>>16,invSubMix2[sx]=t<<8|t>>>24,invSubMix3[sx]=t,x?(x=x2^d[d[d[x8^x2]]],xi^=d[d[xi]]):x=xi=1}}expandKey(keyBuffer){const key=this.uint8ArrayToUint32Array_(keyBuffer);let sameKey=!0,offset=0;for(;offset<key.length&&sameKey;)sameKey=key[offset]===this.key[offset],offset++;if(sameKey)return;this.key=key;const keySize=this.keySize=key.length;if(4!==keySize&&6!==keySize&&8!==keySize)throw new Error("Invalid aes key size="+keySize);const ksRows=this.ksRows=4*(keySize+6+1);let ksRow,invKsRow;const keySchedule=this.keySchedule=new Uint32Array(ksRows),invKeySchedule=this.invKeySchedule=new Uint32Array(ksRows),sbox=this.sBox,rcon=this.rcon,invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3];let prev,t;for(ksRow=0;ksRow<ksRows;ksRow++)ksRow<keySize?prev=keySchedule[ksRow]=key[ksRow]:(t=prev,ksRow%keySize==0?(t=t<<8|t>>>24,t=sbox[t>>>24]<<24|sbox[t>>>16&255]<<16|sbox[t>>>8&255]<<8|sbox[255&t],t^=rcon[ksRow/keySize|0]<<24):keySize>6&&ksRow%keySize==4&&(t=sbox[t>>>24]<<24|sbox[t>>>16&255]<<16|sbox[t>>>8&255]<<8|sbox[255&t]),keySchedule[ksRow]=prev=(keySchedule[ksRow-keySize]^t)>>>0);for(invKsRow=0;invKsRow<ksRows;invKsRow++)ksRow=ksRows-invKsRow,t=3&invKsRow?keySchedule[ksRow]:keySchedule[ksRow-4],invKeySchedule[invKsRow]=invKsRow<4||ksRow<=4?t:invSubMix0[sbox[t>>>24]]^invSubMix1[sbox[t>>>16&255]]^invSubMix2[sbox[t>>>8&255]]^invSubMix3[sbox[255&t]],invKeySchedule[invKsRow]=invKeySchedule[invKsRow]>>>0}networkToHostOrderSwap(word){return word<<24|(65280&word)<<8|(16711680&word)>>8|word>>>24}decrypt(inputArrayBuffer,offset,aesIV){const nRounds=this.keySize+6,invKeySchedule=this.invKeySchedule,invSBOX=this.invSBox,invSubMix=this.invSubMix,invSubMix0=invSubMix[0],invSubMix1=invSubMix[1],invSubMix2=invSubMix[2],invSubMix3=invSubMix[3],initVector=this.uint8ArrayToUint32Array_(aesIV);let initVector0=initVector[0],initVector1=initVector[1],initVector2=initVector[2],initVector3=initVector[3];const inputInt32=new Int32Array(inputArrayBuffer),outputInt32=new Int32Array(inputInt32.length);let t0,t1,t2,t3,s0,s1,s2,s3,inputWords0,inputWords1,inputWords2,inputWords3,ksRow,i;const swapWord=this.networkToHostOrderSwap;for(;offset<inputInt32.length;){for(inputWords0=swapWord(inputInt32[offset]),inputWords1=swapWord(inputInt32[offset+1]),inputWords2=swapWord(inputInt32[offset+2]),inputWords3=swapWord(inputInt32[offset+3]),s0=inputWords0^invKeySchedule[0],s1=inputWords3^invKeySchedule[1],s2=inputWords2^invKeySchedule[2],s3=inputWords1^invKeySchedule[3],ksRow=4,i=1;i<nRounds;i++)t0=invSubMix0[s0>>>24]^invSubMix1[s1>>16&255]^invSubMix2[s2>>8&255]^invSubMix3[255&s3]^invKeySchedule[ksRow],t1=invSubMix0[s1>>>24]^invSubMix1[s2>>16&255]^invSubMix2[s3>>8&255]^invSubMix3[255&s0]^invKeySchedule[ksRow+1],t2=invSubMix0[s2>>>24]^invSubMix1[s3>>16&255]^invSubMix2[s0>>8&255]^invSubMix3[255&s1]^invKeySchedule[ksRow+2],t3=invSubMix0[s3>>>24]^invSubMix1[s0>>16&255]^invSubMix2[s1>>8&255]^invSubMix3[255&s2]^invKeySchedule[ksRow+3],s0=t0,s1=t1,s2=t2,s3=t3,ksRow+=4;t0=invSBOX[s0>>>24]<<24^invSBOX[s1>>16&255]<<16^invSBOX[s2>>8&255]<<8^invSBOX[255&s3]^invKeySchedule[ksRow],t1=invSBOX[s1>>>24]<<24^invSBOX[s2>>16&255]<<16^invSBOX[s3>>8&255]<<8^invSBOX[255&s0]^invKeySchedule[ksRow+1],t2=invSBOX[s2>>>24]<<24^invSBOX[s3>>16&255]<<16^invSBOX[s0>>8&255]<<8^invSBOX[255&s1]^invKeySchedule[ksRow+2],t3=invSBOX[s3>>>24]<<24^invSBOX[s0>>16&255]<<16^invSBOX[s1>>8&255]<<8^invSBOX[255&s2]^invKeySchedule[ksRow+3],outputInt32[offset]=swapWord(t0^initVector0),outputInt32[offset+1]=swapWord(t3^initVector1),outputInt32[offset+2]=swapWord(t2^initVector2),outputInt32[offset+3]=swapWord(t1^initVector3),initVector0=inputWords0,initVector1=inputWords1,initVector2=inputWords2,initVector3=inputWords3,offset+=4}return outputInt32.buffer}}class Decrypter{constructor(config,{removePKCS7Padding=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=config.enableSoftwareAES,this.removePKCS7Padding=removePKCS7Padding,removePKCS7Padding)try{const browserCrypto=self.crypto;browserCrypto&&(this.subtle=browserCrypto.subtle||browserCrypto.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult,remainderData}=this;if(!currentResult||remainderData)return this.reset(),null;const data=new Uint8Array(currentResult);return this.reset(),this.removePKCS7Padding?function removePadding(array){const outputBytes=array.byteLength,paddingBytes=outputBytes&&new DataView(array.buffer).getUint8(outputBytes-1);return paddingBytes?sliceUint8(array,0,outputBytes-paddingBytes):array}(data):data}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(data,key,iv){return this.useSoftware?new Promise(((resolve,reject)=>{this.softwareDecrypt(new Uint8Array(data),key,iv);const decryptResult=this.flush();decryptResult?resolve(decryptResult.buffer):reject(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(data),key,iv)}softwareDecrypt(data,key,iv){const{currentIV,currentResult,remainderData}=this;this.logOnce("JS AES decrypt"),remainderData&&(data=appendUint8Array(remainderData,data),this.remainderData=null);const currentChunk=this.getValidChunk(data);if(!currentChunk.length)return null;currentIV&&(iv=currentIV);let softwareDecrypter=this.softwareDecrypter;softwareDecrypter||(softwareDecrypter=this.softwareDecrypter=new AESDecryptor),softwareDecrypter.expandKey(key);const result=currentResult;return this.currentResult=softwareDecrypter.decrypt(currentChunk.buffer,0,iv),this.currentIV=sliceUint8(currentChunk,-16).buffer,result||null}webCryptoDecrypt(data,key,iv){if(this.key!==key||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(data,key,iv));this.key=key,this.fastAesKey=new FastAESKey(this.subtle,key)}return this.fastAesKey.expandKey().then((aesKey=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new AESCrypto(this.subtle,new Uint8Array(iv)).decrypt(data.buffer,aesKey)})).catch((err=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${err.name}: ${err.message}`),this.onWebCryptoError(data,key,iv))))}onWebCryptoError(data,key,iv){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(data,key,iv);const decryptResult=this.flush();if(decryptResult)return decryptResult.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(data){let currentChunk=data;const splitPoint=data.length-data.length%16;return splitPoint!==data.length&&(currentChunk=sliceUint8(data,0,splitPoint),this.remainderData=sliceUint8(data,splitPoint)),currentChunk}logOnce(msg){this.logEnabled&&(logger.log(`[decrypter]: ${msg}`),this.logEnabled=!1)}}const TimeRanges_toString=function(r){let log="";const len=r.length;for(let i=0;i<len;i++)log+=`[${r.start(i).toFixed(3)}-${r.end(i).toFixed(3)}]`;return log},State_STOPPED="STOPPED",State_IDLE="IDLE",State_KEY_LOADING="KEY_LOADING",State_FRAG_LOADING="FRAG_LOADING",State_FRAG_LOADING_WAITING_RETRY="FRAG_LOADING_WAITING_RETRY",State_WAITING_TRACK="WAITING_TRACK",State_PARSING="PARSING",State_PARSED="PARSED",State_ENDED="ENDED",State_ERROR="ERROR",State_WAITING_INIT_PTS="WAITING_INIT_PTS",State_WAITING_LEVEL="WAITING_LEVEL";class BaseStreamController extends TaskLoop{constructor(hls,fragmentTracker,keyLoader,logPrefix,playlistType){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State_STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=playlistType,this.logPrefix=logPrefix,this.log=logger.log.bind(logger,`${logPrefix}:`),this.warn=logger.warn.bind(logger,`${logPrefix}:`),this.hls=hls,this.fragmentLoader=new FragmentLoader(hls.config),this.keyLoader=keyLoader,this.fragmentTracker=fragmentTracker,this.config=hls.config,this.decrypter=new Decrypter(hls.config),hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(startPosition){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const frag=this.fragCurrent;null!=frag&&frag.loader&&(frag.abortRequests(),this.fragmentTracker.removeFragment(frag)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State_STOPPED}_streamEnded(bufferInfo,levelDetails){if(levelDetails.live||bufferInfo.nextStart||!bufferInfo.end||!this.media)return!1;const partList=levelDetails.partList;if(null!=partList&&partList.length){const lastPart=partList[partList.length-1];return BufferHelper.isBuffered(this.media,lastPart.start+lastPart.duration/2)}const playlistType=levelDetails.fragments[levelDetails.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(playlistType)}getLevelDetails(){var _this$levelLastLoaded;if(this.levels&&null!==this.levelLastLoaded)return null==(_this$levelLastLoaded=this.levelLastLoaded)?void 0:_this$levelLastLoaded.details}onMediaAttached(event,data){const media=this.media=this.mediaBuffer=data.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),media.addEventListener("seeking",this.onvseeking),media.addEventListener("ended",this.onvended);const config=this.config;this.levels&&config.autoStartLoad&&this.state===State_STOPPED&&this.startLoad(config.startPosition)}onMediaDetaching(){const media=this.media;null!=media&&media.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),media&&this.onvseeking&&this.onvended&&(media.removeEventListener("seeking",this.onvseeking),media.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config,fragCurrent,media,mediaBuffer,state}=this,currentTime=media?media.currentTime:0,bufferInfo=BufferHelper.bufferInfo(mediaBuffer||media,currentTime,config.maxBufferHole);if(this.log(`media seeking to ${isFiniteNumber(currentTime)?currentTime.toFixed(3):currentTime}, state: ${state}`),this.state===State_ENDED)this.resetLoadingState();else if(fragCurrent){const tolerance=config.maxFragLookUpTolerance,fragStartOffset=fragCurrent.start-tolerance,fragEndOffset=fragCurrent.start+fragCurrent.duration+tolerance;if(!bufferInfo.len||fragEndOffset<bufferInfo.start||fragStartOffset>bufferInfo.end){const pastFragment=currentTime>fragEndOffset;(currentTime<fragStartOffset||pastFragment)&&(pastFragment&&fragCurrent.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),fragCurrent.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}media&&(this.fragmentTracker.removeFragmentsInRange(currentTime,1/0,this.playlistType,!0),this.lastCurrentTime=currentTime),this.loadedmetadata||bufferInfo.len||(this.nextLoadPosition=this.startPosition=currentTime),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(event,data){this.startTimeOffset=data.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=State_STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(frag,level,targetBufferTime){this._loadFragForPlayback(frag,level,targetBufferTime)}_loadFragForPlayback(frag,level,targetBufferTime){this._doFragLoad(frag,level,targetBufferTime,(data=>{if(this.fragContextChanged(frag))return this.warn(`Fragment ${frag.sn}${data.part?" p: "+data.part.index:""} of level ${frag.level} was dropped during download.`),void this.fragmentTracker.removeFragment(frag);frag.stats.chunkCount++,this._handleFragmentLoadProgress(data)})).then((data=>{if(!data)return;const state=this.state;this.fragContextChanged(frag)?(state===State_FRAG_LOADING||!this.fragCurrent&&state===State_PARSING)&&(this.fragmentTracker.removeFragment(frag),this.state=State_IDLE):("payload"in data&&(this.log(`Loaded fragment ${frag.sn} of level ${frag.level}`),this.hls.trigger(Events.FRAG_LOADED,data)),this._handleFragmentLoadComplete(data))})).catch((reason=>{this.state!==State_STOPPED&&this.state!==State_ERROR&&(this.warn(`Frag error: ${(null==reason?void 0:reason.message)||reason}`),this.resetFragmentLoading(frag))}))}clearTrackerIfNeeded(frag){var _this$mediaBuffer;const{fragmentTracker}=this;if(fragmentTracker.getState(frag)===FragmentState_APPENDING){const playlistType=frag.type,bufferedInfo=this.getFwdBufferInfo(this.mediaBuffer,playlistType),minForwardBufferLength=Math.max(frag.duration,bufferedInfo?bufferedInfo.len:this.config.maxBufferLength),backtrackFragment=this.backtrackFragment;(1===(backtrackFragment?frag.sn-backtrackFragment.sn:0)||this.reduceMaxBufferLength(minForwardBufferLength))&&fragmentTracker.removeFragment(frag)}else 0===(null==(_this$mediaBuffer=this.mediaBuffer)?void 0:_this$mediaBuffer.buffered.length)?fragmentTracker.removeAllFragments():fragmentTracker.hasParts(frag.type)&&(fragmentTracker.detectPartialFragments({frag,part:null,stats:frag.stats,id:frag.type}),fragmentTracker.getState(frag)===FragmentState_PARTIAL&&fragmentTracker.removeFragment(frag))}checkLiveUpdate(details){if(details.updated&&!details.live){const lastFragment=details.fragments[details.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:lastFragment,part:null,stats:lastFragment.stats,id:lastFragment.type})}details.fragments[0]||(details.deltaUpdateFailed=!0)}flushMainBuffer(startOffset,endOffset,type=null){if(!(startOffset-endOffset))return;const flushScope={startOffset,endOffset,type};this.hls.trigger(Events.BUFFER_FLUSHING,flushScope)}_loadInitSegment(frag,level){this._doFragLoad(frag,level).then((data=>{if(!data||this.fragContextChanged(frag)||!this.levels)throw new Error("init load aborted");return data})).then((data=>{const{hls}=this,{payload}=data,decryptData=frag.decryptdata;if(payload&&payload.byteLength>0&&null!=decryptData&&decryptData.key&&decryptData.iv&&"AES-128"===decryptData.method){const startTime=self.performance.now();return this.decrypter.decrypt(new Uint8Array(payload),decryptData.key.buffer,decryptData.iv.buffer).catch((err=>{throw hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:err,reason:err.message,frag}),err})).then((decryptedData=>{const endTime=self.performance.now();return hls.trigger(Events.FRAG_DECRYPTED,{frag,payload:decryptedData,stats:{tstart:startTime,tdecrypt:endTime}}),data.payload=decryptedData,this.completeInitSegmentLoad(data)}))}return this.completeInitSegmentLoad(data)})).catch((reason=>{this.state!==State_STOPPED&&this.state!==State_ERROR&&(this.warn(reason),this.resetFragmentLoading(frag))}))}completeInitSegmentLoad(data){const{levels}=this;if(!levels)throw new Error("init load aborted, missing levels");const stats=data.frag.stats;this.state=State_IDLE,data.frag.data=new Uint8Array(data.payload),stats.parsing.start=stats.buffering.start=self.performance.now(),stats.parsing.end=stats.buffering.end=self.performance.now(),this.tick()}fragContextChanged(frag){const{fragCurrent}=this;return!frag||!fragCurrent||frag.sn!==fragCurrent.sn||frag.level!==fragCurrent.level}fragBufferedComplete(frag,part){var _frag$startPTS,_frag$endPTS,_this$fragCurrent,_this$fragPrevious;const media=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${frag.type} sn: ${frag.sn}${part?" part: "+part.index:""} of ${this.playlistType===PlaylistLevelType_MAIN?"level":"track"} ${frag.level} (frag:[${(null!=(_frag$startPTS=frag.startPTS)?_frag$startPTS:NaN).toFixed(3)}-${(null!=(_frag$endPTS=frag.endPTS)?_frag$endPTS:NaN).toFixed(3)}] > buffer:${media?TimeRanges_toString(BufferHelper.getBuffered(media)):"(detached)"})`),"initSegment"!==frag.sn){var _this$levels;if(frag.type!==PlaylistLevelType_SUBTITLE){const el=frag.elementaryStreams;if(!Object.keys(el).some((type=>!!el[type])))return void(this.state=State_IDLE)}const level=null==(_this$levels=this.levels)?void 0:_this$levels[frag.level];null!=level&&level.fragmentError&&(this.log(`Resetting level fragment error count of ${level.fragmentError} on frag buffered`),level.fragmentError=0)}this.state=State_IDLE,media&&(!this.loadedmetadata&&frag.type==PlaylistLevelType_MAIN&&media.buffered.length&&(null==(_this$fragCurrent=this.fragCurrent)?void 0:_this$fragCurrent.sn)===(null==(_this$fragPrevious=this.fragPrevious)?void 0:_this$fragPrevious.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(fragLoadedEndData){const{transmuxer}=this;if(!transmuxer)return;const{frag,part,partsLoaded}=fragLoadedEndData,complete=!partsLoaded||0===partsLoaded.length||partsLoaded.some((fragLoaded=>!fragLoaded)),chunkMeta=new ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount+1,0,part?part.index:-1,!complete);transmuxer.flush(chunkMeta)}_handleFragmentLoadProgress(frag){}_doFragLoad(frag,level,targetBufferTime=null,progressCallback){var _frag$decryptdata;const details=null==level?void 0:level.details;if(!this.levels||!details)throw new Error(`frag load aborted, missing level${details?"":" detail"}s`);let keyLoadingPromise=null;if(!frag.encrypted||null!=(_frag$decryptdata=frag.decryptdata)&&_frag$decryptdata.key?!frag.encrypted&&details.encryptedFragments.length&&this.keyLoader.loadClear(frag,details.encryptedFragments):(this.log(`Loading key for ${frag.sn} of [${details.startSN}-${details.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${frag.level}`),this.state=State_KEY_LOADING,this.fragCurrent=frag,keyLoadingPromise=this.keyLoader.load(frag).then((keyLoadedData=>{if(!this.fragContextChanged(keyLoadedData.frag))return this.hls.trigger(Events.KEY_LOADED,keyLoadedData),this.state===State_KEY_LOADING&&(this.state=State_IDLE),keyLoadedData})),this.hls.trigger(Events.KEY_LOADING,{frag}),null===this.fragCurrent&&(keyLoadingPromise=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),targetBufferTime=Math.max(frag.start,targetBufferTime||0),this.config.lowLatencyMode&&"initSegment"!==frag.sn){const partList=details.partList;if(partList&&progressCallback){targetBufferTime>frag.end&&details.fragmentHint&&(frag=details.fragmentHint);const partIndex=this.getNextPart(partList,frag,targetBufferTime);if(partIndex>-1){const part=partList[partIndex];let _result;return this.log(`Loading part sn: ${frag.sn} p: ${part.index} cc: ${frag.cc} of playlist [${details.startSN}-${details.endSN}] parts [0-${partIndex}-${partList.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${frag.level}, target: ${parseFloat(targetBufferTime.toFixed(3))}`),this.nextLoadPosition=part.start+part.duration,this.state=State_FRAG_LOADING,_result=keyLoadingPromise?keyLoadingPromise.then((keyLoadedData=>!keyLoadedData||this.fragContextChanged(keyLoadedData.frag)?null:this.doFragPartsLoad(frag,part,level,progressCallback))).catch((error=>this.handleFragLoadError(error))):this.doFragPartsLoad(frag,part,level,progressCallback).catch((error=>this.handleFragLoadError(error))),this.hls.trigger(Events.FRAG_LOADING,{frag,part,targetBufferTime}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):_result}if(!frag.url||this.loadedEndOfParts(partList,targetBufferTime))return Promise.resolve(null)}}this.log(`Loading fragment ${frag.sn} cc: ${frag.cc} ${details?"of ["+details.startSN+"-"+details.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${frag.level}, target: ${parseFloat(targetBufferTime.toFixed(3))}`),isFiniteNumber(frag.sn)&&!this.bitrateTest&&(this.nextLoadPosition=frag.start+frag.duration),this.state=State_FRAG_LOADING;const dataOnProgress=this.config.progressive;let result;return result=dataOnProgress&&keyLoadingPromise?keyLoadingPromise.then((keyLoadedData=>!keyLoadedData||this.fragContextChanged(null==keyLoadedData?void 0:keyLoadedData.frag)?null:this.fragmentLoader.load(frag,progressCallback))).catch((error=>this.handleFragLoadError(error))):Promise.all([this.fragmentLoader.load(frag,dataOnProgress?progressCallback:void 0),keyLoadingPromise]).then((([fragLoadedData])=>(!dataOnProgress&&fragLoadedData&&progressCallback&&progressCallback(fragLoadedData),fragLoadedData))).catch((error=>this.handleFragLoadError(error))),this.hls.trigger(Events.FRAG_LOADING,{frag,targetBufferTime}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):result}doFragPartsLoad(frag,fromPart,level,progressCallback){return new Promise(((resolve,reject)=>{var _level$details;const partsLoaded=[],initialPartList=null==(_level$details=level.details)?void 0:_level$details.partList,loadPart=part=>{this.fragmentLoader.loadPart(frag,part,progressCallback).then((partLoadedData=>{partsLoaded[part.index]=partLoadedData;const loadedPart=partLoadedData.part;this.hls.trigger(Events.FRAG_LOADED,partLoadedData);const nextPart=getPartWith(level,frag.sn,part.index+1)||findPart(initialPartList,frag.sn,part.index+1);if(!nextPart)return resolve({frag,part:loadedPart,partsLoaded});loadPart(nextPart)})).catch(reject)};loadPart(fromPart)}))}handleFragLoadError(error){if("data"in error){const data=error.data;error.data&&data.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(data.frag,data.part):this.hls.trigger(Events.ERROR,data)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:error,error,fatal:!0});return null}_handleTransmuxerFlush(chunkMeta){const context=this.getCurrentContext(chunkMeta);if(!context||this.state!==State_PARSING)return void(this.fragCurrent||this.state===State_STOPPED||this.state===State_ERROR||(this.state=State_IDLE));const{frag,part,level}=context,now=self.performance.now();frag.stats.parsing.end=now,part&&(part.stats.parsing.end=now),this.updateLevelTiming(frag,part,level,chunkMeta.partial)}getCurrentContext(chunkMeta){const{levels,fragCurrent}=this,{level:levelIndex,sn,part:partIndex}=chunkMeta;if(null==levels||!levels[levelIndex])return this.warn(`Levels object was unset while buffering fragment ${sn} of level ${levelIndex}. The current chunk will not be buffered.`),null;const level=levels[levelIndex],part=partIndex>-1?getPartWith(level,sn,partIndex):null,frag=part?part.fragment:function getFragmentWithSN(level,sn,fragCurrent){if(null==level||!level.details)return null;const levelDetails=level.details;let fragment=levelDetails.fragments[sn-levelDetails.startSN];return fragment||(fragment=levelDetails.fragmentHint,fragment&&fragment.sn===sn?fragment:sn<levelDetails.startSN&&fragCurrent&&fragCurrent.sn===sn?fragCurrent:null)}(level,sn,fragCurrent);return frag?(fragCurrent&&fragCurrent!==frag&&(frag.stats=fragCurrent.stats),{frag,part,level}):null}bufferFragmentData(data,frag,part,chunkMeta,noBacktracking){var _buffer;if(!data||this.state!==State_PARSING)return;const{data1,data2}=data;let buffer=data1;if(data1&&data2&&(buffer=appendUint8Array(data1,data2)),null==(_buffer=buffer)||!_buffer.length)return;const segment={type:data.type,frag,part,chunkMeta,parent:frag.type,data:buffer};if(this.hls.trigger(Events.BUFFER_APPENDING,segment),data.dropped&&data.independent&&!part){if(noBacktracking)return;this.flushBufferGap(frag)}}flushBufferGap(frag){const media=this.media;if(!media)return;if(!BufferHelper.isBuffered(media,media.currentTime))return void this.flushMainBuffer(0,frag.start);const currentTime=media.currentTime,bufferInfo=BufferHelper.bufferInfo(media,currentTime,0),fragDuration=frag.duration,segmentFraction=Math.min(2*this.config.maxFragLookUpTolerance,.25*fragDuration),start=Math.max(Math.min(frag.start-segmentFraction,bufferInfo.end-segmentFraction),currentTime+segmentFraction);frag.start-start>segmentFraction&&this.flushMainBuffer(start,frag.start)}getFwdBufferInfo(bufferable,type){const pos=this.getLoadPosition();return isFiniteNumber(pos)?this.getFwdBufferInfoAtPos(bufferable,pos,type):null}getFwdBufferInfoAtPos(bufferable,pos,type){const{config:{maxBufferHole}}=this,bufferInfo=BufferHelper.bufferInfo(bufferable,pos,maxBufferHole);if(0===bufferInfo.len&&void 0!==bufferInfo.nextStart){const bufferedFragAtPos=this.fragmentTracker.getBufferedFrag(pos,type);if(bufferedFragAtPos&&bufferInfo.nextStart<bufferedFragAtPos.end)return BufferHelper.bufferInfo(bufferable,pos,Math.max(bufferInfo.nextStart,maxBufferHole))}return bufferInfo}getMaxBufferLength(levelBitrate){const{config}=this;let maxBufLen;return maxBufLen=levelBitrate?Math.max(8*config.maxBufferSize/levelBitrate,config.maxBufferLength):config.maxBufferLength,Math.min(maxBufLen,config.maxMaxBufferLength)}reduceMaxBufferLength(threshold){const config=this.config,minLength=threshold||config.maxBufferLength,reducedLength=config.maxMaxBufferLength/2;return reducedLength>=minLength&&(config.maxMaxBufferLength=reducedLength,this.warn(`Reduce max buffer length to ${reducedLength}s`),!0)}getAppendedFrag(position,playlistType=PlaylistLevelType_MAIN){const fragOrPart=this.fragmentTracker.getAppendedFrag(position,PlaylistLevelType_MAIN);return fragOrPart&&"fragment"in fragOrPart?fragOrPart.fragment:fragOrPart}getNextFragment(pos,levelDetails){const fragments=levelDetails.fragments,fragLen=fragments.length;if(!fragLen)return null;const{config}=this,start=fragments[0].start;let frag;if(levelDetails.live){const initialLiveManifestSize=config.initialLiveManifestSize;if(fragLen<initialLiveManifestSize)return this.warn(`Not enough fragments to start playback (have: ${fragLen}, need: ${initialLiveManifestSize})`),null;(!levelDetails.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||pos<start)&&(frag=this.getInitialLiveFragment(levelDetails,fragments),this.startPosition=this.nextLoadPosition=frag?this.hls.liveSyncPosition||frag.start:pos)}else pos<=start&&(frag=fragments[0]);if(!frag){const end=config.lowLatencyMode?levelDetails.partEnd:levelDetails.fragmentEnd;frag=this.getFragmentAtPosition(pos,end,levelDetails)}return this.mapToInitFragWhenRequired(frag)}isLoopLoading(frag,targetBufferTime){const trackerState=this.fragmentTracker.getState(frag);return(trackerState===FragmentState_OK||trackerState===FragmentState_PARTIAL&&!!frag.gap)&&this.nextLoadPosition>targetBufferTime}getNextFragmentLoopLoading(frag,levelDetails,bufferInfo,playlistType,maxBufLen){const gapStart=frag.gap,nextFragment=this.getNextFragment(this.nextLoadPosition,levelDetails);if(null===nextFragment)return nextFragment;if(frag=nextFragment,gapStart&&frag&&!frag.gap&&bufferInfo.nextStart){const nextbufferInfo=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,bufferInfo.nextStart,playlistType);if(null!==nextbufferInfo&&bufferInfo.len+nextbufferInfo.len>=maxBufLen)return this.log(`buffer full after gaps in "${playlistType}" playlist starting at sn: ${frag.sn}`),null}return frag}mapToInitFragWhenRequired(frag){return null==frag||!frag.initSegment||null!=frag&&frag.initSegment.data||this.bitrateTest?frag:frag.initSegment}getNextPart(partList,frag,targetBufferTime){let nextPart=-1,contiguous=!1,independentAttrOmitted=!0;for(let i=0,len=partList.length;i<len;i++){const part=partList[i];if(independentAttrOmitted=independentAttrOmitted&&!part.independent,nextPart>-1&&targetBufferTime<part.start)break;const loaded=part.loaded;loaded?nextPart=-1:(contiguous||part.independent||independentAttrOmitted)&&part.fragment===frag&&(nextPart=i),contiguous=loaded}return nextPart}loadedEndOfParts(partList,targetBufferTime){const lastPart=partList[partList.length-1];return lastPart&&targetBufferTime>lastPart.start&&lastPart.loaded}getInitialLiveFragment(levelDetails,fragments){const fragPrevious=this.fragPrevious;let frag=null;if(fragPrevious){if(levelDetails.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${fragPrevious.programDateTime}`),frag=function findFragmentByPDT(fragments,PDTValue,maxFragLookUpTolerance){if(null===PDTValue||!Array.isArray(fragments)||!fragments.length||!isFiniteNumber(PDTValue))return null;if(PDTValue<(fragments[0].programDateTime||0))return null;if(PDTValue>=(fragments[fragments.length-1].endProgramDateTime||0))return null;maxFragLookUpTolerance=maxFragLookUpTolerance||0;for(let seg=0;seg<fragments.length;++seg){const frag=fragments[seg];if(pdtWithinToleranceTest(PDTValue,maxFragLookUpTolerance,frag))return frag}return null}(fragments,fragPrevious.endProgramDateTime,this.config.maxFragLookUpTolerance)),!frag){const targetSN=fragPrevious.sn+1;if(targetSN>=levelDetails.startSN&&targetSN<=levelDetails.endSN){const fragNext=fragments[targetSN-levelDetails.startSN];fragPrevious.cc===fragNext.cc&&(frag=fragNext,this.log(`Live playlist, switching playlist, load frag with next SN: ${frag.sn}`))}frag||(frag=function findFragWithCC(fragments,cc){return BinarySearch_search(fragments,(candidate=>candidate.cc<cc?1:candidate.cc>cc?-1:0))}(fragments,fragPrevious.cc),frag&&this.log(`Live playlist, switching playlist, load frag with same CC: ${frag.sn}`))}}else{const liveStart=this.hls.liveSyncPosition;null!==liveStart&&(frag=this.getFragmentAtPosition(liveStart,this.bitrateTest?levelDetails.fragmentEnd:levelDetails.edge,levelDetails))}return frag}getFragmentAtPosition(bufferEnd,end,levelDetails){const{config}=this;let{fragPrevious}=this,{fragments,endSN}=levelDetails;const{fragmentHint}=levelDetails,{maxFragLookUpTolerance}=config,partList=levelDetails.partList,loadingParts=!!(config.lowLatencyMode&&null!=partList&&partList.length&&fragmentHint);let frag;if(loadingParts&&fragmentHint&&!this.bitrateTest&&(fragments=fragments.concat(fragmentHint),endSN=fragmentHint.sn),bufferEnd<end){frag=findFragmentByPTS(fragPrevious,fragments,bufferEnd,bufferEnd>end-maxFragLookUpTolerance?0:maxFragLookUpTolerance)}else frag=fragments[fragments.length-1];if(frag){const curSNIdx=frag.sn-levelDetails.startSN,fragState=this.fragmentTracker.getState(frag);if((fragState===FragmentState_OK||fragState===FragmentState_PARTIAL&&frag.gap)&&(fragPrevious=frag),fragPrevious&&frag.sn===fragPrevious.sn&&(!loadingParts||partList[0].fragment.sn>frag.sn)){if(fragPrevious&&frag.level===fragPrevious.level){const nextFrag=fragments[curSNIdx+1];frag=frag.sn<endSN&&this.fragmentTracker.getState(nextFrag)!==FragmentState_OK?nextFrag:null}}}return frag}synchronizeToLiveEdge(levelDetails){const{config,media}=this;if(!media)return;const liveSyncPosition=this.hls.liveSyncPosition,currentTime=media.currentTime,start=levelDetails.fragments[0].start,end=levelDetails.edge,withinSlidingWindow=currentTime>=start-config.maxFragLookUpTolerance&&currentTime<=end;if(null!==liveSyncPosition&&media.duration>liveSyncPosition&&(currentTime<liveSyncPosition||!withinSlidingWindow)){const maxLatency=void 0!==config.liveMaxLatencyDuration?config.liveMaxLatencyDuration:config.liveMaxLatencyDurationCount*levelDetails.targetduration;(!withinSlidingWindow&&media.readyState<4||currentTime<end-maxLatency)&&(this.loadedmetadata||(this.nextLoadPosition=liveSyncPosition),media.readyState&&(this.warn(`Playback: ${currentTime.toFixed(3)} is located too far from the end of live sliding playlist: ${end}, reset currentTime to : ${liveSyncPosition.toFixed(3)}`),media.currentTime=liveSyncPosition))}}alignPlaylists(details,previousDetails,switchDetails){const length=details.fragments.length;if(!length)return this.warn("No fragments in live playlist"),0;const slidingStart=details.fragments[0].start,firstLevelLoad=!previousDetails,aligned=details.alignedSliding&&isFiniteNumber(slidingStart);if(firstLevelLoad||!aligned&&!slidingStart){const{fragPrevious}=this;alignStream(fragPrevious,switchDetails,details);const alignedSlidingStart=details.fragments[0].start;return this.log(`Live playlist sliding: ${alignedSlidingStart.toFixed(2)} start-sn: ${previousDetails?previousDetails.startSN:"na"}->${details.startSN} prev-sn: ${fragPrevious?fragPrevious.sn:"na"} fragments: ${length}`),alignedSlidingStart}return slidingStart}waitForCdnTuneIn(details){return details.live&&details.canBlockReload&&details.partTarget&&details.tuneInGoal>Math.max(details.partHoldBack,3*details.partTarget)}setStartPosition(details,sliding){let startPosition=this.startPosition;if(startPosition<sliding&&(startPosition=-1),-1===startPosition||-1===this.lastCurrentTime){const offsetInMultivariantPlaylist=null!==this.startTimeOffset,startTimeOffset=offsetInMultivariantPlaylist?this.startTimeOffset:details.startTimeOffset;null!==startTimeOffset&&isFiniteNumber(startTimeOffset)?(startPosition=sliding+startTimeOffset,startTimeOffset<0&&(startPosition+=details.totalduration),startPosition=Math.min(Math.max(sliding,startPosition),sliding+details.totalduration),this.log(`Start time offset ${startTimeOffset} found in ${offsetInMultivariantPlaylist?"multivariant":"media"} playlist, adjust startPosition to ${startPosition}`),this.startPosition=startPosition):details.live?startPosition=this.hls.liveSyncPosition||sliding:this.startPosition=startPosition=0,this.lastCurrentTime=startPosition}this.nextLoadPosition=startPosition}getLoadPosition(){const{media}=this;let pos=0;return this.loadedmetadata&&media?pos=media.currentTime:this.nextLoadPosition&&(pos=this.nextLoadPosition),pos}handleFragLoadAborted(frag,part){this.transmuxer&&"initSegment"!==frag.sn&&frag.stats.aborted&&(this.warn(`Fragment ${frag.sn}${part?" part "+part.index:""} of level ${frag.level} was aborted`),this.resetFragmentLoading(frag))}resetFragmentLoading(frag){this.fragCurrent&&(this.fragContextChanged(frag)||this.state===State_FRAG_LOADING_WAITING_RETRY)||(this.state=State_IDLE)}onFragmentOrKeyLoadError(filterType,data){if(data.chunkMeta&&!data.frag){const context=this.getCurrentContext(data.chunkMeta);context&&(data.frag=context.frag)}const frag=data.frag;if(!frag||frag.type!==filterType||!this.levels)return;var _this$fragCurrent2;if(this.fragContextChanged(frag))return void this.warn(`Frag load error must match current frag to retry ${frag.url} > ${null==(_this$fragCurrent2=this.fragCurrent)?void 0:_this$fragCurrent2.url}`);const gapTagEncountered=data.details===ErrorDetails.FRAG_GAP;gapTagEncountered&&this.fragmentTracker.fragBuffered(frag,!0);const errorAction=data.errorAction,{action,retryCount=0,retryConfig}=errorAction||{};if(errorAction&&action===NetworkErrorAction_RetryRequest&&retryConfig){this.resetStartWhenNotLoaded(this.levelLastLoaded);const delay=getRetryDelay(retryConfig,retryCount);this.warn(`Fragment ${frag.sn} of ${filterType} ${frag.level} errored with ${data.details}, retrying loading ${retryCount+1}/${retryConfig.maxNumRetry} in ${delay}ms`),errorAction.resolved=!0,this.retryDate=self.performance.now()+delay,this.state=State_FRAG_LOADING_WAITING_RETRY}else if(retryConfig&&errorAction){if(this.resetFragmentErrors(filterType),!(retryCount<retryConfig.maxNumRetry))return void logger.warn(`${data.details} reached or exceeded max retry (${retryCount})`);gapTagEncountered||action===NetworkErrorAction_RemoveAlternatePermanently||(errorAction.resolved=!0)}else(null==errorAction?void 0:errorAction.action)===NetworkErrorAction_SendAlternateToPenaltyBox?this.state=State_WAITING_LEVEL:this.state=State_ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(data){if(this.state===State_PARSING||this.state===State_PARSED){const playlistType=data.parent,bufferedInfo=this.getFwdBufferInfo(this.mediaBuffer,playlistType),buffered=bufferedInfo&&bufferedInfo.len>.5;buffered&&this.reduceMaxBufferLength(bufferedInfo.len);const flushBuffer=!buffered;return flushBuffer&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${playlistType} buffer`),data.frag&&(this.fragmentTracker.removeFragment(data.frag),this.nextLoadPosition=data.frag.start),this.resetLoadingState(),flushBuffer}return!1}resetFragmentErrors(filterType){filterType===PlaylistLevelType_AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==State_STOPPED&&(this.state=State_IDLE)}afterBufferFlushed(media,bufferType,playlistType){if(!media)return;const bufferedTimeRanges=BufferHelper.getBuffered(media);this.fragmentTracker.detectEvictedFragments(bufferType,bufferedTimeRanges,playlistType),this.state===State_ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=State_IDLE}resetStartWhenNotLoaded(level){if(!this.loadedmetadata){this.startFragRequested=!1;const details=level?level.details:null;null!=details&&details.live?(this.startPosition=-1,this.setStartPosition(details,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(chunkMeta){this.warn(`The loading context changed while buffering fragment ${chunkMeta.sn} of level ${chunkMeta.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(start=0){this.fragmentTracker.removeFragmentsInRange(start,1/0,this.playlistType,!1,!0)}updateLevelTiming(frag,part,level,partial){var _this$transmuxer;const details=level.details;if(!details)return void this.warn("level.details undefined");if(!Object.keys(frag.elementaryStreams).reduce(((result,type)=>{const info=frag.elementaryStreams[type];if(info){const parsedDuration=info.endPTS-info.startPTS;if(parsedDuration<=0)return this.warn(`Could not parse fragment ${frag.sn} ${type} duration reliably (${parsedDuration})`),result||!1;const drift=partial?0:updateFragPTSDTS(details,frag,info.startPTS,info.endPTS,info.startDTS,info.endDTS);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details,level,drift,type,frag,start:info.startPTS,end:info.endPTS}),!0}return result}),!1)&&null===(null==(_this$transmuxer=this.transmuxer)?void 0:_this$transmuxer.error)){const error=new Error(`Found no media in fragment ${frag.sn} of level ${frag.level} resetting transmuxer to fallback to playlist timing`);if(0===level.fragmentError&&(level.fragmentError++,frag.gap=!0,this.fragmentTracker.removeFragment(frag),this.fragmentTracker.fragBuffered(frag,!0)),this.warn(error.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error,frag,reason:`Found no media in msn ${frag.sn} of level "${level.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=State_PARSED,this.hls.trigger(Events.FRAG_PARSED,{frag,part})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(data){"demuxerWorker"===data.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(nextState){const previousState=this._state;previousState!==nextState&&(this._state=nextState,this.log(`${previousState}->${nextState}`))}get state(){return this._state}}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(chunk){this.chunks.push(chunk),this.dataLength+=chunk.length}flush(){const{chunks,dataLength}=this;let result;return chunks.length?(result=1===chunks.length?chunks[0]:function concatUint8Arrays(chunks,dataLength){const result=new Uint8Array(dataLength);let offset=0;for(let i=0;i<chunks.length;i++){const chunk=chunks[i];result.set(chunk,offset),offset+=chunk.length}return result}(chunks,dataLength),this.reset(),result):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function dummyTrack(type="",inputTimeScale=9e4){return{type,id:-1,pid:-1,inputTimeScale,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(deaultTimestamp){this.initPTS=deaultTimestamp,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(data,offset){return!1}appendFrame(track,data,offset){}demux(data,timeOffset){this.cachedData&&(data=appendUint8Array(this.cachedData,data),this.cachedData=null);let lastDataIndex,id3Data=getID3Data(data,0),offset=id3Data?id3Data.length:0;const track=this._audioTrack,id3Track=this._id3Track,timestamp=id3Data?getTimeStamp(id3Data):void 0,length=data.length;for((null===this.basePTS||0===this.frameIndex&&isFiniteNumber(timestamp))&&(this.basePTS=initPTSFn(timestamp,timeOffset,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),id3Data&&id3Data.length>0&&id3Track.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:id3Data,type:MetadataSchema_audioId3,duration:Number.POSITIVE_INFINITY});offset<length;){if(this.canParse(data,offset)){const frame=this.appendFrame(track,data,offset);frame?(this.frameIndex++,this.lastPTS=frame.sample.pts,offset+=frame.length,lastDataIndex=offset):offset=length}else canParse$2(data,offset)?(id3Data=getID3Data(data,offset),id3Track.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:id3Data,type:MetadataSchema_audioId3,duration:Number.POSITIVE_INFINITY}),offset+=id3Data.length,lastDataIndex=offset):offset++;if(offset===length&&lastDataIndex!==length){const partialData=sliceUint8(data,lastDataIndex);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,partialData):this.cachedData=partialData}}return{audioTrack:track,videoTrack:dummyTrack(),id3Track,textTrack:dummyTrack()}}demuxSampleAes(data,keyData,timeOffset){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(timeOffset){const cachedData=this.cachedData;return cachedData&&(this.cachedData=null,this.demux(cachedData,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){}}const initPTSFn=(timestamp,timeOffset,initPTS)=>{if(isFiniteNumber(timestamp))return 90*timestamp;return 9e4*timeOffset+(initPTS?9e4*initPTS.baseTime/initPTS.timescale:0)};function isHeaderPattern$1(data,offset){return 255===data[offset]&&240==(246&data[offset+1])}function getHeaderLength(data,offset){return 1&data[offset+1]?7:9}function getFullFrameLength(data,offset){return(3&data[offset+3])<<11|data[offset+4]<<3|(224&data[offset+5])>>>5}function isHeader$1(data,offset){return offset+1<data.length&&isHeaderPattern$1(data,offset)}function probe$1(data,offset){if(isHeader$1(data,offset)){const headerLength=getHeaderLength(data,offset);if(offset+headerLength>=data.length)return!1;const frameLength=getFullFrameLength(data,offset);if(frameLength<=headerLength)return!1;const newOffset=offset+frameLength;return newOffset===data.length||isHeader$1(data,newOffset)}return!1}function initTrackConfig(track,observer,data,offset,audioCodec){if(!track.samplerate){const config=function getAudioConfig(observer,data,offset,audioCodec){let adtsObjectType,adtsExtensionSamplingIndex,adtsChannelConfig,config;const userAgent=navigator.userAgent.toLowerCase(),manifestCodec=audioCodec,adtsSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];adtsObjectType=1+((192&data[offset+2])>>>6);const adtsSamplingIndex=(60&data[offset+2])>>>2;if(!(adtsSamplingIndex>adtsSamplingRates.length-1))return adtsChannelConfig=(1&data[offset+2])<<2,adtsChannelConfig|=(192&data[offset+3])>>>6,logger.log(`manifest codec:${audioCodec}, ADTS type:${adtsObjectType}, samplingIndex:${adtsSamplingIndex}`),/firefox/i.test(userAgent)?adtsSamplingIndex>=6?(adtsObjectType=5,config=new Array(4),adtsExtensionSamplingIndex=adtsSamplingIndex-3):(adtsObjectType=2,config=new Array(2),adtsExtensionSamplingIndex=adtsSamplingIndex):-1!==userAgent.indexOf("android")?(adtsObjectType=2,config=new Array(2),adtsExtensionSamplingIndex=adtsSamplingIndex):(adtsObjectType=5,config=new Array(4),audioCodec&&(-1!==audioCodec.indexOf("mp4a.40.29")||-1!==audioCodec.indexOf("mp4a.40.5"))||!audioCodec&&adtsSamplingIndex>=6?adtsExtensionSamplingIndex=adtsSamplingIndex-3:((audioCodec&&-1!==audioCodec.indexOf("mp4a.40.2")&&(adtsSamplingIndex>=6&&1===adtsChannelConfig||/vivaldi/i.test(userAgent))||!audioCodec&&1===adtsChannelConfig)&&(adtsObjectType=2,config=new Array(2)),adtsExtensionSamplingIndex=adtsSamplingIndex)),config[0]=adtsObjectType<<3,config[0]|=(14&adtsSamplingIndex)>>1,config[1]|=(1&adtsSamplingIndex)<<7,config[1]|=adtsChannelConfig<<3,5===adtsObjectType&&(config[1]|=(14&adtsExtensionSamplingIndex)>>1,config[2]=(1&adtsExtensionSamplingIndex)<<7,config[2]|=8,config[3]=0),{config,samplerate:adtsSamplingRates[adtsSamplingIndex],channelCount:adtsChannelConfig,codec:"mp4a.40."+adtsObjectType,manifestCodec};{const error=new Error(`invalid ADTS sampling index:${adtsSamplingIndex}`);observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,error,reason:error.message})}}(observer,data,offset,audioCodec);if(!config)return;track.config=config.config,track.samplerate=config.samplerate,track.channelCount=config.channelCount,track.codec=config.codec,track.manifestCodec=config.manifestCodec,logger.log(`parsed codec:${track.codec}, rate:${config.samplerate}, channels:${config.channelCount}`)}}function getFrameDuration(samplerate){return 9216e4/samplerate}function appendFrame$2(track,data,offset,pts,frameIndex){const stamp=pts+frameIndex*getFrameDuration(track.samplerate),header=function parseFrameHeader(data,offset){const headerLength=getHeaderLength(data,offset);if(offset+headerLength<=data.length){const frameLength=getFullFrameLength(data,offset)-headerLength;if(frameLength>0)return{headerLength,frameLength}}}(data,offset);let unit;if(header){const{frameLength,headerLength}=header,_length=headerLength+frameLength,missing=Math.max(0,offset+_length-data.length);missing?(unit=new Uint8Array(_length-headerLength),unit.set(data.subarray(offset+headerLength,data.length),0)):unit=data.subarray(offset+headerLength,offset+_length);const _sample={unit,pts:stamp};return missing||track.samples.push(_sample),{sample:_sample,length:_length,missing}}const length=data.length-offset;unit=new Uint8Array(length),unit.set(data.subarray(offset,data.length),0);return{sample:{unit,pts:stamp},length,missing:-1}}let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame$1(track,data,offset,pts,frameIndex){if(offset+24>data.length)return;const header=parseHeader(data,offset);if(header&&offset+header.frameLength<=data.length){const stamp=pts+frameIndex*(9e4*header.samplesPerFrame/header.sampleRate),sample={unit:data.subarray(offset,offset+header.frameLength),pts:stamp,dts:stamp};return track.config=[],track.channelCount=header.channelCount,track.samplerate=header.sampleRate,track.samples.push(sample),{sample,length:header.frameLength,missing:0}}}function parseHeader(data,offset){const mpegVersion=data[offset+1]>>3&3,mpegLayer=data[offset+1]>>1&3,bitRateIndex=data[offset+2]>>4&15,sampleRateIndex=data[offset+2]>>2&3;if(1!==mpegVersion&&0!==bitRateIndex&&15!==bitRateIndex&&3!==sampleRateIndex){const paddingBit=data[offset+2]>>1&1,channelMode=data[offset+3]>>6,bitRate=1e3*BitratesMap[14*(3===mpegVersion?3-mpegLayer:3===mpegLayer?3:4)+bitRateIndex-1],sampleRate=SamplingRateMap[3*(3===mpegVersion?0:2===mpegVersion?1:2)+sampleRateIndex],channelCount=3===channelMode?1:2,sampleCoefficient=SamplesCoefficients[mpegVersion][mpegLayer],bytesInSlot=BytesInSlot[mpegLayer],samplesPerFrame=8*sampleCoefficient*bytesInSlot,frameLength=Math.floor(sampleCoefficient*bitRate/sampleRate+paddingBit)*bytesInSlot;if(null===chromeVersion$1){const result=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=result?parseInt(result[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&2===mpegLayer&&bitRate>=224e3&&0===channelMode&&(data[offset+3]=128|data[offset+3]),{sampleRate,channelCount,frameLength,samplesPerFrame}}}function isHeaderPattern(data,offset){return!(255!==data[offset]||224&~data[offset+1]||!(6&data[offset+1]))}function isHeader(data,offset){return offset+1<data.length&&isHeaderPattern(data,offset)}function probe(data,offset){if(offset+1<data.length&&isHeaderPattern(data,offset)){const headerLength=4,header=parseHeader(data,offset);let frameLength=headerLength;null!=header&&header.frameLength&&(frameLength=header.frameLength);const newOffset=offset+frameLength;return newOffset===data.length||isHeader(data,newOffset)}return!1}const emsgSchemePattern=/\/emsg[-/]ID3/i;const getAudioBSID=(data,offset)=>{let bsid=0,numBits=5;offset+=numBits;const temp=new Uint32Array(1),mask=new Uint32Array(1),byte=new Uint8Array(1);for(;numBits>0;){byte[0]=data[offset];const bits=Math.min(numBits,8),shift=8-bits;mask[0]=4278190080>>>24+shift<<shift,temp[0]=(byte[0]&mask[0])>>shift,bsid=bsid?bsid<<bits|temp[0]:temp[0],offset+=1,numBits-=bits}return bsid};class AC3Demuxer extends BaseAudioDemuxer{constructor(observer){super(),this.observer=void 0,this.observer=observer}resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){super.resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:audioCodec,duration:trackDuration,inputTimeScale:9e4,dropped:0}}canParse(data,offset){return offset+64<data.length}appendFrame(track,data,offset){const frameLength=appendFrame(track,data,offset,this.basePTS,this.frameIndex);if(-1!==frameLength){return{sample:track.samples[track.samples.length-1],length:frameLength,missing:0}}}static probe(data){if(!data)return!1;const id3Data=getID3Data(data,0);if(!id3Data)return!1;const offset=id3Data.length;return 11===data[offset]&&119===data[offset+1]&&void 0!==getTimeStamp(id3Data)&&getAudioBSID(data,offset)<16}}function appendFrame(track,data,start,pts,frameIndex){if(start+8>data.length)return-1;if(11!==data[start]||119!==data[start+1])return-1;const samplingRateCode=data[start+4]>>6;if(samplingRateCode>=3)return-1;const sampleRate=[48e3,44100,32e3][samplingRateCode],frameSizeCode=63&data[start+4],frameLength=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*frameSizeCode+samplingRateCode];if(start+frameLength>data.length)return-1;const channelMode=data[start+6]>>5;let skipCount=0;2===channelMode?skipCount+=2:(1&channelMode&&1!==channelMode&&(skipCount+=2),4&channelMode&&(skipCount+=2));const lfeon=(data[start+6]<<8|data[start+7])>>12-skipCount&1,channelCount=[2,1,2,3,3,4,4,5][channelMode]+lfeon,bsid=data[start+5]>>3,bsmod=7&data[start+5],config=new Uint8Array([samplingRateCode<<6|bsid<<1|bsmod>>2,(3&bsmod)<<6|channelMode<<3|lfeon<<2|frameSizeCode>>4,frameSizeCode<<4&224]),stamp=pts+frameIndex*(1536/sampleRate*9e4),unit=data.subarray(start,start+frameLength);return track.config=config,track.channelCount=channelCount,track.samplerate=sampleRate,track.samples.push({unit,pts:stamp}),frameLength}class BaseVideoParser{constructor(){this.VideoSample=null}createVideoSample(key,pts,dts,debug){return{key,frame:!1,pts,dts,units:[],debug,length:0}}getLastNalUnit(samples){var _VideoSample;let lastUnit,VideoSample=this.VideoSample;if(VideoSample&&0!==VideoSample.units.length||(VideoSample=samples[samples.length-1]),null!=(_VideoSample=VideoSample)&&_VideoSample.units){const units=VideoSample.units;lastUnit=units[units.length-1]}return lastUnit}pushAccessUnit(VideoSample,videoTrack){if(VideoSample.units.length&&VideoSample.frame){if(void 0===VideoSample.pts){const samples=videoTrack.samples,nbSamples=samples.length;if(!nbSamples)return void videoTrack.dropped++;{const lastSample=samples[nbSamples-1];VideoSample.pts=lastSample.pts,VideoSample.dts=lastSample.dts}}videoTrack.samples.push(VideoSample)}VideoSample.debug.length&&logger.log(VideoSample.pts+"/"+VideoSample.dts+":"+VideoSample.debug)}}class ExpGolomb{constructor(data){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=data,this.bytesAvailable=data.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const data=this.data,bytesAvailable=this.bytesAvailable,position=data.byteLength-bytesAvailable,workingBytes=new Uint8Array(4),availableBytes=Math.min(4,bytesAvailable);if(0===availableBytes)throw new Error("no bytes available");workingBytes.set(data.subarray(position,position+availableBytes)),this.word=new DataView(workingBytes.buffer).getUint32(0),this.bitsAvailable=8*availableBytes,this.bytesAvailable-=availableBytes}skipBits(count){let skipBytes;count=Math.min(count,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>count?(this.word<<=count,this.bitsAvailable-=count):(skipBytes=(count-=this.bitsAvailable)>>3,count-=skipBytes<<3,this.bytesAvailable-=skipBytes,this.loadWord(),this.word<<=count,this.bitsAvailable-=count)}readBits(size){let bits=Math.min(this.bitsAvailable,size);const valu=this.word>>>32-bits;if(size>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=bits,this.bitsAvailable>0)this.word<<=bits;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return bits=size-bits,bits>0&&this.bitsAvailable?valu<<bits|this.readBits(bits):valu}skipLZ(){let leadingZeroCount;for(leadingZeroCount=0;leadingZeroCount<this.bitsAvailable;++leadingZeroCount)if(this.word&2147483648>>>leadingZeroCount)return this.word<<=leadingZeroCount,this.bitsAvailable-=leadingZeroCount,leadingZeroCount;return this.loadWord(),leadingZeroCount+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const clz=this.skipLZ();return this.readBits(clz+1)-1}readEG(){const valu=this.readUEG();return 1&valu?1+valu>>>1:-1*(valu>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(count){let deltaScale,lastScale=8,nextScale=8;for(let j=0;j<count;j++)0!==nextScale&&(deltaScale=this.readEG(),nextScale=(lastScale+deltaScale+256)%256),lastScale=0===nextScale?lastScale:nextScale}readSPS(){let numRefFramesInPicOrderCntCycle,scalingListCount,i,frameCropLeftOffset=0,frameCropRightOffset=0,frameCropTopOffset=0,frameCropBottomOffset=0;const readUByte=this.readUByte.bind(this),readBits=this.readBits.bind(this),readUEG=this.readUEG.bind(this),readBoolean=this.readBoolean.bind(this),skipBits=this.skipBits.bind(this),skipEG=this.skipEG.bind(this),skipUEG=this.skipUEG.bind(this),skipScalingList=this.skipScalingList.bind(this);readUByte();const profileIdc=readUByte();if(readBits(5),skipBits(3),readUByte(),skipUEG(),100===profileIdc||110===profileIdc||122===profileIdc||244===profileIdc||44===profileIdc||83===profileIdc||86===profileIdc||118===profileIdc||128===profileIdc){const chromaFormatIdc=readUEG();if(3===chromaFormatIdc&&skipBits(1),skipUEG(),skipUEG(),skipBits(1),readBoolean())for(scalingListCount=3!==chromaFormatIdc?8:12,i=0;i<scalingListCount;i++)readBoolean()&&skipScalingList(i<6?16:64)}skipUEG();const picOrderCntType=readUEG();if(0===picOrderCntType)readUEG();else if(1===picOrderCntType)for(skipBits(1),skipEG(),skipEG(),numRefFramesInPicOrderCntCycle=readUEG(),i=0;i<numRefFramesInPicOrderCntCycle;i++)skipEG();skipUEG(),skipBits(1);const picWidthInMbsMinus1=readUEG(),picHeightInMapUnitsMinus1=readUEG(),frameMbsOnlyFlag=readBits(1);0===frameMbsOnlyFlag&&skipBits(1),skipBits(1),readBoolean()&&(frameCropLeftOffset=readUEG(),frameCropRightOffset=readUEG(),frameCropTopOffset=readUEG(),frameCropBottomOffset=readUEG());let pixelRatio=[1,1];if(readBoolean()&&readBoolean()){switch(readUByte()){case 1:pixelRatio=[1,1];break;case 2:pixelRatio=[12,11];break;case 3:pixelRatio=[10,11];break;case 4:pixelRatio=[16,11];break;case 5:pixelRatio=[40,33];break;case 6:pixelRatio=[24,11];break;case 7:pixelRatio=[20,11];break;case 8:pixelRatio=[32,11];break;case 9:pixelRatio=[80,33];break;case 10:pixelRatio=[18,11];break;case 11:pixelRatio=[15,11];break;case 12:pixelRatio=[64,33];break;case 13:pixelRatio=[160,99];break;case 14:pixelRatio=[4,3];break;case 15:pixelRatio=[3,2];break;case 16:pixelRatio=[2,1];break;case 255:pixelRatio=[readUByte()<<8|readUByte(),readUByte()<<8|readUByte()]}}return{width:Math.ceil(16*(picWidthInMbsMinus1+1)-2*frameCropLeftOffset-2*frameCropRightOffset),height:(2-frameMbsOnlyFlag)*(picHeightInMapUnitsMinus1+1)*16-(frameMbsOnlyFlag?2:4)*(frameCropTopOffset+frameCropBottomOffset),pixelRatio}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class AvcVideoParser extends BaseVideoParser{parseAVCPES(track,textTrack,pes,last,duration){const units=this.parseAVCNALu(track,pes.data);let push,VideoSample=this.VideoSample,spsfound=!1;pes.data=null,VideoSample&&units.length&&!track.audFound&&(this.pushAccessUnit(VideoSample,track),VideoSample=this.VideoSample=this.createVideoSample(!1,pes.pts,pes.dts,"")),units.forEach((unit=>{var _VideoSample2;switch(unit.type){case 1:{let iskey=!1;push=!0;const data=unit.data;if(spsfound&&data.length>4){const sliceType=new ExpGolomb(data).readSliceType();2!==sliceType&&4!==sliceType&&7!==sliceType&&9!==sliceType||(iskey=!0)}var _VideoSample;if(iskey)null!=(_VideoSample=VideoSample)&&_VideoSample.frame&&!VideoSample.key&&(this.pushAccessUnit(VideoSample,track),VideoSample=this.VideoSample=null);VideoSample||(VideoSample=this.VideoSample=this.createVideoSample(!0,pes.pts,pes.dts,"")),VideoSample.frame=!0,VideoSample.key=iskey;break}case 5:push=!0,null!=(_VideoSample2=VideoSample)&&_VideoSample2.frame&&!VideoSample.key&&(this.pushAccessUnit(VideoSample,track),VideoSample=this.VideoSample=null),VideoSample||(VideoSample=this.VideoSample=this.createVideoSample(!0,pes.pts,pes.dts,"")),VideoSample.key=!0,VideoSample.frame=!0;break;case 6:push=!0,parseSEIMessageFromNALu(unit.data,1,pes.pts,textTrack.samples);break;case 7:{var _track$pixelRatio,_track$pixelRatio2;push=!0,spsfound=!0;const sps=unit.data,config=new ExpGolomb(sps).readSPS();if(!track.sps||track.width!==config.width||track.height!==config.height||(null==(_track$pixelRatio=track.pixelRatio)?void 0:_track$pixelRatio[0])!==config.pixelRatio[0]||(null==(_track$pixelRatio2=track.pixelRatio)?void 0:_track$pixelRatio2[1])!==config.pixelRatio[1]){track.width=config.width,track.height=config.height,track.pixelRatio=config.pixelRatio,track.sps=[sps],track.duration=duration;const codecarray=sps.subarray(1,4);let codecstring="avc1.";for(let i=0;i<3;i++){let h=codecarray[i].toString(16);h.length<2&&(h="0"+h),codecstring+=h}track.codec=codecstring}break}case 8:push=!0,track.pps=[unit.data];break;case 9:push=!0,track.audFound=!0,VideoSample&&this.pushAccessUnit(VideoSample,track),VideoSample=this.VideoSample=this.createVideoSample(!1,pes.pts,pes.dts,"");break;case 12:push=!0;break;default:push=!1,VideoSample&&(VideoSample.debug+="unknown NAL "+unit.type+" ")}if(VideoSample&&push){VideoSample.units.push(unit)}})),last&&VideoSample&&(this.pushAccessUnit(VideoSample,track),this.VideoSample=null)}parseAVCNALu(track,array){const len=array.byteLength;let state=track.naluState||0;const lastState=state,units=[];let value,overflow,unitType,i=0,lastUnitStart=-1,lastUnitType=0;for(-1===state&&(lastUnitStart=0,lastUnitType=31&array[0],state=0,i=1);i<len;)if(value=array[i++],state)if(1!==state)if(value)if(1===value){if(overflow=i-state-1,lastUnitStart>=0){const unit={data:array.subarray(lastUnitStart,overflow),type:lastUnitType};units.push(unit)}else{const lastUnit=this.getLastNalUnit(track.samples);lastUnit&&(lastState&&i<=4-lastState&&lastUnit.state&&(lastUnit.data=lastUnit.data.subarray(0,lastUnit.data.byteLength-lastState)),overflow>0&&(lastUnit.data=appendUint8Array(lastUnit.data,array.subarray(0,overflow)),lastUnit.state=0))}i<len?(unitType=31&array[i],lastUnitStart=i,lastUnitType=unitType,state=0):state=-1}else state=0;else state=3;else state=value?0:2;else state=value?0:1;if(lastUnitStart>=0&&state>=0){const unit={data:array.subarray(lastUnitStart,len),type:lastUnitType,state};units.push(unit)}if(0===units.length){const lastUnit=this.getLastNalUnit(track.samples);lastUnit&&(lastUnit.data=appendUint8Array(lastUnit.data,array))}return track.naluState=state,units}}class SampleAesDecrypter{constructor(observer,config,keyData){this.keyData=void 0,this.decrypter=void 0,this.keyData=keyData,this.decrypter=new Decrypter(config,{removePKCS7Padding:!1})}decryptBuffer(encryptedData){return this.decrypter.decrypt(encryptedData,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(samples,sampleIndex,callback){const curUnit=samples[sampleIndex].unit;if(curUnit.length<=16)return;const encryptedData=curUnit.subarray(16,curUnit.length-curUnit.length%16),encryptedBuffer=encryptedData.buffer.slice(encryptedData.byteOffset,encryptedData.byteOffset+encryptedData.length);this.decryptBuffer(encryptedBuffer).then((decryptedBuffer=>{const decryptedData=new Uint8Array(decryptedBuffer);curUnit.set(decryptedData,16),this.decrypter.isSync()||this.decryptAacSamples(samples,sampleIndex+1,callback)}))}decryptAacSamples(samples,sampleIndex,callback){for(;;sampleIndex++){if(sampleIndex>=samples.length)return void callback();if(!(samples[sampleIndex].unit.length<32)&&(this.decryptAacSample(samples,sampleIndex,callback),!this.decrypter.isSync()))return}}getAvcEncryptedData(decodedData){const encryptedDataLen=16*Math.floor((decodedData.length-48)/160)+16,encryptedData=new Int8Array(encryptedDataLen);let outputPos=0;for(let inputPos=32;inputPos<decodedData.length-16;inputPos+=160,outputPos+=16)encryptedData.set(decodedData.subarray(inputPos,inputPos+16),outputPos);return encryptedData}getAvcDecryptedUnit(decodedData,decryptedData){const uint8DecryptedData=new Uint8Array(decryptedData);let inputPos=0;for(let outputPos=32;outputPos<decodedData.length-16;outputPos+=160,inputPos+=16)decodedData.set(uint8DecryptedData.subarray(inputPos,inputPos+16),outputPos);return decodedData}decryptAvcSample(samples,sampleIndex,unitIndex,callback,curUnit){const decodedData=discardEPB(curUnit.data),encryptedData=this.getAvcEncryptedData(decodedData);this.decryptBuffer(encryptedData.buffer).then((decryptedBuffer=>{curUnit.data=this.getAvcDecryptedUnit(decodedData,decryptedBuffer),this.decrypter.isSync()||this.decryptAvcSamples(samples,sampleIndex,unitIndex+1,callback)}))}decryptAvcSamples(samples,sampleIndex,unitIndex,callback){if(samples instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;sampleIndex++,unitIndex=0){if(sampleIndex>=samples.length)return void callback();const curUnits=samples[sampleIndex].units;for(;!(unitIndex>=curUnits.length);unitIndex++){const curUnit=curUnits[unitIndex];if(!(curUnit.data.length<=48||1!==curUnit.type&&5!==curUnit.type||(this.decryptAvcSample(samples,sampleIndex,unitIndex,callback,curUnit),this.decrypter.isSync())))return}}}}class TSDemuxer{constructor(observer,config,typeSupported){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=observer,this.config=config,this.typeSupported=typeSupported,this.videoParser=new AvcVideoParser}static probe(data){const syncOffset=TSDemuxer.syncOffset(data);return syncOffset>0&&logger.warn(`MPEG2-TS detected but first sync word found @ offset ${syncOffset}`),-1!==syncOffset}static syncOffset(data){const length=data.length;let scanwindow=Math.min(940,length-188)+1,i=0;for(;i<scanwindow;){let foundPat=!1,packetStart=-1,tsPackets=0;for(let j=i;j<length;j+=188){if(71!==data[j]||length-j!=188&&71!==data[j+188]){if(tsPackets)return-1;break}if(tsPackets++,-1===packetStart&&(packetStart=j,0!==packetStart&&(scanwindow=Math.min(packetStart+18612,data.length-188)+1)),foundPat||(foundPat=0===parsePID(data,j)),foundPat&&tsPackets>1&&(0===packetStart&&tsPackets>2||j+188>scanwindow))return packetStart}i++}return-1}static createTrack(type,duration){return{container:"video"===type||"audio"===type?"video/mp2t":void 0,type,id:RemuxerTrackIdConfig[type],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===type?duration:void 0}}resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",trackDuration),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=audioCodec,this.videoCodec=videoCodec,this._duration=trackDuration}resetTimeStamp(){}resetContiguity(){const{_audioTrack,_videoTrack,_id3Track}=this;_audioTrack&&(_audioTrack.pesData=null),_videoTrack&&(_videoTrack.pesData=null),_id3Track&&(_id3Track.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(data,timeOffset,isSampleAes=!1,flush=!1){let pes;isSampleAes||(this.sampleAes=null);const videoTrack=this._videoTrack,audioTrack=this._audioTrack,id3Track=this._id3Track,textTrack=this._txtTrack;let videoPid=videoTrack.pid,videoData=videoTrack.pesData,audioPid=audioTrack.pid,id3Pid=id3Track.pid,audioData=audioTrack.pesData,id3Data=id3Track.pesData,unknownPID=null,pmtParsed=this.pmtParsed,pmtId=this._pmtId,len=data.length;if(this.remainderData&&(len=(data=appendUint8Array(this.remainderData,data)).length,this.remainderData=null),len<188&&!flush)return this.remainderData=data,{audioTrack,videoTrack,id3Track,textTrack};const syncOffset=Math.max(0,TSDemuxer.syncOffset(data));len-=(len-syncOffset)%188,len<data.byteLength&&!flush&&(this.remainderData=new Uint8Array(data.buffer,len,data.buffer.byteLength-len));let tsPacketErrors=0;for(let start=syncOffset;start<len;start+=188)if(71===data[start]){const stt=!!(64&data[start+1]),pid=parsePID(data,start);let offset;if((48&data[start+3])>>4>1){if(offset=start+5+data[start+4],offset===start+188)continue}else offset=start+4;switch(pid){case videoPid:stt&&(videoData&&(pes=parsePES(videoData))&&this.videoParser.parseAVCPES(videoTrack,textTrack,pes,!1,this._duration),videoData={data:[],size:0}),videoData&&(videoData.data.push(data.subarray(offset,start+188)),videoData.size+=start+188-offset);break;case audioPid:if(stt){if(audioData&&(pes=parsePES(audioData)))switch(audioTrack.segmentCodec){case"aac":this.parseAACPES(audioTrack,pes);break;case"mp3":this.parseMPEGPES(audioTrack,pes);break;case"ac3":this.parseAC3PES(audioTrack,pes)}audioData={data:[],size:0}}audioData&&(audioData.data.push(data.subarray(offset,start+188)),audioData.size+=start+188-offset);break;case id3Pid:stt&&(id3Data&&(pes=parsePES(id3Data))&&this.parseID3PES(id3Track,pes),id3Data={data:[],size:0}),id3Data&&(id3Data.data.push(data.subarray(offset,start+188)),id3Data.size+=start+188-offset);break;case 0:stt&&(offset+=data[offset]+1),pmtId=this._pmtId=parsePAT(data,offset);break;case pmtId:{stt&&(offset+=data[offset]+1);const parsedPIDs=parsePMT(data,offset,this.typeSupported,isSampleAes,this.observer);videoPid=parsedPIDs.videoPid,videoPid>0&&(videoTrack.pid=videoPid,videoTrack.segmentCodec=parsedPIDs.segmentVideoCodec),audioPid=parsedPIDs.audioPid,audioPid>0&&(audioTrack.pid=audioPid,audioTrack.segmentCodec=parsedPIDs.segmentAudioCodec),id3Pid=parsedPIDs.id3Pid,id3Pid>0&&(id3Track.pid=id3Pid),null===unknownPID||pmtParsed||(logger.warn(`MPEG-TS PMT found at ${start} after unknown PID '${unknownPID}'. Backtracking to sync byte @${syncOffset} to parse all TS packets.`),unknownPID=null,start=syncOffset-188),pmtParsed=this.pmtParsed=!0;break}case 17:case 8191:break;default:unknownPID=pid}}else tsPacketErrors++;tsPacketErrors>0&&emitParsingError(this.observer,new Error(`Found ${tsPacketErrors} TS packet/s that do not start with 0x47`)),videoTrack.pesData=videoData,audioTrack.pesData=audioData,id3Track.pesData=id3Data;const demuxResult={audioTrack,videoTrack,id3Track,textTrack};return flush&&this.extractRemainingSamples(demuxResult),demuxResult}flush(){const{remainderData}=this;let result;return this.remainderData=null,result=remainderData?this.demux(remainderData,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(result),this.sampleAes?this.decrypt(result,this.sampleAes):result}extractRemainingSamples(demuxResult){const{audioTrack,videoTrack,id3Track,textTrack}=demuxResult,videoData=videoTrack.pesData,audioData=audioTrack.pesData,id3Data=id3Track.pesData;let pes;if(videoData&&(pes=parsePES(videoData))?(this.videoParser.parseAVCPES(videoTrack,textTrack,pes,!0,this._duration),videoTrack.pesData=null):videoTrack.pesData=videoData,audioData&&(pes=parsePES(audioData))){switch(audioTrack.segmentCodec){case"aac":this.parseAACPES(audioTrack,pes);break;case"mp3":this.parseMPEGPES(audioTrack,pes);break;case"ac3":this.parseAC3PES(audioTrack,pes)}audioTrack.pesData=null}else null!=audioData&&audioData.size&&logger.log("last AAC PES packet truncated,might overlap between fragments"),audioTrack.pesData=audioData;id3Data&&(pes=parsePES(id3Data))?(this.parseID3PES(id3Track,pes),id3Track.pesData=null):id3Track.pesData=id3Data}demuxSampleAes(data,keyData,timeOffset){const demuxResult=this.demux(data,timeOffset,!0,!this.config.progressive),sampleAes=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,keyData);return this.decrypt(demuxResult,sampleAes)}decrypt(demuxResult,sampleAes){return new Promise((resolve=>{const{audioTrack,videoTrack}=demuxResult;audioTrack.samples&&"aac"===audioTrack.segmentCodec?sampleAes.decryptAacSamples(audioTrack.samples,0,(()=>{videoTrack.samples?sampleAes.decryptAvcSamples(videoTrack.samples,0,0,(()=>{resolve(demuxResult)})):resolve(demuxResult)})):videoTrack.samples&&sampleAes.decryptAvcSamples(videoTrack.samples,0,0,(()=>{resolve(demuxResult)}))}))}destroy(){this._duration=0}parseAACPES(track,pes){let startOffset=0;const aacOverFlow=this.aacOverFlow;let offset,len,pts,data=pes.data;if(aacOverFlow){this.aacOverFlow=null;const frameMissingBytes=aacOverFlow.missing,sampleLength=aacOverFlow.sample.unit.byteLength;if(-1===frameMissingBytes)data=appendUint8Array(aacOverFlow.sample.unit,data);else{const frameOverflowBytes=sampleLength-frameMissingBytes;aacOverFlow.sample.unit.set(data.subarray(0,frameMissingBytes),frameOverflowBytes),track.samples.push(aacOverFlow.sample),startOffset=aacOverFlow.missing}}for(offset=startOffset,len=data.length;offset<len-1&&!isHeader$1(data,offset);offset++);if(offset!==startOffset){let reason;const recoverable=offset<len-1;if(reason=recoverable?`AAC PES did not start with ADTS header,offset:${offset}`:"No ADTS header found in AAC PES",emitParsingError(this.observer,new Error(reason),recoverable),!recoverable)return}if(initTrackConfig(track,this.observer,data,offset,this.audioCodec),void 0!==pes.pts)pts=pes.pts;else{if(!aacOverFlow)return void logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const frameDuration=getFrameDuration(track.samplerate);pts=aacOverFlow.sample.pts+frameDuration}}let frame,frameIndex=0;for(;offset<len;){if(frame=appendFrame$2(track,data,offset,pts,frameIndex),offset+=frame.length,frame.missing){this.aacOverFlow=frame;break}for(frameIndex++;offset<len-1&&!isHeader$1(data,offset);offset++);}}parseMPEGPES(track,pes){const data=pes.data,length=data.length;let frameIndex=0,offset=0;const pts=pes.pts;if(void 0!==pts)for(;offset<length;)if(isHeader(data,offset)){const frame=appendFrame$1(track,data,offset,pts,frameIndex);if(!frame)break;offset+=frame.length,frameIndex++}else offset++;else logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(track,pes){{const data=pes.data,pts=pes.pts;if(void 0===pts)return void logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const length=data.length;let parsed,frameIndex=0,offset=0;for(;offset<length&&(parsed=appendFrame(track,data,offset,pts,frameIndex++))>0;)offset+=parsed}}parseID3PES(id3Track,pes){if(void 0===pes.pts)return void logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const id3Sample=_extends({},pes,{type:this._videoTrack?MetadataSchema_emsg:MetadataSchema_audioId3,duration:Number.POSITIVE_INFINITY});id3Track.samples.push(id3Sample)}}function parsePID(data,offset){return((31&data[offset+1])<<8)+data[offset+2]}function parsePAT(data,offset){return(31&data[offset+10])<<8|data[offset+11]}function parsePMT(data,offset,typeSupported,isSampleAes,observer){const result={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},tableEnd=offset+3+((15&data[offset+1])<<8|data[offset+2])-4;for(offset+=12+((15&data[offset+10])<<8|data[offset+11]);offset<tableEnd;){const pid=parsePID(data,offset),esInfoLength=(15&data[offset+3])<<8|data[offset+4];switch(data[offset]){case 207:if(!isSampleAes){logEncryptedSamplesFoundInUnencryptedStream("ADTS AAC");break}case 15:-1===result.audioPid&&(result.audioPid=pid);break;case 21:-1===result.id3Pid&&(result.id3Pid=pid);break;case 219:if(!isSampleAes){logEncryptedSamplesFoundInUnencryptedStream("H.264");break}case 27:-1===result.videoPid&&(result.videoPid=pid,result.segmentVideoCodec="avc");break;case 3:case 4:typeSupported.mpeg||typeSupported.mp3?-1===result.audioPid&&(result.audioPid=pid,result.segmentAudioCodec="mp3"):logger.log("MPEG audio found, not supported in this browser");break;case 193:if(!isSampleAes){logEncryptedSamplesFoundInUnencryptedStream("AC-3");break}case 129:typeSupported.ac3?-1===result.audioPid&&(result.audioPid=pid,result.segmentAudioCodec="ac3"):logger.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===result.audioPid&&esInfoLength>0){let parsePos=offset+5,remaining=esInfoLength;for(;remaining>2;){if(106===data[parsePos])!0!==typeSupported.ac3?logger.log("AC-3 audio found, not supported in this browser for now"):(result.audioPid=pid,result.segmentAudioCodec="ac3");const descriptorLen=data[parsePos+1]+2;parsePos+=descriptorLen,remaining-=descriptorLen}}break;case 194:case 135:return emitParsingError(observer,new Error("Unsupported EC-3 in M2TS found")),result;case 36:return emitParsingError(observer,new Error("Unsupported HEVC in M2TS found")),result}offset+=esInfoLength+5}return result}function emitParsingError(observer,error,levelRetry){logger.warn(`parsing error: ${error.message}`),observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry,error,reason:error.message})}function logEncryptedSamplesFoundInUnencryptedStream(type){logger.log(`${type} with AES-128-CBC encryption found in unencrypted stream`)}function parsePES(stream){let frag,pesLen,pesHdrLen,pesPts,pesDts,i=0;const data=stream.data;if(!stream||0===stream.size)return null;for(;data[0].length<19&&data.length>1;)data[0]=appendUint8Array(data[0],data[1]),data.splice(1,1);frag=data[0];if(1===(frag[0]<<16)+(frag[1]<<8)+frag[2]){if(pesLen=(frag[4]<<8)+frag[5],pesLen&&pesLen>stream.size-6)return null;const pesFlags=frag[7];192&pesFlags&&(pesPts=536870912*(14&frag[9])+4194304*(255&frag[10])+16384*(254&frag[11])+128*(255&frag[12])+(254&frag[13])/2,64&pesFlags?(pesDts=536870912*(14&frag[14])+4194304*(255&frag[15])+16384*(254&frag[16])+128*(255&frag[17])+(254&frag[18])/2,pesPts-pesDts>54e5&&(logger.warn(`${Math.round((pesPts-pesDts)/9e4)}s delta between PTS and DTS, align them`),pesPts=pesDts)):pesDts=pesPts),pesHdrLen=frag[8];let payloadStartOffset=pesHdrLen+9;if(stream.size<=payloadStartOffset)return null;stream.size-=payloadStartOffset;const pesData=new Uint8Array(stream.size);for(let j=0,dataLen=data.length;j<dataLen;j++){frag=data[j];let len=frag.byteLength;if(payloadStartOffset){if(payloadStartOffset>len){payloadStartOffset-=len;continue}frag=frag.subarray(payloadStartOffset),len-=payloadStartOffset,payloadStartOffset=0}pesData.set(frag,i),i+=len}return pesLen&&(pesLen-=pesHdrLen+3),{data:pesData,pts:pesPts,dts:pesDts,len:pesLen}}return null}class AAC{static getSilentFrame(codec,channelCount){if("mp4a.40.2"===codec){if(1===channelCount)return new Uint8Array([0,200,0,128,35,128]);if(2===channelCount)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===channelCount)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===channelCount)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===channelCount)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===channelCount)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){let i;for(i in MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},MP4.types)MP4.types.hasOwnProperty(i)&&(MP4.types[i]=[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3)]);const videoHdlr=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audioHdlr=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:videoHdlr,audio:audioHdlr};const dref=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),stco=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=stco,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const majorBrand=new Uint8Array([105,115,111,109]),avc1Brand=new Uint8Array([97,118,99,49]),minorVersion=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,majorBrand,minorVersion,majorBrand,avc1Brand),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,dref))}static box(type,...payload){let size=8,i=payload.length;const len=i;for(;i--;)size+=payload[i].byteLength;const result=new Uint8Array(size);for(result[0]=size>>24&255,result[1]=size>>16&255,result[2]=size>>8&255,result[3]=255&size,result.set(type,4),i=0,size=8;i<len;i++)result.set(payload[i],size),size+=payload[i].byteLength;return result}static hdlr(type){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[type])}static mdat(data){return MP4.box(MP4.types.mdat,data)}static mdhd(timescale,duration){duration*=timescale;const upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,timescale>>24&255,timescale>>16&255,timescale>>8&255,255&timescale,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,85,196,0,0]))}static mdia(track){return MP4.box(MP4.types.mdia,MP4.mdhd(track.timescale,track.duration),MP4.hdlr(track.type),MP4.minf(track))}static mfhd(sequenceNumber){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,sequenceNumber>>24,sequenceNumber>>16&255,sequenceNumber>>8&255,255&sequenceNumber]))}static minf(track){return"audio"===track.type?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(track)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(track))}static moof(sn,baseMediaDecodeTime,track){return MP4.box(MP4.types.moof,MP4.mfhd(sn),MP4.traf(track,baseMediaDecodeTime))}static moov(tracks){let i=tracks.length;const boxes=[];for(;i--;)boxes[i]=MP4.trak(tracks[i]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(tracks[0].timescale,tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)))}static mvex(tracks){let i=tracks.length;const boxes=[];for(;i--;)boxes[i]=MP4.trex(tracks[i]);return MP4.box.apply(null,[MP4.types.mvex,...boxes])}static mvhd(timescale,duration){duration*=timescale;const upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1)),bytes=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,timescale>>24&255,timescale>>16&255,timescale>>8&255,255&timescale,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,bytes)}static sdtp(track){const samples=track.samples||[],bytes=new Uint8Array(4+samples.length);let i,flags;for(i=0;i<samples.length;i++)flags=samples[i].flags,bytes[i+4]=flags.dependsOn<<4|flags.isDependedOn<<2|flags.hasRedundancy;return MP4.box(MP4.types.sdtp,bytes)}static stbl(track){return MP4.box(MP4.types.stbl,MP4.stsd(track),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(track){let i,data,len,sps=[],pps=[];for(i=0;i<track.sps.length;i++)data=track.sps[i],len=data.byteLength,sps.push(len>>>8&255),sps.push(255&len),sps=sps.concat(Array.prototype.slice.call(data));for(i=0;i<track.pps.length;i++)data=track.pps[i],len=data.byteLength,pps.push(len>>>8&255),pps.push(255&len),pps=pps.concat(Array.prototype.slice.call(data));const avcc=MP4.box(MP4.types.avcC,new Uint8Array([1,sps[3],sps[4],sps[5],255,224|track.sps.length].concat(sps).concat([track.pps.length]).concat(pps))),width=track.width,height=track.height,hSpacing=track.pixelRatio[0],vSpacing=track.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,width>>8&255,255&width,height>>8&255,255&height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),avcc,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([hSpacing>>24,hSpacing>>16&255,hSpacing>>8&255,255&hSpacing,vSpacing>>24,vSpacing>>16&255,vSpacing>>8&255,255&vSpacing])))}static esds(track){const configlen=track.config.length;return new Uint8Array([0,0,0,0,3,23+configlen,0,1,0,4,15+configlen,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([configlen]).concat(track.config).concat([6,1,2]))}static audioStsd(track){const samplerate=track.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,track.channelCount,0,16,0,0,0,0,samplerate>>8&255,255&samplerate,0,0])}static mp4a(track){return MP4.box(MP4.types.mp4a,MP4.audioStsd(track),MP4.box(MP4.types.esds,MP4.esds(track)))}static mp3(track){return MP4.box(MP4.types[".mp3"],MP4.audioStsd(track))}static ac3(track){return MP4.box(MP4.types["ac-3"],MP4.audioStsd(track),MP4.box(MP4.types.dac3,track.config))}static stsd(track){return"audio"===track.type?"mp3"===track.segmentCodec&&"mp3"===track.codec?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(track)):"ac3"===track.segmentCodec?MP4.box(MP4.types.stsd,MP4.STSD,MP4.ac3(track)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(track)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(track))}static tkhd(track){const id=track.id,duration=track.duration*track.timescale,width=track.width,height=track.height,upperWordDuration=Math.floor(duration/(UINT32_MAX+1)),lowerWordDuration=Math.floor(duration%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,id>>24&255,id>>16&255,id>>8&255,255&id,0,0,0,0,upperWordDuration>>24,upperWordDuration>>16&255,upperWordDuration>>8&255,255&upperWordDuration,lowerWordDuration>>24,lowerWordDuration>>16&255,lowerWordDuration>>8&255,255&lowerWordDuration,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,width>>8&255,255&width,0,0,height>>8&255,255&height,0,0]))}static traf(track,baseMediaDecodeTime){const sampleDependencyTable=MP4.sdtp(track),id=track.id,upperWordBaseMediaDecodeTime=Math.floor(baseMediaDecodeTime/(UINT32_MAX+1)),lowerWordBaseMediaDecodeTime=Math.floor(baseMediaDecodeTime%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,255&id])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,upperWordBaseMediaDecodeTime>>24,upperWordBaseMediaDecodeTime>>16&255,upperWordBaseMediaDecodeTime>>8&255,255&upperWordBaseMediaDecodeTime,lowerWordBaseMediaDecodeTime>>24,lowerWordBaseMediaDecodeTime>>16&255,lowerWordBaseMediaDecodeTime>>8&255,255&lowerWordBaseMediaDecodeTime])),MP4.trun(track,sampleDependencyTable.length+16+20+8+16+8+8),sampleDependencyTable)}static trak(track){return track.duration=track.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(track),MP4.mdia(track))}static trex(track){const id=track.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,id>>24,id>>16&255,id>>8&255,255&id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(track,offset){const samples=track.samples||[],len=samples.length,arraylen=12+16*len,array=new Uint8Array(arraylen);let i,sample,duration,size,flags,cts;for(offset+=8+arraylen,array.set(["video"===track.type?1:0,0,15,1,len>>>24&255,len>>>16&255,len>>>8&255,255&len,offset>>>24&255,offset>>>16&255,offset>>>8&255,255&offset],0),i=0;i<len;i++)sample=samples[i],duration=sample.duration,size=sample.size,flags=sample.flags,cts=sample.cts,array.set([duration>>>24&255,duration>>>16&255,duration>>>8&255,255&duration,size>>>24&255,size>>>16&255,size>>>8&255,255&size,flags.isLeading<<2|flags.dependsOn,flags.isDependedOn<<6|flags.hasRedundancy<<4|flags.paddingValue<<1|flags.isNonSync,61440&flags.degradPrio,15&flags.degradPrio,cts>>>24&255,cts>>>16&255,cts>>>8&255,255&cts],12+16*i);return MP4.box(MP4.types.trun,array)}static initSegment(tracks){MP4.types||MP4.init();const movie=MP4.moov(tracks);return appendUint8Array(MP4.FTYP,movie)}}MP4.types=void 0,MP4.HDLR_TYPES=void 0,MP4.STTS=void 0,MP4.STSC=void 0,MP4.STCO=void 0,MP4.STSZ=void 0,MP4.VMHD=void 0,MP4.SMHD=void 0,MP4.STSD=void 0,MP4.FTYP=void 0,MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(baseTime,destScale,srcBase=1,round=!1){const result=baseTime*destScale*srcBase;return round?Math.round(result):result}function toMsFromMpegTsClock(baseTime,round=!1){return toTimescaleFromBase(baseTime,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,round)}let now,chromeVersion=null,safariWebkitVersion=null;class MP4Remuxer{constructor(observer,config,typeSupported,vendor=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=observer,this.config=config,this.typeSupported=typeSupported,this.ISGenerated=!1,null===chromeVersion){const result=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=result?parseInt(result[1]):0}if(null===safariWebkitVersion){const result=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=result?parseInt(result[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(defaultTimeStamp){logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=defaultTimeStamp}resetNextTimestamp(){logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(videoSamples){let rolloverDetected=!1;const startPTS=videoSamples.reduce(((minPTS,sample)=>{const delta=sample.pts-minPTS;return delta<-4294967296?(rolloverDetected=!0,normalizePts(minPTS,sample.pts)):delta>0?minPTS:sample.pts}),videoSamples[0].pts);return rolloverDetected&&logger.debug("PTS rollover detected"),startPTS}remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,accurateTimeOffset,flush,playlistType){let video,audio,initSegment,text,id3,independent,audioTimeOffset=timeOffset,videoTimeOffset=timeOffset;const hasAudio=audioTrack.pid>-1,hasVideo=videoTrack.pid>-1,length=videoTrack.samples.length,enoughAudioSamples=audioTrack.samples.length>0,enoughVideoSamples=flush&&length>0||length>1;if((!hasAudio||enoughAudioSamples)&&(!hasVideo||enoughVideoSamples)||this.ISGenerated||flush){if(this.ISGenerated){var _videoTrack$pixelRati,_config$pixelRatio,_videoTrack$pixelRati2,_config$pixelRatio2;const config=this.videoTrackConfig;!config||videoTrack.width===config.width&&videoTrack.height===config.height&&(null==(_videoTrack$pixelRati=videoTrack.pixelRatio)?void 0:_videoTrack$pixelRati[0])===(null==(_config$pixelRatio=config.pixelRatio)?void 0:_config$pixelRatio[0])&&(null==(_videoTrack$pixelRati2=videoTrack.pixelRatio)?void 0:_videoTrack$pixelRati2[1])===(null==(_config$pixelRatio2=config.pixelRatio)?void 0:_config$pixelRatio2[1])||this.resetInitSegment()}else initSegment=this.generateIS(audioTrack,videoTrack,timeOffset,accurateTimeOffset);const isVideoContiguous=this.isVideoContiguous;let firstKeyFramePTS,firstKeyFrameIndex=-1;if(enoughVideoSamples&&(firstKeyFrameIndex=function findKeyframeIndex(samples){for(let i=0;i<samples.length;i++)if(samples[i].key)return i;return-1}(videoTrack.samples),!isVideoContiguous&&this.config.forceKeyFrameOnDiscontinuity))if(independent=!0,firstKeyFrameIndex>0){logger.warn(`[mp4-remuxer]: Dropped ${firstKeyFrameIndex} out of ${length} video samples due to a missing keyframe`);const startPTS=this.getVideoStartPts(videoTrack.samples);videoTrack.samples=videoTrack.samples.slice(firstKeyFrameIndex),videoTrack.dropped+=firstKeyFrameIndex,videoTimeOffset+=(videoTrack.samples[0].pts-startPTS)/videoTrack.inputTimeScale,firstKeyFramePTS=videoTimeOffset}else-1===firstKeyFrameIndex&&(logger.warn(`[mp4-remuxer]: No keyframe found out of ${length} video samples`),independent=!1);if(this.ISGenerated){if(enoughAudioSamples&&enoughVideoSamples){const startPTS=this.getVideoStartPts(videoTrack.samples),audiovideoTimestampDelta=(normalizePts(audioTrack.samples[0].pts,startPTS)-startPTS)/videoTrack.inputTimeScale;audioTimeOffset+=Math.max(0,audiovideoTimestampDelta),videoTimeOffset+=Math.max(0,-audiovideoTimestampDelta)}if(enoughAudioSamples){if(audioTrack.samplerate||(logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),initSegment=this.generateIS(audioTrack,videoTrack,timeOffset,accurateTimeOffset)),audio=this.remuxAudio(audioTrack,audioTimeOffset,this.isAudioContiguous,accurateTimeOffset,hasVideo||enoughVideoSamples||playlistType===PlaylistLevelType_AUDIO?videoTimeOffset:void 0),enoughVideoSamples){const audioTrackLength=audio?audio.endPTS-audio.startPTS:0;videoTrack.inputTimeScale||(logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),initSegment=this.generateIS(audioTrack,videoTrack,timeOffset,accurateTimeOffset)),video=this.remuxVideo(videoTrack,videoTimeOffset,isVideoContiguous,audioTrackLength)}}else enoughVideoSamples&&(video=this.remuxVideo(videoTrack,videoTimeOffset,isVideoContiguous,0));video&&(video.firstKeyFrame=firstKeyFrameIndex,video.independent=-1!==firstKeyFrameIndex,video.firstKeyFramePTS=firstKeyFramePTS)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(id3Track.samples.length&&(id3=flushTextTrackMetadataCueSamples(id3Track,timeOffset,this._initPTS,this._initDTS)),textTrack.samples.length&&(text=flushTextTrackUserdataCueSamples(textTrack,timeOffset,this._initPTS))),{audio,video,initSegment,independent,text,id3}}generateIS(audioTrack,videoTrack,timeOffset,accurateTimeOffset){const audioSamples=audioTrack.samples,videoSamples=videoTrack.samples,typeSupported=this.typeSupported,tracks={},_initPTS=this._initPTS;let initPTS,initDTS,timescale,computePTSDTS=!_initPTS||accurateTimeOffset,container="audio/mp4";if(computePTSDTS&&(initPTS=initDTS=1/0),audioTrack.config&&audioSamples.length){switch(audioTrack.timescale=audioTrack.samplerate,audioTrack.segmentCodec){case"mp3":typeSupported.mpeg?(container="audio/mpeg",audioTrack.codec=""):typeSupported.mp3&&(audioTrack.codec="mp3");break;case"ac3":audioTrack.codec="ac-3"}tracks.audio={id:"audio",container,codec:audioTrack.codec,initSegment:"mp3"===audioTrack.segmentCodec&&typeSupported.mpeg?new Uint8Array(0):MP4.initSegment([audioTrack]),metadata:{channelCount:audioTrack.channelCount}},computePTSDTS&&(timescale=audioTrack.inputTimeScale,_initPTS&&timescale===_initPTS.timescale?computePTSDTS=!1:initPTS=initDTS=audioSamples[0].pts-Math.round(timescale*timeOffset))}if(videoTrack.sps&&videoTrack.pps&&videoSamples.length){if(videoTrack.timescale=videoTrack.inputTimeScale,tracks.video={id:"main",container:"video/mp4",codec:videoTrack.codec,initSegment:MP4.initSegment([videoTrack]),metadata:{width:videoTrack.width,height:videoTrack.height}},computePTSDTS)if(timescale=videoTrack.inputTimeScale,_initPTS&&timescale===_initPTS.timescale)computePTSDTS=!1;else{const startPTS=this.getVideoStartPts(videoSamples),startOffset=Math.round(timescale*timeOffset);initDTS=Math.min(initDTS,normalizePts(videoSamples[0].dts,startPTS)-startOffset),initPTS=Math.min(initPTS,startPTS-startOffset)}this.videoTrackConfig={width:videoTrack.width,height:videoTrack.height,pixelRatio:videoTrack.pixelRatio}}if(Object.keys(tracks).length)return this.ISGenerated=!0,computePTSDTS?(this._initPTS={baseTime:initPTS,timescale},this._initDTS={baseTime:initDTS,timescale}):initPTS=timescale=void 0,{tracks,initPTS,timescale}}remuxVideo(track,timeOffset,contiguous,audioTrackLength){const timeScale=track.inputTimeScale,inputSamples=track.samples,outputSamples=[],nbSamples=inputSamples.length,initPTS=this._initPTS;let firstDTS,lastDTS,nextAvcDts=this.nextAvcDts,offset=8,mp4SampleDuration=this.videoSampleDuration,minPTS=Number.POSITIVE_INFINITY,maxPTS=Number.NEGATIVE_INFINITY,sortSamples=!1;if(!contiguous||null===nextAvcDts){const pts=timeOffset*timeScale,cts=inputSamples[0].pts-normalizePts(inputSamples[0].dts,inputSamples[0].pts);chromeVersion&&null!==nextAvcDts&&Math.abs(pts-cts-nextAvcDts)<15e3?contiguous=!0:nextAvcDts=pts-cts}const initTime=initPTS.baseTime*timeScale/initPTS.timescale;for(let i=0;i<nbSamples;i++){const sample=inputSamples[i];sample.pts=normalizePts(sample.pts-initTime,nextAvcDts),sample.dts=normalizePts(sample.dts-initTime,nextAvcDts),sample.dts<inputSamples[i>0?i-1:i].dts&&(sortSamples=!0)}sortSamples&&inputSamples.sort((function(a,b){const deltadts=a.dts-b.dts,deltapts=a.pts-b.pts;return deltadts||deltapts})),firstDTS=inputSamples[0].dts,lastDTS=inputSamples[inputSamples.length-1].dts;const inputDuration=lastDTS-firstDTS,averageSampleDuration=inputDuration?Math.round(inputDuration/(nbSamples-1)):mp4SampleDuration||track.inputTimeScale/30;if(contiguous){const delta=firstDTS-nextAvcDts,foundHole=delta>averageSampleDuration,foundOverlap=delta<-1;if((foundHole||foundOverlap)&&(foundHole?logger.warn(`AVC: ${toMsFromMpegTsClock(delta,!0)} ms (${delta}dts) hole between fragments detected at ${timeOffset.toFixed(3)}`):logger.warn(`AVC: ${toMsFromMpegTsClock(-delta,!0)} ms (${delta}dts) overlapping between fragments detected at ${timeOffset.toFixed(3)}`),!foundOverlap||nextAvcDts>=inputSamples[0].pts||chromeVersion)){firstDTS=nextAvcDts;const firstPTS=inputSamples[0].pts-delta;if(foundHole)inputSamples[0].dts=firstDTS,inputSamples[0].pts=firstPTS;else for(let i=0;i<inputSamples.length&&!(inputSamples[i].dts>firstPTS);i++)inputSamples[i].dts-=delta,inputSamples[i].pts-=delta;logger.log(`Video: Initial PTS/DTS adjusted: ${toMsFromMpegTsClock(firstPTS,!0)}/${toMsFromMpegTsClock(firstDTS,!0)}, delta: ${toMsFromMpegTsClock(delta,!0)} ms`)}}firstDTS=Math.max(0,firstDTS);let nbNalu=0,naluLen=0,dtsStep=firstDTS;for(let i=0;i<nbSamples;i++){const sample=inputSamples[i],units=sample.units,nbUnits=units.length;let sampleLen=0;for(let j=0;j<nbUnits;j++)sampleLen+=units[j].data.length;naluLen+=sampleLen,nbNalu+=nbUnits,sample.length=sampleLen,sample.dts<dtsStep?(sample.dts=dtsStep,dtsStep+=averageSampleDuration/4|0||1):dtsStep=sample.dts,minPTS=Math.min(sample.pts,minPTS),maxPTS=Math.max(sample.pts,maxPTS)}lastDTS=inputSamples[nbSamples-1].dts;const mdatSize=naluLen+4*nbNalu+8;let mdat;try{mdat=new Uint8Array(mdatSize)}catch(err){return void this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:err,bytes:mdatSize,reason:`fail allocating video mdat ${mdatSize}`})}const view=new DataView(mdat.buffer);view.setUint32(0,mdatSize),mdat.set(MP4.types.mdat,4);let stretchedLastFrame=!1,minDtsDelta=Number.POSITIVE_INFINITY,minPtsDelta=Number.POSITIVE_INFINITY,maxDtsDelta=Number.NEGATIVE_INFINITY,maxPtsDelta=Number.NEGATIVE_INFINITY;for(let i=0;i<nbSamples;i++){const VideoSample=inputSamples[i],VideoSampleUnits=VideoSample.units;let ptsDelta,mp4SampleLength=0;for(let j=0,nbUnits=VideoSampleUnits.length;j<nbUnits;j++){const unit=VideoSampleUnits[j],unitData=unit.data,unitDataLen=unit.data.byteLength;view.setUint32(offset,unitDataLen),offset+=4,mdat.set(unitData,offset),offset+=unitDataLen,mp4SampleLength+=4+unitDataLen}if(i<nbSamples-1)mp4SampleDuration=inputSamples[i+1].dts-VideoSample.dts,ptsDelta=inputSamples[i+1].pts-VideoSample.pts;else{const config=this.config,lastFrameDuration=i>0?VideoSample.dts-inputSamples[i-1].dts:averageSampleDuration;if(ptsDelta=i>0?VideoSample.pts-inputSamples[i-1].pts:averageSampleDuration,config.stretchShortVideoTrack&&null!==this.nextAudioPts){const gapTolerance=Math.floor(config.maxBufferHole*timeScale),deltaToFrameEnd=(audioTrackLength?minPTS+audioTrackLength*timeScale:this.nextAudioPts)-VideoSample.pts;deltaToFrameEnd>gapTolerance?(mp4SampleDuration=deltaToFrameEnd-lastFrameDuration,mp4SampleDuration<0?mp4SampleDuration=lastFrameDuration:stretchedLastFrame=!0,logger.log(`[mp4-remuxer]: It is approximately ${deltaToFrameEnd/90} ms to the next segment; using duration ${mp4SampleDuration/90} ms for the last video frame.`)):mp4SampleDuration=lastFrameDuration}else mp4SampleDuration=lastFrameDuration}const compositionTimeOffset=Math.round(VideoSample.pts-VideoSample.dts);minDtsDelta=Math.min(minDtsDelta,mp4SampleDuration),maxDtsDelta=Math.max(maxDtsDelta,mp4SampleDuration),minPtsDelta=Math.min(minPtsDelta,ptsDelta),maxPtsDelta=Math.max(maxPtsDelta,ptsDelta),outputSamples.push(new Mp4Sample(VideoSample.key,mp4SampleDuration,mp4SampleLength,compositionTimeOffset))}if(outputSamples.length)if(chromeVersion){if(chromeVersion<70){const flags=outputSamples[0].flags;flags.dependsOn=2,flags.isNonSync=0}}else if(safariWebkitVersion&&maxPtsDelta-minPtsDelta<maxDtsDelta-minDtsDelta&&averageSampleDuration/maxDtsDelta<.025&&0===outputSamples[0].cts){logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let dts=firstDTS;for(let i=0,len=outputSamples.length;i<len;i++){const nextDts=dts+outputSamples[i].duration,pts=dts+outputSamples[i].cts;if(i<len-1){const nextPts=nextDts+outputSamples[i+1].cts;outputSamples[i].duration=nextPts-pts}else outputSamples[i].duration=i?outputSamples[i-1].duration:averageSampleDuration;outputSamples[i].cts=0,dts=nextDts}}mp4SampleDuration=stretchedLastFrame||!mp4SampleDuration?averageSampleDuration:mp4SampleDuration,this.nextAvcDts=nextAvcDts=lastDTS+mp4SampleDuration,this.videoSampleDuration=mp4SampleDuration,this.isVideoContiguous=!0;const data={data1:MP4.moof(track.sequenceNumber++,firstDTS,_extends({},track,{samples:outputSamples})),data2:mdat,startPTS:minPTS/timeScale,endPTS:(maxPTS+mp4SampleDuration)/timeScale,startDTS:firstDTS/timeScale,endDTS:nextAvcDts/timeScale,type:"video",hasAudio:!1,hasVideo:!0,nb:outputSamples.length,dropped:track.dropped};return track.samples=[],track.dropped=0,data}getSamplesPerFrame(track){switch(track.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(track,timeOffset,contiguous,accurateTimeOffset,videoTimeOffset){const inputTimeScale=track.inputTimeScale,scaleFactor=inputTimeScale/(track.samplerate?track.samplerate:inputTimeScale),mp4SampleDuration=this.getSamplesPerFrame(track),inputSampleDuration=mp4SampleDuration*scaleFactor,initPTS=this._initPTS,rawMPEG="mp3"===track.segmentCodec&&this.typeSupported.mpeg,outputSamples=[],alignedWithVideo=void 0!==videoTimeOffset;let inputSamples=track.samples,offset=rawMPEG?0:8,nextAudioPts=this.nextAudioPts||-1;const timeOffsetMpegTS=timeOffset*inputTimeScale,initTime=initPTS.baseTime*inputTimeScale/initPTS.timescale;if(this.isAudioContiguous=contiguous=contiguous||inputSamples.length&&nextAudioPts>0&&(accurateTimeOffset&&Math.abs(timeOffsetMpegTS-nextAudioPts)<9e3||Math.abs(normalizePts(inputSamples[0].pts-initTime,timeOffsetMpegTS)-nextAudioPts)<20*inputSampleDuration),inputSamples.forEach((function(sample){sample.pts=normalizePts(sample.pts-initTime,timeOffsetMpegTS)})),!contiguous||nextAudioPts<0){if(inputSamples=inputSamples.filter((sample=>sample.pts>=0)),!inputSamples.length)return;nextAudioPts=0===videoTimeOffset?0:accurateTimeOffset&&!alignedWithVideo?Math.max(0,timeOffsetMpegTS):inputSamples[0].pts}if("aac"===track.segmentCodec){const maxAudioFramesDrift=this.config.maxAudioFramesDrift;for(let i=0,nextPts=nextAudioPts;i<inputSamples.length;i++){const sample=inputSamples[i],pts=sample.pts,delta=pts-nextPts,duration=Math.abs(1e3*delta/inputTimeScale);if(delta<=-maxAudioFramesDrift*inputSampleDuration&&alignedWithVideo)0===i&&(logger.warn(`Audio frame @ ${(pts/inputTimeScale).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*delta/inputTimeScale)} ms.`),this.nextAudioPts=nextAudioPts=nextPts=pts);else if(delta>=maxAudioFramesDrift*inputSampleDuration&&duration<1e4&&alignedWithVideo){let missing=Math.round(delta/inputSampleDuration);nextPts=pts-missing*inputSampleDuration,nextPts<0&&(missing--,nextPts+=inputSampleDuration),0===i&&(this.nextAudioPts=nextAudioPts=nextPts),logger.warn(`[mp4-remuxer]: Injecting ${missing} audio frame @ ${(nextPts/inputTimeScale).toFixed(3)}s due to ${Math.round(1e3*delta/inputTimeScale)} ms gap.`);for(let j=0;j<missing;j++){const newStamp=Math.max(nextPts,0);let fillFrame=AAC.getSilentFrame(track.manifestCodec||track.codec,track.channelCount);fillFrame||(logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),fillFrame=sample.unit.subarray()),inputSamples.splice(i,0,{unit:fillFrame,pts:newStamp}),nextPts+=inputSampleDuration,i++}}sample.pts=nextPts,nextPts+=inputSampleDuration}}let mdat,firstPTS=null,lastPTS=null,mdatSize=0,sampleLength=inputSamples.length;for(;sampleLength--;)mdatSize+=inputSamples[sampleLength].unit.byteLength;for(let j=0,_nbSamples=inputSamples.length;j<_nbSamples;j++){const audioSample=inputSamples[j],unit=audioSample.unit;let pts=audioSample.pts;if(null!==lastPTS){outputSamples[j-1].duration=Math.round((pts-lastPTS)/scaleFactor)}else{if(contiguous&&"aac"===track.segmentCodec&&(pts=nextAudioPts),firstPTS=pts,!(mdatSize>0))return;mdatSize+=offset;try{mdat=new Uint8Array(mdatSize)}catch(err){return void this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:err,bytes:mdatSize,reason:`fail allocating audio mdat ${mdatSize}`})}if(!rawMPEG){new DataView(mdat.buffer).setUint32(0,mdatSize),mdat.set(MP4.types.mdat,4)}}mdat.set(unit,offset);const unitLen=unit.byteLength;offset+=unitLen,outputSamples.push(new Mp4Sample(!0,mp4SampleDuration,unitLen,0)),lastPTS=pts}const nbSamples=outputSamples.length;if(!nbSamples)return;const lastSample=outputSamples[outputSamples.length-1];this.nextAudioPts=nextAudioPts=lastPTS+scaleFactor*lastSample.duration;const moof=rawMPEG?new Uint8Array(0):MP4.moof(track.sequenceNumber++,firstPTS/scaleFactor,_extends({},track,{samples:outputSamples}));track.samples=[];const start=firstPTS/inputTimeScale,end=nextAudioPts/inputTimeScale,audioData={data1:moof,data2:mdat,startPTS:start,endPTS:end,startDTS:start,endDTS:end,type:"audio",hasAudio:!0,hasVideo:!1,nb:nbSamples};return this.isAudioContiguous=!0,audioData}remuxEmptyAudio(track,timeOffset,contiguous,videoData){const inputTimeScale=track.inputTimeScale,scaleFactor=inputTimeScale/(track.samplerate?track.samplerate:inputTimeScale),nextAudioPts=this.nextAudioPts,initDTS=this._initDTS,init90kHz=9e4*initDTS.baseTime/initDTS.timescale,startDTS=(null!==nextAudioPts?nextAudioPts:videoData.startDTS*inputTimeScale)+init90kHz,endDTS=videoData.endDTS*inputTimeScale+init90kHz,frameDuration=1024*scaleFactor,nbSamples=Math.ceil((endDTS-startDTS)/frameDuration),silentFrame=AAC.getSilentFrame(track.manifestCodec||track.codec,track.channelCount);if(logger.warn("[mp4-remuxer]: remux empty Audio"),!silentFrame)return void logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const samples=[];for(let i=0;i<nbSamples;i++){const stamp=startDTS+i*frameDuration;samples.push({unit:silentFrame,pts:stamp,dts:stamp})}return track.samples=samples,this.remuxAudio(track,timeOffset,contiguous,!1)}}function normalizePts(value,reference){let offset;if(null===reference)return value;for(offset=reference<value?-8589934592:8589934592;Math.abs(value-reference)>4294967296;)value+=offset;return value}function flushTextTrackMetadataCueSamples(track,timeOffset,initPTS,initDTS){const length=track.samples.length;if(!length)return;const inputTimeScale=track.inputTimeScale;for(let index=0;index<length;index++){const sample=track.samples[index];sample.pts=normalizePts(sample.pts-initPTS.baseTime*inputTimeScale/initPTS.timescale,timeOffset*inputTimeScale)/inputTimeScale,sample.dts=normalizePts(sample.dts-initDTS.baseTime*inputTimeScale/initDTS.timescale,timeOffset*inputTimeScale)/inputTimeScale}const samples=track.samples;return track.samples=[],{samples}}function flushTextTrackUserdataCueSamples(track,timeOffset,initPTS){const length=track.samples.length;if(!length)return;const inputTimeScale=track.inputTimeScale;for(let index=0;index<length;index++){const sample=track.samples[index];sample.pts=normalizePts(sample.pts-initPTS.baseTime*inputTimeScale/initPTS.timescale,timeOffset*inputTimeScale)/inputTimeScale}track.samples.sort(((a,b)=>a.pts-b.pts));const samples=track.samples;return track.samples=[],{samples}}class Mp4Sample{constructor(isKeyframe,duration,size,cts){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=duration,this.size=size,this.cts=cts,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:isKeyframe?2:1,isNonSync:isKeyframe?0:1}}}function getParsedTrackCodec(track,type){const parsedCodec=null==track?void 0:track.codec;if(parsedCodec&&parsedCodec.length>4)return parsedCodec;if(type===ElementaryStreamTypes_AUDIO){if("ec-3"===parsedCodec||"ac-3"===parsedCodec||"alac"===parsedCodec)return parsedCodec;if("fLaC"===parsedCodec||"Opus"===parsedCodec){return getCodecCompatibleName(parsedCodec,!1)}const result="mp4a.40.5";return logger.info(`Parsed audio codec "${parsedCodec}" or audio object type not handled. Using "${result}"`),result}return logger.warn(`Unhandled video codec "${parsedCodec}"`),"hvc1"===parsedCodec||"hev1"===parsedCodec?"hvc1.1.6.L120.90":"av01"===parsedCodec?"av01.0.04M.08":"avc1.42e01e"}try{now=self.performance.now.bind(self.performance)}catch(err){logger.debug("Unable to use Performance API on this environment"),now=null==optionalSelf?void 0:optionalSelf.Date.now}const muxConfig=[{demux:class MP4Demuxer{constructor(observer,config){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=config}resetTimeStamp(){}resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){const videoTrack=this.videoTrack=dummyTrack("video",1),audioTrack=this.audioTrack=dummyTrack("audio",1),captionTrack=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,null==initSegment||!initSegment.byteLength)return;const initData=parseInitSegment(initSegment);if(initData.video){const{id,timescale,codec}=initData.video;videoTrack.id=id,videoTrack.timescale=captionTrack.timescale=timescale,videoTrack.codec=codec}if(initData.audio){const{id,timescale,codec}=initData.audio;audioTrack.id=id,audioTrack.timescale=timescale,audioTrack.codec=codec}captionTrack.id=RemuxerTrackIdConfig.text,videoTrack.sampleDuration=0,videoTrack.duration=audioTrack.duration=trackDuration}resetContiguity(){this.remainderData=null}static probe(data){return function hasMoofData(data){const end=data.byteLength;for(let i=0;i<end;){const size=readUint32(data,i);if(size>8&&109===data[i+4]&&111===data[i+5]&&111===data[i+6]&&102===data[i+7])return!0;i=size>1?i+size:end}return!1}(data)}demux(data,timeOffset){this.timeOffset=timeOffset;let videoSamples=data;const videoTrack=this.videoTrack,textTrack=this.txtTrack;if(this.config.progressive){this.remainderData&&(videoSamples=appendUint8Array(this.remainderData,data));const segmentedData=function segmentValidRange(data){const segmentedRange={valid:null,remainder:null},moofs=findBox(data,["moof"]);if(moofs.length<2)return segmentedRange.remainder=data,segmentedRange;const last=moofs[moofs.length-1];return segmentedRange.valid=sliceUint8(data,0,last.byteOffset-8),segmentedRange.remainder=sliceUint8(data,last.byteOffset-8),segmentedRange}(videoSamples);this.remainderData=segmentedData.remainder,videoTrack.samples=segmentedData.valid||new Uint8Array}else videoTrack.samples=videoSamples;const id3Track=this.extractID3Track(videoTrack,timeOffset);return textTrack.samples=parseSamples(timeOffset,videoTrack),{videoTrack,audioTrack:this.audioTrack,id3Track,textTrack:this.txtTrack}}flush(){const timeOffset=this.timeOffset,videoTrack=this.videoTrack,textTrack=this.txtTrack;videoTrack.samples=this.remainderData||new Uint8Array,this.remainderData=null;const id3Track=this.extractID3Track(videoTrack,this.timeOffset);return textTrack.samples=parseSamples(timeOffset,videoTrack),{videoTrack,audioTrack:dummyTrack(),id3Track,textTrack:dummyTrack()}}extractID3Track(videoTrack,timeOffset){const id3Track=this.id3Track;if(videoTrack.samples.length){const emsgs=findBox(videoTrack.samples,["emsg"]);emsgs&&emsgs.forEach((data=>{const emsgInfo=function parseEmsg(data){const version=data[0];let schemeIdUri="",value="",timeScale=0,presentationTimeDelta=0,presentationTime=0,eventDuration=0,id=0,offset=0;if(0===version){for(;"\0"!==bin2str(data.subarray(offset,offset+1));)schemeIdUri+=bin2str(data.subarray(offset,offset+1)),offset+=1;for(schemeIdUri+=bin2str(data.subarray(offset,offset+1)),offset+=1;"\0"!==bin2str(data.subarray(offset,offset+1));)value+=bin2str(data.subarray(offset,offset+1)),offset+=1;value+=bin2str(data.subarray(offset,offset+1)),offset+=1,timeScale=readUint32(data,12),presentationTimeDelta=readUint32(data,16),eventDuration=readUint32(data,20),id=readUint32(data,24),offset=28}else if(1===version){offset+=4,timeScale=readUint32(data,offset),offset+=4;const leftPresentationTime=readUint32(data,offset);offset+=4;const rightPresentationTime=readUint32(data,offset);for(offset+=4,presentationTime=2**32*leftPresentationTime+rightPresentationTime,isSafeInteger(presentationTime)||(presentationTime=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),eventDuration=readUint32(data,offset),offset+=4,id=readUint32(data,offset),offset+=4;"\0"!==bin2str(data.subarray(offset,offset+1));)schemeIdUri+=bin2str(data.subarray(offset,offset+1)),offset+=1;for(schemeIdUri+=bin2str(data.subarray(offset,offset+1)),offset+=1;"\0"!==bin2str(data.subarray(offset,offset+1));)value+=bin2str(data.subarray(offset,offset+1)),offset+=1;value+=bin2str(data.subarray(offset,offset+1)),offset+=1}return{schemeIdUri,value,timeScale,presentationTime,presentationTimeDelta,eventDuration,id,payload:data.subarray(offset,data.byteLength)}}(data);if(emsgSchemePattern.test(emsgInfo.schemeIdUri)){const pts=isFiniteNumber(emsgInfo.presentationTime)?emsgInfo.presentationTime/emsgInfo.timeScale:timeOffset+emsgInfo.presentationTimeDelta/emsgInfo.timeScale;let duration=4294967295===emsgInfo.eventDuration?Number.POSITIVE_INFINITY:emsgInfo.eventDuration/emsgInfo.timeScale;duration<=.001&&(duration=Number.POSITIVE_INFINITY);const payload=emsgInfo.payload;id3Track.samples.push({data:payload,len:payload.byteLength,dts:pts,pts,type:MetadataSchema_emsg,duration})}}))}return id3Track}demuxSampleAes(data,keyData,timeOffset){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class PassThroughRemuxer{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(defaultInitPTS){this.initPTS=defaultInitPTS,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(initSegment,audioCodec,videoCodec,decryptdata){this.audioCodec=audioCodec,this.videoCodec=videoCodec,this.generateInitSegment(function patchEncyptionData(initSegment,decryptdata){if(!initSegment||!decryptdata)return initSegment;const keyId=decryptdata.keyId;keyId&&decryptdata.isCommonEncryption&&findBox(initSegment,["moov","trak"]).forEach((trak=>{const sampleEntries=findBox(trak,["mdia","minf","stbl","stsd"])[0].subarray(8);let encBoxes=findBox(sampleEntries,["enca"]);const isAudio=encBoxes.length>0;isAudio||(encBoxes=findBox(sampleEntries,["encv"])),encBoxes.forEach((enc=>{findBox(isAudio?enc.subarray(28):enc.subarray(78),["sinf"]).forEach((sinf=>{const tenc=parseSinf(sinf);if(tenc){const tencKeyId=tenc.subarray(8,24);tencKeyId.some((b=>0!==b))||(logger.log(`[eme] Patching keyId in 'enc${isAudio?"a":"v"}>sinf>>tenc' box: ${Hex_hexDump(tencKeyId)} -> ${Hex_hexDump(keyId)}`),tenc.set(keyId,8))}}))}))}));return initSegment}(initSegment,decryptdata)),this.emitInitSegment=!0}generateInitSegment(initSegment){let{audioCodec,videoCodec}=this;if(null==initSegment||!initSegment.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const initData=this.initData=parseInitSegment(initSegment);initData.audio&&(audioCodec=getParsedTrackCodec(initData.audio,ElementaryStreamTypes_AUDIO)),initData.video&&(videoCodec=getParsedTrackCodec(initData.video,ElementaryStreamTypes_VIDEO));const tracks={};initData.audio&&initData.video?tracks.audiovideo={container:"video/mp4",codec:audioCodec+","+videoCodec,initSegment,id:"main"}:initData.audio?tracks.audio={container:"audio/mp4",codec:audioCodec,initSegment,id:"audio"}:initData.video?tracks.video={container:"video/mp4",codec:videoCodec,initSegment,id:"main"}:logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=tracks}remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,accurateTimeOffset){var _initData,_initData2;let{initPTS,lastEndTime}=this;const result={audio:void 0,video:void 0,text:textTrack,id3:id3Track,initSegment:void 0};isFiniteNumber(lastEndTime)||(lastEndTime=this.lastEndTime=timeOffset||0);const data=videoTrack.samples;if(null==data||!data.length)return result;const initSegment={initPTS:void 0,timescale:1};let initData=this.initData;if(null!=(_initData=initData)&&_initData.length||(this.generateInitSegment(data),initData=this.initData),null==(_initData2=initData)||!_initData2.length)return logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),result;this.emitInitSegment&&(initSegment.tracks=this.initTracks,this.emitInitSegment=!1);const duration=function getDuration(data,initData){let rawDuration=0,videoDuration=0,audioDuration=0;const trafs=findBox(data,["moof","traf"]);for(let i=0;i<trafs.length;i++){const traf=trafs[i],tfhd=findBox(traf,["tfhd"])[0],track=initData[readUint32(tfhd,4)];if(!track)continue;const trackDefault=track.default,tfhdFlags=readUint32(tfhd,0)|(null==trackDefault?void 0:trackDefault.flags);let sampleDuration=null==trackDefault?void 0:trackDefault.duration;8&tfhdFlags&&(sampleDuration=readUint32(tfhd,2&tfhdFlags?12:8));const timescale=track.timescale||9e4,truns=findBox(traf,["trun"]);for(let j=0;j<truns.length;j++)rawDuration=computeRawDurationFromSamples(truns[j]),!rawDuration&&sampleDuration&&(rawDuration=sampleDuration*readUint32(truns[j],4)),track.type===ElementaryStreamTypes_VIDEO?videoDuration+=rawDuration/timescale:track.type===ElementaryStreamTypes_AUDIO&&(audioDuration+=rawDuration/timescale)}if(0===videoDuration&&0===audioDuration){let sidxMinStart=1/0,sidxMaxEnd=0,sidxDuration=0;const sidxs=findBox(data,["sidx"]);for(let i=0;i<sidxs.length;i++){const sidx=parseSegmentIndex(sidxs[i]);if(null!=sidx&&sidx.references){sidxMinStart=Math.min(sidxMinStart,sidx.earliestPresentationTime/sidx.timescale);const subSegmentDuration=sidx.references.reduce(((dur,ref)=>dur+ref.info.duration||0),0);sidxMaxEnd=Math.max(sidxMaxEnd,subSegmentDuration+sidx.earliestPresentationTime/sidx.timescale),sidxDuration=sidxMaxEnd-sidxMinStart}}if(sidxDuration&&isFiniteNumber(sidxDuration))return sidxDuration}return videoDuration||audioDuration}(data,initData),startDTS=function getStartDTS(initData,fmp4){return findBox(fmp4,["moof","traf"]).reduce(((result,traf)=>{const tfdt=findBox(traf,["tfdt"])[0],version=tfdt[0],start=findBox(traf,["tfhd"]).reduce(((result,tfhd)=>{const id=readUint32(tfhd,4),track=initData[id];if(track){let baseTime=readUint32(tfdt,4);if(1===version){if(baseTime===UINT32_MAX$1)return logger.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),result;baseTime*=UINT32_MAX$1+1,baseTime+=readUint32(tfdt,8)}const startTime=baseTime/(track.timescale||9e4);if(isFiniteNumber(startTime)&&(null===result||startTime<result))return startTime}return result}),null);return null!==start&&isFiniteNumber(start)&&(null===result||start<result)?start:result}),null)}(initData,data),decodeTime=null===startDTS?timeOffset:startDTS;(function isInvalidInitPts(initPTS,startDTS,timeOffset,duration){if(null===initPTS)return!0;const minDuration=Math.max(duration,1),startTime=startDTS-initPTS.baseTime/initPTS.timescale;return Math.abs(startTime-timeOffset)>minDuration}(initPTS,decodeTime,timeOffset,duration)||initSegment.timescale!==initPTS.timescale&&accurateTimeOffset)&&(initSegment.initPTS=decodeTime-timeOffset,initPTS&&1===initPTS.timescale&&logger.warn("Adjusting initPTS by "+(initSegment.initPTS-initPTS.baseTime)),this.initPTS=initPTS={baseTime:initSegment.initPTS,timescale:1});const startTime=audioTrack?decodeTime-initPTS.baseTime/initPTS.timescale:lastEndTime,endTime=startTime+duration;!function offsetStartDTS(initData,fmp4,timeOffset){findBox(fmp4,["moof","traf"]).forEach((traf=>{findBox(traf,["tfhd"]).forEach((tfhd=>{const id=readUint32(tfhd,4),track=initData[id];if(!track)return;const timescale=track.timescale||9e4;findBox(traf,["tfdt"]).forEach((tfdt=>{const version=tfdt[0],offset=timeOffset*timescale;if(offset){let baseMediaDecodeTime=readUint32(tfdt,4);if(0===version)baseMediaDecodeTime-=offset,baseMediaDecodeTime=Math.max(baseMediaDecodeTime,0),writeUint32(tfdt,4,baseMediaDecodeTime);else{baseMediaDecodeTime*=Math.pow(2,32),baseMediaDecodeTime+=readUint32(tfdt,8),baseMediaDecodeTime-=offset,baseMediaDecodeTime=Math.max(baseMediaDecodeTime,0);const upper=Math.floor(baseMediaDecodeTime/(UINT32_MAX$1+1)),lower=Math.floor(baseMediaDecodeTime%(UINT32_MAX$1+1));writeUint32(tfdt,4,upper),writeUint32(tfdt,8,lower)}}}))}))}))}(initData,data,initPTS.baseTime/initPTS.timescale),duration>0?this.lastEndTime=endTime:(logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const hasAudio=!!initData.audio,hasVideo=!!initData.video;let type="";hasAudio&&(type+="audio"),hasVideo&&(type+="video");const track={data1:data,startPTS:startTime,startDTS:startTime,endPTS:endTime,endDTS:endTime,type,hasAudio,hasVideo,nb:1,dropped:0};return result.audio="audio"===track.type?track:void 0,result.video="audio"!==track.type?track:void 0,result.initSegment=initSegment,result.id3=flushTextTrackMetadataCueSamples(id3Track,timeOffset,initPTS,initPTS),textTrack.samples.length&&(result.text=flushTextTrackUserdataCueSamples(textTrack,timeOffset,initPTS)),result}}},{demux:TSDemuxer,remux:MP4Remuxer},{demux:class AACDemuxer extends BaseAudioDemuxer{constructor(observer,config){super(),this.observer=void 0,this.config=void 0,this.observer=observer,this.config=config}resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){super.resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:audioCodec,duration:trackDuration,inputTimeScale:9e4,dropped:0}}static probe(data){if(!data)return!1;const id3Data=getID3Data(data,0);let offset=(null==id3Data?void 0:id3Data.length)||0;if(probe(data,offset))return!1;for(let length=data.length;offset<length;offset++)if(probe$1(data,offset))return logger.log("ADTS sync word found !"),!0;return!1}canParse(data,offset){return function canParse$1(data,offset){return function canGetFrameLength(data,offset){return offset+5<data.length}(data,offset)&&isHeaderPattern$1(data,offset)&&getFullFrameLength(data,offset)<=data.length-offset}(data,offset)}appendFrame(track,data,offset){initTrackConfig(track,this.observer,data,offset,track.manifestCodec);const frame=appendFrame$2(track,data,offset,this.basePTS,this.frameIndex);if(frame&&0===frame.missing)return frame}},remux:MP4Remuxer},{demux:class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration){super.resetInitSegment(initSegment,audioCodec,videoCodec,trackDuration),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:audioCodec,duration:trackDuration,inputTimeScale:9e4,dropped:0}}static probe(data){if(!data)return!1;const id3Data=getID3Data(data,0);let offset=(null==id3Data?void 0:id3Data.length)||0;if(id3Data&&11===data[offset]&&119===data[offset+1]&&void 0!==getTimeStamp(id3Data)&&getAudioBSID(data,offset)<=16)return!1;for(let length=data.length;offset<length;offset++)if(probe(data,offset))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(data,offset){return function canParse(data,offset){return isHeaderPattern(data,offset)&&4<=data.length-offset}(data,offset)}appendFrame(track,data,offset){if(null!==this.basePTS)return appendFrame$1(track,data,offset,this.basePTS,this.frameIndex)}},remux:MP4Remuxer}];muxConfig.splice(2,0,{demux:AC3Demuxer,remux:MP4Remuxer});class Transmuxer{constructor(observer,typeSupported,config,vendor,id){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=observer,this.typeSupported=typeSupported,this.config=config,this.vendor=vendor,this.id=id}configure(transmuxConfig){this.transmuxConfig=transmuxConfig,this.decrypter&&this.decrypter.reset()}push(data,decryptdata,chunkMeta,state){const stats=chunkMeta.transmuxing;stats.executeStart=now();let uintData=new Uint8Array(data);const{currentTransmuxState,transmuxConfig}=this;state&&(this.currentTransmuxState=state);const{contiguous,discontinuity,trackSwitch,accurateTimeOffset,timeOffset,initSegmentChange}=state||currentTransmuxState,{audioCodec,videoCodec,defaultInitPts,duration,initSegmentData}=transmuxConfig,keyData=function getEncryptionType(data,decryptData){let encryptionType=null;data.byteLength>0&&null!=(null==decryptData?void 0:decryptData.key)&&null!==decryptData.iv&&null!=decryptData.method&&(encryptionType=decryptData);return encryptionType}(uintData,decryptdata);if(keyData&&"AES-128"===keyData.method){const decrypter=this.getDecrypter();if(!decrypter.isSync())return this.decryptionPromise=decrypter.webCryptoDecrypt(uintData,keyData.key.buffer,keyData.iv.buffer).then((decryptedData=>{const result=this.push(decryptedData,null,chunkMeta);return this.decryptionPromise=null,result})),this.decryptionPromise;{let decryptedData=decrypter.softwareDecrypt(uintData,keyData.key.buffer,keyData.iv.buffer);if(chunkMeta.part>-1&&(decryptedData=decrypter.flush()),!decryptedData)return stats.executeEnd=now(),emptyResult(chunkMeta);uintData=new Uint8Array(decryptedData)}}const resetMuxers=this.needsProbing(discontinuity,trackSwitch);if(resetMuxers){const error=this.configureTransmuxer(uintData);if(error)return logger.warn(`[transmuxer] ${error.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error,reason:error.message}),stats.executeEnd=now(),emptyResult(chunkMeta)}(discontinuity||trackSwitch||initSegmentChange||resetMuxers)&&this.resetInitSegment(initSegmentData,audioCodec,videoCodec,duration,decryptdata),(discontinuity||initSegmentChange||resetMuxers)&&this.resetInitialTimestamp(defaultInitPts),contiguous||this.resetContiguity();const result=this.transmux(uintData,keyData,timeOffset,accurateTimeOffset,chunkMeta),currentState=this.currentTransmuxState;return currentState.contiguous=!0,currentState.discontinuity=!1,currentState.trackSwitch=!1,stats.executeEnd=now(),result}flush(chunkMeta){const stats=chunkMeta.transmuxing;stats.executeStart=now();const{decrypter,currentTransmuxState,decryptionPromise}=this;if(decryptionPromise)return decryptionPromise.then((()=>this.flush(chunkMeta)));const transmuxResults=[],{timeOffset}=currentTransmuxState;if(decrypter){const decryptedData=decrypter.flush();decryptedData&&transmuxResults.push(this.push(decryptedData,null,chunkMeta))}const{demuxer,remuxer}=this;if(!demuxer||!remuxer)return stats.executeEnd=now(),[emptyResult(chunkMeta)];const demuxResultOrPromise=demuxer.flush(timeOffset);return isPromise(demuxResultOrPromise)?demuxResultOrPromise.then((demuxResult=>(this.flushRemux(transmuxResults,demuxResult,chunkMeta),transmuxResults))):(this.flushRemux(transmuxResults,demuxResultOrPromise,chunkMeta),transmuxResults)}flushRemux(transmuxResults,demuxResult,chunkMeta){const{audioTrack,videoTrack,id3Track,textTrack}=demuxResult,{accurateTimeOffset,timeOffset}=this.currentTransmuxState;logger.log(`[transmuxer.ts]: Flushed fragment ${chunkMeta.sn}${chunkMeta.part>-1?" p: "+chunkMeta.part:""} of level ${chunkMeta.level}`);const remuxResult=this.remuxer.remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,accurateTimeOffset,!0,this.id);transmuxResults.push({remuxResult,chunkMeta}),chunkMeta.transmuxing.executeEnd=now()}resetInitialTimestamp(defaultInitPts){const{demuxer,remuxer}=this;demuxer&&remuxer&&(demuxer.resetTimeStamp(defaultInitPts),remuxer.resetTimeStamp(defaultInitPts))}resetContiguity(){const{demuxer,remuxer}=this;demuxer&&remuxer&&(demuxer.resetContiguity(),remuxer.resetNextTimestamp())}resetInitSegment(initSegmentData,audioCodec,videoCodec,trackDuration,decryptdata){const{demuxer,remuxer}=this;demuxer&&remuxer&&(demuxer.resetInitSegment(initSegmentData,audioCodec,videoCodec,trackDuration),remuxer.resetInitSegment(initSegmentData,audioCodec,videoCodec,decryptdata))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(data,keyData,timeOffset,accurateTimeOffset,chunkMeta){let result;return result=keyData&&"SAMPLE-AES"===keyData.method?this.transmuxSampleAes(data,keyData,timeOffset,accurateTimeOffset,chunkMeta):this.transmuxUnencrypted(data,timeOffset,accurateTimeOffset,chunkMeta),result}transmuxUnencrypted(data,timeOffset,accurateTimeOffset,chunkMeta){const{audioTrack,videoTrack,id3Track,textTrack}=this.demuxer.demux(data,timeOffset,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(audioTrack,videoTrack,id3Track,textTrack,timeOffset,accurateTimeOffset,!1,this.id),chunkMeta}}transmuxSampleAes(data,decryptData,timeOffset,accurateTimeOffset,chunkMeta){return this.demuxer.demuxSampleAes(data,decryptData,timeOffset).then((demuxResult=>({remuxResult:this.remuxer.remux(demuxResult.audioTrack,demuxResult.videoTrack,demuxResult.id3Track,demuxResult.textTrack,timeOffset,accurateTimeOffset,!1,this.id),chunkMeta})))}configureTransmuxer(data){const{config,observer,typeSupported,vendor}=this;let mux;for(let i=0,len=muxConfig.length;i<len;i++){var _muxConfig$i$demux;if(null!=(_muxConfig$i$demux=muxConfig[i].demux)&&_muxConfig$i$demux.probe(data)){mux=muxConfig[i];break}}if(!mux)return new Error("Failed to find demuxer by probing fragment data");const demuxer=this.demuxer,remuxer=this.remuxer,Remuxer=mux.remux,Demuxer=mux.demux;remuxer&&remuxer instanceof Remuxer||(this.remuxer=new Remuxer(observer,config,typeSupported,vendor)),demuxer&&demuxer instanceof Demuxer||(this.demuxer=new Demuxer(observer,config,typeSupported),this.probe=Demuxer.probe)}needsProbing(discontinuity,trackSwitch){return!this.demuxer||!this.remuxer||discontinuity||trackSwitch}getDecrypter(){let decrypter=this.decrypter;return decrypter||(decrypter=this.decrypter=new Decrypter(this.config)),decrypter}}const emptyResult=chunkMeta=>({remuxResult:{},chunkMeta});function isPromise(p){return"then"in p&&p.then instanceof Function}class TransmuxConfig{constructor(audioCodec,videoCodec,initSegmentData,duration,defaultInitPts){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=audioCodec,this.videoCodec=videoCodec,this.initSegmentData=initSegmentData,this.duration=duration,this.defaultInitPts=defaultInitPts||null}}class TransmuxState{constructor(discontinuity,contiguous,accurateTimeOffset,trackSwitch,timeOffset,initSegmentChange){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=discontinuity,this.contiguous=contiguous,this.accurateTimeOffset=accurateTimeOffset,this.trackSwitch=trackSwitch,this.timeOffset=timeOffset,this.initSegmentChange=initSegmentChange}}var eventemitter3={exports:{}};!function(module){var has=Object.prototype.hasOwnProperty,prefix="~";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function addListener(emitter,event,fn,context,once){if("function"!=typeof fn)throw new TypeError("The listener must be a function");var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;return emitter._events[evt]?emitter._events[evt].fn?emitter._events[evt]=[emitter._events[evt],listener]:emitter._events[evt].push(listener):(emitter._events[evt]=listener,emitter._eventsCount++),emitter}function clearEvent(emitter,evt){0==--emitter._eventsCount?emitter._events=new Events:delete emitter._events[evt]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function eventNames(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function listeners(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++)ee[i]=handlers[i].fn;return ee},EventEmitter.prototype.listenerCount=function listenerCount(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];return listeners?listeners.fn?1:listeners.length:0},EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function on(event,fn,context){return addListener(this,event,fn,context,!1)},EventEmitter.prototype.once=function once(event,fn,context){return addListener(this,event,fn,context,!0)},EventEmitter.prototype.removeListener=function removeListener(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return clearEvent(this,evt),this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||clearEvent(this,evt);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:clearEvent(this,evt)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){var evt;return event?(evt=prefix?prefix+event:event,this._events[evt]&&clearEvent(this,evt)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,module.exports=EventEmitter}(eventemitter3);var EventEmitter=getDefaultExportFromCjs(eventemitter3.exports);class TransmuxerInterface{constructor(hls,id,onTransmuxComplete,onFlush){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const config=hls.config;this.hls=hls,this.id=id,this.useWorker=!!config.enableWorker,this.onTransmuxComplete=onTransmuxComplete,this.onFlush=onFlush;const forwardMessage=(ev,data)=>{(data=data||{}).frag=this.frag,data.id=this.id,ev===Events.ERROR&&(this.error=data.error),this.hls.trigger(ev,data)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,forwardMessage),this.observer.on(Events.ERROR,forwardMessage);const MediaSource=getMediaSource(config.preferManagedMediaSource)||{isTypeSupported:()=>!1},m2tsTypeSupported={mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:MediaSource.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&"undefined"!=typeof Worker){if(config.workerPath||function hasUMDWorker(){return"function"==typeof __HLS_WORKER_BUNDLE__}()){try{config.workerPath?(logger.log(`loading Web Worker ${config.workerPath} for "${id}"`),this.workerContext=function loadWorker(path){const scriptURL=new self.URL(path,self.location.href).href;return{worker:new self.Worker(scriptURL),scriptURL}}(config.workerPath)):(logger.log(`injecting Web Worker for "${id}"`),this.workerContext=function injectWorker(){const blob=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),objectURL=self.URL.createObjectURL(blob);return{worker:new self.Worker(objectURL),objectURL}}()),this.onwmsg=event=>this.onWorkerMessage(event);const{worker}=this.workerContext;worker.addEventListener("message",this.onwmsg),worker.onerror=event=>{const error=new Error(`${event.message}  (${event.filename}:${event.lineno})`);config.enableWorker=!1,logger.warn(`Error in "${id}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error})},worker.postMessage({cmd:"init",typeSupported:m2tsTypeSupported,vendor:"",id,config:JSON.stringify(config)})}catch(err){logger.warn(`Error setting up "${id}" Web Worker, fallback to inline`,err),this.resetWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,m2tsTypeSupported,config,"",id)}return}}this.transmuxer=new Transmuxer(this.observer,m2tsTypeSupported,config,"",id)}resetWorker(){if(this.workerContext){const{worker,objectURL}=this.workerContext;objectURL&&self.URL.revokeObjectURL(objectURL),worker.removeEventListener("message",this.onwmsg),worker.onerror=null,worker.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const transmuxer=this.transmuxer;transmuxer&&(transmuxer.destroy(),this.transmuxer=null)}const observer=this.observer;observer&&observer.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(data,initSegmentData,audioCodec,videoCodec,frag,part,duration,accurateTimeOffset,chunkMeta,defaultInitPTS){var _frag$initSegment,_lastFrag$initSegment;chunkMeta.transmuxing.start=self.performance.now();const{transmuxer}=this,timeOffset=part?part.start:frag.start,decryptdata=frag.decryptdata,lastFrag=this.frag,discontinuity=!(lastFrag&&frag.cc===lastFrag.cc),trackSwitch=!(lastFrag&&chunkMeta.level===lastFrag.level),snDiff=lastFrag?chunkMeta.sn-lastFrag.sn:-1,partDiff=this.part?chunkMeta.part-this.part.index:-1,progressive=0===snDiff&&chunkMeta.id>1&&chunkMeta.id===(null==lastFrag?void 0:lastFrag.stats.chunkCount),contiguous=!trackSwitch&&(1===snDiff||0===snDiff&&(1===partDiff||progressive&&partDiff<=0)),now=self.performance.now();(trackSwitch||snDiff||0===frag.stats.parsing.start)&&(frag.stats.parsing.start=now),!part||!partDiff&&contiguous||(part.stats.parsing.start=now);const initSegmentChange=!(lastFrag&&(null==(_frag$initSegment=frag.initSegment)?void 0:_frag$initSegment.url)===(null==(_lastFrag$initSegment=lastFrag.initSegment)?void 0:_lastFrag$initSegment.url)),state=new TransmuxState(discontinuity,contiguous,accurateTimeOffset,trackSwitch,timeOffset,initSegmentChange);if(!contiguous||discontinuity||initSegmentChange){logger.log(`[transmuxer-interface, ${frag.type}]: Starting new transmux session for sn: ${chunkMeta.sn} p: ${chunkMeta.part} level: ${chunkMeta.level} id: ${chunkMeta.id}\n        discontinuity: ${discontinuity}\n        trackSwitch: ${trackSwitch}\n        contiguous: ${contiguous}\n        accurateTimeOffset: ${accurateTimeOffset}\n        timeOffset: ${timeOffset}\n        initSegmentChange: ${initSegmentChange}`);const config=new TransmuxConfig(audioCodec,videoCodec,initSegmentData,duration,defaultInitPTS);this.configureTransmuxer(config)}if(this.frag=frag,this.part=part,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data,decryptdata,chunkMeta,state},data instanceof ArrayBuffer?[data]:[]);else if(transmuxer){const transmuxResult=transmuxer.push(data,decryptdata,chunkMeta,state);isPromise(transmuxResult)?(transmuxer.async=!0,transmuxResult.then((data=>{this.handleTransmuxComplete(data)})).catch((error=>{this.transmuxerError(error,chunkMeta,"transmuxer-interface push error")}))):(transmuxer.async=!1,this.handleTransmuxComplete(transmuxResult))}}flush(chunkMeta){chunkMeta.transmuxing.start=self.performance.now();const{transmuxer}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta});else if(transmuxer){let transmuxResult=transmuxer.flush(chunkMeta);isPromise(transmuxResult)||transmuxer.async?(isPromise(transmuxResult)||(transmuxResult=Promise.resolve(transmuxResult)),transmuxResult.then((data=>{this.handleFlushResult(data,chunkMeta)})).catch((error=>{this.transmuxerError(error,chunkMeta,"transmuxer-interface flush error")}))):this.handleFlushResult(transmuxResult,chunkMeta)}}transmuxerError(error,chunkMeta,reason){this.hls&&(this.error=error,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta,frag:this.frag||void 0,fatal:!1,error,err:error,reason}))}handleFlushResult(results,chunkMeta){results.forEach((result=>{this.handleTransmuxComplete(result)})),this.onFlush(chunkMeta)}onWorkerMessage(event){const data=event.data;if(null==data||!data.event)return void logger.warn("worker message received with no "+(data?"event name":"data"));const hls=this.hls;if(this.hls)switch(data.event){case"init":{var _this$workerContext;const objectURL=null==(_this$workerContext=this.workerContext)?void 0:_this$workerContext.objectURL;objectURL&&self.URL.revokeObjectURL(objectURL);break}case"transmuxComplete":this.handleTransmuxComplete(data.data);break;case"flush":this.onFlush(data.data);break;case"workerLog":logger[data.data.logType]&&logger[data.data.logType](data.data.message);break;default:data.data=data.data||{},data.data.frag=this.frag,data.data.id=this.id,hls.trigger(data.event,data.data)}}configureTransmuxer(config){const{transmuxer}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config}):transmuxer&&transmuxer.configure(config)}handleTransmuxComplete(result){result.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(result)}}function subtitleOptionsIdentical(trackList1,trackList2){if(trackList1.length!==trackList2.length)return!1;for(let i=0;i<trackList1.length;i++)if(!mediaAttributesIdentical(trackList1[i].attrs,trackList2[i].attrs))return!1;return!0}function mediaAttributesIdentical(attrs1,attrs2,customAttributes){const stableRenditionId=attrs1["STABLE-RENDITION-ID"];return stableRenditionId&&!customAttributes?stableRenditionId===attrs2["STABLE-RENDITION-ID"]:!(customAttributes||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((subtitleAttribute=>attrs1[subtitleAttribute]!==attrs2[subtitleAttribute]))}function subtitleTrackMatchesTextTrack(subtitleTrack,textTrack){return textTrack.label.toLowerCase()===subtitleTrack.name.toLowerCase()&&(!textTrack.language||textTrack.language.toLowerCase()===(subtitleTrack.lang||"").toLowerCase())}class BufferableInstance{constructor(timeranges){this.buffered=void 0;const getRange=(name,index,length)=>{if((index>>>=0)>length-1)throw new DOMException(`Failed to execute '${name}' on 'TimeRanges': The index provided (${index}) is greater than the maximum bound (${length})`);return timeranges[index][name]};this.buffered={get length(){return timeranges.length},end:index=>getRange("end",index,timeranges.length),start:index=>getRange("start",index,timeranges.length)}}}class BufferOperationQueue{constructor(sourceBufferReference){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=sourceBufferReference}append(operation,type,pending){const queue=this.queues[type];queue.push(operation),1!==queue.length||pending||this.executeNext(type)}insertAbort(operation,type){this.queues[type].unshift(operation),this.executeNext(type)}appendBlocker(type){let execute;const promise=new Promise((resolve=>{execute=resolve})),operation={execute,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(operation,type),promise}executeNext(type){const queue=this.queues[type];if(queue.length){const operation=queue[0];try{operation.execute()}catch(error){logger.warn(`[buffer-operation-queue]: Exception executing "${type}" SourceBuffer operation: ${error}`),operation.onError(error);const sb=this.buffers[type];null!=sb&&sb.updating||this.shiftAndExecuteNext(type)}}}shiftAndExecuteNext(type){this.queues[type].shift(),this.executeNext(type)}current(type){return this.queues[type][0]}}const VIDEO_CODEC_PROFILE_REPLACE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;function removeSourceChildren(node){const sourceChildren=node.querySelectorAll("source");[].slice.call(sourceChildren).forEach((source=>{node.removeChild(source)}))}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=byte=>String.fromCharCode(specialCea608CharsCodes[byte]||byte),rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(severity,msg){if(this.verboseLevel>=severity){const m="function"==typeof msg?msg():msg;logger.log(`${this.time} [${severity}] ${m}`)}}}const numArrayToHexArray=function numArrayToHexArray(numArray){const hexArray=[];for(let j=0;j<numArray.length;j++)hexArray.push(numArray[j].toString(16));return hexArray};class PenState{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(styles){const attribs=["foreground","underline","italics","background","flash"];for(let i=0;i<attribs.length;i++){const style=attribs[i];styles.hasOwnProperty(style)&&(this[style]=styles[style])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(other){return this.foreground===other.foreground&&this.underline===other.underline&&this.italics===other.italics&&this.background===other.background&&this.flash===other.flash}copy(newPenState){this.foreground=newPenState.foreground,this.underline=newPenState.underline,this.italics=newPenState.italics,this.background=newPenState.background,this.flash=newPenState.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(){this.uchar=" ",this.penState=new PenState}reset(){this.uchar=" ",this.penState.reset()}setChar(uchar,newPenState){this.uchar=uchar,this.penState.copy(newPenState)}setPenState(newPenState){this.penState.copy(newPenState)}equals(other){return this.uchar===other.uchar&&this.penState.equals(other.penState)}copy(newChar){this.uchar=newChar.uchar,this.penState.copy(newChar.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Row{constructor(logger){this.chars=[],this.pos=0,this.currPenState=new PenState,this.cueStartTime=null,this.logger=void 0;for(let i=0;i<100;i++)this.chars.push(new StyledUnicodeChar);this.logger=logger}equals(other){for(let i=0;i<100;i++)if(!this.chars[i].equals(other.chars[i]))return!1;return!0}copy(other){for(let i=0;i<100;i++)this.chars[i].copy(other.chars[i])}isEmpty(){let empty=!0;for(let i=0;i<100;i++)if(!this.chars[i].isEmpty()){empty=!1;break}return empty}setCursor(absPos){this.pos!==absPos&&(this.pos=absPos),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=100)}moveCursor(relPos){const newPos=this.pos+relPos;if(relPos>1)for(let i=this.pos+1;i<newPos+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(newPos)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(byte){byte>=144&&this.backSpace();const char=getCharForByte(byte);this.pos>=100?this.logger.log(0,(()=>"Cannot insert "+byte.toString(16)+" ("+char+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(char,this.currPenState),this.moveCursor(1))}clearFromPos(startPos){let i;for(i=startPos;i<100;i++)this.chars[i].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const chars=[];let empty=!0;for(let i=0;i<100;i++){const char=this.chars[i].uchar;" "!==char&&(empty=!1),chars.push(char)}return empty?"":chars.join("")}setPenStyles(styles){this.currPenState.setStyles(styles);this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(logger){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let i=0;i<15;i++)this.rows.push(new Row(logger));this.logger=logger}reset(){for(let i=0;i<15;i++)this.rows[i].clear();this.currRow=14}equals(other){let equal=!0;for(let i=0;i<15;i++)if(!this.rows[i].equals(other.rows[i])){equal=!1;break}return equal}copy(other){for(let i=0;i<15;i++)this.rows[i].copy(other.rows[i])}isEmpty(){let empty=!0;for(let i=0;i<15;i++)if(!this.rows[i].isEmpty()){empty=!1;break}return empty}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(char){this.rows[this.currRow].insertChar(char)}setPen(styles){this.rows[this.currRow].setPenStyles(styles)}moveCursor(relPos){this.rows[this.currRow].moveCursor(relPos)}setCursor(absPos){this.logger.log(2,"setCursor: "+absPos);this.rows[this.currRow].setCursor(absPos)}setPAC(pacData){this.logger.log(2,(()=>"pacData = "+JSON.stringify(pacData)));let newRow=pacData.row-1;if(this.nrRollUpRows&&newRow<this.nrRollUpRows-1&&(newRow=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==newRow){for(let i=0;i<15;i++)this.rows[i].clear();const topRowIndex=this.currRow+1-this.nrRollUpRows,lastOutputScreen=this.lastOutputScreen;if(lastOutputScreen){const prevLineTime=lastOutputScreen.rows[topRowIndex].cueStartTime,time=this.logger.time;if(null!==prevLineTime&&null!==time&&prevLineTime<time)for(let i=0;i<this.nrRollUpRows;i++)this.rows[newRow-this.nrRollUpRows+i+1].copy(lastOutputScreen.rows[topRowIndex+i])}}this.currRow=newRow;const row=this.rows[this.currRow];if(null!==pacData.indent){const indent=pacData.indent,prevPos=Math.max(indent-1,0);row.setCursor(pacData.indent),pacData.color=row.chars[prevPos].penState.foreground}const styles={foreground:pacData.color,underline:pacData.underline,italics:pacData.italics,background:"black",flash:!1};this.setPen(styles)}setBkgData(bkgData){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(bkgData))),this.backSpace(),this.setPen(bkgData),this.insertChar(32)}setRollUpRows(nrRows){this.nrRollUpRows=nrRows}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const topRowIndex=this.currRow+1-this.nrRollUpRows,topRow=this.rows.splice(topRowIndex,1)[0];topRow.clear(),this.rows.splice(this.currRow,0,topRow),this.logger.log(2,"Rolling up")}getDisplayText(asOneRow){asOneRow=asOneRow||!1;const displayText=[];let text="",rowNr=-1;for(let i=0;i<15;i++){const rowText=this.rows[i].getTextString();rowText&&(rowNr=i+1,asOneRow?displayText.push("Row "+rowNr+": '"+rowText+"'"):displayText.push(rowText.trim()))}return displayText.length>0&&(text=asOneRow?"["+displayText.join(" | ")+"]":displayText.join("\n")),text}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(channelNumber,outputFilter,logger){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=channelNumber,this.outputFilter=outputFilter,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(logger),this.nonDisplayedMemory=new CaptionScreen(logger),this.lastOutputScreen=new CaptionScreen(logger),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=logger}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(newHandler){this.outputFilter=newHandler}setPAC(pacData){this.writeScreen.setPAC(pacData)}setBkgData(bkgData){this.writeScreen.setBkgData(bkgData)}setMode(newMode){newMode!==this.mode&&(this.mode=newMode,this.logger.log(2,(()=>"MODE="+newMode)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=newMode)}insertChars(chars){for(let i=0;i<chars.length;i++)this.writeScreen.insertChar(chars[i]);const screen=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>screen+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(nrRows){this.logger.log(2,"RU("+nrRows+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(nrRows)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const tmp=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=tmp,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(nrCols){this.logger.log(2,"TO("+nrCols+") - Tab Offset"),this.writeScreen.moveCursor(nrCols)}ccMIDROW(secondByte){const styles={flash:!1};if(styles.underline=secondByte%2==1,styles.italics=secondByte>=46,styles.italics)styles.foreground="white";else{const colorIndex=Math.floor(secondByte/2)-16,colors=["white","green","blue","cyan","red","yellow","magenta"];styles.foreground=colors[colorIndex]}this.logger.log(2,"MIDROW: "+JSON.stringify(styles)),this.writeScreen.setPen(styles)}outputDataUpdate(dispatch=!1){const time=this.logger.time;null!==time&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,time,this.lastOutputScreen),dispatch&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:time):this.cueStartTime=time,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Cea608Parser{constructor(field,out1,out2){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const logger=this.logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(field,out1,logger),new Cea608Channel(field+1,out2,logger)]}getHandler(channel){return this.channels[channel].getHandler()}setHandler(channel,newHandler){this.channels[channel].setHandler(newHandler)}addData(time,byteList){this.logger.time=time;for(let i=0;i<byteList.length;i+=2){const a=127&byteList[i],b=127&byteList[i+1];let cmdFound=!1,charsFound=null;if(0===a&&0===b)continue;this.logger.log(3,(()=>"["+numArrayToHexArray([byteList[i],byteList[i+1]])+"] -> ("+numArrayToHexArray([a,b])+")"));const cmdHistory=this.cmdHistory;if(a>=16&&a<=31){if(hasCmdRepeated(a,b,cmdHistory)){setLastCmd(null,null,cmdHistory),this.logger.log(3,(()=>"Repeated command ("+numArrayToHexArray([a,b])+") is dropped"));continue}setLastCmd(a,b,this.cmdHistory),cmdFound=this.parseCmd(a,b),cmdFound||(cmdFound=this.parseMidrow(a,b)),cmdFound||(cmdFound=this.parsePAC(a,b)),cmdFound||(cmdFound=this.parseBackgroundAttributes(a,b))}else setLastCmd(null,null,cmdHistory);if(!cmdFound&&(charsFound=this.parseChars(a,b),charsFound)){const currChNr=this.currentChannel;if(currChNr&&currChNr>0){this.channels[currChNr].insertChars(charsFound)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}cmdFound||charsFound||this.logger.log(2,(()=>"Couldn't parse cleaned data "+numArrayToHexArray([a,b])+" orig: "+numArrayToHexArray([byteList[i],byteList[i+1]])))}}parseCmd(a,b){if(!((20===a||28===a||21===a||29===a)&&b>=32&&b<=47)&&!((23===a||31===a)&&b>=33&&b<=35))return!1;const chNr=20===a||21===a||23===a?1:2,channel=this.channels[chNr];return 20===a||21===a||28===a||29===a?32===b?channel.ccRCL():33===b?channel.ccBS():34===b?channel.ccAOF():35===b?channel.ccAON():36===b?channel.ccDER():37===b?channel.ccRU(2):38===b?channel.ccRU(3):39===b?channel.ccRU(4):40===b?channel.ccFON():41===b?channel.ccRDC():42===b?channel.ccTR():43===b?channel.ccRTD():44===b?channel.ccEDM():45===b?channel.ccCR():46===b?channel.ccENM():47===b&&channel.ccEOC():channel.ccTO(b-32),this.currentChannel=chNr,!0}parseMidrow(a,b){let chNr=0;if((17===a||25===a)&&b>=32&&b<=47){if(chNr=17===a?1:2,chNr!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const channel=this.channels[chNr];return!!channel&&(channel.ccMIDROW(b),this.logger.log(3,(()=>"MIDROW ("+numArrayToHexArray([a,b])+")")),!0)}return!1}parsePAC(a,b){let row;if(!((a>=17&&a<=23||a>=25&&a<=31)&&b>=64&&b<=127)&&!((16===a||24===a)&&b>=64&&b<=95))return!1;const chNr=a<=23?1:2;row=b>=64&&b<=95?1===chNr?rowsLowCh1[a]:rowsLowCh2[a]:1===chNr?rowsHighCh1[a]:rowsHighCh2[a];const channel=this.channels[chNr];return!!channel&&(channel.setPAC(this.interpretPAC(row,b)),this.currentChannel=chNr,!0)}interpretPAC(row,byte){let pacIndex;const pacData={color:null,italics:!1,indent:null,underline:!1,row};return pacIndex=byte>95?byte-96:byte-64,pacData.underline=!(1&~pacIndex),pacIndex<=13?pacData.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(pacIndex/2)]:pacIndex<=15?(pacData.italics=!0,pacData.color="white"):pacData.indent=4*Math.floor((pacIndex-16)/2),pacData}parseChars(a,b){let channelNr,charCodes=null,charCode1=null;if(a>=25?(channelNr=2,charCode1=a-8):(channelNr=1,charCode1=a),charCode1>=17&&charCode1<=19){let oneCode;oneCode=17===charCode1?b+80:18===charCode1?b+112:b+144,this.logger.log(2,(()=>"Special char '"+getCharForByte(oneCode)+"' in channel "+channelNr)),charCodes=[oneCode]}else a>=32&&a<=127&&(charCodes=0===b?[a]:[a,b]);return charCodes&&this.logger.log(3,(()=>"Char codes =  "+numArrayToHexArray(charCodes).join(","))),charCodes}parseBackgroundAttributes(a,b){if(!((16===a||24===a)&&b>=32&&b<=47)&&!((23===a||31===a)&&b>=45&&b<=47))return!1;let index;const bkgData={};16===a||24===a?(index=Math.floor((b-32)/2),bkgData.background=backgroundColors[index],b%2==1&&(bkgData.background=bkgData.background+"_semi")):45===b?bkgData.background="transparent":(bkgData.foreground="black",47===b&&(bkgData.underline=!0));const chNr=a<=23?1:2;return this.channels[chNr].setBkgData(bkgData),!0}reset(){for(let i=0;i<Object.keys(this.channels).length;i++){const channel=this.channels[i];channel&&channel.reset()}setLastCmd(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let i=0;i<this.channels.length;i++){const channel=this.channels[i];channel&&channel.cueSplitAtTime(t)}}}function setLastCmd(a,b,cmdHistory){cmdHistory.a=a,cmdHistory.b=b}function hasCmdRepeated(a,b,cmdHistory){return cmdHistory.a===a&&cmdHistory.b===b}class OutputFilter{constructor(timelineController,trackName){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=timelineController,this.trackName=trackName}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(startTime,endTime,screen){(null===this.startTime||this.startTime>startTime)&&(this.startTime=startTime),this.endTime=endTime,this.screen=screen,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var VTTCue=function(){if(null!=optionalSelf&&optionalSelf.VTTCue)return self.VTTCue;const AllowedDirections=["","lr","rl"],AllowedAlignments=["start","middle","end","left","right"];function isAllowedValue(allowed,value){if("string"!=typeof value)return!1;if(!Array.isArray(allowed))return!1;const lcValue=value.toLowerCase();return!!~allowed.indexOf(lcValue)&&lcValue}function findAlignSetting(value){return isAllowedValue(AllowedAlignments,value)}function extend(obj,...rest){let i=1;for(;i<arguments.length;i++){const cobj=arguments[i];for(const p in cobj)obj[p]=cobj[p]}return obj}function VTTCue(startTime,endTime,text){const cue=this,baseObj={enumerable:!0};cue.hasBeenReset=!1;let _id="",_pauseOnExit=!1,_startTime=startTime,_endTime=endTime,_text=text,_region=null,_vertical="",_snapToLines=!0,_line="auto",_lineAlign="start",_position=50,_positionAlign="middle",_size=50,_align="middle";Object.defineProperty(cue,"id",extend({},baseObj,{get:function(){return _id},set:function(value){_id=""+value}})),Object.defineProperty(cue,"pauseOnExit",extend({},baseObj,{get:function(){return _pauseOnExit},set:function(value){_pauseOnExit=!!value}})),Object.defineProperty(cue,"startTime",extend({},baseObj,{get:function(){return _startTime},set:function(value){if("number"!=typeof value)throw new TypeError("Start time must be set to a number.");_startTime=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"endTime",extend({},baseObj,{get:function(){return _endTime},set:function(value){if("number"!=typeof value)throw new TypeError("End time must be set to a number.");_endTime=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"text",extend({},baseObj,{get:function(){return _text},set:function(value){_text=""+value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"region",extend({},baseObj,{get:function(){return _region},set:function(value){_region=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"vertical",extend({},baseObj,{get:function(){return _vertical},set:function(value){const setting=function findDirectionSetting(value){return isAllowedValue(AllowedDirections,value)}(value);if(!1===setting)throw new SyntaxError("An invalid or illegal string was specified.");_vertical=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"snapToLines",extend({},baseObj,{get:function(){return _snapToLines},set:function(value){_snapToLines=!!value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"line",extend({},baseObj,{get:function(){return _line},set:function(value){if("number"!=typeof value&&"auto"!==value)throw new SyntaxError("An invalid number or illegal string was specified.");_line=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"lineAlign",extend({},baseObj,{get:function(){return _lineAlign},set:function(value){const setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_lineAlign=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"position",extend({},baseObj,{get:function(){return _position},set:function(value){if(value<0||value>100)throw new Error("Position must be between 0 and 100.");_position=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"positionAlign",extend({},baseObj,{get:function(){return _positionAlign},set:function(value){const setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_positionAlign=setting,this.hasBeenReset=!0}})),Object.defineProperty(cue,"size",extend({},baseObj,{get:function(){return _size},set:function(value){if(value<0||value>100)throw new Error("Size must be between 0 and 100.");_size=value,this.hasBeenReset=!0}})),Object.defineProperty(cue,"align",extend({},baseObj,{get:function(){return _align},set:function(value){const setting=findAlignSetting(value);if(!setting)throw new SyntaxError("An invalid or illegal string was specified.");_align=setting,this.hasBeenReset=!0}})),cue.displayState=void 0}return VTTCue.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},VTTCue}();class StringDecoder{decode(data,options){if(!data)return"";if("string"!=typeof data)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(data))}}function parseTimeStamp(input){function computeSeconds(h,m,s,f){return 3600*(0|h)+60*(0|m)+(0|s)+parseFloat(f||0)}const m=input.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return m?parseFloat(m[2])>59?computeSeconds(m[2],m[3],0,m[4]):computeSeconds(m[1],m[2],m[3],m[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(k,v){this.get(k)||""===v||(this.values[k]=v)}get(k,dflt,defaultKey){return defaultKey?this.has(k)?this.values[k]:dflt[defaultKey]:this.has(k)?this.values[k]:dflt}has(k){return k in this.values}alt(k,v,a){for(let n=0;n<a.length;++n)if(v===a[n]){this.set(k,v);break}}integer(k,v){/^-?\d+$/.test(v)&&this.set(k,parseInt(v,10))}percent(k,v){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(v)){const percent=parseFloat(v);if(percent>=0&&percent<=100)return this.set(k,percent),!0}return!1}}function parseOptions(input,callback,keyValueDelim,groupDelim){const groups=groupDelim?input.split(groupDelim):[input];for(const i in groups){if("string"!=typeof groups[i])continue;const kv=groups[i].split(keyValueDelim);if(2!==kv.length)continue;callback(kv[0],kv[1])}}const defaults=new VTTCue(0,0,""),center="middle"===defaults.align?"middle":"center";function parseCue(input,cue,regionList){const oInput=input;function consumeTimeStamp(){const ts=parseTimeStamp(input);if(null===ts)throw new Error("Malformed timestamp: "+oInput);return input=input.replace(/^[^\sa-zA-Z-]+/,""),ts}function skipWhitespace(){input=input.replace(/^\s+/,"")}if(skipWhitespace(),cue.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==input.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+oInput);input=input.slice(3),skipWhitespace(),cue.endTime=consumeTimeStamp(),skipWhitespace(),function consumeCueSettings(input,cue){const settings=new Settings;parseOptions(input,(function(k,v){let vals;switch(k){case"region":for(let i=regionList.length-1;i>=0;i--)if(regionList[i].id===v){settings.set(k,regionList[i].region);break}break;case"vertical":settings.alt(k,v,["rl","lr"]);break;case"line":vals=v.split(","),settings.integer(k,vals[0]),settings.percent(k,vals[0])&&settings.set("snapToLines",!1),settings.alt(k,vals[0],["auto"]),2===vals.length&&settings.alt("lineAlign",vals[1],["start",center,"end"]);break;case"position":vals=v.split(","),settings.percent(k,vals[0]),2===vals.length&&settings.alt("positionAlign",vals[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":settings.percent(k,v);break;case"align":settings.alt(k,v,["start",center,"end","left","right"])}}),/:/,/\s/),cue.region=settings.get("region",null),cue.vertical=settings.get("vertical","");let line=settings.get("line","auto");"auto"===line&&-1===defaults.line&&(line=-1),cue.line=line,cue.lineAlign=settings.get("lineAlign","start"),cue.snapToLines=settings.get("snapToLines",!0),cue.size=settings.get("size",100),cue.align=settings.get("align",center);let position=settings.get("position","auto");"auto"===position&&50===defaults.position&&(position="start"===cue.align||"left"===cue.align?0:"end"===cue.align||"right"===cue.align?100:50),cue.position=position}(input,cue)}function fixLineBreaks(input){return input.replace(/<br(?: \/)?>/gi,"\n")}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(data){const _this=this;function collectNextLine(){let buffer=_this.buffer,pos=0;for(buffer=fixLineBreaks(buffer);pos<buffer.length&&"\r"!==buffer[pos]&&"\n"!==buffer[pos];)++pos;const line=buffer.slice(0,pos);return"\r"===buffer[pos]&&++pos,"\n"===buffer[pos]&&++pos,_this.buffer=buffer.slice(pos),line}data&&(_this.buffer+=_this.decoder.decode(data,{stream:!0}));try{let line="";if("INITIAL"===_this.state){if(!/\r\n|\n/.test(_this.buffer))return this;line=collectNextLine();const m=line.match(/^()?WEBVTT([ \t].*)?$/);if(null==m||!m[0])throw new Error("Malformed WebVTT signature.");_this.state="HEADER"}let alreadyCollectedLine=!1;for(;_this.buffer;){if(!/\r\n|\n/.test(_this.buffer))return this;switch(alreadyCollectedLine?alreadyCollectedLine=!1:line=collectNextLine(),_this.state){case"HEADER":/:/.test(line)?parseOptions(line,(function(k,v){}),/:/):line||(_this.state="ID");continue;case"NOTE":line||(_this.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(line)){_this.state="NOTE";break}if(!line)continue;if(_this.cue=new VTTCue(0,0,""),_this.state="CUE",-1===line.indexOf("--\x3e")){_this.cue.id=line;continue}case"CUE":if(!_this.cue){_this.state="BADCUE";continue}try{parseCue(line,_this.cue,_this.regionList)}catch(e){_this.cue=null,_this.state="BADCUE";continue}_this.state="CUETEXT";continue;case"CUETEXT":{const hasSubstring=-1!==line.indexOf("--\x3e");if(!line||hasSubstring&&(alreadyCollectedLine=!0)){_this.oncue&&_this.cue&&_this.oncue(_this.cue),_this.cue=null,_this.state="ID";continue}if(null===_this.cue)continue;_this.cue.text&&(_this.cue.text+="\n"),_this.cue.text+=line}continue;case"BADCUE":line||(_this.state="ID")}}}catch(e){"CUETEXT"===_this.state&&_this.cue&&_this.oncue&&_this.oncue(_this.cue),_this.cue=null,_this.state="INITIAL"===_this.state?"BADWEBVTT":"BADCUE"}return this}flush(){const _this=this;try{if((_this.cue||"HEADER"===_this.state)&&(_this.buffer+="\n\n",_this.parse()),"INITIAL"===_this.state||"BADWEBVTT"===_this.state)throw new Error("Malformed WebVTT signature.")}catch(e){_this.onparsingerror&&_this.onparsingerror(e)}return _this.onflush&&_this.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function startsWith(inputString,searchString,position=0){return inputString.slice(position,position+searchString.length)===searchString},hash=function hash(text){let _hash=5381,i=text.length;for(;i;)_hash=33*_hash^text.charCodeAt(--i);return(_hash>>>0).toString()};function generateCueId(startTime,endTime,text){return hash(startTime.toString())+hash(endTime.toString())+hash(text)}function parseWebVTT(vttByteArray,initPTS,vttCCs,cc,timeOffset,callBack,errorCallBack){const parser=new VTTParser,vttLines=utf8ArrayToStr(new Uint8Array(vttByteArray)).trim().replace(LINEBREAKS,"\n").split("\n"),cues=[],init90kHz=initPTS?function toMpegTsClockFromTimescale(baseTime,srcScale=1){return toTimescaleFromBase(baseTime,MPEG_TS_CLOCK_FREQ_HZ,1/srcScale)}(initPTS.baseTime,initPTS.timescale):0;let parsingError,cueTime="00:00.000",timestampMapMPEGTS=0,timestampMapLOCAL=0,inHeader=!0;parser.oncue=function(cue){const currCC=vttCCs[cc];let cueOffset=vttCCs.ccOffset;const webVttMpegTsMapOffset=(timestampMapMPEGTS-init90kHz)/9e4;if(null!=currCC&&currCC.new&&(void 0!==timestampMapLOCAL?cueOffset=vttCCs.ccOffset=currCC.start:function calculateOffset(vttCCs,cc,presentationTime){let currCC=vttCCs[cc],prevCC=vttCCs[currCC.prevCC];if(!prevCC||!prevCC.new&&currCC.new)return vttCCs.ccOffset=vttCCs.presentationOffset=currCC.start,void(currCC.new=!1);for(;null!=(_prevCC=prevCC)&&_prevCC.new;){var _prevCC;vttCCs.ccOffset+=currCC.start-prevCC.start,currCC.new=!1,currCC=prevCC,prevCC=vttCCs[currCC.prevCC]}vttCCs.presentationOffset=presentationTime}(vttCCs,cc,webVttMpegTsMapOffset)),webVttMpegTsMapOffset){if(!initPTS)return void(parsingError=new Error("Missing initPTS for VTT MPEGTS"));cueOffset=webVttMpegTsMapOffset-vttCCs.presentationOffset}const duration=cue.endTime-cue.startTime,startTime=normalizePts(9e4*(cue.startTime+cueOffset-timestampMapLOCAL),9e4*timeOffset)/9e4;cue.startTime=Math.max(startTime,0),cue.endTime=Math.max(startTime+duration,0);const text=cue.text.trim();cue.text=decodeURIComponent(encodeURIComponent(text)),cue.id||(cue.id=generateCueId(cue.startTime,cue.endTime,text)),cue.endTime>0&&cues.push(cue)},parser.onparsingerror=function(error){parsingError=error},parser.onflush=function(){parsingError?errorCallBack(parsingError):callBack(cues)},vttLines.forEach((line=>{if(inHeader){if(startsWith(line,"X-TIMESTAMP-MAP=")){inHeader=!1,line.slice(16).split(",").forEach((timestamp=>{startsWith(timestamp,"LOCAL:")?cueTime=timestamp.slice(6):startsWith(timestamp,"MPEGTS:")&&(timestampMapMPEGTS=parseInt(timestamp.slice(7)))}));try{timestampMapLOCAL=function cueString2millis(timeString){let ts=parseInt(timeString.slice(-3));const secs=parseInt(timeString.slice(-6,-4)),mins=parseInt(timeString.slice(-9,-7)),hours=timeString.length>9?parseInt(timeString.substring(0,timeString.indexOf(":"))):0;if(!(isFiniteNumber(ts)&&isFiniteNumber(secs)&&isFiniteNumber(mins)&&isFiniteNumber(hours)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${timeString}`);return ts+=1e3*secs,ts+=6e4*mins,ts+=36e5*hours,ts}(cueTime)/1e3}catch(error){parsingError=error}return}""===line&&(inHeader=!1)}parser.parse(line+"\n")})),parser.flush()}const HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(payload,initPTS,callBack,errorCallBack){const results=findBox(new Uint8Array(payload),["mdat"]);if(0===results.length)return void errorCallBack(new Error("Could not parse IMSC1 mdat"));const ttmlList=results.map((mdat=>utf8ArrayToStr(mdat))),syncTime=function toTimescaleFromScale(baseTime,destScale,srcScale=1,round=!1){return toTimescaleFromBase(baseTime,destScale,1/srcScale,round)}(initPTS.baseTime,1,initPTS.timescale);try{ttmlList.forEach((ttml=>callBack(function parseTTML(ttml,syncTime){const xmlDoc=(new DOMParser).parseFromString(ttml,"text/xml"),tt=xmlDoc.getElementsByTagName("tt")[0];if(!tt)throw new Error("Invalid ttml");const defaultRateInfo={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},rateInfo=Object.keys(defaultRateInfo).reduce(((result,key)=>(result[key]=tt.getAttribute(`ttp:${key}`)||defaultRateInfo[key],result)),{}),trim="preserve"!==tt.getAttribute("xml:space"),styleElements=collectionToDictionary(getElementCollection(tt,"styling","style")),regionElements=collectionToDictionary(getElementCollection(tt,"layout","region")),cueElements=getElementCollection(tt,"body","[begin]");return[].map.call(cueElements,(cueElement=>{const cueText=getTextContent(cueElement,trim);if(!cueText||!cueElement.hasAttribute("begin"))return null;const startTime=parseTtmlTime(cueElement.getAttribute("begin"),rateInfo),duration=parseTtmlTime(cueElement.getAttribute("dur"),rateInfo);let endTime=parseTtmlTime(cueElement.getAttribute("end"),rateInfo);if(null===startTime)throw timestampParsingError(cueElement);if(null===endTime){if(null===duration)throw timestampParsingError(cueElement);endTime=startTime+duration}const cue=new VTTCue(startTime-syncTime,endTime-syncTime,cueText);cue.id=generateCueId(cue.startTime,cue.endTime,cue.text);const styles=function getTtmlStyles(region,style,styleElements){const ttsNs="http://www.w3.org/ns/ttml#styling";let regionStyle=null;const styleAttributes=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],regionStyleName=null!=region&&region.hasAttribute("style")?region.getAttribute("style"):null;regionStyleName&&styleElements.hasOwnProperty(regionStyleName)&&(regionStyle=styleElements[regionStyleName]);return styleAttributes.reduce(((styles,name)=>{const value=getAttributeNS(style,ttsNs,name)||getAttributeNS(region,ttsNs,name)||getAttributeNS(regionStyle,ttsNs,name);return value&&(styles[name]=value),styles}),{})}(regionElements[cueElement.getAttribute("region")],styleElements[cueElement.getAttribute("style")],styleElements),{textAlign}=styles;if(textAlign){const lineAlign=textAlignToLineAlign[textAlign];lineAlign&&(cue.lineAlign=lineAlign),cue.align=textAlign}return _extends(cue,styles),cue})).filter((cue=>null!==cue))}(ttml,syncTime))))}catch(error){errorCallBack(error)}}function getElementCollection(fromElement,parentName,childName){const parent=fromElement.getElementsByTagName(parentName)[0];return parent?[].slice.call(parent.querySelectorAll(childName)):[]}function collectionToDictionary(elementsWithId){return elementsWithId.reduce(((dict,element)=>{const id=element.getAttribute("xml:id");return id&&(dict[id]=element),dict}),{})}function getTextContent(element,trim){return[].slice.call(element.childNodes).reduce(((str,node,i)=>{var _node$childNodes;return"br"===node.nodeName&&i?str+"\n":null!=(_node$childNodes=node.childNodes)&&_node$childNodes.length?getTextContent(node,trim):trim?str+node.textContent.trim().replace(/\s+/g," "):str+node.textContent}),"")}function getAttributeNS(element,ns,name){return element&&element.hasAttributeNS(ns,name)?element.getAttributeNS(ns,name):null}function timestampParsingError(node){return new Error(`Could not parse ttml timestamp ${node}`)}function parseTtmlTime(timeAttributeValue,rateInfo){if(!timeAttributeValue)return null;let seconds=parseTimeStamp(timeAttributeValue);return null===seconds&&(HMSF_REGEX.test(timeAttributeValue)?seconds=function parseHoursMinutesSecondsFrames(timeAttributeValue,rateInfo){const m=HMSF_REGEX.exec(timeAttributeValue),frames=(0|m[4])+(0|m[5])/rateInfo.subFrameRate;return 3600*(0|m[1])+60*(0|m[2])+(0|m[3])+frames/rateInfo.frameRate}(timeAttributeValue,rateInfo):TIME_UNIT_REGEX.test(timeAttributeValue)&&(seconds=function parseTimeUnits(timeAttributeValue,rateInfo){const m=TIME_UNIT_REGEX.exec(timeAttributeValue),value=Number(m[1]);switch(m[2]){case"h":return 3600*value;case"m":return 60*value;case"ms":return 1e3*value;case"f":return value/rateInfo.frameRate;case"t":return value/rateInfo.tickRate}return value}(timeAttributeValue,rateInfo))),seconds}function captionsOrSubtitlesFromCharacteristics(track){return track.characteristics&&/transcribes-spoken-dialog/gi.test(track.characteristics)&&/describes-music-and-sound/gi.test(track.characteristics)?"captions":"subtitles"}function canReuseVttTextTrack(inUseTrack,manifestTrack){return!!inUseTrack&&inUseTrack.kind===captionsOrSubtitlesFromCharacteristics(manifestTrack)&&subtitleTrackMatchesTextTrack(manifestTrack,inUseTrack)}class CapLevelController{constructor(hls){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=hls,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(streamController){this.streamController=streamController}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls}=this;hls.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls}=this;hls.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(event,data){const level=this.hls.levels[data.droppedLevel];this.isLevelAllowed(level)&&this.restrictedLevels.push({bitrate:level.bitrate,height:level.height,width:level.width})}onMediaAttaching(event,data){this.media=data.media instanceof HTMLVideoElement?data.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(event,data){const hls=this.hls;this.restrictedLevels=[],this.firstLevel=data.firstLevel,hls.config.capLevelToPlayerSize&&data.video&&this.startCapping()}onLevelsUpdated(event,data){this.timer&&isFiniteNumber(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(event,data){this.hls.config.capLevelToPlayerSize&&data.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const levels=this.hls.levels;if(levels.length){const hls=this.hls,maxLevel=this.getMaxLevel(levels.length-1);maxLevel!==this.autoLevelCapping&&logger.log(`Setting autoLevelCapping to ${maxLevel}: ${levels[maxLevel].height}p@${levels[maxLevel].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),hls.autoLevelCapping=maxLevel,hls.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=hls.autoLevelCapping}}}getMaxLevel(capLevelIndex){const levels=this.hls.levels;if(!levels.length)return-1;const validLevels=levels.filter(((level,index)=>this.isLevelAllowed(level)&&index<=capLevelIndex));return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(validLevels,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const media=this.media,boundsRect={width:0,height:0};if(media){const clientRect=media.getBoundingClientRect();boundsRect.width=clientRect.width,boundsRect.height=clientRect.height,boundsRect.width||boundsRect.height||(boundsRect.width=clientRect.right-clientRect.left||media.width||0,boundsRect.height=clientRect.bottom-clientRect.top||media.height||0)}return this.clientRect=boundsRect,boundsRect}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let pixelRatio=1;if(!this.hls.config.ignoreDevicePixelRatio)try{pixelRatio=self.devicePixelRatio}catch(e){}return pixelRatio}isLevelAllowed(level){return!this.restrictedLevels.some((restrictedLevel=>level.bitrate===restrictedLevel.bitrate&&level.width===restrictedLevel.width&&level.height===restrictedLevel.height))}static getMaxLevelByMediaSize(levels,width,height){if(null==levels||!levels.length)return-1;let maxLevelIndex=levels.length-1;const squareSize=Math.max(width,height);for(let i=0;i<levels.length;i+=1){const level=levels[i];if((level.width>=squareSize||level.height>=squareSize)&&(curLevel=level,!(nextLevel=levels[i+1])||curLevel.width!==nextLevel.width||curLevel.height!==nextLevel.height)){maxLevelIndex=i;break}}var curLevel,nextLevel;return maxLevelIndex}}class EMEController{constructor(hls){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=logger.debug.bind(logger,"[eme]"),this.log=logger.log.bind(logger,"[eme]"),this.warn=logger.warn.bind(logger,"[eme]"),this.error=logger.error.bind(logger,"[eme]"),this.hls=hls,this.config=hls.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const config=this.config;config.requestMediaKeySystemAccessFunc=null,config.licenseXhrSetup=config.licenseResponseCallback=void 0,config.drmSystems=config.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(keySystem){const{drmSystems,widevineLicenseUrl}=this.config,keySystemConfiguration=drmSystems[keySystem];if(keySystemConfiguration)return keySystemConfiguration.licenseUrl;if(keySystem===KeySystems.WIDEVINE&&widevineLicenseUrl)return widevineLicenseUrl;throw new Error(`no license server URL configured for key-system "${keySystem}"`)}getServerCertificateUrl(keySystem){const{drmSystems}=this.config,keySystemConfiguration=drmSystems[keySystem];if(keySystemConfiguration)return keySystemConfiguration.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${keySystem}"]`)}attemptKeySystemAccess(keySystemsToAttempt){const levels=this.hls.levels,uniqueCodec=(value,i,a)=>!!value&&a.indexOf(value)===i,audioCodecs=levels.map((level=>level.audioCodec)).filter(uniqueCodec),videoCodecs=levels.map((level=>level.videoCodec)).filter(uniqueCodec);return audioCodecs.length+videoCodecs.length===0&&videoCodecs.push("avc1.42e01e"),new Promise(((resolve,reject)=>{const attempt=keySystems=>{const keySystem=keySystems.shift();this.getMediaKeysPromise(keySystem,audioCodecs,videoCodecs).then((mediaKeys=>resolve({keySystem,mediaKeys}))).catch((error=>{keySystems.length?attempt(keySystems):reject(error instanceof EMEKeyError?error:new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error,fatal:!0},error.message))}))};attempt(keySystemsToAttempt)}))}requestMediaKeySystemAccess(keySystem,supportedConfigurations){const{requestMediaKeySystemAccessFunc}=this.config;if("function"!=typeof requestMediaKeySystemAccessFunc){let errMessage=`Configured requestMediaKeySystemAccess is not a function ${requestMediaKeySystemAccessFunc}`;return null===requestMediaKeySystemAccess&&"http:"===self.location.protocol&&(errMessage=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(errMessage))}return requestMediaKeySystemAccessFunc(keySystem,supportedConfigurations)}getMediaKeysPromise(keySystem,audioCodecs,videoCodecs){const mediaKeySystemConfigs=function getSupportedMediaKeySystemConfigurations(keySystem,audioCodecs,videoCodecs,drmSystemOptions){let initDataTypes;switch(keySystem){case KeySystems.FAIRPLAY:initDataTypes=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:initDataTypes=["cenc"];break;case KeySystems.CLEARKEY:initDataTypes=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${keySystem}`)}return function createMediaKeySystemConfigurations(initDataTypes,audioCodecs,videoCodecs,drmSystemOptions){return[{initDataTypes,persistentState:drmSystemOptions.persistentState||"optional",distinctiveIdentifier:drmSystemOptions.distinctiveIdentifier||"optional",sessionTypes:drmSystemOptions.sessionTypes||[drmSystemOptions.sessionType||"temporary"],audioCapabilities:audioCodecs.map((codec=>({contentType:`audio/mp4; codecs="${codec}"`,robustness:drmSystemOptions.audioRobustness||"",encryptionScheme:drmSystemOptions.audioEncryptionScheme||null}))),videoCapabilities:videoCodecs.map((codec=>({contentType:`video/mp4; codecs="${codec}"`,robustness:drmSystemOptions.videoRobustness||"",encryptionScheme:drmSystemOptions.videoEncryptionScheme||null})))}]}(initDataTypes,audioCodecs,videoCodecs,drmSystemOptions)}(keySystem,audioCodecs,videoCodecs,this.config.drmSystemOptions),keySystemAccessPromises=this.keySystemAccessPromises[keySystem];let keySystemAccess=null==keySystemAccessPromises?void 0:keySystemAccessPromises.keySystemAccess;if(!keySystemAccess){this.log(`Requesting encrypted media "${keySystem}" key-system access with config: ${JSON.stringify(mediaKeySystemConfigs)}`),keySystemAccess=this.requestMediaKeySystemAccess(keySystem,mediaKeySystemConfigs);const _keySystemAccessPromises=this.keySystemAccessPromises[keySystem]={keySystemAccess};return keySystemAccess.catch((error=>{this.log(`Failed to obtain access to key-system "${keySystem}": ${error}`)})),keySystemAccess.then((mediaKeySystemAccess=>{this.log(`Access for key-system "${mediaKeySystemAccess.keySystem}" obtained`);const certificateRequest=this.fetchServerCertificate(keySystem);return this.log(`Create media-keys for "${keySystem}"`),_keySystemAccessPromises.mediaKeys=mediaKeySystemAccess.createMediaKeys().then((mediaKeys=>(this.log(`Media-keys created for "${keySystem}"`),certificateRequest.then((certificate=>certificate?this.setMediaKeysServerCertificate(mediaKeys,keySystem,certificate):mediaKeys))))),_keySystemAccessPromises.mediaKeys.catch((error=>{this.error(`Failed to create media-keys for "${keySystem}"}: ${error}`)})),_keySystemAccessPromises.mediaKeys}))}return keySystemAccess.then((()=>keySystemAccessPromises.mediaKeys))}createMediaKeySessionContext({decryptdata,keySystem,mediaKeys}){this.log(`Creating key-system session "${keySystem}" keyId: ${Hex_hexDump(decryptdata.keyId||[])}`);const mediaKeysSession=mediaKeys.createSession(),mediaKeySessionContext={decryptdata,keySystem,mediaKeys,mediaKeysSession,keyStatus:"status-pending"};return this.mediaKeySessions.push(mediaKeySessionContext),mediaKeySessionContext}renewKeySession(mediaKeySessionContext){const decryptdata=mediaKeySessionContext.decryptdata;if(decryptdata.pssh){const keySessionContext=this.createMediaKeySessionContext(mediaKeySessionContext),keyId=this.getKeyIdString(decryptdata),scheme="cenc";this.keyIdToKeySessionPromise[keyId]=this.generateRequestWithPreferredKeySession(keySessionContext,scheme,decryptdata.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(mediaKeySessionContext)}getKeyIdString(decryptdata){if(!decryptdata)throw new Error("Could not read keyId of undefined decryptdata");if(null===decryptdata.keyId)throw new Error("keyId is null");return Hex_hexDump(decryptdata.keyId)}updateKeySession(mediaKeySessionContext,data){var _mediaKeySessionConte;const keySession=mediaKeySessionContext.mediaKeysSession;return this.log(`Updating key-session "${keySession.sessionId}" for keyID ${Hex_hexDump((null==(_mediaKeySessionConte=mediaKeySessionContext.decryptdata)?void 0:_mediaKeySessionConte.keyId)||[])}\n      } (data length: ${data?data.byteLength:data})`),keySession.update(data)}selectKeySystemFormat(frag){const keyFormats=Object.keys(frag.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${frag.sn} ${frag.type}: ${frag.level}) key formats ${keyFormats.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(keyFormats)),this.keyFormatPromise}getKeyFormatPromise(keyFormats){return new Promise(((resolve,reject)=>{const keySystemsInConfig=getKeySystemsForConfig(this.config),keySystemsToAttempt=keyFormats.map(keySystemFormatToKeySystemDomain).filter((value=>!!value&&-1!==keySystemsInConfig.indexOf(value)));return this.getKeySystemSelectionPromise(keySystemsToAttempt).then((({keySystem})=>{const keySystemFormat=keySystemDomainToKeySystemFormat(keySystem);keySystemFormat?resolve(keySystemFormat):reject(new Error(`Unable to find format for key-system "${keySystem}"`))})).catch(reject)}))}loadKey(data){const decryptdata=data.keyInfo.decryptdata,keyId=this.getKeyIdString(decryptdata),keyDetails=`(keyId: ${keyId} format: "${decryptdata.keyFormat}" method: ${decryptdata.method} uri: ${decryptdata.uri})`;this.log(`Starting session for key ${keyDetails}`);let keySessionContextPromise=this.keyIdToKeySessionPromise[keyId];return keySessionContextPromise||(keySessionContextPromise=this.keyIdToKeySessionPromise[keyId]=this.getKeySystemForKeyPromise(decryptdata).then((({keySystem,mediaKeys})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${data.frag.sn} ${data.frag.type}: ${data.frag.level} using key ${keyDetails}`),this.attemptSetMediaKeys(keySystem,mediaKeys).then((()=>{this.throwIfDestroyed();const keySessionContext=this.createMediaKeySessionContext({keySystem,mediaKeys,decryptdata});return this.generateRequestWithPreferredKeySession(keySessionContext,"cenc",decryptdata.pssh,"playlist-key")}))))),keySessionContextPromise.catch((error=>this.handleError(error)))),keySessionContextPromise}throwIfDestroyed(message="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(error){this.hls&&(this.error(error.message),error instanceof EMEKeyError?this.hls.trigger(Events.ERROR,error.data):this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error,fatal:!0}))}getKeySystemForKeyPromise(decryptdata){const keyId=this.getKeyIdString(decryptdata),mediaKeySessionContext=this.keyIdToKeySessionPromise[keyId];if(!mediaKeySessionContext){const keySystem=keySystemFormatToKeySystemDomain(decryptdata.keyFormat),keySystemsToAttempt=keySystem?[keySystem]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(keySystemsToAttempt)}return mediaKeySessionContext}getKeySystemSelectionPromise(keySystemsToAttempt){if(keySystemsToAttempt.length||(keySystemsToAttempt=getKeySystemsForConfig(this.config)),0===keySystemsToAttempt.length)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(keySystemsToAttempt)}_onMediaEncrypted(event){const{initDataType,initData}=event;if(this.debug(`"${event.type}" event: init data type: "${initDataType}"`),null===initData)return;let keyId,keySystemDomain;if("sinf"===initDataType&&this.config.drmSystems[KeySystems.FAIRPLAY]){const json=bin2str(new Uint8Array(initData));try{const sinf=base64Decode(JSON.parse(json).sinf),tenc=parseSinf(new Uint8Array(sinf));if(!tenc)return;keyId=tenc.subarray(8,24),keySystemDomain=KeySystems.FAIRPLAY}catch(error){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const psshInfo=function parsePssh(initData){if(!(initData instanceof ArrayBuffer)||initData.byteLength<32)return null;const result={version:0,systemId:"",kids:null,data:null},view=new DataView(initData),boxSize=view.getUint32(0);if(initData.byteLength!==boxSize&&boxSize>44)return null;if(1886614376!==view.getUint32(4))return null;if(result.version=view.getUint32(8)>>>24,result.version>1)return null;result.systemId=Hex_hexDump(new Uint8Array(initData,12,16));const dataSizeOrKidCount=view.getUint32(28);if(0===result.version){if(boxSize-32<dataSizeOrKidCount)return null;result.data=new Uint8Array(initData,32,dataSizeOrKidCount)}else if(1===result.version){result.kids=[];for(let i=0;i<dataSizeOrKidCount;i++)result.kids.push(new Uint8Array(initData,32+16*i,16))}return result}(initData);if(null===psshInfo)return;0===psshInfo.version&&psshInfo.systemId===KeySystemIds_WIDEVINE&&psshInfo.data&&(keyId=psshInfo.data.subarray(8,24)),keySystemDomain=function keySystemIdToKeySystemDomain(systemId){if(systemId===KeySystemIds_WIDEVINE)return KeySystems.WIDEVINE}(psshInfo.systemId)}if(!keySystemDomain||!keyId)return;const keyIdHex=Hex_hexDump(keyId),{keyIdToKeySessionPromise,mediaKeySessions}=this;let keySessionContextPromise=keyIdToKeySessionPromise[keyIdHex];for(let i=0;i<mediaKeySessions.length;i++){const keyContext=mediaKeySessions[i],decryptdata=keyContext.decryptdata;if(decryptdata.pssh||!decryptdata.keyId)continue;const oldKeyIdHex=Hex_hexDump(decryptdata.keyId);if(keyIdHex===oldKeyIdHex||-1!==decryptdata.uri.replace(/-/g,"").indexOf(keyIdHex)){keySessionContextPromise=keyIdToKeySessionPromise[oldKeyIdHex],delete keyIdToKeySessionPromise[oldKeyIdHex],decryptdata.pssh=new Uint8Array(initData),decryptdata.keyId=keyId,keySessionContextPromise=keyIdToKeySessionPromise[keyIdHex]=keySessionContextPromise.then((()=>this.generateRequestWithPreferredKeySession(keyContext,initDataType,initData,"encrypted-event-key-match")));break}}keySessionContextPromise||(keySessionContextPromise=keyIdToKeySessionPromise[keyIdHex]=this.getKeySystemSelectionPromise([keySystemDomain]).then((({keySystem,mediaKeys})=>{var _keySystemToKeySystem;this.throwIfDestroyed();const decryptdata=new LevelKey("ISO-23001-7",keyIdHex,null!=(_keySystemToKeySystem=keySystemDomainToKeySystemFormat(keySystem))?_keySystemToKeySystem:"");return decryptdata.pssh=new Uint8Array(initData),decryptdata.keyId=keyId,this.attemptSetMediaKeys(keySystem,mediaKeys).then((()=>{this.throwIfDestroyed();const keySessionContext=this.createMediaKeySessionContext({decryptdata,keySystem,mediaKeys});return this.generateRequestWithPreferredKeySession(keySessionContext,initDataType,initData,"encrypted-event-no-match")}))}))),keySessionContextPromise.catch((error=>this.handleError(error)))}_onWaitingForKey(event){this.log(`"${event.type}" event`)}attemptSetMediaKeys(keySystem,mediaKeys){const queue=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${keySystem}"`);const setMediaKeysPromise=Promise.all(queue).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(mediaKeys)}));return this.setMediaKeysQueue.push(setMediaKeysPromise),setMediaKeysPromise.then((()=>{this.log(`Media-keys set for "${keySystem}"`),queue.push(setMediaKeysPromise),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((p=>-1===queue.indexOf(p)))}))}generateRequestWithPreferredKeySession(context,initDataType,initData,reason){var _this$config$drmSyste,_this$config$drmSyste2;const generateRequestFilter=null==(_this$config$drmSyste=this.config.drmSystems)||null==(_this$config$drmSyste2=_this$config$drmSyste[context.keySystem])?void 0:_this$config$drmSyste2.generateRequest;if(generateRequestFilter)try{const mappedInitData=generateRequestFilter.call(this.hls,initDataType,initData,context);if(!mappedInitData)throw new Error("Invalid response from configured generateRequest filter");initDataType=mappedInitData.initDataType,initData=context.decryptdata.pssh=mappedInitData.initData?new Uint8Array(mappedInitData.initData):null}catch(error){var _this$hls;if(this.warn(error.message),null!=(_this$hls=this.hls)&&_this$hls.config.debug)throw error}if(null===initData)return this.log(`Skipping key-session request for "${reason}" (no initData)`),Promise.resolve(context);const keyId=this.getKeyIdString(context.decryptdata);this.log(`Generating key-session request for "${reason}": ${keyId} (init data type: ${initDataType} length: ${initData?initData.byteLength:null})`);const licenseStatus=new EventEmitter,onmessage=context._onmessage=event=>{const keySession=context.mediaKeysSession;if(!keySession)return void licenseStatus.emit("error",new Error("invalid state"));const{messageType,message}=event;this.log(`"${messageType}" message event for session "${keySession.sessionId}" message size: ${message.byteLength}`),"license-request"===messageType||"license-renewal"===messageType?this.renewLicense(context,message).catch((error=>{this.handleError(error),licenseStatus.emit("error",error)})):"license-release"===messageType?context.keySystem===KeySystems.FAIRPLAY&&(this.updateKeySession(context,strToUtf8array("acknowledged")),this.removeSession(context)):this.warn(`unhandled media key message type "${messageType}"`)},onkeystatuseschange=context._onkeystatuseschange=event=>{if(!context.mediaKeysSession)return void licenseStatus.emit("error",new Error("invalid state"));this.onKeyStatusChange(context);const keyStatus=context.keyStatus;licenseStatus.emit("keyStatus",keyStatus),"expired"===keyStatus&&(this.warn(`${context.keySystem} expired for key ${keyId}`),this.renewKeySession(context))};context.mediaKeysSession.addEventListener("message",onmessage),context.mediaKeysSession.addEventListener("keystatuseschange",onkeystatuseschange);const keyUsablePromise=new Promise(((resolve,reject)=>{licenseStatus.on("error",reject),licenseStatus.on("keyStatus",(keyStatus=>{keyStatus.startsWith("usable")?resolve():"output-restricted"===keyStatus?reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===keyStatus?reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${keyStatus}"`)):"expired"===keyStatus?reject(new Error("key expired while generating request")):this.warn(`unhandled key status change "${keyStatus}"`)}))}));return context.mediaKeysSession.generateRequest(initDataType,initData).then((()=>{var _context$mediaKeysSes;this.log(`Request generated for key-session "${null==(_context$mediaKeysSes=context.mediaKeysSession)?void 0:_context$mediaKeysSes.sessionId}" keyId: ${keyId}`)})).catch((error=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error,fatal:!1},`Error generating key-session request: ${error}`)})).then((()=>keyUsablePromise)).catch((error=>{throw licenseStatus.removeAllListeners(),this.removeSession(context),error})).then((()=>(licenseStatus.removeAllListeners(),context)))}onKeyStatusChange(mediaKeySessionContext){mediaKeySessionContext.mediaKeysSession.keyStatuses.forEach(((status,keyId)=>{this.log(`key status change "${status}" for keyStatuses keyId: ${Hex_hexDump("buffer"in keyId?new Uint8Array(keyId.buffer,keyId.byteOffset,keyId.byteLength):new Uint8Array(keyId))} session keyId: ${Hex_hexDump(new Uint8Array(mediaKeySessionContext.decryptdata.keyId||[]))} uri: ${mediaKeySessionContext.decryptdata.uri}`),mediaKeySessionContext.keyStatus=status}))}fetchServerCertificate(keySystem){const config=this.config,certLoader=new(0,config.loader)(config),url=this.getServerCertificateUrl(keySystem);return url?(this.log(`Fetching server certificate for "${keySystem}"`),new Promise(((resolve,reject)=>{const loaderContext={responseType:"arraybuffer",url},loadPolicy=config.certLoadPolicy.default,loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},loaderCallbacks={onSuccess:(response,stats,context,networkDetails)=>{resolve(response.data)},onError:(response,contex,networkDetails,stats)=>{reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails,response:_objectSpread2({url:loaderContext.url,data:void 0},response)},`"${keySystem}" certificate request failed (${url}). Status: ${response.code} (${response.text})`))},onTimeout:(stats,context,networkDetails)=>{reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails,response:{url:loaderContext.url,data:void 0}},`"${keySystem}" certificate request timed out (${url})`))},onAbort:(stats,context,networkDetails)=>{reject(new Error("aborted"))}};certLoader.load(loaderContext,loaderConfig,loaderCallbacks)}))):Promise.resolve()}setMediaKeysServerCertificate(mediaKeys,keySystem,cert){return new Promise(((resolve,reject)=>{mediaKeys.setServerCertificate(cert).then((success=>{this.log(`setServerCertificate ${success?"success":"not supported by CDM"} (${null==cert?void 0:cert.byteLength}) on "${keySystem}"`),resolve(mediaKeys)})).catch((error=>{reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error,fatal:!0},error.message))}))}))}renewLicense(context,keyMessage){return this.requestLicense(context,new Uint8Array(keyMessage)).then((data=>this.updateKeySession(context,new Uint8Array(data)).catch((error=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error,fatal:!0},error.message)}))))}unpackPlayReadyKeyMessage(xhr,licenseChallenge){const xmlString=String.fromCharCode.apply(null,new Uint16Array(licenseChallenge.buffer));if(!xmlString.includes("PlayReadyKeyMessage"))return xhr.setRequestHeader("Content-Type","text/xml; charset=utf-8"),licenseChallenge;const keyMessageXml=(new DOMParser).parseFromString(xmlString,"application/xml"),headers=keyMessageXml.querySelectorAll("HttpHeader");if(headers.length>0){let header;for(let i=0,len=headers.length;i<len;i++){var _header$querySelector,_header$querySelector2;header=headers[i];const name=null==(_header$querySelector=header.querySelector("name"))?void 0:_header$querySelector.textContent,value=null==(_header$querySelector2=header.querySelector("value"))?void 0:_header$querySelector2.textContent;name&&value&&xhr.setRequestHeader(name,value)}}const challengeElement=keyMessageXml.querySelector("Challenge"),challengeText=null==challengeElement?void 0:challengeElement.textContent;if(!challengeText)throw new Error("Cannot find <Challenge> in key message");return strToUtf8array(atob(challengeText))}setupLicenseXHR(xhr,url,keysListItem,licenseChallenge){const licenseXhrSetup=this.config.licenseXhrSetup;return licenseXhrSetup?Promise.resolve().then((()=>{if(!keysListItem.decryptdata)throw new Error("Key removed");return licenseXhrSetup.call(this.hls,xhr,url,keysListItem,licenseChallenge)})).catch((error=>{if(!keysListItem.decryptdata)throw error;return xhr.open("POST",url,!0),licenseXhrSetup.call(this.hls,xhr,url,keysListItem,licenseChallenge)})).then((licenseXhrSetupResult=>{xhr.readyState||xhr.open("POST",url,!0);return{xhr,licenseChallenge:licenseXhrSetupResult||licenseChallenge}})):(xhr.open("POST",url,!0),Promise.resolve({xhr,licenseChallenge}))}requestLicense(keySessionContext,licenseChallenge){const keyLoadPolicy=this.config.keyLoadPolicy.default;return new Promise(((resolve,reject)=>{const url=this.getLicenseServerUrl(keySessionContext.keySystem);this.log(`Sending license request to URL: ${url}`);const xhr=new XMLHttpRequest;xhr.responseType="arraybuffer",xhr.onreadystatechange=()=>{if(!this.hls||!keySessionContext.mediaKeysSession)return reject(new Error("invalid state"));if(4===xhr.readyState)if(200===xhr.status){this._requestLicenseFailureCount=0;let data=xhr.response;this.log(`License received ${data instanceof ArrayBuffer?data.byteLength:data}`);const licenseResponseCallback=this.config.licenseResponseCallback;if(licenseResponseCallback)try{data=licenseResponseCallback.call(this.hls,xhr,url,keySessionContext)}catch(error){this.error(error)}resolve(data)}else{const retryConfig=keyLoadPolicy.errorRetry,maxNumRetry=retryConfig?retryConfig.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>maxNumRetry||xhr.status>=400&&xhr.status<500)reject(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:xhr,response:{url,data:void 0,code:xhr.status,text:xhr.statusText}},`License Request XHR failed (${url}). Status: ${xhr.status} (${xhr.statusText})`));else{const attemptsLeft=maxNumRetry-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${attemptsLeft} attempts left`),this.requestLicense(keySessionContext,licenseChallenge).then(resolve,reject)}}},keySessionContext.licenseXhr&&keySessionContext.licenseXhr.readyState!==XMLHttpRequest.DONE&&keySessionContext.licenseXhr.abort(),keySessionContext.licenseXhr=xhr,this.setupLicenseXHR(xhr,url,keySessionContext,licenseChallenge).then((({xhr,licenseChallenge})=>{keySessionContext.keySystem==KeySystems.PLAYREADY&&(licenseChallenge=this.unpackPlayReadyKeyMessage(xhr,licenseChallenge)),xhr.send(licenseChallenge)}))}))}onMediaAttached(event,data){if(!this.config.emeEnabled)return;const media=data.media;this.media=media,media.addEventListener("encrypted",this.onMediaEncrypted),media.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const media=this.media,mediaKeysList=this.mediaKeySessions;media&&(media.removeEventListener("encrypted",this.onMediaEncrypted),media.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},LevelKey.clearKeyUriToKeyIdMap();const keySessionCount=mediaKeysList.length;EMEController.CDMCleanupPromise=Promise.all(mediaKeysList.map((mediaKeySessionContext=>this.removeSession(mediaKeySessionContext))).concat(null==media?void 0:media.setMediaKeys(null).catch((error=>{this.log(`Could not clear media keys: ${error}`)})))).then((()=>{keySessionCount&&(this.log("finished closing key sessions and clearing media keys"),mediaKeysList.length=0)})).catch((error=>{this.log(`Could not close sessions and clear media keys: ${error}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(event,{sessionKeys}){if(sessionKeys&&this.config.emeEnabled&&!this.keyFormatPromise){const keyFormats=sessionKeys.reduce(((formats,sessionKey)=>(-1===formats.indexOf(sessionKey.keyFormat)&&formats.push(sessionKey.keyFormat),formats)),[]);this.log(`Selecting key-system from session-keys ${keyFormats.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(keyFormats)}}removeSession(mediaKeySessionContext){const{mediaKeysSession,licenseXhr}=mediaKeySessionContext;if(mediaKeysSession){this.log(`Remove licenses and keys and close session ${mediaKeysSession.sessionId}`),mediaKeySessionContext._onmessage&&(mediaKeysSession.removeEventListener("message",mediaKeySessionContext._onmessage),mediaKeySessionContext._onmessage=void 0),mediaKeySessionContext._onkeystatuseschange&&(mediaKeysSession.removeEventListener("keystatuseschange",mediaKeySessionContext._onkeystatuseschange),mediaKeySessionContext._onkeystatuseschange=void 0),licenseXhr&&licenseXhr.readyState!==XMLHttpRequest.DONE&&licenseXhr.abort(),mediaKeySessionContext.mediaKeysSession=mediaKeySessionContext.decryptdata=mediaKeySessionContext.licenseXhr=void 0;const index=this.mediaKeySessions.indexOf(mediaKeySessionContext);return index>-1&&this.mediaKeySessions.splice(index,1),mediaKeysSession.remove().catch((error=>{this.log(`Could not remove session: ${error}`)})).then((()=>mediaKeysSession.close())).catch((error=>{this.log(`Could not close session: ${error}`)}))}}}EMEController.CDMCleanupPromise=void 0;class EMEKeyError extends Error{constructor(data,message){super(message),this.data=void 0,data.error||(data.error=new Error(message)),this.data=data,data.err=data.error}}var CmObjectType,CmStreamingFormat,CmcdHeaderField;!function(CmObjectType){CmObjectType.MANIFEST="m",CmObjectType.AUDIO="a",CmObjectType.VIDEO="v",CmObjectType.MUXED="av",CmObjectType.INIT="i",CmObjectType.CAPTION="c",CmObjectType.TIMED_TEXT="tt",CmObjectType.KEY="k",CmObjectType.OTHER="o"}(CmObjectType||(CmObjectType={})),function(CmStreamingFormat){CmStreamingFormat.DASH="d",CmStreamingFormat.HLS="h",CmStreamingFormat.SMOOTH="s",CmStreamingFormat.OTHER="o"}(CmStreamingFormat||(CmStreamingFormat={})),function(CmcdHeaderField){CmcdHeaderField.OBJECT="CMCD-Object",CmcdHeaderField.REQUEST="CMCD-Request",CmcdHeaderField.SESSION="CMCD-Session",CmcdHeaderField.STATUS="CMCD-Status"}(CmcdHeaderField||(CmcdHeaderField={}));const CmcdHeaderMap={[CmcdHeaderField.OBJECT]:["br","d","ot","tb"],[CmcdHeaderField.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[CmcdHeaderField.SESSION]:["cid","pr","sf","sid","st","v"],[CmcdHeaderField.STATUS]:["bs","rtp"]};class SfItem{constructor(value,params){this.value=void 0,this.params=void 0,Array.isArray(value)&&(value=value.map((v=>v instanceof SfItem?v:new SfItem(v)))),this.value=value,this.params=params}}class SfToken{constructor(description){this.description=void 0,this.description=description}}const DICT="Dict";function throwError(action,src,type,cause){return new Error(`failed to ${action} "${function format(value){return Array.isArray(value)?JSON.stringify(value):value instanceof Map?"Map{}":value instanceof Set?"Set{}":"object"==typeof value?JSON.stringify(value):String(value)}(src)}" as ${type}`,{cause})}const BARE_ITEM="Bare Item",BOOLEAN="Boolean",BYTES="Byte Sequence",DECIMAL="Decimal",INTEGER="Integer";const STRING_REGEX=/[\x00-\x1f\x7f]+/,TOKEN="Token",KEY="Key";function serializeError(src,type,cause){return throwError("serialize",src,type,cause)}function serializeByteSequence(value){if(!1===ArrayBuffer.isView(value))throw serializeError(value,BYTES);return`:${function base64encode(binary){return btoa(String.fromCharCode(...binary))}(value)}:`}function serializeInteger(value){if(function isInvalidInt(value){return value<-999999999999999||999999999999999<value}(value))throw serializeError(value,INTEGER);return value.toString()}function roundToEven(value,precision){if(value<0)return-roundToEven(-value,precision);const decimalShift=Math.pow(10,precision);if(Math.abs(value*decimalShift%1-.5)<Number.EPSILON){const flooredValue=Math.floor(value*decimalShift);return(flooredValue%2==0?flooredValue:flooredValue+1)/decimalShift}return Math.round(value*decimalShift)/decimalShift}function serializeDecimal(value){const roundedValue=roundToEven(value,3);if(Math.floor(Math.abs(roundedValue)).toString().length>12)throw serializeError(value,DECIMAL);const stringValue=roundedValue.toString();return stringValue.includes(".")?stringValue:`${stringValue}.0`}const STRING="String";function serializeToken(token){const value=function symbolToStr(symbol){return symbol.description||symbol.toString().slice(7,-1)}(token);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(value))throw serializeError(value,TOKEN);return value}function serializeBareItem(value){switch(typeof value){case"number":if(!isFiniteNumber(value))throw serializeError(value,BARE_ITEM);return Number.isInteger(value)?serializeInteger(value):serializeDecimal(value);case"string":return function serializeString(value){if(STRING_REGEX.test(value))throw serializeError(value,STRING);return`"${value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(value);case"symbol":return serializeToken(value);case"boolean":return function serializeBoolean(value){if("boolean"!=typeof value)throw serializeError(value,BOOLEAN);return value?"?1":"?0"}(value);case"object":if(value instanceof Date)return function serializeDate(value){return`@${serializeInteger(value.getTime()/1e3)}`}(value);if(value instanceof Uint8Array)return serializeByteSequence(value);if(value instanceof SfToken)return serializeToken(value);default:throw serializeError(value,BARE_ITEM)}}function serializeKey(value){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(value))throw serializeError(value,KEY);return value}function serializeParams(params){return null==params?"":Object.entries(params).map((([key,value])=>!0===value?`;${serializeKey(key)}`:`;${serializeKey(key)}=${serializeBareItem(value)}`)).join("")}function serializeItem(value){return value instanceof SfItem?`${serializeBareItem(value.value)}${serializeParams(value.params)}`:serializeBareItem(value)}function serializeDict(dict,options={whitespace:!0}){if("object"!=typeof dict)throw serializeError(dict,DICT);const entries=dict instanceof Map?dict.entries():Object.entries(dict),optionalWhiteSpace=null!=options&&options.whitespace?" ":"";return Array.from(entries).map((([key,item])=>{item instanceof SfItem==!1&&(item=new SfItem(item));let output=serializeKey(key);return!0===item.value?output+=serializeParams(item.params):(output+="=",Array.isArray(item.value)?output+=function serializeInnerList(value){return`(${value.value.map(serializeItem).join(" ")})${serializeParams(value.params)}`}(item):output+=serializeItem(item)),output})).join(`,${optionalWhiteSpace}`)}const isTokenField=key=>"ot"===key||"sf"===key||"st"===key,isValid=value=>"number"==typeof value?isFiniteNumber(value):null!=value&&""!==value&&!1!==value;const toRounded=value=>Math.round(value),toHundred=value=>100*toRounded(value/100),CmcdFormatters={br:toRounded,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor:(value,options)=>(null!=options&&options.baseUrl&&(value=function urlToRelativePath(url,base){const to=new URL(url),from=new URL(base);if(to.origin!==from.origin)return url;const toPath=to.pathname.split("/").slice(1),fromPath=from.pathname.split("/").slice(1,-1);for(;toPath[0]===fromPath[0];)toPath.shift(),fromPath.shift();for(;fromPath.length;)fromPath.shift(),toPath.unshift("..");return toPath.join("/")}(value,options.baseUrl)),encodeURIComponent(value)),rtp:toHundred,tb:toRounded};function encodeCmcd(cmcd,options={}){return cmcd?function encodeSfDict(value,options){return serializeDict(value,options)}(function processCmcd(obj,options){const results={};if(null==obj||"object"!=typeof obj)return results;const keys=Object.keys(obj).sort(),formatters=_extends({},CmcdFormatters,null==options?void 0:options.formatters),filter=null==options?void 0:options.filter;return keys.forEach((key=>{if(null!=filter&&filter(key))return;let value=obj[key];const formatter=formatters[key];formatter&&(value=formatter(value,options)),"v"===key&&1===value||"pr"==key&&1===value||isValid(value)&&(isTokenField(key)&&"string"==typeof value&&(value=new SfToken(value)),results[key]=value)})),results}(cmcd,options),_extends({whitespace:!1},options)):""}function appendCmcdHeaders(headers,cmcd,options){return _extends(headers,function toCmcdHeaders(cmcd,options={}){if(!cmcd)return{};const entries=Object.entries(cmcd),headerMap=Object.entries(CmcdHeaderMap).concat(Object.entries((null==options?void 0:options.customHeaderMap)||{})),shards=entries.reduce(((acc,entry)=>{var _headerMap$find;const[key,value]=entry,field=(null==(_headerMap$find=headerMap.find((entry=>entry[1].includes(key))))?void 0:_headerMap$find[0])||CmcdHeaderField.REQUEST;return null!=acc[field]||(acc[field]={}),acc[field][key]=value,acc}),{});return Object.entries(shards).reduce(((acc,[field,value])=>(acc[field]=encodeCmcd(value,options),acc)),{})}(cmcd,options))}const CMCD_PARAM="CMCD";const REGEX=/CMCD=[^&#]+/;function appendCmcdQuery(url,cmcd,options){const query=function toCmcdQuery(cmcd,options={}){if(!cmcd)return"";const params=encodeCmcd(cmcd,options);return`${CMCD_PARAM}=${encodeURIComponent(params)}`}(cmcd,options);if(!query)return url;if(REGEX.test(url))return url.replace(REGEX,query);const separator=url.includes("?")?"&":"?";return`${url}${separator}${query}`}function cloneRenditionGroups(tracks,groupCloneMap,uriReplacement,cloneId){tracks&&Object.keys(groupCloneMap).forEach((audioGroupId=>{const clonedTracks=tracks.filter((track=>track.groupId===audioGroupId)).map((track=>{const clonedTrack=_extends({},track);return clonedTrack.details=void 0,clonedTrack.attrs=new AttrList(clonedTrack.attrs),clonedTrack.url=clonedTrack.attrs.URI=performUriReplacement(track.url,track.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",uriReplacement),clonedTrack.groupId=clonedTrack.attrs["GROUP-ID"]=groupCloneMap[audioGroupId],clonedTrack.attrs["PATHWAY-ID"]=cloneId,clonedTrack}));tracks.push(...clonedTracks)}))}function performUriReplacement(uri,stableId,perOptionKey,uriReplacement){const{HOST:host,PARAMS:params,[perOptionKey]:perOptionUris}=uriReplacement;let perVariantUri;stableId&&(perVariantUri=null==perOptionUris?void 0:perOptionUris[stableId],perVariantUri&&(uri=perVariantUri));const url=new self.URL(uri);return host&&!perVariantUri&&(url.host=host),params&&Object.keys(params).sort().forEach((key=>{key&&url.searchParams.set(key,params[key])})),url.href}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(config){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=config&&config.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const loader=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),loader&&(loader.onreadystatechange=null,loader.onprogress=null,4!==loader.readyState&&(this.stats.aborted=!0,loader.abort()))}abort(){var _this$callbacks;this.abortInternal(),null!=(_this$callbacks=this.callbacks)&&_this$callbacks.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(context,config,callbacks){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=context,this.config=config,this.callbacks=callbacks,this.loadInternal()}loadInternal(){const{config,context}=this;if(!config||!context)return;const xhr=this.loader=new self.XMLHttpRequest,stats=this.stats;stats.loading.first=0,stats.loaded=0,stats.aborted=!1;const xhrSetup=this.xhrSetup;xhrSetup?Promise.resolve().then((()=>{if(this.loader===xhr&&!this.stats.aborted)return xhrSetup(xhr,context.url)})).catch((error=>{if(this.loader===xhr&&!this.stats.aborted)return xhr.open("GET",context.url,!0),xhrSetup(xhr,context.url)})).then((()=>{this.loader!==xhr||this.stats.aborted||this.openAndSendXhr(xhr,context,config)})).catch((error=>{this.callbacks.onError({code:xhr.status,text:error.message},context,xhr,stats)})):this.openAndSendXhr(xhr,context,config)}openAndSendXhr(xhr,context,config){xhr.readyState||xhr.open("GET",context.url,!0);const headers=context.headers,{maxTimeToFirstByteMs,maxLoadTimeMs}=config.loadPolicy;if(headers)for(const header in headers)xhr.setRequestHeader(header,headers[header]);context.rangeEnd&&xhr.setRequestHeader("Range","bytes="+context.rangeStart+"-"+(context.rangeEnd-1)),xhr.onreadystatechange=this.readystatechange.bind(this),xhr.onprogress=this.loadprogress.bind(this),xhr.responseType=context.responseType,self.clearTimeout(this.requestTimeout),config.timeout=maxTimeToFirstByteMs&&isFiniteNumber(maxTimeToFirstByteMs)?maxTimeToFirstByteMs:maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),config.timeout),xhr.send()}readystatechange(){const{context,loader:xhr,stats}=this;if(!context||!xhr)return;const readyState=xhr.readyState,config=this.config;if(!stats.aborted&&readyState>=2&&(0===stats.loading.first&&(stats.loading.first=Math.max(self.performance.now(),stats.loading.start),config.timeout!==config.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),config.timeout=config.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),config.loadPolicy.maxLoadTimeMs-(stats.loading.first-stats.loading.start)))),4===readyState)){self.clearTimeout(this.requestTimeout),xhr.onreadystatechange=null,xhr.onprogress=null;const status=xhr.status,useResponse="text"!==xhr.responseType;if(status>=200&&status<300&&(useResponse&&xhr.response||null!==xhr.responseText)){stats.loading.end=Math.max(self.performance.now(),stats.loading.first);const data=useResponse?xhr.response:xhr.responseText,len="arraybuffer"===xhr.responseType?data.byteLength:data.length;if(stats.loaded=stats.total=len,stats.bwEstimate=8e3*stats.total/(stats.loading.end-stats.loading.first),!this.callbacks)return;const onProgress=this.callbacks.onProgress;if(onProgress&&onProgress(stats,context,data,xhr),!this.callbacks)return;const response={url:xhr.responseURL,data,code:status};this.callbacks.onSuccess(response,stats,context,xhr)}else{const retryConfig=config.loadPolicy.errorRetry;shouldRetry(retryConfig,stats.retry,!1,{url:context.url,data:void 0,code:status})?this.retry(retryConfig):(logger.error(`${status} while loading ${context.url}`),this.callbacks.onError({code:status,text:xhr.statusText},context,xhr,stats))}}}loadtimeout(){if(!this.config)return;const retryConfig=this.config.loadPolicy.timeoutRetry;if(shouldRetry(retryConfig,this.stats.retry,!0))this.retry(retryConfig);else{var _this$context;logger.warn(`timeout while loading ${null==(_this$context=this.context)?void 0:_this$context.url}`);const callbacks=this.callbacks;callbacks&&(this.abortInternal(),callbacks.onTimeout(this.stats,this.context,this.loader))}}retry(retryConfig){const{context,stats}=this;this.retryDelay=getRetryDelay(retryConfig,stats.retry),stats.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==context?void 0:context.url}, retrying ${stats.retry}/${retryConfig.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(event){const stats=this.stats;stats.loaded=event.loaded,event.lengthComputable&&(stats.total=event.total)}getCacheAge(){let result=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const ageHeader=this.loader.getResponseHeader("age");result=ageHeader?parseFloat(ageHeader):null}return result}getResponseHeader(name){return this.loader&&new RegExp(`^${name}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(name):null}}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(config){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=config.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var _this$callbacks;this.abortInternal(),null!=(_this$callbacks=this.callbacks)&&_this$callbacks.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(context,config,callbacks){const stats=this.stats;if(stats.loading.start)throw new Error("Loader can only be used once.");stats.loading.start=self.performance.now();const initParams=function getRequestParameters(context,signal){const initParams={method:"GET",mode:"cors",credentials:"same-origin",signal,headers:new self.Headers(_extends({},context.headers))};context.rangeEnd&&initParams.headers.set("Range","bytes="+context.rangeStart+"-"+String(context.rangeEnd-1));return initParams}(context,this.controller.signal),onProgress=callbacks.onProgress,isArrayBuffer="arraybuffer"===context.responseType,LENGTH=isArrayBuffer?"byteLength":"length",{maxTimeToFirstByteMs,maxLoadTimeMs}=config.loadPolicy;this.context=context,this.config=config,this.callbacks=callbacks,this.request=this.fetchSetup(context,initParams),self.clearTimeout(this.requestTimeout),config.timeout=maxTimeToFirstByteMs&&isFiniteNumber(maxTimeToFirstByteMs)?maxTimeToFirstByteMs:maxLoadTimeMs,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),callbacks.onTimeout(stats,context,this.response)}),config.timeout),self.fetch(this.request).then((response=>{this.response=this.loader=response;const first=Math.max(self.performance.now(),stats.loading.start);if(self.clearTimeout(this.requestTimeout),config.timeout=maxLoadTimeMs,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),callbacks.onTimeout(stats,context,this.response)}),maxLoadTimeMs-(first-stats.loading.start)),!response.ok){const{status,statusText}=response;throw new FetchError(statusText||"fetch, bad network response",status,response)}return stats.loading.first=first,stats.total=function getContentLength(headers){const contentRange=headers.get("Content-Range");if(contentRange){const byteRangeLength=function getByteRangeLength(byteRangeHeader){const result=BYTERANGE.exec(byteRangeHeader);if(result)return parseInt(result[2])-parseInt(result[1])+1}(contentRange);if(isFiniteNumber(byteRangeLength))return byteRangeLength}const contentLength=headers.get("Content-Length");if(contentLength)return parseInt(contentLength)}(response.headers)||stats.total,onProgress&&isFiniteNumber(config.highWaterMark)?this.loadProgressively(response,stats,context,config.highWaterMark,onProgress):isArrayBuffer?response.arrayBuffer():"json"===context.responseType?response.json():response.text()})).then((responseData=>{const response=this.response;if(!response)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),stats.loading.end=Math.max(self.performance.now(),stats.loading.first);const total=responseData[LENGTH];total&&(stats.loaded=stats.total=total);const loaderResponse={url:response.url,data:responseData,code:response.status};onProgress&&!isFiniteNumber(config.highWaterMark)&&onProgress(stats,context,responseData,response),callbacks.onSuccess(loaderResponse,stats,context,response)})).catch((error=>{if(self.clearTimeout(this.requestTimeout),stats.aborted)return;const code=error&&error.code||0,text=error?error.message:null;callbacks.onError({code,text},context,error?error.details:null,stats)}))}getCacheAge(){let result=null;if(this.response){const ageHeader=this.response.headers.get("age");result=ageHeader?parseFloat(ageHeader):null}return result}getResponseHeader(name){return this.response?this.response.headers.get(name):null}loadProgressively(response,stats,context,highWaterMark=0,onProgress){const chunkCache=new ChunkCache,reader=response.body.getReader(),pump=()=>reader.read().then((data=>{if(data.done)return chunkCache.dataLength&&onProgress(stats,context,chunkCache.flush(),response),Promise.resolve(new ArrayBuffer(0));const chunk=data.value,len=chunk.length;return stats.loaded+=len,len<highWaterMark||chunkCache.dataLength?(chunkCache.push(chunk),chunkCache.dataLength>=highWaterMark&&onProgress(stats,context,chunkCache.flush(),response)):onProgress(stats,context,chunk,response),pump()})).catch((()=>Promise.reject()));return pump()}}function getRequest(context,initParams){return new self.Request(context.url,initParams)}class FetchError extends Error{constructor(message,code,details){super(message),this.code=void 0,this.details=void 0,this.code=code,this.details=details}}const WHITESPACE_CHAR=/\s/,Cues={newCue(track,startTime,endTime,captionScreen){const result=[];let row,cue,indenting,indent,text;const Cue=self.VTTCue||self.TextTrackCue;for(let r=0;r<captionScreen.rows.length;r++)if(row=captionScreen.rows[r],indenting=!0,indent=0,text="",!row.isEmpty()){var _track$cues;for(let c=0;c<row.chars.length;c++)WHITESPACE_CHAR.test(row.chars[c].uchar)&&indenting?indent++:(text+=row.chars[c].uchar,indenting=!1);row.cueStartTime=startTime,startTime===endTime&&(endTime+=1e-4),indent>=16?indent--:indent++;const cueText=fixLineBreaks(text.trim()),id=generateCueId(startTime,endTime,cueText);null!=track&&null!=(_track$cues=track.cues)&&_track$cues.getCueById(id)||(cue=new Cue(startTime,endTime,cueText),cue.id=id,cue.line=r+1,cue.align="left",cue.position=10+Math.min(80,10*Math.floor(8*indent/32)),result.push(cue))}return track&&result.length&&(result.sort(((cueA,cueB)=>"auto"===cueA.line||"auto"===cueB.line?0:cueA.line>8&&cueB.line>8?cueB.line-cueA.line:cueA.line-cueB.line)),result.forEach((cue=>addCueToTrack(track,cue)))),result}},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class AbrController{constructor(_hls){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:frag,partCurrent:part,hls}=this,{autoLevelEnabled,media}=hls;if(!frag||!media)return;const now=performance.now(),stats=part?part.stats:frag.stats,duration=part?part.duration:frag.duration,timeLoading=now-stats.loading.start,minAutoLevel=hls.minAutoLevel;if(stats.aborted||stats.loaded&&stats.loaded===stats.total||frag.level<=minAutoLevel)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!autoLevelEnabled||media.paused||!media.playbackRate||!media.readyState)return;const bufferInfo=hls.mainForwardBufferInfo;if(null===bufferInfo)return;const ttfbEstimate=this.bwEstimator.getEstimateTTFB(),playbackRate=Math.abs(media.playbackRate);if(timeLoading<=Math.max(ttfbEstimate,duration/(2*playbackRate)*1e3))return;const bufferStarvationDelay=bufferInfo.len/playbackRate,ttfb=stats.loading.first?stats.loading.first-stats.loading.start:-1,loadedFirstByte=stats.loaded&&ttfb>-1,bwEstimate=this.getBwEstimate(),levels=hls.levels,level=levels[frag.level],expectedLen=stats.total||Math.max(stats.loaded,Math.round(duration*level.averageBitrate/8));let timeStreaming=loadedFirstByte?timeLoading-ttfb:timeLoading;timeStreaming<1&&loadedFirstByte&&(timeStreaming=Math.min(timeLoading,8*stats.loaded/bwEstimate));const loadRate=loadedFirstByte?1e3*stats.loaded/timeStreaming:0,fragLoadedDelay=loadRate?(expectedLen-stats.loaded)/loadRate:8*expectedLen/bwEstimate+ttfbEstimate/1e3;if(fragLoadedDelay<=bufferStarvationDelay)return;const bwe=loadRate?8*loadRate:bwEstimate;let nextLoadLevel,fragLevelNextLoadedDelay=Number.POSITIVE_INFINITY;for(nextLoadLevel=frag.level-1;nextLoadLevel>minAutoLevel;nextLoadLevel--){const levelNextBitrate=levels[nextLoadLevel].maxBitrate;if(fragLevelNextLoadedDelay=this.getTimeToLoadFrag(ttfbEstimate/1e3,bwe,duration*levelNextBitrate,!levels[nextLoadLevel].details),fragLevelNextLoadedDelay<bufferStarvationDelay)break}if(fragLevelNextLoadedDelay>=fragLoadedDelay)return;if(fragLevelNextLoadedDelay>10*duration)return;hls.nextLoadLevel=hls.nextAutoLevel=nextLoadLevel,loadedFirstByte?this.bwEstimator.sample(timeLoading-Math.min(ttfbEstimate,ttfb),stats.loaded):this.bwEstimator.sampleTTFB(timeLoading);const nextLoadLevelBitrate=levels[nextLoadLevel].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>nextLoadLevelBitrate&&this.resetEstimator(nextLoadLevelBitrate),this.clearTimer(),logger.warn(`[abr] Fragment ${frag.sn}${part?" part "+part.index:""} of level ${frag.level} is loading too slowly;\n      Time to underbuffer: ${bufferStarvationDelay.toFixed(3)} s\n      Estimated load time for current fragment: ${fragLoadedDelay.toFixed(3)} s\n      Estimated load time for down switch fragment: ${fragLevelNextLoadedDelay.toFixed(3)} s\n      TTFB estimate: ${0|ttfb} ms\n      Current BW estimate: ${isFiniteNumber(bwEstimate)?0|bwEstimate:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${nextLoadLevel} @ ${0|nextLoadLevelBitrate} bps`),hls.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag,part,stats})},this.hls=_hls,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(abrEwmaDefaultEstimate){abrEwmaDefaultEstimate&&(logger.log(`setting initial bwe to ${abrEwmaDefaultEstimate}`),this.hls.config.abrEwmaDefaultEstimate=abrEwmaDefaultEstimate),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const config=this.hls.config;return new EwmaBandWidthEstimator(config.abrEwmaSlowVoD,config.abrEwmaFastVoD,config.abrEwmaDefaultEstimate)}registerListeners(){const{hls}=this;hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.FRAG_LOADING,this.onFragLoading,this),hls.on(Events.FRAG_LOADED,this.onFragLoaded,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.on(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls}=this;hls&&(hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.FRAG_LOADING,this.onFragLoading,this),hls.off(Events.FRAG_LOADED,this.onFragLoaded,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.off(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),hls.off(Events.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(event,data){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(event,data){const frag=data.frag;if(!this.ignoreFragment(frag)){var _data$part;if(!frag.bitrateTest)this.fragCurrent=frag,this.partCurrent=null!=(_data$part=data.part)?_data$part:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(event,data){this.clearTimer()}onError(event,data){if(!data.fatal)switch(data.details){case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ErrorDetails.FRAG_LOAD_TIMEOUT:{const frag=data.frag,{fragCurrent,partCurrent:part}=this;if(frag&&fragCurrent&&frag.sn===fragCurrent.sn&&frag.level===fragCurrent.level){const now=performance.now(),stats=part?part.stats:frag.stats,timeLoading=now-stats.loading.start,ttfb=stats.loading.first?stats.loading.first-stats.loading.start:-1;if(stats.loaded&&ttfb>-1){const ttfbEstimate=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(timeLoading-Math.min(ttfbEstimate,ttfb),stats.loaded)}else this.bwEstimator.sampleTTFB(timeLoading)}break}}}getTimeToLoadFrag(timeToFirstByteSec,bandwidth,fragSizeBits,isSwitch){return timeToFirstByteSec+fragSizeBits/bandwidth+(isSwitch?this.lastLevelLoadSec:0)}onLevelLoaded(event,data){const config=this.hls.config,{loading}=data.stats,timeLoadingMs=loading.end-loading.start;isFiniteNumber(timeLoadingMs)&&(this.lastLevelLoadSec=timeLoadingMs/1e3),data.details.live?this.bwEstimator.update(config.abrEwmaSlowLive,config.abrEwmaFastLive):this.bwEstimator.update(config.abrEwmaSlowVoD,config.abrEwmaFastVoD)}onFragLoaded(event,{frag,part}){const stats=part?part.stats:frag.stats;if(frag.type===PlaylistLevelType_MAIN&&this.bwEstimator.sampleTTFB(stats.loading.first-stats.loading.start),!this.ignoreFragment(frag)){if(this.clearTimer(),frag.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const duration=part?part.duration:frag.duration,level=this.hls.levels[frag.level],loadedBytes=(level.loaded?level.loaded.bytes:0)+stats.loaded,loadedDuration=(level.loaded?level.loaded.duration:0)+duration;level.loaded={bytes:loadedBytes,duration:loadedDuration},level.realBitrate=Math.round(8*loadedBytes/loadedDuration)}if(frag.bitrateTest){const fragBufferedData={stats,frag,part,id:frag.type};this.onFragBuffered(Events.FRAG_BUFFERED,fragBufferedData),frag.bitrateTest=!1}else this.lastLoadedFragLevel=frag.level}}onFragBuffered(event,data){const{frag,part}=data,stats=null!=part&&part.stats.loaded?part.stats:frag.stats;if(stats.aborted)return;if(this.ignoreFragment(frag))return;const processingMs=stats.parsing.end-stats.loading.start-Math.min(stats.loading.first-stats.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(processingMs,stats.loaded),stats.bwEstimate=this.getBwEstimate(),frag.bitrateTest?this.bitrateTestDelay=processingMs/1e3:this.bitrateTestDelay=0}ignoreFragment(frag){return frag.type!==PlaylistLevelType_MAIN||"initSegment"===frag.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel,minAutoLevel}=this.hls,bwEstimate=this.getBwEstimate(),maxStartDelay=this.hls.config.maxStarvationDelay,abrAutoLevel=this.findBestLevel(bwEstimate,minAutoLevel,maxAutoLevel,0,maxStartDelay,1,1);if(abrAutoLevel>-1)return abrAutoLevel;const firstLevel=this.hls.firstLevel,clamped=Math.min(Math.max(firstLevel,minAutoLevel),maxAutoLevel);return logger.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${firstLevel} clamped to ${clamped}`),clamped}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const forcedAutoLevel=this.forcedAutoLevel,useEstimate=this.bwEstimator.canEstimate(),loadedFirstFrag=this.lastLoadedFragLevel>-1;if(!(-1===forcedAutoLevel||useEstimate&&loadedFirstFrag&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return forcedAutoLevel;const nextABRAutoLevel=useEstimate&&loadedFirstFrag?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==forcedAutoLevel){const levels=this.hls.levels;if(levels.length>Math.max(forcedAutoLevel,nextABRAutoLevel)&&levels[forcedAutoLevel].loadError<=levels[nextABRAutoLevel].loadError)return forcedAutoLevel}return this._nextAutoLevel=nextABRAutoLevel,this.nextAutoLevelKey=this.getAutoLevelKey(),nextABRAutoLevel}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent,partCurrent,hls}=this,{maxAutoLevel,config,minAutoLevel}=hls,currentFragDuration=partCurrent?partCurrent.duration:fragCurrent?fragCurrent.duration:0,avgbw=this.getBwEstimate(),bufferStarvationDelay=this.getStarvationDelay();let bwFactor=config.abrBandWidthFactor,bwUpFactor=config.abrBandWidthUpFactor;if(bufferStarvationDelay){const _bestLevel=this.findBestLevel(avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay,0,bwFactor,bwUpFactor);if(_bestLevel>=0)return _bestLevel}let maxStarvationDelay=currentFragDuration?Math.min(currentFragDuration,config.maxStarvationDelay):config.maxStarvationDelay;if(!bufferStarvationDelay){const bitrateTestDelay=this.bitrateTestDelay;if(bitrateTestDelay){maxStarvationDelay=(currentFragDuration?Math.min(currentFragDuration,config.maxLoadingDelay):config.maxLoadingDelay)-bitrateTestDelay,logger.info(`[abr] bitrate test took ${Math.round(1e3*bitrateTestDelay)}ms, set first fragment max fetchDuration to ${Math.round(1e3*maxStarvationDelay)} ms`),bwFactor=bwUpFactor=1}}const bestLevel=this.findBestLevel(avgbw,minAutoLevel,maxAutoLevel,bufferStarvationDelay,maxStarvationDelay,bwFactor,bwUpFactor);if(logger.info(`[abr] ${bufferStarvationDelay?"rebuffering expected":"buffer is empty"}, optimal quality level ${bestLevel}`),bestLevel>-1)return bestLevel;const minLevel=hls.levels[minAutoLevel],autoLevel=hls.levels[hls.loadLevel];return(null==minLevel?void 0:minLevel.bitrate)<(null==autoLevel?void 0:autoLevel.bitrate)?minAutoLevel:hls.loadLevel}getStarvationDelay(){const hls=this.hls,media=hls.media;if(!media)return 1/0;const playbackRate=media&&0!==media.playbackRate?Math.abs(media.playbackRate):1,bufferInfo=hls.mainForwardBufferInfo;return(bufferInfo?bufferInfo.len:0)/playbackRate}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(currentBw,minAutoLevel,maxAutoLevel,bufferStarvationDelay,maxStarvationDelay,bwFactor,bwUpFactor){var _level$details;const maxFetchDuration=bufferStarvationDelay+maxStarvationDelay,lastLoadedFragLevel=this.lastLoadedFragLevel,selectionBaseLevel=-1===lastLoadedFragLevel?this.hls.firstLevel:lastLoadedFragLevel,{fragCurrent,partCurrent}=this,{levels,allAudioTracks,loadLevel,config}=this.hls;if(1===levels.length)return 0;const level=levels[selectionBaseLevel],live=!(null==level||null==(_level$details=level.details)||!_level$details.live),firstSelection=-1===loadLevel||-1===lastLoadedFragLevel;let currentCodecSet,currentVideoRange="SDR",currentFrameRate=(null==level?void 0:level.frameRate)||0;const{audioPreference,videoPreference}=config,audioTracksByGroup=this.audioTracksByGroup||(this.audioTracksByGroup=function getAudioTracksByGroup(allAudioTracks){return allAudioTracks.reduce(((audioTracksByGroup,track)=>{let trackGroup=audioTracksByGroup.groups[track.groupId];trackGroup||(trackGroup=audioTracksByGroup.groups[track.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),trackGroup.tracks.push(track);const channelsKey=track.channels||"2";return trackGroup.channels[channelsKey]=(trackGroup.channels[channelsKey]||0)+1,trackGroup.hasDefault=trackGroup.hasDefault||track.default,trackGroup.hasAutoSelect=trackGroup.hasAutoSelect||track.autoselect,trackGroup.hasDefault&&(audioTracksByGroup.hasDefaultAudio=!0),trackGroup.hasAutoSelect&&(audioTracksByGroup.hasAutoSelectAudio=!0),audioTracksByGroup}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}(allAudioTracks));if(firstSelection){if(-1!==this.firstSelection)return this.firstSelection;const codecTiers=this.codecTiers||(this.codecTiers=function getCodecTiers(levels,audioTracksByGroup,minAutoLevel,maxAutoLevel){return levels.slice(minAutoLevel,maxAutoLevel+1).reduce(((tiers,level)=>{if(!level.codecSet)return tiers;const audioGroups=level.audioGroups;let tier=tiers[level.codecSet];tier||(tiers[level.codecSet]=tier={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!audioGroups,fragmentError:0}),tier.minBitrate=Math.min(tier.minBitrate,level.bitrate);const lesserWidthOrHeight=Math.min(level.height,level.width);return tier.minHeight=Math.min(tier.minHeight,lesserWidthOrHeight),tier.minFramerate=Math.min(tier.minFramerate,level.frameRate),tier.maxScore=Math.max(tier.maxScore,level.score),tier.fragmentError+=level.fragmentError,tier.videoRanges[level.videoRange]=(tier.videoRanges[level.videoRange]||0)+1,audioGroups&&audioGroups.forEach((audioGroupId=>{if(!audioGroupId)return;const audioGroup=audioTracksByGroup.groups[audioGroupId];audioGroup&&(tier.hasDefaultAudio=tier.hasDefaultAudio||audioTracksByGroup.hasDefaultAudio?audioGroup.hasDefault:audioGroup.hasAutoSelect||!audioTracksByGroup.hasDefaultAudio&&!audioTracksByGroup.hasAutoSelectAudio,Object.keys(audioGroup.channels).forEach((channels=>{tier.channels[channels]=(tier.channels[channels]||0)+audioGroup.channels[channels]})))})),tiers}),{})}(levels,audioTracksByGroup,minAutoLevel,maxAutoLevel)),startTier=function getStartCodecTier(codecTiers,currentVideoRange,currentBw,audioPreference,videoPreference){const codecSets=Object.keys(codecTiers),channelsPreference=null==audioPreference?void 0:audioPreference.channels,audioCodecPreference=null==audioPreference?void 0:audioPreference.audioCodec,preferStereo=channelsPreference&&2===parseInt(channelsPreference);let hasStereo=!0,hasCurrentVideoRange=!1,minHeight=1/0,minFramerate=1/0,minBitrate=1/0,selectedScore=0,videoRanges=[];const{preferHDR,allowedVideoRanges}=getVideoSelectionOptions(currentVideoRange,videoPreference);for(let i=codecSets.length;i--;){const tier=codecTiers[codecSets[i]];hasStereo=tier.channels[2]>0,minHeight=Math.min(minHeight,tier.minHeight),minFramerate=Math.min(minFramerate,tier.minFramerate),minBitrate=Math.min(minBitrate,tier.minBitrate);const matchingVideoRanges=allowedVideoRanges.filter((range=>tier.videoRanges[range]>0));matchingVideoRanges.length>0&&(hasCurrentVideoRange=!0,videoRanges=matchingVideoRanges)}minHeight=isFiniteNumber(minHeight)?minHeight:0,minFramerate=isFiniteNumber(minFramerate)?minFramerate:0;const maxHeight=Math.max(1080,minHeight),maxFramerate=Math.max(30,minFramerate);return minBitrate=isFiniteNumber(minBitrate)?minBitrate:currentBw,currentBw=Math.max(minBitrate,currentBw),hasCurrentVideoRange||(currentVideoRange=void 0,videoRanges=[]),{codecSet:codecSets.reduce(((selected,candidate)=>{const candidateTier=codecTiers[candidate];if(candidate===selected)return selected;if(candidateTier.minBitrate>currentBw)return logStartCodecCandidateIgnored(candidate,`min bitrate of ${candidateTier.minBitrate} > current estimate of ${currentBw}`),selected;if(!candidateTier.hasDefaultAudio)return logStartCodecCandidateIgnored(candidate,"no renditions with default or auto-select sound found"),selected;if(audioCodecPreference&&candidate.indexOf(audioCodecPreference.substring(0,4))%5!=0)return logStartCodecCandidateIgnored(candidate,`audio codec preference "${audioCodecPreference}" not found`),selected;if(channelsPreference&&!preferStereo){if(!candidateTier.channels[channelsPreference])return logStartCodecCandidateIgnored(candidate,`no renditions with ${channelsPreference} channel sound found (channels options: ${Object.keys(candidateTier.channels)})`),selected}else if((!audioCodecPreference||preferStereo)&&hasStereo&&0===candidateTier.channels[2])return logStartCodecCandidateIgnored(candidate,"no renditions with stereo sound found"),selected;return candidateTier.minHeight>maxHeight?(logStartCodecCandidateIgnored(candidate,`min resolution of ${candidateTier.minHeight} > maximum of ${maxHeight}`),selected):candidateTier.minFramerate>maxFramerate?(logStartCodecCandidateIgnored(candidate,`min framerate of ${candidateTier.minFramerate} > maximum of ${maxFramerate}`),selected):videoRanges.some((range=>candidateTier.videoRanges[range]>0))?candidateTier.maxScore<selectedScore?(logStartCodecCandidateIgnored(candidate,`max score of ${candidateTier.maxScore} < selected max of ${selectedScore}`),selected):selected&&(codecsSetSelectionPreferenceValue(candidate)>=codecsSetSelectionPreferenceValue(selected)||candidateTier.fragmentError>codecTiers[selected].fragmentError)?selected:(selectedScore=candidateTier.maxScore,candidate):(logStartCodecCandidateIgnored(candidate,`no variants with VIDEO-RANGE of ${JSON.stringify(videoRanges)} found`),selected)}),void 0),videoRanges,preferHDR,minFramerate,minBitrate}}(codecTiers,currentVideoRange,currentBw,audioPreference,videoPreference),{codecSet,videoRanges,minFramerate,minBitrate,preferHDR}=startTier;currentCodecSet=codecSet,currentVideoRange=preferHDR?videoRanges[videoRanges.length-1]:videoRanges[0],currentFrameRate=minFramerate,currentBw=Math.max(currentBw,minBitrate),logger.log(`[abr] picked start tier ${JSON.stringify(startTier)}`)}else currentCodecSet=null==level?void 0:level.codecSet,currentVideoRange=null==level?void 0:level.videoRange;const currentFragDuration=partCurrent?partCurrent.duration:fragCurrent?fragCurrent.duration:0,ttfbEstimateSec=this.bwEstimator.getEstimateTTFB()/1e3,levelsSkipped=[];for(let i=maxAutoLevel;i>=minAutoLevel;i--){var _levelInfo$supportedR;const levelInfo=levels[i],upSwitch=i>selectionBaseLevel;if(!levelInfo)continue;if(config.useMediaCapabilities&&!levelInfo.supportedResult&&!levelInfo.supportedPromise){const mediaCapabilities=navigator.mediaCapabilities;"function"==typeof(null==mediaCapabilities?void 0:mediaCapabilities.decodingInfo)&&requiresMediaCapabilitiesDecodingInfo(levelInfo,audioTracksByGroup,currentVideoRange,currentFrameRate,currentBw,audioPreference)?(levelInfo.supportedPromise=getMediaDecodingInfoPromise(levelInfo,audioTracksByGroup,mediaCapabilities),levelInfo.supportedPromise.then((decodingInfo=>{if(!this.hls)return;levelInfo.supportedResult=decodingInfo;const levels=this.hls.levels,index=levels.indexOf(levelInfo);decodingInfo.error?logger.warn(`[abr] MediaCapabilities decodingInfo error: "${decodingInfo.error}" for level ${index} ${JSON.stringify(decodingInfo)}`):decodingInfo.supported||(logger.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${index} ${JSON.stringify(decodingInfo)}`),index>-1&&levels.length>1&&(logger.log(`[abr] Removing unsupported level ${index}`),this.hls.removeLevel(index)))}))):levelInfo.supportedResult=SUPPORTED_INFO_DEFAULT}if(currentCodecSet&&levelInfo.codecSet!==currentCodecSet||currentVideoRange&&levelInfo.videoRange!==currentVideoRange||upSwitch&&currentFrameRate>levelInfo.frameRate||!upSwitch&&currentFrameRate>0&&currentFrameRate<levelInfo.frameRate||levelInfo.supportedResult&&(null==(_levelInfo$supportedR=levelInfo.supportedResult.decodingInfoResults)||!_levelInfo$supportedR[0].smooth)){levelsSkipped.push(i);continue}const levelDetails=levelInfo.details,avgDuration=(partCurrent?null==levelDetails?void 0:levelDetails.partTarget:null==levelDetails?void 0:levelDetails.averagetargetduration)||currentFragDuration;let adjustedbw;adjustedbw=upSwitch?bwUpFactor*currentBw:bwFactor*currentBw;const bitrate=currentFragDuration&&bufferStarvationDelay>=2*currentFragDuration&&0===maxStarvationDelay?levels[i].averageBitrate:levels[i].maxBitrate,fetchDuration=this.getTimeToLoadFrag(ttfbEstimateSec,adjustedbw,bitrate*avgDuration,void 0===levelDetails);if(adjustedbw>=bitrate&&(i===lastLoadedFragLevel||0===levelInfo.loadError&&0===levelInfo.fragmentError)&&(fetchDuration<=ttfbEstimateSec||!isFiniteNumber(fetchDuration)||live&&!this.bitrateTestDelay||fetchDuration<maxFetchDuration)){const forcedAutoLevel=this.forcedAutoLevel;return i===loadLevel||-1!==forcedAutoLevel&&forcedAutoLevel===loadLevel||(levelsSkipped.length&&logger.trace(`[abr] Skipped level(s) ${levelsSkipped.join(",")} of ${maxAutoLevel} max with CODECS and VIDEO-RANGE:"${levels[levelsSkipped[0]].codecs}" ${levels[levelsSkipped[0]].videoRange}; not compatible with "${level.codecs}" ${currentVideoRange}`),logger.info(`[abr] switch candidate:${selectionBaseLevel}->${i} adjustedbw(${Math.round(adjustedbw)})-bitrate=${Math.round(adjustedbw-bitrate)} ttfb:${ttfbEstimateSec.toFixed(1)} avgDuration:${avgDuration.toFixed(1)} maxFetchDuration:${maxFetchDuration.toFixed(1)} fetchDuration:${fetchDuration.toFixed(1)} firstSelection:${firstSelection} codecSet:${currentCodecSet} videoRange:${currentVideoRange} hls.loadLevel:${loadLevel}`)),firstSelection&&(this.firstSelection=i),i}}return-1}set nextAutoLevel(nextLevel){const{maxAutoLevel,minAutoLevel}=this.hls,value=Math.min(Math.max(nextLevel,minAutoLevel),maxAutoLevel);this._nextAutoLevel!==value&&(this.nextAutoLevelKey="",this._nextAutoLevel=value)}},bufferController:class BufferController{constructor(hls){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=event=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=event=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media,mediaSource}=this;this.log("Media source opened"),media&&(media.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media,mediaSource})),mediaSource&&mediaSource.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc,_objectUrl}=this;mediaSrc!==_objectUrl&&logger.error(`Media element src was set while attaching MediaSource (${_objectUrl} > ${mediaSrc})`)},this.hls=hls;const logPrefix="[buffer-controller]";this.appendSource=function isManagedMediaSource(source){return"undefined"!=typeof self&&source===self.ManagedMediaSource}(getMediaSource(hls.config.preferManagedMediaSource)),this.log=logger.log.bind(logger,logPrefix),this.warn=logger.warn.bind(logger,logPrefix),this.error=logger.error.bind(logger,logPrefix),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.BUFFER_RESET,this.onBufferReset,this),hls.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),hls.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.on(Events.BUFFER_EOS,this.onBufferEos,this),hls.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),hls.on(Events.FRAG_PARSED,this.onFragParsed,this),hls.on(Events.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.BUFFER_RESET,this.onBufferReset,this),hls.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),hls.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),hls.off(Events.BUFFER_EOS,this.onBufferEos,this),hls.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),hls.off(Events.FRAG_PARSED,this.onFragParsed,this),hls.off(Events.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new BufferOperationQueue(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(event,data){let codecEvents=2;(data.audio&&!data.video||!data.altAudio)&&(codecEvents=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=codecEvents,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(event,data){const media=this.media=data.media,MediaSource=getMediaSource(this.appendSource);if(media&&MediaSource){var _ms$constructor;const ms=this.mediaSource=new MediaSource;this.log(`created media source: ${null==(_ms$constructor=ms.constructor)?void 0:_ms$constructor.name}`),ms.addEventListener("sourceopen",this._onMediaSourceOpen),ms.addEventListener("sourceended",this._onMediaSourceEnded),ms.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(ms.addEventListener("startstreaming",this._onStartStreaming),ms.addEventListener("endstreaming",this._onEndStreaming));const objectUrl=this._objectUrl=self.URL.createObjectURL(ms);if(this.appendSource)try{media.removeAttribute("src");const MMS=self.ManagedMediaSource;media.disableRemotePlayback=media.disableRemotePlayback||MMS&&ms instanceof MMS,removeSourceChildren(media),function addSource(media,url){const source=self.document.createElement("source");source.type="video/mp4",source.src=url,media.appendChild(source)}(media,objectUrl),media.load()}catch(error){media.src=objectUrl}else media.src=objectUrl;media.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media,mediaSource,_objectUrl}=this;if(mediaSource){if(this.log("media source detaching"),"open"===mediaSource.readyState)try{mediaSource.endOfStream()}catch(err){this.warn(`onMediaDetaching: ${err.message} while calling endOfStream`)}this.onBufferReset(),mediaSource.removeEventListener("sourceopen",this._onMediaSourceOpen),mediaSource.removeEventListener("sourceended",this._onMediaSourceEnded),mediaSource.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(mediaSource.removeEventListener("startstreaming",this._onStartStreaming),mediaSource.removeEventListener("endstreaming",this._onEndStreaming)),media&&(media.removeEventListener("emptied",this._onMediaEmptied),_objectUrl&&self.URL.revokeObjectURL(_objectUrl),this.mediaSrc===_objectUrl?(media.removeAttribute("src"),this.appendSource&&removeSourceChildren(media),media.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Events.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((type=>{this.resetBuffer(type)})),this._initSourceBuffer()}resetBuffer(type){const sb=this.sourceBuffer[type];try{var _this$mediaSource;if(sb)this.removeBufferListeners(type),this.sourceBuffer[type]=void 0,null!=(_this$mediaSource=this.mediaSource)&&_this$mediaSource.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(sb)}catch(err){this.warn(`onBufferReset ${type}`,err)}}onBufferCodecs(event,data){const sourceBufferCount=this.getSourceBufferTypes().length,trackNames=Object.keys(data);if(trackNames.forEach((trackName=>{if(sourceBufferCount){const track=this.tracks[trackName];if(track&&"function"==typeof track.buffer.changeType){var _trackCodec;const{id,codec,levelCodec,container,metadata}=data[trackName],currentCodecFull=pickMostCompleteCodecName(track.codec,track.levelCodec),currentCodec=null==currentCodecFull?void 0:currentCodecFull.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");let trackCodec=pickMostCompleteCodecName(codec,levelCodec);const nextCodec=null==(_trackCodec=trackCodec)?void 0:_trackCodec.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");if(trackCodec&&currentCodec!==nextCodec){"audio"===trackName.slice(0,5)&&(trackCodec=getCodecCompatibleName(trackCodec,this.appendSource));const mimeType=`${container};codecs=${trackCodec}`;this.appendChangeType(trackName,mimeType),this.log(`switching codec ${currentCodecFull} to ${trackCodec}`),this.tracks[trackName]={buffer:track.buffer,codec,container,levelCodec,metadata,id}}}}else this.pendingTracks[trackName]=data[trackName]})),sourceBufferCount)return;const bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==bufferCodecEventsExpected&&(this.log(`${bufferCodecEventsExpected} bufferCodec event(s) expected ${trackNames.join(",")}`),this.bufferCodecEventsExpected=bufferCodecEventsExpected),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks()}appendChangeType(type,mimeType){const{operationQueue}=this,operation={execute:()=>{const sb=this.sourceBuffer[type];sb&&(this.log(`changing ${type} sourceBuffer type to ${mimeType}`),sb.changeType(mimeType)),operationQueue.shiftAndExecuteNext(type)},onStart:()=>{},onComplete:()=>{},onError:error=>{this.warn(`Failed to change ${type} SourceBuffer type`,error)}};operationQueue.append(operation,type,!!this.pendingTracks[type])}onBufferAppending(event,eventData){const{hls,operationQueue,tracks}=this,{data,type,frag,part,chunkMeta}=eventData,chunkStats=chunkMeta.buffering[type],bufferAppendingStart=self.performance.now();chunkStats.start=bufferAppendingStart;const fragBuffering=frag.stats.buffering,partBuffering=part?part.stats.buffering:null;0===fragBuffering.start&&(fragBuffering.start=bufferAppendingStart),partBuffering&&0===partBuffering.start&&(partBuffering.start=bufferAppendingStart);const audioTrack=tracks.audio;let checkTimestampOffset=!1;"audio"===type&&"audio/mpeg"===(null==audioTrack?void 0:audioTrack.container)&&(checkTimestampOffset=!this.lastMpegAudioChunk||1===chunkMeta.id||this.lastMpegAudioChunk.sn!==chunkMeta.sn,this.lastMpegAudioChunk=chunkMeta);const fragStart=frag.start,operation={execute:()=>{if(chunkStats.executeStart=self.performance.now(),checkTimestampOffset){const sb=this.sourceBuffer[type];if(sb){const delta=fragStart-sb.timestampOffset;Math.abs(delta)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${fragStart} (delta: ${delta}) sn: ${frag.sn})`),sb.timestampOffset=fragStart)}}this.appendExecutor(data,type)},onStart:()=>{},onComplete:()=>{const end=self.performance.now();chunkStats.executeEnd=chunkStats.end=end,0===fragBuffering.first&&(fragBuffering.first=end),partBuffering&&0===partBuffering.first&&(partBuffering.first=end);const{sourceBuffer}=this,timeRanges={};for(const type in sourceBuffer)timeRanges[type]=BufferHelper.getBuffered(sourceBuffer[type]);this.appendErrors[type]=0,"audio"===type||"video"===type?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Events.BUFFER_APPENDED,{type,frag,part,chunkMeta,parent:frag.type,timeRanges})},onError:error=>{const event={type:ErrorTypes.MEDIA_ERROR,parent:frag.type,details:ErrorDetails.BUFFER_APPEND_ERROR,sourceBufferName:type,frag,part,chunkMeta,error,err:error,fatal:!1};if(error.code===DOMException.QUOTA_EXCEEDED_ERR)event.details=ErrorDetails.BUFFER_FULL_ERROR;else{const appendErrorCount=++this.appendErrors[type];event.details=ErrorDetails.BUFFER_APPEND_ERROR,this.warn(`Failed ${appendErrorCount}/${hls.config.appendErrorMaxRetry} times to append segment in "${type}" sourceBuffer`),appendErrorCount>=hls.config.appendErrorMaxRetry&&(event.fatal=!0)}hls.trigger(Events.ERROR,event)}};operationQueue.append(operation,type,!!this.pendingTracks[type])}onBufferFlushing(event,data){const{operationQueue}=this,flushOperation=type=>({execute:this.removeExecutor.bind(this,type,data.startOffset,data.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type})},onError:error=>{this.warn(`Failed to remove from ${type} SourceBuffer`,error)}});data.type?operationQueue.append(flushOperation(data.type),data.type):this.getSourceBufferTypes().forEach((type=>{operationQueue.append(flushOperation(type),type)}))}onFragParsed(event,data){const{frag,part}=data,buffersAppendedTo=[],elementaryStreams=part?part.elementaryStreams:frag.elementaryStreams;elementaryStreams[ElementaryStreamTypes_AUDIOVIDEO]?buffersAppendedTo.push("audiovideo"):(elementaryStreams[ElementaryStreamTypes_AUDIO]&&buffersAppendedTo.push("audio"),elementaryStreams[ElementaryStreamTypes_VIDEO]&&buffersAppendedTo.push("video"));0===buffersAppendedTo.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${frag.type} level: ${frag.level} sn: ${frag.sn}`),this.blockBuffers((()=>{const now=self.performance.now();frag.stats.buffering.end=now,part&&(part.stats.buffering.end=now);const stats=part?part.stats:frag.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag,part,stats,id:frag.type})}),buffersAppendedTo)}onFragChanged(event,data){this.trimBuffers()}onBufferEos(event,data){this.getSourceBufferTypes().reduce(((acc,type)=>{const sb=this.sourceBuffer[type];return!sb||data.type&&data.type!==type||(sb.ending=!0,sb.ended||(sb.ended=!0,this.log(`${type} sourceBuffer now EOS`))),acc&&!(sb&&!sb.ended)}),!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((type=>{const sb=this.sourceBuffer[type];sb&&(sb.ending=!1)}));const{mediaSource}=this;mediaSource&&"open"===mediaSource.readyState?(this.log("Calling mediaSource.endOfStream()"),mediaSource.endOfStream()):mediaSource&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${mediaSource.readyState}`)})))}onLevelUpdated(event,{details}){details.fragments.length&&(this.details=details,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls,details,media}=this;if(!media||null===details)return;if(!this.getSourceBufferTypes().length)return;const config=hls.config,currentTime=media.currentTime,targetDuration=details.levelTargetDuration,backBufferLength=details.live&&null!==config.liveBackBufferLength?config.liveBackBufferLength:config.backBufferLength;if(isFiniteNumber(backBufferLength)&&backBufferLength>0){const maxBackBufferLength=Math.max(backBufferLength,targetDuration),targetBackBufferPosition=Math.floor(currentTime/targetDuration)*targetDuration-maxBackBufferLength;this.flushBackBuffer(currentTime,targetDuration,targetBackBufferPosition)}if(isFiniteNumber(config.frontBufferFlushThreshold)&&config.frontBufferFlushThreshold>0){const frontBufferLength=Math.max(config.maxBufferLength,config.frontBufferFlushThreshold),maxFrontBufferLength=Math.max(frontBufferLength,targetDuration),targetFrontBufferPosition=Math.floor(currentTime/targetDuration)*targetDuration+maxFrontBufferLength;this.flushFrontBuffer(currentTime,targetDuration,targetFrontBufferPosition)}}flushBackBuffer(currentTime,targetDuration,targetBackBufferPosition){const{details,sourceBuffer}=this;this.getSourceBufferTypes().forEach((type=>{const sb=sourceBuffer[type];if(sb){const buffered=BufferHelper.getBuffered(sb);if(buffered.length>0&&targetBackBufferPosition>buffered.start(0)){if(this.hls.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:targetBackBufferPosition}),null!=details&&details.live)this.hls.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:targetBackBufferPosition});else if(sb.ended&&buffered.end(buffered.length-1)-currentTime<2*targetDuration)return void this.log(`Cannot flush ${type} back buffer while SourceBuffer is in ended state`);this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:targetBackBufferPosition,type})}}}))}flushFrontBuffer(currentTime,targetDuration,targetFrontBufferPosition){const{sourceBuffer}=this;this.getSourceBufferTypes().forEach((type=>{const sb=sourceBuffer[type];if(sb){const buffered=BufferHelper.getBuffered(sb),numBufferedRanges=buffered.length;if(numBufferedRanges<2)return;const bufferStart=buffered.start(numBufferedRanges-1),bufferEnd=buffered.end(numBufferedRanges-1);if(targetFrontBufferPosition>bufferStart||currentTime>=bufferStart&&currentTime<=bufferEnd)return;if(sb.ended&&currentTime-bufferEnd<2*targetDuration)return void this.log(`Cannot flush ${type} front buffer while SourceBuffer is in ended state`);this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:bufferStart,endOffset:1/0,type})}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details,hls,media,mediaSource}=this,levelDuration=details.fragments[0].start+details.totalduration,mediaDuration=media.duration,msDuration=isFiniteNumber(mediaSource.duration)?mediaSource.duration:0;details.live&&hls.config.liveDurationInfinity?(mediaSource.duration=1/0,this.updateSeekableRange(details)):(levelDuration>msDuration&&levelDuration>mediaDuration||!isFiniteNumber(mediaDuration))&&(this.log(`Updating Media Source duration to ${levelDuration.toFixed(3)}`),mediaSource.duration=levelDuration)}updateSeekableRange(levelDetails){const mediaSource=this.mediaSource,fragments=levelDetails.fragments;if(fragments.length&&levelDetails.live&&null!=mediaSource&&mediaSource.setLiveSeekableRange){const start=Math.max(0,fragments[0].start),end=Math.max(start,start+levelDetails.totalduration);this.log(`Media Source duration is set to ${mediaSource.duration}. Setting seekable range to ${start}-${end}.`),mediaSource.setLiveSeekableRange(start,end)}}checkPendingTracks(){const{bufferCodecEventsExpected,operationQueue,pendingTracks}=this,pendingTracksCount=Object.keys(pendingTracks).length;if(pendingTracksCount&&(!bufferCodecEventsExpected||2===pendingTracksCount||"audiovideo"in pendingTracks)){this.createSourceBuffers(pendingTracks),this.pendingTracks={};const buffers=this.getSourceBufferTypes();if(buffers.length)this.hls.trigger(Events.BUFFER_CREATED,{tracks:this.tracks}),buffers.forEach((type=>{operationQueue.executeNext(type)}));else{const error=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error,reason:error.message})}}}createSourceBuffers(tracks){const{sourceBuffer,mediaSource}=this;if(!mediaSource)throw Error("createSourceBuffers called when mediaSource was null");for(const trackName in tracks)if(!sourceBuffer[trackName]){var _track$levelCodec;const track=tracks[trackName];if(!track)throw Error(`source buffer exists for track ${trackName}, however track does not`);let codec=-1===(null==(_track$levelCodec=track.levelCodec)?void 0:_track$levelCodec.indexOf(","))?track.levelCodec:track.codec;codec&&"audio"===trackName.slice(0,5)&&(codec=getCodecCompatibleName(codec,this.appendSource));const mimeType=`${track.container};codecs=${codec}`;this.log(`creating sourceBuffer(${mimeType})`);try{const sb=sourceBuffer[trackName]=mediaSource.addSourceBuffer(mimeType),sbName=trackName;this.addBufferListener(sbName,"updatestart",this._onSBUpdateStart),this.addBufferListener(sbName,"updateend",this._onSBUpdateEnd),this.addBufferListener(sbName,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(sbName,"bufferedchange",((type,event)=>{const removedRanges=event.removedRanges;null!=removedRanges&&removedRanges.length&&this.hls.trigger(Events.BUFFER_FLUSHED,{type:trackName})})),this.tracks[trackName]={buffer:sb,codec,container:track.container,levelCodec:track.levelCodec,metadata:track.metadata,id:track.id}}catch(err){this.error(`error while trying to add sourceBuffer: ${err.message}`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:err,sourceBufferName:trackName,mimeType})}}}get mediaSrc(){var _this$media;const media=(null==(_this$media=this.media)?void 0:_this$media.firstChild)||this.media;return null==media?void 0:media.src}_onSBUpdateStart(type){const{operationQueue}=this;operationQueue.current(type).onStart()}_onSBUpdateEnd(type){var _this$mediaSource2;if("closed"===(null==(_this$mediaSource2=this.mediaSource)?void 0:_this$mediaSource2.readyState))return void this.resetBuffer(type);const{operationQueue}=this;operationQueue.current(type).onComplete(),operationQueue.shiftAndExecuteNext(type)}_onSBUpdateError(type,event){var _this$mediaSource3;const error=new Error(`${type} SourceBuffer error. MediaSource readyState: ${null==(_this$mediaSource3=this.mediaSource)?void 0:_this$mediaSource3.readyState}`);this.error(`${error}`,event),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,sourceBufferName:type,error,fatal:!1});const operation=this.operationQueue.current(type);operation&&operation.onError(error)}removeExecutor(type,startOffset,endOffset){const{media,mediaSource,operationQueue,sourceBuffer}=this,sb=sourceBuffer[type];if(!media||!mediaSource||!sb)return this.warn(`Attempting to remove from the ${type} SourceBuffer, but it does not exist`),void operationQueue.shiftAndExecuteNext(type);const mediaDuration=isFiniteNumber(media.duration)?media.duration:1/0,msDuration=isFiniteNumber(mediaSource.duration)?mediaSource.duration:1/0,removeStart=Math.max(0,startOffset),removeEnd=Math.min(endOffset,mediaDuration,msDuration);removeEnd>removeStart&&(!sb.ending||sb.ended)?(sb.ended=!1,this.log(`Removing [${removeStart},${removeEnd}] from the ${type} SourceBuffer`),sb.remove(removeStart,removeEnd)):operationQueue.shiftAndExecuteNext(type)}appendExecutor(data,type){const sb=this.sourceBuffer[type];if(sb)sb.ended=!1,sb.appendBuffer(data);else if(!this.pendingTracks[type])throw new Error(`Attempting to append to the ${type} SourceBuffer, but it does not exist`)}blockBuffers(onUnblocked,buffers=this.getSourceBufferTypes()){if(!buffers.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(onUnblocked);const{operationQueue}=this,blockingOperations=buffers.map((type=>operationQueue.appendBlocker(type)));Promise.all(blockingOperations).then((()=>{onUnblocked(),buffers.forEach((type=>{const sb=this.sourceBuffer[type];null!=sb&&sb.updating||operationQueue.shiftAndExecuteNext(type)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(type,event,fn){const buffer=this.sourceBuffer[type];if(!buffer)return;const listener=fn.bind(this,type);this.listeners[type].push({event,listener}),buffer.addEventListener(event,listener)}removeBufferListeners(type){const buffer=this.sourceBuffer[type];buffer&&this.listeners[type].forEach((l=>{buffer.removeEventListener(l.event,l.listener)}))}},capLevelController:CapLevelController,errorController:class ErrorController{constructor(hls){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=hls,this.log=logger.log.bind(logger,"[info]:"),this.warn=logger.warn.bind(logger,"[warning]:"),this.error=logger.error.bind(logger,"[error]:"),this.registerListeners()}registerListeners(){const hls=this.hls;hls.on(Events.ERROR,this.onError,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const hls=this.hls;hls&&(hls.off(Events.ERROR,this.onError,this),hls.off(Events.ERROR,this.onErrorOut,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(startPosition){}stopLoad(){this.playlistError=0}getVariantLevelIndex(frag){return(null==frag?void 0:frag.type)===PlaylistLevelType_MAIN?frag.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(event,data){var _data$frag,_data$level;if(data.fatal)return;const hls=this.hls,context=data.context;switch(data.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:return void(data.errorAction=this.getFragRetryOrSwitchAction(data));case ErrorDetails.FRAG_PARSING_ERROR:if(null!=(_data$frag=data.frag)&&_data$frag.gap)return void(data.errorAction={action:NetworkErrorAction_DoNothing,flags:ErrorActionFlags_None});case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:return data.errorAction=this.getFragRetryOrSwitchAction(data),void(data.errorAction.action=NetworkErrorAction_SendAlternateToPenaltyBox);case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var _data$context,_data$context$levelDe;const levelIndex=data.parent===PlaylistLevelType_MAIN?data.level:hls.loadLevel;data.details===ErrorDetails.LEVEL_EMPTY_ERROR&&null!=(_data$context=data.context)&&null!=(_data$context$levelDe=_data$context.levelDetails)&&_data$context$levelDe.live?data.errorAction=this.getPlaylistRetryOrSwitchAction(data,levelIndex):(data.levelRetry=!1,data.errorAction=this.getLevelSwitchAction(data,levelIndex))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==context?void 0:context.level)&&(data.errorAction=this.getPlaylistRetryOrSwitchAction(data,context.level)));case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(context){const level=hls.levels[hls.loadLevel];if(level&&(context.type===PlaylistContextType_AUDIO_TRACK&&level.hasAudioGroup(context.groupId)||context.type===PlaylistContextType_SUBTITLE_TRACK&&level.hasSubtitleGroup(context.groupId)))return data.errorAction=this.getPlaylistRetryOrSwitchAction(data,hls.loadLevel),data.errorAction.action=NetworkErrorAction_SendAlternateToPenaltyBox,void(data.errorAction.flags=ErrorActionFlags_MoveAllAlternatesMatchingHost)}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const level=hls.levels[hls.loadLevel],restrictedHdcpLevel=null==level?void 0:level.attrs["HDCP-LEVEL"];restrictedHdcpLevel?data.errorAction={action:NetworkErrorAction_SendAlternateToPenaltyBox,flags:ErrorActionFlags_MoveAllAlternatesMatchingHDCP,hdcpLevel:restrictedHdcpLevel}:this.keySystemError(data)}return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:return void(data.errorAction=this.getLevelSwitchAction(data,null!=(_data$level=data.level)?_data$level:hls.loadLevel));case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:return void(data.errorAction={action:NetworkErrorAction_DoNothing,flags:ErrorActionFlags_None})}data.type===ErrorTypes.KEY_SYSTEM_ERROR&&this.keySystemError(data)}keySystemError(data){const levelIndex=this.getVariantLevelIndex(data.frag);data.levelRetry=!1,data.errorAction=this.getLevelSwitchAction(data,levelIndex)}getPlaylistRetryOrSwitchAction(data,levelIndex){const retryConfig=getRetryConfig(this.hls.config.playlistLoadPolicy,data),retryCount=this.playlistError++;if(shouldRetry(retryConfig,retryCount,isTimeoutError(data),data.response))return{action:NetworkErrorAction_RetryRequest,flags:ErrorActionFlags_None,retryConfig,retryCount};const errorAction=this.getLevelSwitchAction(data,levelIndex);return retryConfig&&(errorAction.retryConfig=retryConfig,errorAction.retryCount=retryCount),errorAction}getFragRetryOrSwitchAction(data){const hls=this.hls,variantLevelIndex=this.getVariantLevelIndex(data.frag),level=hls.levels[variantLevelIndex],{fragLoadPolicy,keyLoadPolicy}=hls.config,retryConfig=getRetryConfig(data.details.startsWith("key")?keyLoadPolicy:fragLoadPolicy,data),fragmentErrors=hls.levels.reduce(((acc,level)=>acc+level.fragmentError),0);if(level){data.details!==ErrorDetails.FRAG_GAP&&level.fragmentError++;if(shouldRetry(retryConfig,fragmentErrors,isTimeoutError(data),data.response))return{action:NetworkErrorAction_RetryRequest,flags:ErrorActionFlags_None,retryConfig,retryCount:fragmentErrors}}const errorAction=this.getLevelSwitchAction(data,variantLevelIndex);return retryConfig&&(errorAction.retryConfig=retryConfig,errorAction.retryCount=fragmentErrors),errorAction}getLevelSwitchAction(data,levelIndex){const hls=this.hls;null==levelIndex&&(levelIndex=hls.loadLevel);const level=this.hls.levels[levelIndex];if(level){var _data$frag2,_data$context2;const errorDetails=data.details;level.loadError++,errorDetails===ErrorDetails.BUFFER_APPEND_ERROR&&level.fragmentError++;let nextLevel=-1;const{levels,loadLevel,minAutoLevel,maxAutoLevel}=hls;hls.autoLevelEnabled||(hls.loadLevel=-1);const fragErrorType=null==(_data$frag2=data.frag)?void 0:_data$frag2.type,findAudioCodecAlternate=(fragErrorType===PlaylistLevelType_AUDIO&&errorDetails===ErrorDetails.FRAG_PARSING_ERROR||"audio"===data.sourceBufferName&&(errorDetails===ErrorDetails.BUFFER_ADD_CODEC_ERROR||errorDetails===ErrorDetails.BUFFER_APPEND_ERROR))&&levels.some((({audioCodec})=>level.audioCodec!==audioCodec)),findVideoCodecAlternate="video"===data.sourceBufferName&&(errorDetails===ErrorDetails.BUFFER_ADD_CODEC_ERROR||errorDetails===ErrorDetails.BUFFER_APPEND_ERROR)&&levels.some((({codecSet,audioCodec})=>level.codecSet!==codecSet&&level.audioCodec===audioCodec)),{type:playlistErrorType,groupId:playlistErrorGroupId}=null!=(_data$context2=data.context)?_data$context2:{};for(let i=levels.length;i--;){const candidate=(i+loadLevel)%levels.length;if(candidate!==loadLevel&&candidate>=minAutoLevel&&candidate<=maxAutoLevel&&0===levels[candidate].loadError){var _level$audioGroups,_level$subtitleGroups;const levelCandidate=levels[candidate];if(errorDetails===ErrorDetails.FRAG_GAP&&fragErrorType===PlaylistLevelType_MAIN&&data.frag){const levelDetails=levels[candidate].details;if(levelDetails){const fragCandidate=findFragmentByPTS(data.frag,levelDetails.fragments,data.frag.start);if(null!=fragCandidate&&fragCandidate.gap)continue}}else{if(playlistErrorType===PlaylistContextType_AUDIO_TRACK&&levelCandidate.hasAudioGroup(playlistErrorGroupId)||playlistErrorType===PlaylistContextType_SUBTITLE_TRACK&&levelCandidate.hasSubtitleGroup(playlistErrorGroupId))continue;if(fragErrorType===PlaylistLevelType_AUDIO&&null!=(_level$audioGroups=level.audioGroups)&&_level$audioGroups.some((groupId=>levelCandidate.hasAudioGroup(groupId)))||fragErrorType===PlaylistLevelType_SUBTITLE&&null!=(_level$subtitleGroups=level.subtitleGroups)&&_level$subtitleGroups.some((groupId=>levelCandidate.hasSubtitleGroup(groupId)))||findAudioCodecAlternate&&level.audioCodec===levelCandidate.audioCodec||!findAudioCodecAlternate&&level.audioCodec!==levelCandidate.audioCodec||findVideoCodecAlternate&&level.codecSet===levelCandidate.codecSet)continue}nextLevel=candidate;break}}if(nextLevel>-1&&hls.loadLevel!==nextLevel)return data.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction_SendAlternateToPenaltyBox,flags:ErrorActionFlags_None,nextAutoLevel:nextLevel}}return{action:NetworkErrorAction_SendAlternateToPenaltyBox,flags:ErrorActionFlags_MoveAllAlternatesMatchingHost}}onErrorOut(event,data){var _data$errorAction;switch(null==(_data$errorAction=data.errorAction)?void 0:_data$errorAction.action){case NetworkErrorAction_DoNothing:break;case NetworkErrorAction_SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(data),data.errorAction.resolved||data.details===ErrorDetails.FRAG_GAP?/MediaSource readyState: ended/.test(data.error.message)&&(this.warn(`MediaSource ended after "${data.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):data.fatal=!0}data.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(data){const hls=this.hls,errorAction=data.errorAction;if(!errorAction)return;const{flags,hdcpLevel,nextAutoLevel}=errorAction;switch(flags){case ErrorActionFlags_None:this.switchLevel(data,nextAutoLevel);break;case ErrorActionFlags_MoveAllAlternatesMatchingHDCP:hdcpLevel&&(hls.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(hdcpLevel)-1],errorAction.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${hls.maxHdcpLevel}" or lower`)}errorAction.resolved||this.switchLevel(data,nextAutoLevel)}switchLevel(data,levelIndex){void 0!==levelIndex&&data.errorAction&&(this.warn(`switching to level ${levelIndex} after ${data.details}`),this.hls.nextAutoLevel=levelIndex,data.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}},fpsController:class FPSController{constructor(hls){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=hls,this.registerListeners()}setStreamController(streamController){this.streamController=streamController}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(event,data){const config=this.hls.config;if(config.capLevelOnFPSDrop){const media=data.media instanceof self.HTMLVideoElement?data.media:null;this.media=media,media&&"function"==typeof media.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),config.fpsDroppedMonitoringPeriod)}}checkFPS(video,decodedFrames,droppedFrames){const currentTime=performance.now();if(decodedFrames){if(this.lastTime){const currentPeriod=currentTime-this.lastTime,currentDropped=droppedFrames-this.lastDroppedFrames,currentDecoded=decodedFrames-this.lastDecodedFrames,droppedFPS=1e3*currentDropped/currentPeriod,hls=this.hls;if(hls.trigger(Events.FPS_DROP,{currentDropped,currentDecoded,totalDroppedFrames:droppedFrames}),droppedFPS>0&&currentDropped>hls.config.fpsDroppedMonitoringThreshold*currentDecoded){let currentLevel=hls.currentLevel;logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+currentLevel),currentLevel>0&&(-1===hls.autoLevelCapping||hls.autoLevelCapping>=currentLevel)&&(currentLevel-=1,hls.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:currentLevel,droppedLevel:hls.currentLevel}),hls.autoLevelCapping=currentLevel,this.streamController.nextLevelSwitch())}}this.lastTime=currentTime,this.lastDroppedFrames=droppedFrames,this.lastDecodedFrames=decodedFrames}}checkFPSInterval(){const video=this.media;if(video)if(this.isVideoPlaybackQualityAvailable){const videoPlaybackQuality=video.getVideoPlaybackQuality();this.checkFPS(video,videoPlaybackQuality.totalVideoFrames,videoPlaybackQuality.droppedVideoFrames)}else this.checkFPS(video,video.webkitDecodedFrameCount,video.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:class SubtitleStreamController extends BaseStreamController{constructor(hls,fragmentTracker,keyLoader){super(hls,fragmentTracker,keyLoader,"[subtitle-stream-controller]",PlaylistLevelType_SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(Events.ERROR,this.onError,this),hls.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),hls.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),hls.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(Events.ERROR,this.onError,this),hls.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),hls.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),hls.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(startPosition){this.stopLoad(),this.state=State_IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=startPosition,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(event,data){this.mainDetails=data.details}onSubtitleFragProcessed(event,data){const{frag,success}=data;if(this.fragPrevious=frag,this.state=State_IDLE,!success)return;const buffered=this.tracksBuffered[this.currentTrackId];if(!buffered)return;let timeRange;const fragStart=frag.start;for(let i=0;i<buffered.length;i++)if(fragStart>=buffered[i].start&&fragStart<=buffered[i].end){timeRange=buffered[i];break}const fragEnd=frag.start+frag.duration;timeRange?timeRange.end=fragEnd:(timeRange={start:fragStart,end:fragEnd},buffered.push(timeRange)),this.fragmentTracker.fragBuffered(frag),this.fragBufferedComplete(frag,null)}onBufferFlushing(event,data){const{startOffset,endOffset}=data;if(0===startOffset&&endOffset!==Number.POSITIVE_INFINITY){const endOffsetSubtitles=endOffset-1;if(endOffsetSubtitles<=0)return;data.endOffsetSubtitles=Math.max(0,endOffsetSubtitles),this.tracksBuffered.forEach((buffered=>{for(let i=0;i<buffered.length;)if(buffered[i].end<=endOffsetSubtitles)buffered.shift();else{if(!(buffered[i].start<endOffsetSubtitles))break;buffered[i].start=endOffsetSubtitles,i++}})),this.fragmentTracker.removeFragmentsInRange(startOffset,endOffsetSubtitles,PlaylistLevelType_SUBTITLE)}}onFragBuffered(event,data){var _this$media;this.loadedmetadata||data.frag.type!==PlaylistLevelType_MAIN||null!=(_this$media=this.media)&&_this$media.buffered.length&&(this.loadedmetadata=!0)}onError(event,data){const frag=data.frag;(null==frag?void 0:frag.type)===PlaylistLevelType_SUBTITLE&&(data.details===ErrorDetails.FRAG_GAP&&this.fragmentTracker.fragBuffered(frag,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State_STOPPED&&(this.state=State_IDLE))}onSubtitleTracksUpdated(event,{subtitleTracks}){this.levels&&subtitleOptionsIdentical(this.levels,subtitleTracks)?this.levels=subtitleTracks.map((mediaPlaylist=>new Level(mediaPlaylist))):(this.tracksBuffered=[],this.levels=subtitleTracks.map((mediaPlaylist=>{const level=new Level(mediaPlaylist);return this.tracksBuffered[level.id]=[],level})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType_SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(event,data){var _this$levels;if(this.currentTrackId=data.id,null==(_this$levels=this.levels)||!_this$levels.length||-1===this.currentTrackId)return void this.clearInterval();const currentTrack=this.levels[this.currentTrackId];null!=currentTrack&&currentTrack.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,currentTrack&&this.setInterval(500)}onSubtitleTrackLoaded(event,data){var _track$details;const{currentTrackId,levels}=this,{details:newDetails,id:trackId}=data;if(!levels)return void this.warn(`Subtitle tracks were reset while loading level ${trackId}`);const track=levels[trackId];if(trackId>=levels.length||!track)return;this.log(`Subtitle track ${trackId} loaded [${newDetails.startSN},${newDetails.endSN}]${newDetails.lastPartSn?`[part-${newDetails.lastPartSn}-${newDetails.lastPartIndex}]`:""},duration:${newDetails.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let sliding=0;if(newDetails.live||null!=(_track$details=track.details)&&_track$details.live){const mainDetails=this.mainDetails;if(newDetails.deltaUpdateFailed||!mainDetails)return;const mainSlidingStartFragment=mainDetails.fragments[0];var _this$levelLastLoaded;if(track.details)sliding=this.alignPlaylists(newDetails,track.details,null==(_this$levelLastLoaded=this.levelLastLoaded)?void 0:_this$levelLastLoaded.details),0===sliding&&mainSlidingStartFragment&&(sliding=mainSlidingStartFragment.start,addSliding(newDetails,sliding));else newDetails.hasProgramDateTime&&mainDetails.hasProgramDateTime?(alignMediaPlaylistByPDT(newDetails,mainDetails),sliding=newDetails.fragments[0].start):mainSlidingStartFragment&&(sliding=mainSlidingStartFragment.start,addSliding(newDetails,sliding))}if(track.details=newDetails,this.levelLastLoaded=track,trackId===currentTrackId&&(this.startFragRequested||!this.mainDetails&&newDetails.live||this.setStartPosition(this.mainDetails||newDetails,sliding),this.tick(),newDetails.live&&!this.fragCurrent&&this.media&&this.state===State_IDLE)){findFragmentByPTS(null,newDetails.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),track.details=void 0)}}_handleFragmentLoadComplete(fragLoadedData){const{frag,payload}=fragLoadedData,decryptData=frag.decryptdata,hls=this.hls;if(!this.fragContextChanged(frag)&&payload&&payload.byteLength>0&&null!=decryptData&&decryptData.key&&decryptData.iv&&"AES-128"===decryptData.method){const startTime=performance.now();this.decrypter.decrypt(new Uint8Array(payload),decryptData.key.buffer,decryptData.iv.buffer).catch((err=>{throw hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:err,reason:err.message,frag}),err})).then((decryptedData=>{const endTime=performance.now();hls.trigger(Events.FRAG_DECRYPTED,{frag,payload:decryptedData,stats:{tstart:startTime,tdecrypt:endTime}})})).catch((err=>{this.warn(`${err.name}: ${err.message}`),this.state=State_IDLE}))}}doTick(){if(this.media){if(this.state===State_IDLE){const{currentTrackId,levels}=this,track=null==levels?void 0:levels[currentTrackId];if(!track||!levels.length||!track.details)return;const{config}=this,currentTime=this.getLoadPosition(),bufferedInfo=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],currentTime,config.maxBufferHole),{end:targetBufferTime,len:bufferLen}=bufferedInfo,mainBufferInfo=this.getFwdBufferInfo(this.media,PlaylistLevelType_MAIN),trackDetails=track.details;if(bufferLen>this.getMaxBufferLength(null==mainBufferInfo?void 0:mainBufferInfo.len)+trackDetails.levelTargetDuration)return;const fragments=trackDetails.fragments,fragLen=fragments.length,end=trackDetails.edge;let foundFrag=null;const fragPrevious=this.fragPrevious;if(targetBufferTime<end){const tolerance=config.maxFragLookUpTolerance,lookupTolerance=targetBufferTime>end-tolerance?0:tolerance;foundFrag=findFragmentByPTS(fragPrevious,fragments,Math.max(fragments[0].start,targetBufferTime),lookupTolerance),!foundFrag&&fragPrevious&&fragPrevious.start<fragments[0].start&&(foundFrag=fragments[0])}else foundFrag=fragments[fragLen-1];if(!foundFrag)return;if(foundFrag=this.mapToInitFragWhenRequired(foundFrag),"initSegment"!==foundFrag.sn){const prevFrag=fragments[foundFrag.sn-trackDetails.startSN-1];prevFrag&&prevFrag.cc===foundFrag.cc&&this.fragmentTracker.getState(prevFrag)===FragmentState_NOT_LOADED&&(foundFrag=prevFrag)}this.fragmentTracker.getState(foundFrag)===FragmentState_NOT_LOADED&&this.loadFragment(foundFrag,track,targetBufferTime)}}else this.state=State_IDLE}getMaxBufferLength(mainBufferLength){const maxConfigBuffer=super.getMaxBufferLength();return mainBufferLength?Math.max(maxConfigBuffer,mainBufferLength):maxConfigBuffer}loadFragment(frag,level,targetBufferTime){this.fragCurrent=frag,"initSegment"===frag.sn?this._loadInitSegment(frag,level):(this.startFragRequested=!0,super.loadFragment(frag,level,targetBufferTime))}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class SubtitleTrackController extends BasePlaylistController{constructor(hls){super(hls,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let textTrack=null;const tracks=filterSubtitleTracks(this.media.textTracks);for(let i=0;i<tracks.length;i++)if("hidden"===tracks[i].mode)textTrack=tracks[i];else if("showing"===tracks[i].mode){textTrack=tracks[i];break}const trackId=this.findTrackForTextTrack(textTrack);this.subtitleTrack!==trackId&&this.setSubtitleTrack(trackId)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(value){this._subtitleDisplay=value,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),hls.off(Events.ERROR,this.onError,this)}onMediaAttached(event,data){this.media=data.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(timeout){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,timeout)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);filterSubtitleTracks(this.media.textTracks).forEach((track=>{clearCurrentCues(track)})),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(event,data){this.tracks=data.subtitleTracks}onSubtitleTrackLoaded(event,data){const{id,groupId,details}=data,trackInActiveGroup=this.tracksInGroup[id];if(!trackInActiveGroup||trackInActiveGroup.groupId!==groupId)return void this.warn(`Subtitle track with id:${id} and group:${groupId} not found in active group ${null==trackInActiveGroup?void 0:trackInActiveGroup.groupId}`);const curDetails=trackInActiveGroup.details;trackInActiveGroup.details=data.details,this.log(`Subtitle track ${id} "${trackInActiveGroup.name}" lang:${trackInActiveGroup.lang} group:${groupId} loaded [${details.startSN}-${details.endSN}]`),id===this.trackId&&this.playlistLoaded(id,data,curDetails)}onLevelLoading(event,data){this.switchLevel(data.level)}onLevelSwitching(event,data){this.switchLevel(data.level)}switchLevel(levelIndex){const levelInfo=this.hls.levels[levelIndex];if(!levelInfo)return;const subtitleGroups=levelInfo.subtitleGroups||null,currentGroups=this.groupIds;let currentTrack=this.currentTrack;if(!subtitleGroups||(null==currentGroups?void 0:currentGroups.length)!==(null==subtitleGroups?void 0:subtitleGroups.length)||null!=subtitleGroups&&subtitleGroups.some((groupId=>-1===(null==currentGroups?void 0:currentGroups.indexOf(groupId))))){this.groupIds=subtitleGroups,this.trackId=-1,this.currentTrack=null;const subtitleTracks=this.tracks.filter((track=>!subtitleGroups||-1!==subtitleGroups.indexOf(track.groupId)));if(subtitleTracks.length)this.selectDefaultTrack&&!subtitleTracks.some((track=>track.default))&&(this.selectDefaultTrack=!1),subtitleTracks.forEach(((track,i)=>{track.id=i}));else if(!currentTrack&&!this.tracksInGroup.length)return;this.tracksInGroup=subtitleTracks;const subtitlePreference=this.hls.config.subtitlePreference;if(!currentTrack&&subtitlePreference){this.selectDefaultTrack=!1;const groupIndex=findMatchingOption(subtitlePreference,subtitleTracks);if(groupIndex>-1)currentTrack=subtitleTracks[groupIndex];else{const allIndex=findMatchingOption(subtitlePreference,this.tracks);currentTrack=this.tracks[allIndex]}}let trackId=this.findTrackId(currentTrack);-1===trackId&&currentTrack&&(trackId=this.findTrackId(null));const subtitleTracksUpdated={subtitleTracks};this.log(`Updating subtitle tracks, ${subtitleTracks.length} track(s) found in "${null==subtitleGroups?void 0:subtitleGroups.join(",")}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,subtitleTracksUpdated),-1!==trackId&&-1===this.trackId&&this.setSubtitleTrack(trackId)}else this.shouldReloadPlaylist(currentTrack)&&this.setSubtitleTrack(this.trackId)}findTrackId(currentTrack){const tracks=this.tracksInGroup,selectDefault=this.selectDefaultTrack;for(let i=0;i<tracks.length;i++){const track=tracks[i];if((!selectDefault||track.default)&&(selectDefault||currentTrack)&&(!currentTrack||matchesOption(track,currentTrack)))return i}if(currentTrack){for(let i=0;i<tracks.length;i++){const track=tracks[i];if(mediaAttributesIdentical(currentTrack.attrs,track.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<tracks.length;i++){const track=tracks[i];if(mediaAttributesIdentical(currentTrack.attrs,track.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(textTrack){if(textTrack){const tracks=this.tracksInGroup;for(let i=0;i<tracks.length;i++){if(subtitleTrackMatchesTextTrack(tracks[i],textTrack))return i}}return-1}onError(event,data){!data.fatal&&data.context&&(data.context.type!==PlaylistContextType_SUBTITLE_TRACK||data.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(data.context.groupId)||this.checkRetry(data))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(newId){this.selectDefaultTrack=!1,this.setSubtitleTrack(newId)}setSubtitleOption(subtitleOption){if(this.hls.config.subtitlePreference=subtitleOption,subtitleOption){const allSubtitleTracks=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,allSubtitleTracks.length){const currentTrack=this.currentTrack;if(currentTrack&&matchesOption(subtitleOption,currentTrack))return currentTrack;const groupIndex=findMatchingOption(subtitleOption,this.tracksInGroup);if(groupIndex>-1){const track=this.tracksInGroup[groupIndex];return this.setSubtitleTrack(groupIndex),track}if(currentTrack)return null;{const allIndex=findMatchingOption(subtitleOption,allSubtitleTracks);if(allIndex>-1)return allSubtitleTracks[allIndex]}}}return null}loadPlaylist(hlsUrlParameters){super.loadPlaylist();const currentTrack=this.currentTrack;if(this.shouldLoadPlaylist(currentTrack)&&currentTrack){const id=currentTrack.id,groupId=currentTrack.groupId;let url=currentTrack.url;if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn(`Could not construct new URL with HLS Delivery Directives: ${error}`)}this.log(`Loading subtitle playlist for id ${id}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url,id,groupId,deliveryDirectives:hlsUrlParameters||null})}}toggleTrackModes(){const{media}=this;if(!media)return;const textTracks=filterSubtitleTracks(media.textTracks),currentTrack=this.currentTrack;let nextTrack;if(currentTrack&&(nextTrack=textTracks.filter((textTrack=>subtitleTrackMatchesTextTrack(currentTrack,textTrack)))[0],nextTrack||this.warn(`Unable to find subtitle TextTrack with name "${currentTrack.name}" and language "${currentTrack.lang}"`)),[].slice.call(textTracks).forEach((track=>{"disabled"!==track.mode&&track!==nextTrack&&(track.mode="disabled")})),nextTrack){const mode=this.subtitleDisplay?"showing":"hidden";nextTrack.mode!==mode&&(nextTrack.mode=mode)}}setSubtitleTrack(newId){const tracks=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=newId);if(newId<-1||newId>=tracks.length||!isFiniteNumber(newId))return void this.warn(`Invalid subtitle track id: ${newId}`);this.clearTimer(),this.selectDefaultTrack=!1;const lastTrack=this.currentTrack,track=tracks[newId]||null;if(this.trackId=newId,this.currentTrack=track,this.toggleTrackModes(),!track)return void this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:newId});const trackLoaded=!!track.details&&!track.details.live;if(newId===this.trackId&&track===lastTrack&&trackLoaded)return;this.log(`Switching to subtitle-track ${newId}`+(track?` "${track.name}" lang:${track.lang} group:${track.groupId}`:""));const{id,groupId="",name,type,url}=track;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id,groupId,name,type,url});const hlsUrlParameters=this.switchParams(track.url,null==lastTrack?void 0:lastTrack.details,track.details);this.loadPlaylist(hlsUrlParameters)}},timelineController:class TimelineController{constructor(hls){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=hls,this.config=hls.config,this.Cues=hls.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.on(Events.FRAG_LOADING,this.onFragLoading,this),hls.on(Events.FRAG_LOADED,this.onFragLoaded,this),hls.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),hls.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),hls.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),hls.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls}=this;hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),hls.off(Events.FRAG_LOADING,this.onFragLoading,this),hls.off(Events.FRAG_LOADED,this.onFragLoaded,this),hls.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),hls.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),hls.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),hls.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const channel1=new OutputFilter(this,"textTrack1"),channel2=new OutputFilter(this,"textTrack2"),channel3=new OutputFilter(this,"textTrack3"),channel4=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,channel1,channel2),this.cea608Parser2=new Cea608Parser(3,channel3,channel4)}}addCues(trackName,startTime,endTime,screen,cueRanges){let merged=!1;for(let i=cueRanges.length;i--;){const cueRange=cueRanges[i],overlap=(x1=cueRange[0],x2=cueRange[1],y1=startTime,y2=endTime,Math.min(x2,y2)-Math.max(x1,y1));if(overlap>=0&&(cueRange[0]=Math.min(cueRange[0],startTime),cueRange[1]=Math.max(cueRange[1],endTime),merged=!0,overlap/(endTime-startTime)>.5))return}var x1,x2,y1,y2;if(merged||cueRanges.push([startTime,endTime]),this.config.renderTextTracksNatively){const track=this.captionsTracks[trackName];this.Cues.newCue(track,startTime,endTime,screen)}else{const cues=this.Cues.newCue(null,startTime,endTime,screen);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues,track:trackName})}}onInitPtsFound(event,{frag,id,initPTS,timescale}){const{unparsedVttFrags}=this;"main"===id&&(this.initPTS[frag.cc]={baseTime:initPTS,timescale}),unparsedVttFrags.length&&(this.unparsedVttFrags=[],unparsedVttFrags.forEach((frag=>{this.onFragLoaded(Events.FRAG_LOADED,frag)})))}getExistingTrack(label,language){const{media}=this;if(media)for(let i=0;i<media.textTracks.length;i++){const textTrack=media.textTracks[i];if(canReuseVttTextTrack(textTrack,{name:label,lang:language,attrs:{}}))return textTrack}return null}createCaptionsTrack(trackName){this.config.renderTextTracksNatively?this.createNativeTrack(trackName):this.createNonNativeTrack(trackName)}createNativeTrack(trackName){if(this.captionsTracks[trackName])return;const{captionsProperties,captionsTracks,media}=this,{label,languageCode}=captionsProperties[trackName],existingTrack=this.getExistingTrack(label,languageCode);if(existingTrack)captionsTracks[trackName]=existingTrack,clearCurrentCues(captionsTracks[trackName]),sendAddTrackEvent(captionsTracks[trackName],media);else{const textTrack=this.createTextTrack("captions",label,languageCode);textTrack&&(textTrack[trackName]=!0,captionsTracks[trackName]=textTrack)}}createNonNativeTrack(trackName){if(this.nonNativeCaptionsTracks[trackName])return;const trackProperties=this.captionsProperties[trackName];if(!trackProperties)return;const track={_id:trackName,label:trackProperties.label,kind:"captions",default:!!trackProperties.media&&!!trackProperties.media.default,closedCaptions:trackProperties.media};this.nonNativeCaptionsTracks[trackName]=track,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[track]})}createTextTrack(kind,label,lang){const media=this.media;if(media)return media.addTextTrack(kind,label,lang)}onMediaAttaching(event,data){this.media=data.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks}=this;Object.keys(captionsTracks).forEach((trackName=>{clearCurrentCues(captionsTracks[trackName]),delete captionsTracks[trackName]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media}=this;if(!media)return;const textTracks=media.textTracks;if(textTracks)for(let i=0;i<textTracks.length;i++)clearCurrentCues(textTracks[i])}onSubtitleTracksUpdated(event,data){const tracks=data.subtitleTracks||[],hasIMSC1=tracks.some((track=>"stpp.ttml.im1t"===track.textCodec));if(this.config.enableWebVTT||hasIMSC1&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,tracks))return void(this.tracks=tracks);if(this.textTracks=[],this.tracks=tracks,this.config.renderTextTracksNatively){const media=this.media,inUseTracks=media?filterSubtitleTracks(media.textTracks):null;if(this.tracks.forEach(((track,index)=>{let textTrack;if(inUseTracks){let inUseTrack=null;for(let i=0;i<inUseTracks.length;i++)if(inUseTracks[i]&&canReuseVttTextTrack(inUseTracks[i],track)){inUseTrack=inUseTracks[i],inUseTracks[i]=null;break}inUseTrack&&(textTrack=inUseTrack)}if(textTrack)clearCurrentCues(textTrack);else{const textTrackKind=captionsOrSubtitlesFromCharacteristics(track);textTrack=this.createTextTrack(textTrackKind,track.name,track.lang),textTrack&&(textTrack.mode="disabled")}textTrack&&this.textTracks.push(textTrack)})),null!=inUseTracks&&inUseTracks.length){const unusedTextTracks=inUseTracks.filter((t=>null!==t)).map((t=>t.label));unusedTextTracks.length&&logger.warn(`Media element contains unused subtitle tracks: ${unusedTextTracks.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const tracksList=this.tracks.map((track=>({label:track.name,kind:track.type.toLowerCase(),default:track.default,subtitleTrack:track})));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:tracksList})}}}onManifestLoaded(event,data){this.config.enableCEA708Captions&&data.captions&&data.captions.forEach((captionsTrack=>{const instreamIdMatch=/(?:CC|SERVICE)([1-4])/.exec(captionsTrack.instreamId);if(!instreamIdMatch)return;const trackName=`textTrack${instreamIdMatch[1]}`,trackProperties=this.captionsProperties[trackName];trackProperties&&(trackProperties.label=captionsTrack.name,captionsTrack.lang&&(trackProperties.languageCode=captionsTrack.lang),trackProperties.media=captionsTrack)}))}closedCaptionsForLevel(frag){const level=this.hls.levels[frag.level];return null==level?void 0:level.attrs["CLOSED-CAPTIONS"]}onFragLoading(event,data){if(this.enabled&&data.frag.type===PlaylistLevelType_MAIN){var _data$part$index,_data$part;const{cea608Parser1,cea608Parser2,lastSn}=this,{cc,sn}=data.frag,partIndex=null!=(_data$part$index=null==(_data$part=data.part)?void 0:_data$part.index)?_data$part$index:-1;cea608Parser1&&cea608Parser2&&(sn!==lastSn+1||sn===lastSn&&partIndex!==this.lastPartIndex+1||cc!==this.lastCc)&&(cea608Parser1.reset(),cea608Parser2.reset()),this.lastCc=cc,this.lastSn=sn,this.lastPartIndex=partIndex}}onFragLoaded(event,data){const{frag,payload}=data;if(frag.type===PlaylistLevelType_SUBTITLE)if(payload.byteLength){const decryptData=frag.decryptdata,decrypted="stats"in data;if(null==decryptData||!decryptData.encrypted||decrypted){const trackPlaylistMedia=this.tracks[frag.level],vttCCs=this.vttCCs;vttCCs[frag.cc]||(vttCCs[frag.cc]={start:frag.start,prevCC:this.prevCC,new:!0},this.prevCC=frag.cc),trackPlaylistMedia&&"stpp.ttml.im1t"===trackPlaylistMedia.textCodec?this._parseIMSC1(frag,payload):this._parseVTTs(data)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag,error:new Error("Empty subtitle payload")})}_parseIMSC1(frag,payload){const hls=this.hls;parseIMSC1(payload,this.initPTS[frag.cc],(cues=>{this._appendCues(cues,frag.level),hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag})}),(error=>{logger.log(`Failed to parse IMSC1: ${error}`),hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag,error})}))}_parseVTTs(data){var _frag$initSegment;const{frag,payload}=data,{initPTS,unparsedVttFrags}=this,maxAvCC=initPTS.length-1;if(!initPTS[frag.cc]&&-1===maxAvCC)return void unparsedVttFrags.push(data);const hls=this.hls;parseWebVTT(null!=(_frag$initSegment=frag.initSegment)&&_frag$initSegment.data?appendUint8Array(frag.initSegment.data,new Uint8Array(payload)):payload,this.initPTS[frag.cc],this.vttCCs,frag.cc,frag.start,(cues=>{this._appendCues(cues,frag.level),hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag})}),(error=>{const missingInitPTS="Missing initPTS for VTT MPEGTS"===error.message;missingInitPTS?unparsedVttFrags.push(data):this._fallbackToIMSC1(frag,payload),logger.log(`Failed to parse VTT cue: ${error}`),missingInitPTS&&maxAvCC>frag.cc||hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag,error})}))}_fallbackToIMSC1(frag,payload){const trackPlaylistMedia=this.tracks[frag.level];trackPlaylistMedia.textCodec||parseIMSC1(payload,this.initPTS[frag.cc],(()=>{trackPlaylistMedia.textCodec="stpp.ttml.im1t",this._parseIMSC1(frag,payload)}),(()=>{trackPlaylistMedia.textCodec="wvtt"}))}_appendCues(cues,fragLevel){const hls=this.hls;if(this.config.renderTextTracksNatively){const textTrack=this.textTracks[fragLevel];if(!textTrack||"disabled"===textTrack.mode)return;cues.forEach((cue=>addCueToTrack(textTrack,cue)))}else{const currentTrack=this.tracks[fragLevel];if(!currentTrack)return;const track=currentTrack.default?"default":"subtitles"+fragLevel;hls.trigger(Events.CUES_PARSED,{type:"subtitles",cues,track})}}onFragDecrypted(event,data){const{frag}=data;frag.type===PlaylistLevelType_SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,data)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(event,data){this.initCea608Parsers();const{cea608Parser1,cea608Parser2}=this;if(!this.enabled||!cea608Parser1||!cea608Parser2)return;const{frag,samples}=data;if(frag.type!==PlaylistLevelType_MAIN||"NONE"!==this.closedCaptionsForLevel(frag))for(let i=0;i<samples.length;i++){const ccBytes=samples[i].bytes;if(ccBytes){const ccdatas=this.extractCea608Data(ccBytes);cea608Parser1.addData(samples[i].pts,ccdatas[0]),cea608Parser2.addData(samples[i].pts,ccdatas[1])}}}onBufferFlushing(event,{startOffset,endOffset,endOffsetSubtitles,type}){const{media}=this;if(media&&!(media.currentTime<endOffset)){if(!type||"video"===type){const{captionsTracks}=this;Object.keys(captionsTracks).forEach((trackName=>removeCuesInRange(captionsTracks[trackName],startOffset,endOffset)))}if(this.config.renderTextTracksNatively&&0===startOffset&&void 0!==endOffsetSubtitles){const{textTracks}=this;Object.keys(textTracks).forEach((trackName=>removeCuesInRange(textTracks[trackName],startOffset,endOffsetSubtitles)))}}}extractCea608Data(byteArray){const actualCCBytes=[[],[]],count=31&byteArray[0];let position=2;for(let j=0;j<count;j++){const tmpByte=byteArray[position++],ccbyte1=127&byteArray[position++],ccbyte2=127&byteArray[position++];if(0===ccbyte1&&0===ccbyte2)continue;if(!!(4&tmpByte)){const ccType=3&tmpByte;0!==ccType&&1!==ccType||(actualCCBytes[ccType].push(ccbyte1),actualCCBytes[ccType].push(ccbyte2))}}return actualCCBytes}},audioStreamController:class AudioStreamController extends BaseStreamController{constructor(hls,fragmentTracker,keyLoader){super(hls,fragmentTracker,keyLoader,"[audio-stream-controller]",PlaylistLevelType_AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),hls.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.on(Events.ERROR,this.onError,this),hls.on(Events.BUFFER_RESET,this.onBufferReset,this),hls.on(Events.BUFFER_CREATED,this.onBufferCreated,this),hls.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),hls.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.off(Events.ERROR,this.onError,this),hls.off(Events.BUFFER_RESET,this.onBufferReset,this),hls.off(Events.BUFFER_CREATED,this.onBufferCreated,this),hls.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),hls.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(event,{frag,id,initPTS,timescale}){if("main"===id){const cc=frag.cc;this.initPTS[frag.cc]={baseTime:initPTS,timescale},this.log(`InitPTS for cc: ${cc} found from main: ${initPTS}`),this.videoTrackCC=cc,this.state===State_WAITING_INIT_PTS&&this.tick()}}startLoad(startPosition){if(!this.levels)return this.startPosition=startPosition,void(this.state=State_STOPPED);const lastCurrentTime=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),lastCurrentTime>0&&-1===startPosition?(this.log(`Override startPosition with lastCurrentTime @${lastCurrentTime.toFixed(3)}`),startPosition=lastCurrentTime,this.state=State_IDLE):(this.loadedmetadata=!1,this.state=State_WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=startPosition,this.tick()}doTick(){switch(this.state){case State_IDLE:this.doTickIdle();break;case State_WAITING_TRACK:{var _levels$trackId;const{levels,trackId}=this,details=null==levels||null==(_levels$trackId=levels[trackId])?void 0:_levels$trackId.details;if(details){if(this.waitForCdnTuneIn(details))break;this.state=State_WAITING_INIT_PTS}break}case State_FRAG_LOADING_WAITING_RETRY:{var _this$media;const now=performance.now(),retryDate=this.retryDate;if(!retryDate||now>=retryDate||null!=(_this$media=this.media)&&_this$media.seeking){const{levels,trackId}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==levels?void 0:levels[trackId])||null),this.state=State_IDLE}break}case State_WAITING_INIT_PTS:{const waitingData=this.waitingData;if(waitingData){const{frag,part,cache,complete}=waitingData;if(void 0!==this.initPTS[frag.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=State_FRAG_LOADING;const data={frag,part,payload:cache.flush(),networkDetails:null};this._handleFragmentLoadProgress(data),complete&&super._handleFragmentLoadComplete(data)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${frag.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const pos=this.getLoadPosition(),bufferInfo=BufferHelper.bufferInfo(this.mediaBuffer,pos,this.config.maxBufferHole);fragmentWithinToleranceTest(bufferInfo.end,this.config.maxFragLookUpTolerance,frag)<0&&(this.log(`Waiting fragment cc (${frag.cc}) @ ${frag.start} cancelled because another fragment at ${bufferInfo.end} is needed`),this.clearWaitingFragment())}}else this.state=State_IDLE}}this.onTickEnd()}clearWaitingFragment(){const waitingData=this.waitingData;waitingData&&(this.fragmentTracker.removeFragment(waitingData.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=State_IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media}=this;null!=media&&media.readyState&&(this.lastCurrentTime=media.currentTime)}doTickIdle(){const{hls,levels,media,trackId}=this,config=hls.config;if(!media&&(this.startFragRequested||!config.startFragPrefetch)||null==levels||!levels[trackId])return;const levelInfo=levels[trackId],trackDetails=levelInfo.details;if(!trackDetails||trackDetails.live&&this.levelLastLoaded!==levelInfo||this.waitForCdnTuneIn(trackDetails))return void(this.state=State_WAITING_TRACK);const bufferable=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&bufferable&&(this.bufferFlushed=!1,this.afterBufferFlushed(bufferable,ElementaryStreamTypes_AUDIO,PlaylistLevelType_AUDIO));const bufferInfo=this.getFwdBufferInfo(bufferable,PlaylistLevelType_AUDIO);if(null===bufferInfo)return;const{bufferedTrack,switchingTrack}=this;if(!switchingTrack&&this._streamEnded(bufferInfo,trackDetails))return hls.trigger(Events.BUFFER_EOS,{type:"audio"}),void(this.state=State_ENDED);const mainBufferInfo=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,PlaylistLevelType_MAIN),bufferLen=bufferInfo.len,maxBufLen=this.getMaxBufferLength(null==mainBufferInfo?void 0:mainBufferInfo.len),fragments=trackDetails.fragments,start=fragments[0].start;let targetBufferTime=this.flushing?this.getLoadPosition():bufferInfo.end;if(switchingTrack&&media){const pos=this.getLoadPosition();bufferedTrack&&!mediaAttributesIdentical(switchingTrack.attrs,bufferedTrack.attrs)&&(targetBufferTime=pos),trackDetails.PTSKnown&&pos<start&&(bufferInfo.end>start||bufferInfo.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),media.currentTime=start+.05)}if(bufferLen>=maxBufLen&&!switchingTrack&&targetBufferTime<fragments[fragments.length-1].start)return;let frag=this.getNextFragment(targetBufferTime,trackDetails),atGap=!1;if(frag&&this.isLoopLoading(frag,targetBufferTime)&&(atGap=!!frag.gap,frag=this.getNextFragmentLoopLoading(frag,trackDetails,bufferInfo,PlaylistLevelType_MAIN,maxBufLen)),!frag)return void(this.bufferFlushed=!0);const atBufferSyncLimit=mainBufferInfo&&frag.start>mainBufferInfo.end+trackDetails.targetduration;if(atBufferSyncLimit||(null==mainBufferInfo||!mainBufferInfo.len)&&bufferInfo.len){const mainFrag=this.getAppendedFrag(frag.start,PlaylistLevelType_MAIN);if(null===mainFrag)return;if(atGap||(atGap=!!mainFrag.gap||!!atBufferSyncLimit&&0===mainBufferInfo.len),atBufferSyncLimit&&!atGap||atGap&&bufferInfo.nextStart&&bufferInfo.nextStart<mainFrag.end)return}this.loadFragment(frag,levelInfo,targetBufferTime)}getMaxBufferLength(mainBufferLength){const maxConfigBuffer=super.getMaxBufferLength();return mainBufferLength?Math.min(Math.max(maxConfigBuffer,mainBufferLength),this.config.maxMaxBufferLength):maxConfigBuffer}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(event,{audioTracks}){this.resetTransmuxer(),this.levels=audioTracks.map((mediaPlaylist=>new Level(mediaPlaylist)))}onAudioTrackSwitching(event,data){const altAudio=!!data.url;this.trackId=data.id;const{fragCurrent}=this;fragCurrent&&(fragCurrent.abortRequests(),this.removeUnbufferedFrags(fragCurrent.start)),this.resetLoadingState(),altAudio?this.setInterval(100):this.resetTransmuxer(),altAudio?(this.switchingTrack=data,this.state=State_IDLE,this.flushAudioIfNeeded(data)):(this.switchingTrack=null,this.bufferedTrack=data,this.state=State_STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(event,data){this.mainDetails=data.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(event,data){var _track$details;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=data);const{levels}=this,{details:newDetails,id:trackId}=data;if(!levels)return void this.warn(`Audio tracks were reset while loading level ${trackId}`);this.log(`Audio track ${trackId} loaded [${newDetails.startSN},${newDetails.endSN}]${newDetails.lastPartSn?`[part-${newDetails.lastPartSn}-${newDetails.lastPartIndex}]`:""},duration:${newDetails.totalduration}`);const track=levels[trackId];let sliding=0;if(newDetails.live||null!=(_track$details=track.details)&&_track$details.live){this.checkLiveUpdate(newDetails);const mainDetails=this.mainDetails;if(newDetails.deltaUpdateFailed||!mainDetails)return;var _this$levelLastLoaded;if(!track.details&&newDetails.hasProgramDateTime&&mainDetails.hasProgramDateTime)alignMediaPlaylistByPDT(newDetails,mainDetails),sliding=newDetails.fragments[0].start;else sliding=this.alignPlaylists(newDetails,track.details,null==(_this$levelLastLoaded=this.levelLastLoaded)?void 0:_this$levelLastLoaded.details)}track.details=newDetails,this.levelLastLoaded=track,this.startFragRequested||!this.mainDetails&&newDetails.live||this.setStartPosition(this.mainDetails||newDetails,sliding),this.state!==State_WAITING_TRACK||this.waitForCdnTuneIn(newDetails)||(this.state=State_IDLE),this.tick()}_handleFragmentLoadProgress(data){var _frag$initSegment;const{frag,part,payload}=data,{config,trackId,levels}=this;if(!levels)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${frag.sn} of level ${frag.level} will not be buffered`);const track=levels[trackId];if(!track)return void this.warn("Audio track is undefined on fragment load progress");const details=track.details;if(!details)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(frag.start);const audioCodec=config.defaultAudioCodec||track.audioCodec||"mp4a.40.2";let transmuxer=this.transmuxer;transmuxer||(transmuxer=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType_AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const initPTS=this.initPTS[frag.cc],initSegmentData=null==(_frag$initSegment=frag.initSegment)?void 0:_frag$initSegment.data;if(void 0!==initPTS){const accurateTimeOffset=!1,partIndex=part?part.index:-1,partial=-1!==partIndex,chunkMeta=new ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount,payload.byteLength,partIndex,partial);transmuxer.push(payload,initSegmentData,audioCodec,"",frag,part,details.totalduration,accurateTimeOffset,chunkMeta,initPTS)}else{this.log(`Unknown video PTS for cc ${frag.cc}, waiting for video PTS before demuxing audio frag ${frag.sn} of [${details.startSN} ,${details.endSN}],track ${trackId}`);const{cache}=this.waitingData=this.waitingData||{frag,part,cache:new ChunkCache,complete:!1};cache.push(new Uint8Array(payload)),this.waitingVideoCC=this.videoTrackCC,this.state=State_WAITING_INIT_PTS}}_handleFragmentLoadComplete(fragLoadedData){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(fragLoadedData)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(event,data){const audioTrack=data.tracks.audio;audioTrack&&(this.mediaBuffer=audioTrack.buffer||null),data.tracks.video&&(this.videoBuffer=data.tracks.video.buffer||null)}onFragBuffered(event,data){const{frag,part}=data;if(frag.type===PlaylistLevelType_AUDIO)if(this.fragContextChanged(frag))this.warn(`Fragment ${frag.sn}${part?" p: "+part.index:""} of level ${frag.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==frag.sn){this.fragPrevious=frag;const track=this.switchingTrack;track&&(this.bufferedTrack=track,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},track)))}this.fragBufferedComplete(frag,part)}else if(!this.loadedmetadata&&frag.type===PlaylistLevelType_MAIN){const bufferable=this.videoBuffer||this.media;if(bufferable){BufferHelper.getBuffered(bufferable).length&&(this.loadedmetadata=!0)}}}onError(event,data){var _data$context;if(data.fatal)this.state=State_ERROR;else switch(data.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType_AUDIO,data);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:data.levelRetry||this.state!==State_WAITING_TRACK||(null==(_data$context=data.context)?void 0:_data$context.type)!==PlaylistContextType_AUDIO_TRACK||(this.state=State_IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!data.parent||"audio"!==data.parent)return;if(data.details===ErrorDetails.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(data)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(data)}}onBufferFlushing(event,{type}){type!==ElementaryStreamTypes_VIDEO&&(this.flushing=!0)}onBufferFlushed(event,{type}){if(type!==ElementaryStreamTypes_VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===State_ENDED&&(this.state=State_IDLE);const mediaBuffer=this.mediaBuffer||this.media;mediaBuffer&&(this.afterBufferFlushed(mediaBuffer,type,PlaylistLevelType_AUDIO),this.tick())}}_handleTransmuxComplete(transmuxResult){var _id3$samples;const id="audio",{hls}=this,{remuxResult,chunkMeta}=transmuxResult,context=this.getCurrentContext(chunkMeta);if(!context)return void this.resetWhenMissingContext(chunkMeta);const{frag,part,level}=context,{details}=level,{audio,text,id3,initSegment}=remuxResult;if(!this.fragContextChanged(frag)&&details){if(this.state=State_PARSING,this.switchingTrack&&audio&&this.completeAudioSwitch(this.switchingTrack),null!=initSegment&&initSegment.tracks){const mapFragment=frag.initSegment||frag;this._bufferInitSegment(level,initSegment.tracks,mapFragment,chunkMeta),hls.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:mapFragment,id,tracks:initSegment.tracks})}if(audio){const{startPTS,endPTS,startDTS,endDTS}=audio;part&&(part.elementaryStreams[ElementaryStreamTypes_AUDIO]={startPTS,endPTS,startDTS,endDTS}),frag.setElementaryStreamInfo(ElementaryStreamTypes_AUDIO,startPTS,endPTS,startDTS,endDTS),this.bufferFragmentData(audio,frag,part,chunkMeta)}if(null!=id3&&null!=(_id3$samples=id3.samples)&&_id3$samples.length){const emittedID3=_extends({id,frag,details},id3);hls.trigger(Events.FRAG_PARSING_METADATA,emittedID3)}if(text){const emittedText=_extends({id,frag,details},text);hls.trigger(Events.FRAG_PARSING_USERDATA,emittedText)}}else this.fragmentTracker.removeFragment(frag)}_bufferInitSegment(currentLevel,tracks,frag,chunkMeta){if(this.state!==State_PARSING)return;tracks.video&&delete tracks.video;const track=tracks.audio;if(!track)return;track.id="audio";const variantAudioCodecs=currentLevel.audioCodec;this.log(`Init audio buffer, container:${track.container}, codecs[level/parsed]=[${variantAudioCodecs}/${track.codec}]`),variantAudioCodecs&&1===variantAudioCodecs.split(",").length&&(track.levelCodec=variantAudioCodecs),this.hls.trigger(Events.BUFFER_CODECS,tracks);const initSegment=track.initSegment;if(null!=initSegment&&initSegment.byteLength){const segment={type:"audio",frag,part:null,chunkMeta,parent:frag.type,data:initSegment};this.hls.trigger(Events.BUFFER_APPENDING,segment)}this.tickImmediate()}loadFragment(frag,track,targetBufferTime){const fragState=this.fragmentTracker.getState(frag);var _track$details2;if(this.fragCurrent=frag,this.switchingTrack||fragState===FragmentState_NOT_LOADED||fragState===FragmentState_PARTIAL)if("initSegment"===frag.sn)this._loadInitSegment(frag,track);else if(null!=(_track$details2=track.details)&&_track$details2.live&&!this.initPTS[frag.cc]){this.log(`Waiting for video PTS in continuity counter ${frag.cc} of live stream before loading audio fragment ${frag.sn} of level ${this.trackId}`),this.state=State_WAITING_INIT_PTS;const mainDetails=this.mainDetails;mainDetails&&mainDetails.fragments[0].start!==track.details.fragments[0].start&&alignMediaPlaylistByPDT(track.details,mainDetails)}else this.startFragRequested=!0,super.loadFragment(frag,track,targetBufferTime);else this.clearTrackerIfNeeded(frag)}flushAudioIfNeeded(switchingTrack){const{media,bufferedTrack}=this,bufferedAttributes=null==bufferedTrack?void 0:bufferedTrack.attrs,switchAttributes=switchingTrack.attrs;media&&bufferedAttributes&&(bufferedAttributes.CHANNELS!==switchAttributes.CHANNELS||bufferedTrack.name!==switchingTrack.name||bufferedTrack.lang!==switchingTrack.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(switchingTrack){const{hls}=this;this.flushAudioIfNeeded(switchingTrack),this.bufferedTrack=switchingTrack,this.switchingTrack=null,hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},switchingTrack))}},audioTrackController:class AudioTrackController extends BasePlaylistController{constructor(hls){super(hls,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls}=this;hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls}=this;hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),hls.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),hls.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(event,data){this.tracks=data.audioTracks||[]}onAudioTrackLoaded(event,data){const{id,groupId,details}=data,trackInActiveGroup=this.tracksInGroup[id];if(!trackInActiveGroup||trackInActiveGroup.groupId!==groupId)return void this.warn(`Audio track with id:${id} and group:${groupId} not found in active group ${null==trackInActiveGroup?void 0:trackInActiveGroup.groupId}`);const curDetails=trackInActiveGroup.details;trackInActiveGroup.details=data.details,this.log(`Audio track ${id} "${trackInActiveGroup.name}" lang:${trackInActiveGroup.lang} group:${groupId} loaded [${details.startSN}-${details.endSN}]`),id===this.trackId&&this.playlistLoaded(id,data,curDetails)}onLevelLoading(event,data){this.switchLevel(data.level)}onLevelSwitching(event,data){this.switchLevel(data.level)}switchLevel(levelIndex){const levelInfo=this.hls.levels[levelIndex];if(!levelInfo)return;const audioGroups=levelInfo.audioGroups||null,currentGroups=this.groupIds;let currentTrack=this.currentTrack;if(!audioGroups||(null==currentGroups?void 0:currentGroups.length)!==(null==audioGroups?void 0:audioGroups.length)||null!=audioGroups&&audioGroups.some((groupId=>-1===(null==currentGroups?void 0:currentGroups.indexOf(groupId))))){this.groupIds=audioGroups,this.trackId=-1,this.currentTrack=null;const audioTracks=this.tracks.filter((track=>!audioGroups||-1!==audioGroups.indexOf(track.groupId)));if(audioTracks.length)this.selectDefaultTrack&&!audioTracks.some((track=>track.default))&&(this.selectDefaultTrack=!1),audioTracks.forEach(((track,i)=>{track.id=i}));else if(!currentTrack&&!this.tracksInGroup.length)return;this.tracksInGroup=audioTracks;const audioPreference=this.hls.config.audioPreference;if(!currentTrack&&audioPreference){const groupIndex=findMatchingOption(audioPreference,audioTracks,audioMatchPredicate);if(groupIndex>-1)currentTrack=audioTracks[groupIndex];else{const allIndex=findMatchingOption(audioPreference,this.tracks);currentTrack=this.tracks[allIndex]}}let trackId=this.findTrackId(currentTrack);-1===trackId&&currentTrack&&(trackId=this.findTrackId(null));const audioTracksUpdated={audioTracks};this.log(`Updating audio tracks, ${audioTracks.length} track(s) found in group(s): ${null==audioGroups?void 0:audioGroups.join(",")}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,audioTracksUpdated);const selectedTrackId=this.trackId;if(-1!==trackId&&-1===selectedTrackId)this.setAudioTrack(trackId);else if(audioTracks.length&&-1===selectedTrackId){var _this$groupIds;const error=new Error(`No audio track selected for current audio group-ID(s): ${null==(_this$groupIds=this.groupIds)?void 0:_this$groupIds.join(",")} track count: ${audioTracks.length}`);this.warn(error.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error})}}else this.shouldReloadPlaylist(currentTrack)&&this.setAudioTrack(this.trackId)}onError(event,data){!data.fatal&&data.context&&(data.context.type!==PlaylistContextType_AUDIO_TRACK||data.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(data.context.groupId)||(this.requestScheduled=-1,this.checkRetry(data)))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(newId){this.selectDefaultTrack=!1,this.setAudioTrack(newId)}setAudioOption(audioOption){const hls=this.hls;if(hls.config.audioPreference=audioOption,audioOption){const allAudioTracks=this.allAudioTracks;if(this.selectDefaultTrack=!1,allAudioTracks.length){const currentTrack=this.currentTrack;if(currentTrack&&matchesOption(audioOption,currentTrack,audioMatchPredicate))return currentTrack;const groupIndex=findMatchingOption(audioOption,this.tracksInGroup,audioMatchPredicate);if(groupIndex>-1){const track=this.tracksInGroup[groupIndex];return this.setAudioTrack(groupIndex),track}if(currentTrack){let searchIndex=hls.loadLevel;-1===searchIndex&&(searchIndex=hls.firstAutoLevel);const switchIndex=function findClosestLevelWithAudioGroup(option,levels,allAudioTracks,searchIndex,matchPredicate){const currentLevel=levels[searchIndex],renditions=levels.reduce(((variantMap,level,index)=>{const uri=level.uri;return(variantMap[uri]||(variantMap[uri]=[])).push(index),variantMap}),{})[currentLevel.uri];renditions.length>1&&(searchIndex=Math.max.apply(Math,renditions));const currentVideoRange=currentLevel.videoRange,currentFrameRate=currentLevel.frameRate,currentVideoCodec=currentLevel.codecSet.substring(0,4),matchingVideo=searchDownAndUpList(levels,searchIndex,(level=>{if(level.videoRange!==currentVideoRange||level.frameRate!==currentFrameRate||level.codecSet.substring(0,4)!==currentVideoCodec)return!1;const audioGroups=level.audioGroups,tracks=allAudioTracks.filter((track=>!audioGroups||-1!==audioGroups.indexOf(track.groupId)));return findMatchingOption(option,tracks,matchPredicate)>-1}));return matchingVideo>-1?matchingVideo:searchDownAndUpList(levels,searchIndex,(level=>{const audioGroups=level.audioGroups,tracks=allAudioTracks.filter((track=>!audioGroups||-1!==audioGroups.indexOf(track.groupId)));return findMatchingOption(option,tracks,matchPredicate)>-1}))}(audioOption,hls.levels,allAudioTracks,searchIndex,audioMatchPredicate);if(-1===switchIndex)return null;hls.nextLoadLevel=switchIndex}if(audioOption.channels||audioOption.audioCodec){const withoutCodecAndChannelsMatch=findMatchingOption(audioOption,allAudioTracks);if(withoutCodecAndChannelsMatch>-1)return allAudioTracks[withoutCodecAndChannelsMatch]}}}return null}setAudioTrack(newId){const tracks=this.tracksInGroup;if(newId<0||newId>=tracks.length)return void this.warn(`Invalid audio track id: ${newId}`);this.clearTimer(),this.selectDefaultTrack=!1;const lastTrack=this.currentTrack,track=tracks[newId],trackLoaded=track.details&&!track.details.live;if(newId===this.trackId&&track===lastTrack&&trackLoaded)return;if(this.log(`Switching to audio-track ${newId} "${track.name}" lang:${track.lang} group:${track.groupId} channels:${track.channels}`),this.trackId=newId,this.currentTrack=track,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},track)),trackLoaded)return;const hlsUrlParameters=this.switchParams(track.url,null==lastTrack?void 0:lastTrack.details,track.details);this.loadPlaylist(hlsUrlParameters)}findTrackId(currentTrack){const audioTracks=this.tracksInGroup;for(let i=0;i<audioTracks.length;i++){const track=audioTracks[i];if((!this.selectDefaultTrack||track.default)&&(!currentTrack||matchesOption(currentTrack,track,audioMatchPredicate)))return i}if(currentTrack){const{name,lang,assocLang,characteristics,audioCodec,channels}=currentTrack;for(let i=0;i<audioTracks.length;i++){if(matchesOption({name,lang,assocLang,characteristics,audioCodec,channels},audioTracks[i],audioMatchPredicate))return i}for(let i=0;i<audioTracks.length;i++){const track=audioTracks[i];if(mediaAttributesIdentical(currentTrack.attrs,track.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<audioTracks.length;i++){const track=audioTracks[i];if(mediaAttributesIdentical(currentTrack.attrs,track.attrs,["LANGUAGE"]))return i}}return-1}loadPlaylist(hlsUrlParameters){const audioTrack=this.currentTrack;if(this.shouldLoadPlaylist(audioTrack)&&audioTrack){super.loadPlaylist();const id=audioTrack.id,groupId=audioTrack.groupId;let url=audioTrack.url;if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn(`Could not construct new URL with HLS Delivery Directives: ${error}`)}this.log(`loading audio-track playlist ${id} "${audioTrack.name}" lang:${audioTrack.lang} group:${groupId}`),this.clearTimer(),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url,id,groupId,deliveryDirectives:hlsUrlParameters||null})}}},emeController:EMEController,cmcdController:class CMCDController{constructor(hls){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=context=>{try{this.apply(context,{ot:CmObjectType.MANIFEST,su:!this.initialized})}catch(error){logger.warn("Could not generate manifest CMCD data.",error)}},this.applyFragmentData=context=>{try{const fragment=context.frag,level=this.hls.levels[fragment.level],ot=this.getObjectType(fragment),data={d:1e3*fragment.duration,ot};ot!==CmObjectType.VIDEO&&ot!==CmObjectType.AUDIO&&ot!=CmObjectType.MUXED||(data.br=level.bitrate/1e3,data.tb=this.getTopBandwidth(ot)/1e3,data.bl=this.getBufferLength(ot)),this.apply(context,data)}catch(error){logger.warn("Could not generate segment CMCD data.",error)}},this.hls=hls;const config=this.config=hls.config,{cmcd}=config;null!=cmcd&&(config.pLoader=this.createPlaylistLoader(),config.fLoader=this.createFragmentLoader(),this.sid=cmcd.sessionId||function uuid(){try{return crypto.randomUUID()}catch(error){try{const url=URL.createObjectURL(new Blob),uuid=url.toString();return URL.revokeObjectURL(url),uuid.slice(uuid.lastIndexOf("/")+1)}catch(error){let dt=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(c=>{const r=(dt+16*Math.random())%16|0;return dt=Math.floor(dt/16),("x"==c?r:3&r|8).toString(16)}))}}}(),this.cid=cmcd.contentId,this.useHeaders=!0===cmcd.useHeaders,this.includeKeys=cmcd.includeKeys,this.registerListeners())}registerListeners(){const hls=this.hls;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),hls.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const hls=this.hls;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),hls.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(event,data){this.media=data.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(event,data){var _data$tracks$audio,_data$tracks$video;this.audioBuffer=null==(_data$tracks$audio=data.tracks.audio)?void 0:_data$tracks$audio.buffer,this.videoBuffer=null==(_data$tracks$video=data.tracks.video)?void 0:_data$tracks$video.buffer}createData(){var _this$media;return{v:1,sf:CmStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:null==(_this$media=this.media)?void 0:_this$media.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(context,data={}){_extends(data,this.createData());const isVideo=data.ot===CmObjectType.INIT||data.ot===CmObjectType.VIDEO||data.ot===CmObjectType.MUXED;this.starved&&isVideo&&(data.bs=!0,data.su=!0,this.starved=!1),null==data.su&&(data.su=this.buffering);const{includeKeys}=this;includeKeys&&(data=Object.keys(data).reduce(((acc,key)=>(includeKeys.includes(key)&&(acc[key]=data[key]),acc)),{})),this.useHeaders?(context.headers||(context.headers={}),appendCmcdHeaders(context.headers,data)):context.url=appendCmcdQuery(context.url,data)}getObjectType(fragment){const{type}=fragment;return"subtitle"===type?CmObjectType.TIMED_TEXT:"initSegment"===fragment.sn?CmObjectType.INIT:"audio"===type?CmObjectType.AUDIO:"main"===type?this.hls.audioTracks.length?CmObjectType.VIDEO:CmObjectType.MUXED:void 0}getTopBandwidth(type){let levels,bitrate=0;const hls=this.hls;if(type===CmObjectType.AUDIO)levels=hls.audioTracks;else{const max=hls.maxAutoLevel,len=max>-1?max+1:hls.levels.length;levels=hls.levels.slice(0,len)}for(const level of levels)level.bitrate>bitrate&&(bitrate=level.bitrate);return bitrate>0?bitrate:NaN}getBufferLength(type){const media=this.hls.media,buffer=type===CmObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!buffer||!media)return NaN;return 1e3*BufferHelper.bufferInfo(buffer,media.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader}=this.config,apply=this.applyPlaylistData,Ctor=pLoader||this.config.loader;return class CmcdPlaylistLoader{constructor(config){this.loader=void 0,this.loader=new Ctor(config)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(context,config,callbacks){apply(context),this.loader.load(context,config,callbacks)}}}createFragmentLoader(){const{fLoader}=this.config,apply=this.applyFragmentData,Ctor=fLoader||this.config.loader;return class CmcdFragmentLoader{constructor(config){this.loader=void 0,this.loader=new Ctor(config)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(context,config,callbacks){apply(context),this.loader.load(context,config,callbacks)}}}},contentSteeringController:class ContentSteeringController{constructor(hls){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=hls,this.log=logger.log.bind(logger,"[content-steering]:"),this.registerListeners()}registerListeners(){const hls=this.hls;hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){const hls=this.hls;hls&&(hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const ttl=1e3*this.timeToLoad-(performance.now()-this.updated);if(ttl>0)return void this.scheduleRefresh(this.uri,ttl)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(levelToRemove){const levels=this.levels;levels&&(this.levels=levels.filter((level=>level!==levelToRemove)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(event,data){const{contentSteering}=data;null!==contentSteering&&(this.pathwayId=contentSteering.pathwayId,this.uri=contentSteering.uri,this.started&&this.startLoad())}onManifestParsed(event,data){this.audioTracks=data.audioTracks,this.subtitleTracks=data.subtitleTracks}onError(event,data){const{errorAction}=data;if((null==errorAction?void 0:errorAction.action)===NetworkErrorAction_SendAlternateToPenaltyBox&&errorAction.flags===ErrorActionFlags_MoveAllAlternatesMatchingHost){const levels=this.levels;let pathwayPriority=this.pathwayPriority,errorPathway=this.pathwayId;if(data.context){const{groupId,pathwayId,type}=data.context;groupId&&levels?errorPathway=this.getPathwayForGroupId(groupId,type,errorPathway):pathwayId&&(errorPathway=pathwayId)}errorPathway in this.penalizedPathways||(this.penalizedPathways[errorPathway]=performance.now()),!pathwayPriority&&levels&&(pathwayPriority=levels.reduce(((pathways,level)=>(-1===pathways.indexOf(level.pathwayId)&&pathways.push(level.pathwayId),pathways)),[])),pathwayPriority&&pathwayPriority.length>1&&(this.updatePathwayPriority(pathwayPriority),errorAction.resolved=this.pathwayId!==errorPathway),errorAction.resolved||logger.warn(`Could not resolve ${data.details} ("${data.error.message}") with content-steering for Pathway: ${errorPathway} levels: ${levels?levels.length:levels} priorities: ${JSON.stringify(pathwayPriority)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(levels){this.levels=levels;let pathwayLevels=this.getLevelsForPathway(this.pathwayId);if(0===pathwayLevels.length){const pathwayId=levels[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${pathwayId}"`),pathwayLevels=this.getLevelsForPathway(pathwayId),this.pathwayId=pathwayId}return pathwayLevels.length!==levels.length?(this.log(`Found ${pathwayLevels.length}/${levels.length} levels in Pathway "${this.pathwayId}"`),pathwayLevels):levels}getLevelsForPathway(pathwayId){return null===this.levels?[]:this.levels.filter((level=>pathwayId===level.pathwayId))}updatePathwayPriority(pathwayPriority){let levels;this.pathwayPriority=pathwayPriority;const penalizedPathways=this.penalizedPathways,now=performance.now();Object.keys(penalizedPathways).forEach((pathwayId=>{now-penalizedPathways[pathwayId]>3e5&&delete penalizedPathways[pathwayId]}));for(let i=0;i<pathwayPriority.length;i++){const pathwayId=pathwayPriority[i];if(pathwayId in penalizedPathways)continue;if(pathwayId===this.pathwayId)return;const selectedIndex=this.hls.nextLoadLevel,selectedLevel=this.hls.levels[selectedIndex];if(levels=this.getLevelsForPathway(pathwayId),levels.length>0){this.log(`Setting Pathway to "${pathwayId}"`),this.pathwayId=pathwayId,reassignFragmentLevelIndexes(levels),this.hls.trigger(Events.LEVELS_UPDATED,{levels});const levelAfterChange=this.hls.levels[selectedIndex];selectedLevel&&levelAfterChange&&this.levels&&(levelAfterChange.attrs["STABLE-VARIANT-ID"]!==selectedLevel.attrs["STABLE-VARIANT-ID"]&&levelAfterChange.bitrate!==selectedLevel.bitrate&&this.log(`Unstable Pathways change from bitrate ${selectedLevel.bitrate} to ${levelAfterChange.bitrate}`),this.hls.nextLoadLevel=selectedIndex);break}}}getPathwayForGroupId(groupId,type,defaultPathway){const levels=this.getLevelsForPathway(defaultPathway).concat(this.levels||[]);for(let i=0;i<levels.length;i++)if(type===PlaylistContextType_AUDIO_TRACK&&levels[i].hasAudioGroup(groupId)||type===PlaylistContextType_SUBTITLE_TRACK&&levels[i].hasSubtitleGroup(groupId))return levels[i].pathwayId;return defaultPathway}clonePathways(pathwayClones){const levels=this.levels;if(!levels)return;const audioGroupCloneMap={},subtitleGroupCloneMap={};pathwayClones.forEach((pathwayClone=>{const{ID:cloneId,"BASE-ID":baseId,"URI-REPLACEMENT":uriReplacement}=pathwayClone;if(levels.some((level=>level.pathwayId===cloneId)))return;const clonedVariants=this.getLevelsForPathway(baseId).map((baseLevel=>{const attributes=new AttrList(baseLevel.attrs);attributes["PATHWAY-ID"]=cloneId;const clonedAudioGroupId=attributes.AUDIO&&`${attributes.AUDIO}_clone_${cloneId}`,clonedSubtitleGroupId=attributes.SUBTITLES&&`${attributes.SUBTITLES}_clone_${cloneId}`;clonedAudioGroupId&&(audioGroupCloneMap[attributes.AUDIO]=clonedAudioGroupId,attributes.AUDIO=clonedAudioGroupId),clonedSubtitleGroupId&&(subtitleGroupCloneMap[attributes.SUBTITLES]=clonedSubtitleGroupId,attributes.SUBTITLES=clonedSubtitleGroupId);const url=performUriReplacement(baseLevel.uri,attributes["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",uriReplacement),clonedLevel=new Level({attrs:attributes,audioCodec:baseLevel.audioCodec,bitrate:baseLevel.bitrate,height:baseLevel.height,name:baseLevel.name,url,videoCodec:baseLevel.videoCodec,width:baseLevel.width});if(baseLevel.audioGroups)for(let i=1;i<baseLevel.audioGroups.length;i++)clonedLevel.addGroupId("audio",`${baseLevel.audioGroups[i]}_clone_${cloneId}`);if(baseLevel.subtitleGroups)for(let i=1;i<baseLevel.subtitleGroups.length;i++)clonedLevel.addGroupId("text",`${baseLevel.subtitleGroups[i]}_clone_${cloneId}`);return clonedLevel}));levels.push(...clonedVariants),cloneRenditionGroups(this.audioTracks,audioGroupCloneMap,uriReplacement,cloneId),cloneRenditionGroups(this.subtitleTracks,subtitleGroupCloneMap,uriReplacement,cloneId)}))}loadSteeringManifest(uri){const config=this.hls.config,Loader=config.loader;let url;this.loader&&this.loader.destroy(),this.loader=new Loader(config);try{url=new self.URL(uri)}catch(error){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${uri}`)}if("data:"!==url.protocol){const throughput=0|(this.hls.bandwidthEstimate||config.abrEwmaDefaultEstimate);url.searchParams.set("_HLS_pathway",this.pathwayId),url.searchParams.set("_HLS_throughput",""+throughput)}const context={responseType:"json",url:url.href},loadPolicy=config.steeringManifestLoadPolicy.default,legacyRetryCompatibility=loadPolicy.errorRetry||loadPolicy.timeoutRetry||{},loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:legacyRetryCompatibility.maxNumRetry||0,retryDelay:legacyRetryCompatibility.retryDelayMs||0,maxRetryDelay:legacyRetryCompatibility.maxRetryDelayMs||0},callbacks={onSuccess:(response,stats,context,networkDetails)=>{this.log(`Loaded steering manifest: "${url}"`);const steeringData=response.data;if(1!==steeringData.VERSION)return void this.log(`Steering VERSION ${steeringData.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=steeringData.TTL;const{"RELOAD-URI":reloadUri,"PATHWAY-CLONES":pathwayClones,"PATHWAY-PRIORITY":pathwayPriority}=steeringData;if(reloadUri)try{this.uri=new self.URL(reloadUri,url).href}catch(error){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${reloadUri}`)}this.scheduleRefresh(this.uri||context.url),pathwayClones&&this.clonePathways(pathwayClones);const loadedSteeringData={steeringManifest:steeringData,url:url.toString()};this.hls.trigger(Events.STEERING_MANIFEST_LOADED,loadedSteeringData),pathwayPriority&&this.updatePathwayPriority(pathwayPriority)},onError:(error,context,networkDetails,stats)=>{if(this.log(`Error loading steering manifest: ${error.code} ${error.text} (${context.url})`),this.stopLoad(),410===error.code)return this.enabled=!1,void this.log(`Steering manifest ${context.url} no longer available`);let ttl=1e3*this.timeToLoad;if(429!==error.code)this.scheduleRefresh(this.uri||context.url,ttl);else{const loader=this.loader;if("function"==typeof(null==loader?void 0:loader.getResponseHeader)){const retryAfter=loader.getResponseHeader("Retry-After");retryAfter&&(ttl=1e3*parseFloat(retryAfter))}this.log(`Steering manifest ${context.url} rate limited`)}},onTimeout:(stats,context,networkDetails)=>{this.log(`Timeout loading steering manifest (${context.url})`),this.scheduleRefresh(this.uri||context.url)}};this.log(`Requesting steering manifest: ${url}`),this.loader.load(context,loaderConfig,callbacks)}scheduleRefresh(uri,ttlMs=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var _this$hls;const media=null==(_this$hls=this.hls)?void 0:_this$hls.media;!media||media.ended?this.scheduleRefresh(uri,1e3*this.timeToLoad):this.loadSteeringManifest(uri)}),ttlMs)}}});function deepCpy(obj){return obj&&"object"==typeof obj?Array.isArray(obj)?obj.map(deepCpy):Object.keys(obj).reduce(((result,key)=>(result[key]=deepCpy(obj[key]),result)),{}):obj}function enableStreamingMode(config){const currentLoader=config.loader;if(currentLoader!==FetchLoader&&currentLoader!==XhrLoader)logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),config.progressive=!1;else{(function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1})()&&(config.loader=FetchLoader,config.progressive=!0,config.enableSoftwareAES=!0,logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}let chromeOrFirefox;class LevelController extends BasePlaylistController{constructor(hls,contentSteeringController){super(hls,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=contentSteeringController,this._registerListeners()}_registerListeners(){const{hls}=this;hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),hls.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),hls.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((level=>{level.loadError=0,level.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(event,data){this.resetLevels()}onManifestLoaded(event,data){const preferManagedMediaSource=this.hls.config.preferManagedMediaSource,levels=[],redundantSet={},generatePathwaySet={};let resolutionFound=!1,videoCodecFound=!1,audioCodecFound=!1;data.levels.forEach((levelParsed=>{var _audioCodec,_videoCodec;const attributes=levelParsed.attrs;let{audioCodec,videoCodec}=levelParsed;-1!==(null==(_audioCodec=audioCodec)?void 0:_audioCodec.indexOf("mp4a.40.34"))&&(chromeOrFirefox||(chromeOrFirefox=/chrome|firefox/i.test(navigator.userAgent)),chromeOrFirefox&&(levelParsed.audioCodec=audioCodec=void 0)),audioCodec&&(levelParsed.audioCodec=audioCodec=getCodecCompatibleName(audioCodec,preferManagedMediaSource)),0===(null==(_videoCodec=videoCodec)?void 0:_videoCodec.indexOf("avc1"))&&(videoCodec=levelParsed.videoCodec=function convertAVC1ToAVCOTI(codec){const avcdata=codec.split(".");if(avcdata.length>2){let result=avcdata.shift()+".";return result+=parseInt(avcdata.shift()).toString(16),result+=("000"+parseInt(avcdata.shift()).toString(16)).slice(-4),result}return codec}(videoCodec));const{width,height,unknownCodecs}=levelParsed;if(resolutionFound||(resolutionFound=!(!width||!height)),videoCodecFound||(videoCodecFound=!!videoCodec),audioCodecFound||(audioCodecFound=!!audioCodec),null!=unknownCodecs&&unknownCodecs.length||audioCodec&&!areCodecsMediaSourceSupported(audioCodec,"audio",preferManagedMediaSource)||videoCodec&&!areCodecsMediaSourceSupported(videoCodec,"video",preferManagedMediaSource))return;const{CODECS,"FRAME-RATE":FRAMERATE,"HDCP-LEVEL":HDCP,"PATHWAY-ID":PATHWAY,RESOLUTION,"VIDEO-RANGE":VIDEO_RANGE}=attributes,levelKey=`${`${PATHWAY||"."}-`}${levelParsed.bitrate}-${RESOLUTION}-${FRAMERATE}-${CODECS}-${VIDEO_RANGE}-${HDCP}`;if(redundantSet[levelKey])if(redundantSet[levelKey].uri===levelParsed.url||levelParsed.attrs["PATHWAY-ID"])redundantSet[levelKey].addGroupId("audio",attributes.AUDIO),redundantSet[levelKey].addGroupId("text",attributes.SUBTITLES);else{const pathwayCount=generatePathwaySet[levelKey]+=1;levelParsed.attrs["PATHWAY-ID"]=new Array(pathwayCount+1).join(".");const level=new Level(levelParsed);redundantSet[levelKey]=level,levels.push(level)}else{const level=new Level(levelParsed);redundantSet[levelKey]=level,generatePathwaySet[levelKey]=1,levels.push(level)}})),this.filterAndSortMediaOptions(levels,data,resolutionFound,videoCodecFound,audioCodecFound)}filterAndSortMediaOptions(filteredLevels,data,resolutionFound,videoCodecFound,audioCodecFound){let audioTracks=[],subtitleTracks=[],levels=filteredLevels;if((resolutionFound||videoCodecFound)&&audioCodecFound&&(levels=levels.filter((({videoCodec,videoRange,width,height})=>(!!videoCodec||!(!width||!height))&&function isVideoRange(value){return!!value&&VideoRangeValues.indexOf(value)>-1}(videoRange)))),0===levels.length)return void Promise.resolve().then((()=>{if(this.hls){data.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(data.levels[0].attrs)}`);const error=new Error("no level with compatible codecs found in manifest");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:data.url,error,reason:error.message})}}));if(data.audioTracks){const{preferManagedMediaSource}=this.hls.config;audioTracks=data.audioTracks.filter((track=>!track.audioCodec||areCodecsMediaSourceSupported(track.audioCodec,"audio",preferManagedMediaSource))),assignTrackIdsByGroup(audioTracks)}data.subtitles&&(subtitleTracks=data.subtitles,assignTrackIdsByGroup(subtitleTracks));const unsortedLevels=levels.slice(0);levels.sort(((a,b)=>{if(a.attrs["HDCP-LEVEL"]!==b.attrs["HDCP-LEVEL"])return(a.attrs["HDCP-LEVEL"]||"")>(b.attrs["HDCP-LEVEL"]||"")?1:-1;if(resolutionFound&&a.height!==b.height)return a.height-b.height;if(a.frameRate!==b.frameRate)return a.frameRate-b.frameRate;if(a.videoRange!==b.videoRange)return VideoRangeValues.indexOf(a.videoRange)-VideoRangeValues.indexOf(b.videoRange);if(a.videoCodec!==b.videoCodec){const valueA=videoCodecPreferenceValue(a.videoCodec),valueB=videoCodecPreferenceValue(b.videoCodec);if(valueA!==valueB)return valueB-valueA}if(a.uri===b.uri&&a.codecSet!==b.codecSet){const valueA=codecsSetSelectionPreferenceValue(a.codecSet),valueB=codecsSetSelectionPreferenceValue(b.codecSet);if(valueA!==valueB)return valueB-valueA}return a.averageBitrate!==b.averageBitrate?a.averageBitrate-b.averageBitrate:0}));let firstLevelInPlaylist=unsortedLevels[0];if(this.steering&&(levels=this.steering.filterParsedLevels(levels),levels.length!==unsortedLevels.length))for(let i=0;i<unsortedLevels.length;i++)if(unsortedLevels[i].pathwayId===levels[0].pathwayId){firstLevelInPlaylist=unsortedLevels[i];break}this._levels=levels;for(let i=0;i<levels.length;i++)if(levels[i]===firstLevelInPlaylist){var _this$hls$userConfig;this._firstLevel=i;const firstLevelBitrate=firstLevelInPlaylist.bitrate,bandwidthEstimate=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${levels.length} level(s) found, first bitrate: ${firstLevelBitrate}`),void 0===(null==(_this$hls$userConfig=this.hls.userConfig)?void 0:_this$hls$userConfig.abrEwmaDefaultEstimate)){const startingBwEstimate=Math.min(firstLevelBitrate,this.hls.config.abrEwmaDefaultEstimateMax);startingBwEstimate>bandwidthEstimate&&bandwidthEstimate===hlsDefaultConfig.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=startingBwEstimate)}break}const audioOnly=audioCodecFound&&!videoCodecFound,edata={levels,audioTracks,subtitleTracks,sessionData:data.sessionData,sessionKeys:data.sessionKeys,firstLevel:this._firstLevel,stats:data.stats,audio:audioCodecFound,video:videoCodecFound,altAudio:!audioOnly&&audioTracks.some((t=>!!t.url))};this.hls.trigger(Events.MANIFEST_PARSED,edata),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(newLevel){const levels=this._levels;if(0===levels.length)return;if(newLevel<0||newLevel>=levels.length){const error=new Error("invalid level idx"),fatal=newLevel<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:newLevel,fatal,error,reason:error.message}),fatal)return;newLevel=Math.min(newLevel,levels.length-1)}const lastLevelIndex=this.currentLevelIndex,lastLevel=this.currentLevel,lastPathwayId=lastLevel?lastLevel.attrs["PATHWAY-ID"]:void 0,level=levels[newLevel],pathwayId=level.attrs["PATHWAY-ID"];if(this.currentLevelIndex=newLevel,this.currentLevel=level,lastLevelIndex===newLevel&&level.details&&lastLevel&&lastPathwayId===pathwayId)return;this.log(`Switching to level ${newLevel} (${level.height?level.height+"p ":""}${level.videoRange?level.videoRange+" ":""}${level.codecSet?level.codecSet+" ":""}@${level.bitrate})${pathwayId?" with Pathway "+pathwayId:""} from level ${lastLevelIndex}${lastPathwayId?" with Pathway "+lastPathwayId:""}`);const levelSwitchingData={level:newLevel,attrs:level.attrs,details:level.details,bitrate:level.bitrate,averageBitrate:level.averageBitrate,maxBitrate:level.maxBitrate,realBitrate:level.realBitrate,width:level.width,height:level.height,codecSet:level.codecSet,audioCodec:level.audioCodec,videoCodec:level.videoCodec,audioGroups:level.audioGroups,subtitleGroups:level.subtitleGroups,loaded:level.loaded,loadError:level.loadError,fragmentError:level.fragmentError,name:level.name,id:level.id,uri:level.uri,url:level.url,urlId:0,audioGroupIds:level.audioGroupIds,textGroupIds:level.textGroupIds};this.hls.trigger(Events.LEVEL_SWITCHING,levelSwitchingData);const levelDetails=level.details;if(!levelDetails||levelDetails.live){const hlsUrlParameters=this.switchParams(level.uri,null==lastLevel?void 0:lastLevel.details,levelDetails);this.loadPlaylist(hlsUrlParameters)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(newLevel){this.manualLevelIndex=newLevel,void 0===this._startLevel&&(this._startLevel=newLevel),-1!==newLevel&&(this.level=newLevel)}get firstLevel(){return this._firstLevel}set firstLevel(newLevel){this._firstLevel=newLevel}get startLevel(){if(void 0===this._startLevel){const configStartLevel=this.hls.config.startLevel;return void 0!==configStartLevel?configStartLevel:this.hls.firstAutoLevel}return this._startLevel}set startLevel(newLevel){this._startLevel=newLevel}onError(event,data){!data.fatal&&data.context&&data.context.type===PlaylistContextType_LEVEL&&data.context.level===this.level&&this.checkRetry(data)}onFragBuffered(event,{frag}){if(void 0!==frag&&frag.type===PlaylistLevelType_MAIN){const el=frag.elementaryStreams;if(!Object.keys(el).some((type=>!!el[type])))return;const level=this._levels[frag.level];null!=level&&level.loadError&&(this.log(`Resetting level error count of ${level.loadError} on frag buffered`),level.loadError=0)}}onLevelLoaded(event,data){var _data$deliveryDirecti2;const{level,details}=data,curLevel=this._levels[level];var _data$deliveryDirecti;if(!curLevel)return this.warn(`Invalid level index ${level}`),void(null!=(_data$deliveryDirecti=data.deliveryDirectives)&&_data$deliveryDirecti.skip&&(details.deltaUpdateFailed=!0));level===this.currentLevelIndex?(0===curLevel.fragmentError&&(curLevel.loadError=0),this.playlistLoaded(level,data,curLevel.details)):null!=(_data$deliveryDirecti2=data.deliveryDirectives)&&_data$deliveryDirecti2.skip&&(details.deltaUpdateFailed=!0)}loadPlaylist(hlsUrlParameters){super.loadPlaylist();const currentLevelIndex=this.currentLevelIndex,currentLevel=this.currentLevel;if(currentLevel&&this.shouldLoadPlaylist(currentLevel)){let url=currentLevel.uri;if(hlsUrlParameters)try{url=hlsUrlParameters.addDirectives(url)}catch(error){this.warn(`Could not construct new URL with HLS Delivery Directives: ${error}`)}const pathwayId=currentLevel.attrs["PATHWAY-ID"];this.log(`Loading level index ${currentLevelIndex}${void 0!==(null==hlsUrlParameters?void 0:hlsUrlParameters.msn)?" at sn "+hlsUrlParameters.msn+" part "+hlsUrlParameters.part:""} with${pathwayId?" Pathway "+pathwayId:""} ${url}`),this.clearTimer(),this.hls.trigger(Events.LEVEL_LOADING,{url,level:currentLevelIndex,pathwayId:currentLevel.attrs["PATHWAY-ID"],id:0,deliveryDirectives:hlsUrlParameters||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(nextLevel){this.level=nextLevel,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=nextLevel)}removeLevel(levelIndex){var _this$currentLevel;const levels=this._levels.filter(((level,index)=>index!==levelIndex||(this.steering&&this.steering.removeLevel(level),level===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,level.details&&level.details.fragments.forEach((f=>f.level=-1))),!1)));reassignFragmentLevelIndexes(levels),this._levels=levels,this.currentLevelIndex>-1&&null!=(_this$currentLevel=this.currentLevel)&&_this$currentLevel.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(Events.LEVELS_UPDATED,{levels})}onLevelsUpdated(event,{levels}){this._levels=levels}checkMaxAutoUpdated(){const{autoLevelCapping,maxAutoLevel,maxHdcpLevel}=this.hls;this._maxAutoLevel!==maxAutoLevel&&(this._maxAutoLevel=maxAutoLevel,this.hls.trigger(Events.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping,levels:this.levels,maxAutoLevel,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel}))}}function assignTrackIdsByGroup(tracks){const groups={};tracks.forEach((track=>{const groupId=track.groupId||"";track.id=groups[groupId]=groups[groupId]||0,groups[groupId]++}))}class KeyLoader{constructor(config){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=config}abort(type){for(const uri in this.keyUriToKeyInfo){const loader=this.keyUriToKeyInfo[uri].loader;if(loader){var _loader$context;if(type&&type!==(null==(_loader$context=loader.context)?void 0:_loader$context.frag.type))return;loader.abort()}}}detach(){for(const uri in this.keyUriToKeyInfo){const keyInfo=this.keyUriToKeyInfo[uri];(keyInfo.mediaKeySessionContext||keyInfo.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[uri]}}destroy(){this.detach();for(const uri in this.keyUriToKeyInfo){const loader=this.keyUriToKeyInfo[uri].loader;loader&&loader.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(frag,details=ErrorDetails.KEY_LOAD_ERROR,error,networkDetails,response){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details,fatal:!1,frag,response,error,networkDetails})}loadClear(loadingFrag,encryptedFragments){if(this.emeController&&this.config.emeEnabled){const{sn,cc}=loadingFrag;for(let i=0;i<encryptedFragments.length;i++){const frag=encryptedFragments[i];if(cc<=frag.cc&&("initSegment"===sn||"initSegment"===frag.sn||sn<frag.sn)){this.emeController.selectKeySystemFormat(frag).then((keySystemFormat=>{frag.setKeyFormat(keySystemFormat)}));break}}}}load(frag){return!frag.decryptdata&&frag.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(frag).then((keySystemFormat=>this.loadInternal(frag,keySystemFormat))):this.loadInternal(frag)}loadInternal(frag,keySystemFormat){var _keyInfo,_keyInfo2;keySystemFormat&&frag.setKeyFormat(keySystemFormat);const decryptdata=frag.decryptdata;if(!decryptdata){const error=new Error(keySystemFormat?`Expected frag.decryptdata to be defined after setting format ${keySystemFormat}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_ERROR,error))}const uri=decryptdata.uri;if(!uri)return Promise.reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${uri}"`)));let keyInfo=this.keyUriToKeyInfo[uri];if(null!=(_keyInfo=keyInfo)&&_keyInfo.decryptdata.key)return decryptdata.key=keyInfo.decryptdata.key,Promise.resolve({frag,keyInfo});var _keyInfo$mediaKeySess;if(null!=(_keyInfo2=keyInfo)&&_keyInfo2.keyLoadPromise)switch(null==(_keyInfo$mediaKeySess=keyInfo.mediaKeySessionContext)?void 0:_keyInfo$mediaKeySess.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return keyInfo.keyLoadPromise.then((keyLoadedData=>(decryptdata.key=keyLoadedData.keyInfo.decryptdata.key,{frag,keyInfo})))}switch(keyInfo=this.keyUriToKeyInfo[uri]={decryptdata,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},decryptdata.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===decryptdata.keyFormat?this.loadKeyHTTP(keyInfo,frag):this.loadKeyEME(keyInfo,frag);case"AES-128":return this.loadKeyHTTP(keyInfo,frag);default:return Promise.reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${decryptdata.method}"`)))}}loadKeyEME(keyInfo,frag){const keyLoadedData={frag,keyInfo};if(this.emeController&&this.config.emeEnabled){const keySessionContextPromise=this.emeController.loadKey(keyLoadedData);if(keySessionContextPromise)return(keyInfo.keyLoadPromise=keySessionContextPromise.then((keySessionContext=>(keyInfo.mediaKeySessionContext=keySessionContext,keyLoadedData)))).catch((error=>{throw keyInfo.keyLoadPromise=null,error}))}return Promise.resolve(keyLoadedData)}loadKeyHTTP(keyInfo,frag){const config=this.config,keyLoader=new(0,config.loader)(config);return frag.keyLoader=keyInfo.loader=keyLoader,keyInfo.keyLoadPromise=new Promise(((resolve,reject)=>{const loaderContext={keyInfo,frag,responseType:"arraybuffer",url:keyInfo.decryptdata.uri},loadPolicy=config.keyLoadPolicy.default,loaderConfig={loadPolicy,timeout:loadPolicy.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},loaderCallbacks={onSuccess:(response,stats,context,networkDetails)=>{const{frag,keyInfo,url:uri}=context;if(!frag.decryptdata||keyInfo!==this.keyUriToKeyInfo[uri])return reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),networkDetails));keyInfo.decryptdata.key=frag.decryptdata.key=new Uint8Array(response.data),frag.keyLoader=null,keyInfo.loader=null,resolve({frag,keyInfo})},onError:(response,context,networkDetails,stats)=>{this.resetLoader(context),reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${response.code} loading key ${response.text}`),networkDetails,_objectSpread2({url:loaderContext.url,data:void 0},response)))},onTimeout:(stats,context,networkDetails)=>{this.resetLoader(context),reject(this.createKeyLoadError(frag,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),networkDetails))},onAbort:(stats,context,networkDetails)=>{this.resetLoader(context),reject(this.createKeyLoadError(frag,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),networkDetails))}};keyLoader.load(loaderContext,loaderConfig,loaderCallbacks)}))}resetLoader(context){const{frag,keyInfo,url:uri}=context,loader=keyInfo.loader;frag.keyLoader===loader&&(frag.keyLoader=null,keyInfo.loader=null),delete this.keyUriToKeyInfo[uri],loader&&loader.destroy()}}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isMSESupported(){if(!getMediaSource())return!1;const sourceBuffer=getSourceBuffer();return!sourceBuffer||sourceBuffer.prototype&&"function"==typeof sourceBuffer.prototype.appendBuffer&&"function"==typeof sourceBuffer.prototype.remove}class GapController{constructor(config,media,fragmentTracker,hls){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=config,this.media=media,this.fragmentTracker=fragmentTracker,this.hls=hls}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(lastCurrentTime,activeFrag){const{config,media,stalled}=this;if(null===media)return;const{currentTime,seeking}=media,seeked=this.seeking&&!seeking,beginSeek=!this.seeking&&seeking;if(this.seeking=seeking,currentTime!==lastCurrentTime){if(this.moved=!0,seeking||(this.nudgeRetry=0),null!==stalled){if(this.stallReported){const _stalledDuration=self.performance.now()-stalled;logger.warn(`playback not stuck anymore @${currentTime}, after ${Math.round(_stalledDuration)}ms`),this.stallReported=!1}this.stalled=null}return}if(beginSeek||seeked)return void(this.stalled=null);if(media.paused&&!seeking||media.ended||0===media.playbackRate||!BufferHelper.getBuffered(media).length)return void(this.nudgeRetry=0);const bufferInfo=BufferHelper.bufferInfo(media,currentTime,0),nextStart=bufferInfo.nextStart||0;if(seeking){const hasEnoughBuffer=bufferInfo.len>2,noBufferGap=!nextStart||activeFrag&&activeFrag.start<=currentTime||nextStart-currentTime>2&&!this.fragmentTracker.getPartialFragment(currentTime);if(hasEnoughBuffer||noBufferGap)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var _level$details;if(!(bufferInfo.len>0)&&!nextStart)return;const startJump=Math.max(nextStart,bufferInfo.start||0)-currentTime,level=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,maxStartGapJump=(null==level||null==(_level$details=level.details)?void 0:_level$details.live)?2*level.details.targetduration:2,partialOrGap=this.fragmentTracker.getPartialFragment(currentTime);if(startJump>0&&(startJump<=maxStartGapJump||partialOrGap))return void(media.paused||this._trySkipBufferHole(partialOrGap))}const tnow=self.performance.now();if(null===stalled)return void(this.stalled=tnow);const stalledDuration=tnow-stalled;if(!seeking&&stalledDuration>=250&&(this._reportStall(bufferInfo),!this.media))return;const bufferedWithHoles=BufferHelper.bufferInfo(media,currentTime,config.maxBufferHole);this._tryFixBufferStall(bufferedWithHoles,stalledDuration)}_tryFixBufferStall(bufferInfo,stalledDurationMs){const{config,fragmentTracker,media}=this;if(null===media)return;const currentTime=media.currentTime,partial=fragmentTracker.getPartialFragment(currentTime);if(partial){if(this._trySkipBufferHole(partial)||!this.media)return}(bufferInfo.len>config.maxBufferHole||bufferInfo.nextStart&&bufferInfo.nextStart-currentTime<config.maxBufferHole)&&stalledDurationMs>1e3*config.highBufferWatchdogPeriod&&(logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(bufferInfo){const{hls,media,stallReported}=this;if(!stallReported&&media){this.stallReported=!0;const error=new Error(`Playback stalling at @${media.currentTime} due to low buffer (${JSON.stringify(bufferInfo)})`);logger.warn(error.message),hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error,buffer:bufferInfo.len})}}_trySkipBufferHole(partial){const{config,hls,media}=this;if(null===media)return 0;const currentTime=media.currentTime,bufferInfo=BufferHelper.bufferInfo(media,currentTime,0),startTime=currentTime<bufferInfo.start?bufferInfo.start:bufferInfo.nextStart;if(startTime){const bufferStarved=bufferInfo.len<=config.maxBufferHole,waiting=bufferInfo.len>0&&bufferInfo.len<1&&media.readyState<3,gapLength=startTime-currentTime;if(gapLength>0&&(bufferStarved||waiting)){if(gapLength>config.maxBufferHole){const{fragmentTracker}=this;let startGap=!1;if(0===currentTime){const startFrag=fragmentTracker.getAppendedFrag(0,PlaylistLevelType_MAIN);startFrag&&startTime<startFrag.end&&(startGap=!0)}if(!startGap){const startProvisioned=partial||fragmentTracker.getAppendedFrag(currentTime,PlaylistLevelType_MAIN);if(startProvisioned){let moreToLoad=!1,pos=startProvisioned.end;for(;pos<startTime;){const provisioned=fragmentTracker.getPartialFragment(pos);if(!provisioned){moreToLoad=!0;break}pos+=provisioned.duration}if(moreToLoad)return 0}}}const targetTime=Math.max(startTime+.05,currentTime+.1);if(logger.warn(`skipping hole, adjusting currentTime from ${currentTime} to ${targetTime}`),this.moved=!0,this.stalled=null,media.currentTime=targetTime,partial&&!partial.gap){const error=new Error(`fragment loaded with buffer holes, seeking from ${currentTime} to ${targetTime}`);hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error,reason:error.message,frag:partial})}return targetTime}}return 0}_tryNudgeBuffer(){const{config,hls,media,nudgeRetry}=this;if(null===media)return;const currentTime=media.currentTime;if(this.nudgeRetry++,nudgeRetry<config.nudgeMaxRetry){const targetTime=currentTime+(nudgeRetry+1)*config.nudgeOffset,error=new Error(`Nudging 'currentTime' from ${currentTime} to ${targetTime}`);logger.warn(error.message),media.currentTime=targetTime,hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error,fatal:!1})}else{const error=new Error(`Playhead still not moving while enough data buffered @${currentTime} after ${config.nudgeMaxRetry} nudges`);logger.error(error.message),hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error,fatal:!0})}}}class StreamController extends BaseStreamController{constructor(hls,fragmentTracker,keyLoader){super(hls,fragmentTracker,keyLoader,"[stream-controller]",PlaylistLevelType_MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls}=this;hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.on(Events.LEVEL_LOADING,this.onLevelLoading,this),hls.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),hls.on(Events.ERROR,this.onError,this),hls.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.on(Events.BUFFER_CREATED,this.onBufferCreated,this),hls.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls}=this;hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),hls.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),hls.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),hls.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),hls.off(Events.ERROR,this.onError,this),hls.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),hls.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),hls.off(Events.BUFFER_CREATED,this.onBufferCreated,this),hls.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),hls.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),hls.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(startPosition){if(this.levels){const{lastCurrentTime,hls}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let startLevel=hls.startLevel;-1===startLevel&&(hls.config.testBandwidth&&this.levels.length>1?(startLevel=0,this.bitrateTest=!0):startLevel=hls.firstAutoLevel),hls.nextLoadLevel=startLevel,this.level=hls.loadLevel,this.loadedmetadata=!1}lastCurrentTime>0&&-1===startPosition&&(this.log(`Override startPosition with lastCurrentTime @${lastCurrentTime.toFixed(3)}`),startPosition=lastCurrentTime),this.state=State_IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=startPosition,this.tick()}else this._forceStartLoad=!0,this.state=State_STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State_WAITING_LEVEL:{const{levels,level}=this,currentLevel=null==levels?void 0:levels[level],details=null==currentLevel?void 0:currentLevel.details;if(details&&(!details.live||this.levelLastLoaded===currentLevel)){if(this.waitForCdnTuneIn(details))break;this.state=State_IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=State_IDLE;break}break}case State_FRAG_LOADING_WAITING_RETRY:{var _this$media;const now=self.performance.now(),retryDate=this.retryDate;if(!retryDate||now>=retryDate||null!=(_this$media=this.media)&&_this$media.seeking){const{levels,level}=this,currentLevel=null==levels?void 0:levels[level];this.resetStartWhenNotLoaded(currentLevel||null),this.state=State_IDLE}}}this.state===State_IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls,levelLastLoaded,levels,media}=this;if(null===levelLastLoaded||!media&&(this.startFragRequested||!hls.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const level=hls.nextLoadLevel;if(null==levels||!levels[level])return;const levelInfo=levels[level],bufferInfo=this.getMainFwdBufferInfo();if(null===bufferInfo)return;const lastDetails=this.getLevelDetails();if(lastDetails&&this._streamEnded(bufferInfo,lastDetails)){const data={};return this.altAudio&&(data.type="video"),this.hls.trigger(Events.BUFFER_EOS,data),void(this.state=State_ENDED)}hls.loadLevel!==level&&-1===hls.manualLevel&&this.log(`Adapting to level ${level} from level ${this.level}`),this.level=hls.nextLoadLevel=level;const levelDetails=levelInfo.details;if(!levelDetails||this.state===State_WAITING_LEVEL||levelDetails.live&&this.levelLastLoaded!==levelInfo)return this.level=level,void(this.state=State_WAITING_LEVEL);const bufferLen=bufferInfo.len,maxBufLen=this.getMaxBufferLength(levelInfo.maxBitrate);if(bufferLen>=maxBufLen)return;this.backtrackFragment&&this.backtrackFragment.start>bufferInfo.end&&(this.backtrackFragment=null);const targetBufferTime=this.backtrackFragment?this.backtrackFragment.start:bufferInfo.end;let frag=this.getNextFragment(targetBufferTime,levelDetails);if(this.couldBacktrack&&!this.fragPrevious&&frag&&"initSegment"!==frag.sn&&this.fragmentTracker.getState(frag)!==FragmentState_OK){var _this$backtrackFragme;const fragIdx=(null!=(_this$backtrackFragme=this.backtrackFragment)?_this$backtrackFragme:frag).sn-levelDetails.startSN,backtrackFrag=levelDetails.fragments[fragIdx-1];backtrackFrag&&frag.cc===backtrackFrag.cc&&(frag=backtrackFrag,this.fragmentTracker.removeFragment(backtrackFrag))}else this.backtrackFragment&&bufferInfo.len&&(this.backtrackFragment=null);if(frag&&this.isLoopLoading(frag,targetBufferTime)){if(!frag.gap){const type=this.audioOnly&&!this.altAudio?ElementaryStreamTypes_AUDIO:ElementaryStreamTypes_VIDEO,mediaBuffer=(type===ElementaryStreamTypes_VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;mediaBuffer&&this.afterBufferFlushed(mediaBuffer,type,PlaylistLevelType_MAIN)}frag=this.getNextFragmentLoopLoading(frag,levelDetails,bufferInfo,PlaylistLevelType_MAIN,maxBufLen)}frag&&(!frag.initSegment||frag.initSegment.data||this.bitrateTest||(frag=frag.initSegment),this.loadFragment(frag,levelInfo,targetBufferTime))}loadFragment(frag,level,targetBufferTime){const fragState=this.fragmentTracker.getState(frag);this.fragCurrent=frag,fragState===FragmentState_NOT_LOADED||fragState===FragmentState_PARTIAL?"initSegment"===frag.sn?this._loadInitSegment(frag,level):this.bitrateTest?(this.log(`Fragment ${frag.sn} of level ${frag.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(frag,level)):(this.startFragRequested=!0,super.loadFragment(frag,level,targetBufferTime)):this.clearTrackerIfNeeded(frag)}getBufferedFrag(position){return this.fragmentTracker.getBufferedFrag(position,PlaylistLevelType_MAIN)}followingBufferedFrag(frag){return frag?this.getBufferedFrag(frag.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels,media}=this;if(null!=media&&media.readyState){let fetchdelay;const fragPlayingCurrent=this.getAppendedFrag(media.currentTime);fragPlayingCurrent&&fragPlayingCurrent.start>1&&this.flushMainBuffer(0,fragPlayingCurrent.start-1);const levelDetails=this.getLevelDetails();if(null!=levelDetails&&levelDetails.live){const bufferInfo=this.getMainFwdBufferInfo();if(!bufferInfo||bufferInfo.len<2*levelDetails.targetduration)return}if(!media.paused&&levels){const nextLevel=levels[this.hls.nextLoadLevel],fragLastKbps=this.fragLastKbps;fetchdelay=fragLastKbps&&this.fragCurrent?this.fragCurrent.duration*nextLevel.maxBitrate/(1e3*fragLastKbps)+1:0}else fetchdelay=0;const bufferedFrag=this.getBufferedFrag(media.currentTime+fetchdelay);if(bufferedFrag){const nextBufferedFrag=this.followingBufferedFrag(bufferedFrag);if(nextBufferedFrag){this.abortCurrentFrag();const maxStart=nextBufferedFrag.maxStartPTS?nextBufferedFrag.maxStartPTS:nextBufferedFrag.start,fragDuration=nextBufferedFrag.duration,startPts=Math.max(bufferedFrag.end,maxStart+Math.min(Math.max(fragDuration-this.config.maxFragLookUpTolerance,fragDuration*(this.couldBacktrack?.5:.125)),fragDuration*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(startPts,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const fragCurrent=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,fragCurrent&&(fragCurrent.abortRequests(),this.fragmentTracker.removeFragment(fragCurrent)),this.state){case State_KEY_LOADING:case State_FRAG_LOADING:case State_FRAG_LOADING_WAITING_RETRY:case State_PARSING:case State_PARSED:this.state=State_IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(startOffset,endOffset){super.flushMainBuffer(startOffset,endOffset,this.altAudio?"video":null)}onMediaAttached(event,data){super.onMediaAttached(event,data);const media=data.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),media.addEventListener("playing",this.onvplaying),media.addEventListener("seeked",this.onvseeked),this.gapController=new GapController(this.config,media,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media}=this;media&&this.onvplaying&&this.onvseeked&&(media.removeEventListener("playing",this.onvplaying),media.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const media=this.media,currentTime=media?media.currentTime:null;isFiniteNumber(currentTime)&&this.log(`Media seeked to ${currentTime.toFixed(3)}`);const bufferInfo=this.getMainFwdBufferInfo();null!==bufferInfo&&0!==bufferInfo.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${bufferInfo?bufferInfo.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(event,data){let aac=!1,heaac=!1;data.levels.forEach((level=>{const codec=level.audioCodec;codec&&(aac=aac||-1!==codec.indexOf("mp4a.40.2"),heaac=heaac||-1!==codec.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=aac&&heaac&&!function changeTypeSupported(){var _sourceBuffer$prototy;const sourceBuffer=getSourceBuffer();return"function"==typeof(null==sourceBuffer||null==(_sourceBuffer$prototy=sourceBuffer.prototype)?void 0:_sourceBuffer$prototy.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=data.levels,this.startFragRequested=!1}onLevelLoading(event,data){const{levels}=this;if(!levels||this.state!==State_IDLE)return;const level=levels[data.level];(!level.details||level.details.live&&this.levelLastLoaded!==level||this.waitForCdnTuneIn(level.details))&&(this.state=State_WAITING_LEVEL)}onLevelLoaded(event,data){var _curLevel$details;const{levels}=this,newLevelId=data.level,newDetails=data.details,duration=newDetails.totalduration;if(!levels)return void this.warn(`Levels were reset while loading level ${newLevelId}`);this.log(`Level ${newLevelId} loaded [${newDetails.startSN},${newDetails.endSN}]${newDetails.lastPartSn?`[part-${newDetails.lastPartSn}-${newDetails.lastPartIndex}]`:""}, cc [${newDetails.startCC}, ${newDetails.endCC}] duration:${duration}`);const curLevel=levels[newLevelId],fragCurrent=this.fragCurrent;!fragCurrent||this.state!==State_FRAG_LOADING&&this.state!==State_FRAG_LOADING_WAITING_RETRY||fragCurrent.level!==data.level&&fragCurrent.loader&&this.abortCurrentFrag();let sliding=0;if(newDetails.live||null!=(_curLevel$details=curLevel.details)&&_curLevel$details.live){var _this$levelLastLoaded;if(this.checkLiveUpdate(newDetails),newDetails.deltaUpdateFailed)return;sliding=this.alignPlaylists(newDetails,curLevel.details,null==(_this$levelLastLoaded=this.levelLastLoaded)?void 0:_this$levelLastLoaded.details)}if(curLevel.details=newDetails,this.levelLastLoaded=curLevel,this.hls.trigger(Events.LEVEL_UPDATED,{details:newDetails,level:newLevelId}),this.state===State_WAITING_LEVEL){if(this.waitForCdnTuneIn(newDetails))return;this.state=State_IDLE}this.startFragRequested?newDetails.live&&this.synchronizeToLiveEdge(newDetails):this.setStartPosition(newDetails,sliding),this.tick()}_handleFragmentLoadProgress(data){var _frag$initSegment;const{frag,part,payload}=data,{levels}=this;if(!levels)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${frag.sn} of level ${frag.level} will not be buffered`);const currentLevel=levels[frag.level],details=currentLevel.details;if(!details)return this.warn(`Dropping fragment ${frag.sn} of level ${frag.level} after level details were reset`),void this.fragmentTracker.removeFragment(frag);const videoCodec=currentLevel.videoCodec,accurateTimeOffset=details.PTSKnown||!details.live,initSegmentData=null==(_frag$initSegment=frag.initSegment)?void 0:_frag$initSegment.data,audioCodec=this._getAudioCodec(currentLevel),transmuxer=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType_MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),partIndex=part?part.index:-1,partial=-1!==partIndex,chunkMeta=new ChunkMetadata(frag.level,frag.sn,frag.stats.chunkCount,payload.byteLength,partIndex,partial),initPTS=this.initPTS[frag.cc];transmuxer.push(payload,initSegmentData,audioCodec,videoCodec,frag,part,details.totalduration,accurateTimeOffset,chunkMeta,initPTS)}onAudioTrackSwitching(event,data){const fromAltAudio=this.altAudio;if(!!!data.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const fragCurrent=this.fragCurrent;fragCurrent&&(this.log("Switching to main audio track, cancel main fragment load"),fragCurrent.abortRequests(),this.fragmentTracker.removeFragment(fragCurrent)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const hls=this.hls;fromAltAudio&&(hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),hls.trigger(Events.AUDIO_TRACK_SWITCHED,data)}}onAudioTrackSwitched(event,data){const trackId=data.id,altAudio=!!this.hls.audioTracks[trackId].url;if(altAudio){const videoBuffer=this.videoBuffer;videoBuffer&&this.mediaBuffer!==videoBuffer&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=videoBuffer)}this.altAudio=altAudio,this.tick()}onBufferCreated(event,data){const tracks=data.tracks;let mediaTrack,name,alternate=!1;for(const type in tracks){const track=tracks[type];if("main"===track.id){if(name=type,mediaTrack=track,"video"===type){const videoTrack=tracks[type];videoTrack&&(this.videoBuffer=videoTrack.buffer)}}else alternate=!0}alternate&&mediaTrack?(this.log(`Alternate track found, use ${name}.buffered to schedule main fragment loading`),this.mediaBuffer=mediaTrack.buffer):this.mediaBuffer=this.media}onFragBuffered(event,data){const{frag,part}=data;if(frag&&frag.type!==PlaylistLevelType_MAIN)return;if(this.fragContextChanged(frag))return this.warn(`Fragment ${frag.sn}${part?" p: "+part.index:""} of level ${frag.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===State_PARSED&&(this.state=State_IDLE));const stats=part?part.stats:frag.stats;this.fragLastKbps=Math.round(8*stats.total/(stats.buffering.end-stats.loading.first)),"initSegment"!==frag.sn&&(this.fragPrevious=frag),this.fragBufferedComplete(frag,part)}onError(event,data){var _data$context;if(data.fatal)this.state=State_ERROR;else switch(data.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType_MAIN,data);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:data.levelRetry||this.state!==State_WAITING_LEVEL||(null==(_data$context=data.context)?void 0:_data$context.type)!==PlaylistContextType_LEVEL||(this.state=State_IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!data.parent||"main"!==data.parent)return;if(data.details===ErrorDetails.BUFFER_APPEND_ERROR)return void this.resetLoadingState();this.reduceLengthAndFlushBuffer(data)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(data)}}checkBuffer(){const{media,gapController}=this;if(media&&gapController&&media.readyState){if(this.loadedmetadata||!BufferHelper.getBuffered(media).length){const activeFrag=this.state!==State_IDLE?this.fragCurrent:null;gapController.poll(this.lastCurrentTime,activeFrag)}this.lastCurrentTime=media.currentTime}}onFragLoadEmergencyAborted(){this.state=State_IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(event,{type}){if(type!==ElementaryStreamTypes_AUDIO||this.audioOnly&&!this.altAudio){const mediaBuffer=(type===ElementaryStreamTypes_VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(mediaBuffer,type,PlaylistLevelType_MAIN),this.tick()}}onLevelsUpdated(event,data){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=data.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media}=this;if(!media)return;const currentTime=media.currentTime;let startPosition=this.startPosition;if(startPosition>=0&&currentTime<startPosition){if(media.seeking)return void this.log(`could not seek to ${startPosition}, already seeking at ${currentTime}`);const buffered=BufferHelper.getBuffered(media),delta=(buffered.length?buffered.start(0):0)-startPosition;delta>0&&(delta<this.config.maxBufferHole||delta<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${delta} to match buffer start`),startPosition+=delta,this.startPosition=startPosition),this.log(`seek to target start position ${startPosition} from current time ${currentTime}`),media.currentTime=startPosition}}_getAudioCodec(currentLevel){let audioCodec=this.config.defaultAudioCodec||currentLevel.audioCodec;return this.audioCodecSwap&&audioCodec&&(this.log("Swapping audio codec"),audioCodec=-1!==audioCodec.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),audioCodec}_loadBitrateTestFrag(frag,level){frag.bitrateTest=!0,this._doFragLoad(frag,level).then((data=>{const{hls}=this;if(!data||this.fragContextChanged(frag))return;level.fragmentError=0,this.state=State_IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const stats=frag.stats;stats.parsing.start=stats.parsing.end=stats.buffering.start=stats.buffering.end=self.performance.now(),hls.trigger(Events.FRAG_LOADED,data),frag.bitrateTest=!1}))}_handleTransmuxComplete(transmuxResult){var _id3$samples;const id="main",{hls}=this,{remuxResult,chunkMeta}=transmuxResult,context=this.getCurrentContext(chunkMeta);if(!context)return void this.resetWhenMissingContext(chunkMeta);const{frag,part,level}=context,{video,text,id3,initSegment}=remuxResult,{details}=level,audio=this.altAudio?void 0:remuxResult.audio;if(this.fragContextChanged(frag))this.fragmentTracker.removeFragment(frag);else{if(this.state=State_PARSING,initSegment){if(null!=initSegment&&initSegment.tracks){const mapFragment=frag.initSegment||frag;this._bufferInitSegment(level,initSegment.tracks,mapFragment,chunkMeta),hls.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:mapFragment,id,tracks:initSegment.tracks})}const initPTS=initSegment.initPTS,timescale=initSegment.timescale;isFiniteNumber(initPTS)&&(this.initPTS[frag.cc]={baseTime:initPTS,timescale},hls.trigger(Events.INIT_PTS_FOUND,{frag,id,initPTS,timescale}))}if(video&&details&&"initSegment"!==frag.sn){const prevFrag=details.fragments[frag.sn-1-details.startSN],isFirstFragment=frag.sn===details.startSN,isFirstInDiscontinuity=!prevFrag||frag.cc>prevFrag.cc;if(!1!==remuxResult.independent){const{startPTS,endPTS,startDTS,endDTS}=video;if(part)part.elementaryStreams[video.type]={startPTS,endPTS,startDTS,endDTS};else if(video.firstKeyFrame&&video.independent&&1===chunkMeta.id&&!isFirstInDiscontinuity&&(this.couldBacktrack=!0),video.dropped&&video.independent){const bufferInfo=this.getMainFwdBufferInfo(),targetBufferTime=(bufferInfo?bufferInfo.end:this.getLoadPosition())+this.config.maxBufferHole,startTime=video.firstKeyFramePTS?video.firstKeyFramePTS:startPTS;if(!isFirstFragment&&targetBufferTime<startTime-this.config.maxBufferHole&&!isFirstInDiscontinuity)return void this.backtrack(frag);isFirstInDiscontinuity&&(frag.gap=!0),frag.setElementaryStreamInfo(video.type,frag.start,endPTS,frag.start,endDTS,!0)}else isFirstFragment&&startPTS>2&&(frag.gap=!0);frag.setElementaryStreamInfo(video.type,startPTS,endPTS,startDTS,endDTS),this.backtrackFragment&&(this.backtrackFragment=frag),this.bufferFragmentData(video,frag,part,chunkMeta,isFirstFragment||isFirstInDiscontinuity)}else{if(!isFirstFragment&&!isFirstInDiscontinuity)return void this.backtrack(frag);frag.gap=!0}}if(audio){const{startPTS,endPTS,startDTS,endDTS}=audio;part&&(part.elementaryStreams[ElementaryStreamTypes_AUDIO]={startPTS,endPTS,startDTS,endDTS}),frag.setElementaryStreamInfo(ElementaryStreamTypes_AUDIO,startPTS,endPTS,startDTS,endDTS),this.bufferFragmentData(audio,frag,part,chunkMeta)}if(details&&null!=id3&&null!=(_id3$samples=id3.samples)&&_id3$samples.length){const emittedID3={id,frag,details,samples:id3.samples};hls.trigger(Events.FRAG_PARSING_METADATA,emittedID3)}if(details&&text){const emittedText={id,frag,details,samples:text.samples};hls.trigger(Events.FRAG_PARSING_USERDATA,emittedText)}}}_bufferInitSegment(currentLevel,tracks,frag,chunkMeta){if(this.state!==State_PARSING)return;this.audioOnly=!!tracks.audio&&!tracks.video,this.altAudio&&!this.audioOnly&&delete tracks.audio;const{audio,video,audiovideo}=tracks;if(audio){let audioCodec=currentLevel.audioCodec;const ua=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){audioCodec&&(audioCodec=-1!==audioCodec.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const audioMetadata=audio.metadata;audioMetadata&&"channelCount"in audioMetadata&&1!==(audioMetadata.channelCount||1)&&-1===ua.indexOf("firefox")&&(audioCodec="mp4a.40.5")}audioCodec&&-1!==audioCodec.indexOf("mp4a.40.5")&&-1!==ua.indexOf("android")&&"audio/mpeg"!==audio.container&&(audioCodec="mp4a.40.2",this.log(`Android: force audio codec to ${audioCodec}`)),currentLevel.audioCodec&&currentLevel.audioCodec!==audioCodec&&this.log(`Swapping manifest audio codec "${currentLevel.audioCodec}" for "${audioCodec}"`),audio.levelCodec=audioCodec,audio.id="main",this.log(`Init audio buffer, container:${audio.container}, codecs[selected/level/parsed]=[${audioCodec||""}/${currentLevel.audioCodec||""}/${audio.codec}]`)}video&&(video.levelCodec=currentLevel.videoCodec,video.id="main",this.log(`Init video buffer, container:${video.container}, codecs[level/parsed]=[${currentLevel.videoCodec||""}/${video.codec}]`)),audiovideo&&this.log(`Init audiovideo buffer, container:${audiovideo.container}, codecs[level/parsed]=[${currentLevel.codecs}/${audiovideo.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,tracks),Object.keys(tracks).forEach((trackName=>{const initSegment=tracks[trackName].initSegment;null!=initSegment&&initSegment.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:trackName,data:initSegment,frag,part:null,chunkMeta,parent:frag.type})})),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,PlaylistLevelType_MAIN)}backtrack(frag){this.couldBacktrack=!0,this.backtrackFragment=frag,this.resetTransmuxer(),this.flushBufferGap(frag),this.fragmentTracker.removeFragment(frag),this.fragPrevious=null,this.nextLoadPosition=frag.start,this.state=State_IDLE}checkFragmentChanged(){const video=this.media;let fragPlayingCurrent=null;if(video&&video.readyState>1&&!1===video.seeking){const currentTime=video.currentTime;if(BufferHelper.isBuffered(video,currentTime)?fragPlayingCurrent=this.getAppendedFrag(currentTime):BufferHelper.isBuffered(video,currentTime+.1)&&(fragPlayingCurrent=this.getAppendedFrag(currentTime+.1)),fragPlayingCurrent){this.backtrackFragment=null;const fragPlaying=this.fragPlaying,fragCurrentLevel=fragPlayingCurrent.level;fragPlaying&&fragPlayingCurrent.sn===fragPlaying.sn&&fragPlaying.level===fragCurrentLevel||(this.fragPlaying=fragPlayingCurrent,this.hls.trigger(Events.FRAG_CHANGED,{frag:fragPlayingCurrent}),fragPlaying&&fragPlaying.level===fragCurrentLevel||this.hls.trigger(Events.LEVEL_SWITCHED,{level:fragCurrentLevel}))}}}get nextLevel(){const frag=this.nextBufferedFrag;return frag?frag.level:-1}get currentFrag(){const media=this.media;return media?this.fragPlaying||this.getAppendedFrag(media.currentTime):null}get currentProgramDateTime(){const media=this.media;if(media){const currentTime=media.currentTime,frag=this.currentFrag;if(frag&&isFiniteNumber(currentTime)&&isFiniteNumber(frag.programDateTime)){const epocMs=frag.programDateTime+1e3*(currentTime-frag.start);return new Date(epocMs)}}return null}get currentLevel(){const frag=this.currentFrag;return frag?frag.level:-1}get nextBufferedFrag(){const frag=this.currentFrag;return frag?this.followingBufferedFrag(frag):null}get forceStartLoad(){return this._forceStartLoad}}class Hls{static get version(){return"1.5.11"}static isMSESupported(){return isMSESupported()}static isSupported(){return function isSupported(){if(!isMSESupported())return!1;const mediaSource=getMediaSource();return"function"==typeof(null==mediaSource?void 0:mediaSource.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((codecsForVideoContainer=>mediaSource.isTypeSupported(mimeTypeForCodec(codecsForVideoContainer,"video"))))||["mp4a.40.2","fLaC"].some((codecForAudioContainer=>mediaSource.isTypeSupported(mimeTypeForCodec(codecForAudioContainer,"audio")))))}()}static getMediaSource(){return getMediaSource()}static get Events(){return Events}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(defaultConfig){Hls.defaultConfig=defaultConfig}constructor(userConfig={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new EventEmitter,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,function enableLogs(debugConfig,id){if("object"==typeof console&&!0===debugConfig||"object"==typeof debugConfig){exportLoggerFunctions(debugConfig,"debug","log","info","warn","error");try{exportedLogger.log(`Debug logs enabled for "${id}" in hls.js version 1.5.11`)}catch(e){exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}(userConfig.debug||!1,"Hls instance");const config=this.config=function mergeConfig(defaultConfig,userConfig){if((userConfig.liveSyncDurationCount||userConfig.liveMaxLatencyDurationCount)&&(userConfig.liveSyncDuration||userConfig.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==userConfig.liveMaxLatencyDurationCount&&(void 0===userConfig.liveSyncDurationCount||userConfig.liveMaxLatencyDurationCount<=userConfig.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==userConfig.liveMaxLatencyDuration&&(void 0===userConfig.liveSyncDuration||userConfig.liveMaxLatencyDuration<=userConfig.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const defaultsCopy=deepCpy(defaultConfig),deprecatedSettings=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((type=>{const policyName=`${"level"===type?"playlist":type}LoadPolicy`,policyNotSet=void 0===userConfig[policyName],report=[];deprecatedSettings.forEach((setting=>{const deprecatedSetting=`${type}Loading${setting}`,value=userConfig[deprecatedSetting];if(void 0!==value&&policyNotSet){report.push(deprecatedSetting);const settings=defaultsCopy[policyName].default;switch(userConfig[policyName]={default:settings},setting){case"TimeOut":settings.maxLoadTimeMs=value,settings.maxTimeToFirstByteMs=value;break;case"MaxRetry":settings.errorRetry.maxNumRetry=value,settings.timeoutRetry.maxNumRetry=value;break;case"RetryDelay":settings.errorRetry.retryDelayMs=value,settings.timeoutRetry.retryDelayMs=value;break;case"MaxRetryTimeout":settings.errorRetry.maxRetryDelayMs=value,settings.timeoutRetry.maxRetryDelayMs=value}}})),report.length&&logger.warn(`hls.js config: "${report.join('", "')}" setting(s) are deprecated, use "${policyName}": ${JSON.stringify(userConfig[policyName])}`)})),_objectSpread2(_objectSpread2({},defaultsCopy),userConfig)}(Hls.DefaultConfig,userConfig);this.userConfig=userConfig,config.progressive&&enableStreamingMode(config);const{abrController:ConfigAbrController,bufferController:ConfigBufferController,capLevelController:ConfigCapLevelController,errorController:ConfigErrorController,fpsController:ConfigFpsController}=config,errorController=new ConfigErrorController(this),abrController=this.abrController=new ConfigAbrController(this),bufferController=this.bufferController=new ConfigBufferController(this),capLevelController=this.capLevelController=new ConfigCapLevelController(this),fpsController=new ConfigFpsController(this),playListLoader=new PlaylistLoader(this),id3TrackController=new ID3TrackController(this),ConfigContentSteeringController=config.contentSteeringController,contentSteering=ConfigContentSteeringController?new ConfigContentSteeringController(this):null,levelController=this.levelController=new LevelController(this,contentSteering),fragmentTracker=new FragmentTracker(this),keyLoader=new KeyLoader(this.config),streamController=this.streamController=new StreamController(this,fragmentTracker,keyLoader);capLevelController.setStreamController(streamController),fpsController.setStreamController(streamController);const networkControllers=[playListLoader,levelController,streamController];contentSteering&&networkControllers.splice(1,0,contentSteering),this.networkControllers=networkControllers;const coreComponents=[abrController,bufferController,capLevelController,fpsController,id3TrackController,fragmentTracker];this.audioTrackController=this.createController(config.audioTrackController,networkControllers);const AudioStreamControllerClass=config.audioStreamController;AudioStreamControllerClass&&networkControllers.push(new AudioStreamControllerClass(this,fragmentTracker,keyLoader)),this.subtitleTrackController=this.createController(config.subtitleTrackController,networkControllers);const SubtitleStreamControllerClass=config.subtitleStreamController;SubtitleStreamControllerClass&&networkControllers.push(new SubtitleStreamControllerClass(this,fragmentTracker,keyLoader)),this.createController(config.timelineController,coreComponents),keyLoader.emeController=this.emeController=this.createController(config.emeController,coreComponents),this.cmcdController=this.createController(config.cmcdController,coreComponents),this.latencyController=this.createController(LatencyController,coreComponents),this.coreComponents=coreComponents,networkControllers.push(errorController);const onErrorOut=errorController.onErrorOut;"function"==typeof onErrorOut&&this.on(Events.ERROR,onErrorOut,errorController)}createController(ControllerClass,components){if(ControllerClass){const controllerInstance=new ControllerClass(this);return components&&components.push(controllerInstance),controllerInstance}return null}on(event,listener,context=this){this._emitter.on(event,listener,context)}once(event,listener,context=this){this._emitter.once(event,listener,context)}removeAllListeners(event){this._emitter.removeAllListeners(event)}off(event,listener,context=this,once){this._emitter.off(event,listener,context,once)}listeners(event){return this._emitter.listeners(event)}emit(event,name,eventObject){return this._emitter.emit(event,name,eventObject)}trigger(event,eventObject){if(this.config.debug)return this.emit(event,event,eventObject);try{return this.emit(event,event,eventObject)}catch(error){if(logger.error("An internal error happened while handling event "+event+'. Error message: "'+error.message+'". Here is a stacktrace:',error),!this.triggeringException){this.triggeringException=!0;const fatal=event===Events.ERROR;this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal,event,error}),this.triggeringException=!1}}return!1}listenerCount(event){return this._emitter.listenerCount(event)}destroy(){logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((component=>component.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((component=>component.destroy())),this.coreComponents.length=0;const config=this.config;config.xhrSetup=config.fetchSetup=void 0,this.userConfig=null}attachMedia(media){logger.log("attachMedia"),this._media=media,this.trigger(Events.MEDIA_ATTACHING,{media})}detachMedia(){logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,void 0),this._media=null}loadSource(url){this.stopLoad();const media=this.media,loadedSource=this.url,loadingSource=this.url=urlToolkitExports.buildAbsoluteURL(self.location.href,url,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,logger.log(`loadSource:${loadingSource}`),media&&loadedSource&&(loadedSource!==loadingSource||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(media)),this.trigger(Events.MANIFEST_LOADING,{url})}startLoad(startPosition=-1){logger.log(`startLoad(${startPosition})`),this.started=!0,this.networkControllers.forEach((controller=>{controller.startLoad(startPosition)}))}stopLoad(){logger.log("stopLoad"),this.started=!1,this.networkControllers.forEach((controller=>{controller.stopLoad()}))}resumeBuffering(){this.started&&this.networkControllers.forEach((controller=>{"fragmentLoader"in controller&&controller.startLoad(-1)}))}pauseBuffering(){this.networkControllers.forEach((controller=>{"fragmentLoader"in controller&&controller.stopLoad()}))}swapAudioCodec(){logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){logger.log("recoverMediaError");const media=this._media;this.detachMedia(),media&&this.attachMedia(media)}removeLevel(levelIndex){this.levelController.removeLevel(levelIndex)}get levels(){const levels=this.levelController.levels;return levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(newLevel){logger.log(`set currentLevel:${newLevel}`),this.levelController.manualLevel=newLevel,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(newLevel){logger.log(`set nextLevel:${newLevel}`),this.levelController.manualLevel=newLevel,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(newLevel){logger.log(`set loadLevel:${newLevel}`),this.levelController.manualLevel=newLevel}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(level){this.levelController.nextLoadLevel=level}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(newLevel){logger.log(`set firstLevel:${newLevel}`),this.levelController.firstLevel=newLevel}get startLevel(){const startLevel=this.levelController.startLevel;return-1===startLevel&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:startLevel}set startLevel(newLevel){logger.log(`set startLevel:${newLevel}`),-1!==newLevel&&(newLevel=Math.max(newLevel,this.minAutoLevel)),this.levelController.startLevel=newLevel}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(shouldStartCapping){const newCapLevelToPlayerSize=!!shouldStartCapping;newCapLevelToPlayerSize!==this.config.capLevelToPlayerSize&&(newCapLevelToPlayerSize?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=newCapLevelToPlayerSize)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator}=this.abrController;return bwEstimator?bwEstimator.getEstimate():NaN}set bandwidthEstimate(abrEwmaDefaultEstimate){this.abrController.resetEstimator(abrEwmaDefaultEstimate)}get ttfbEstimate(){const{bwEstimator}=this.abrController;return bwEstimator?bwEstimator.getEstimateTTFB():NaN}set autoLevelCapping(newLevel){this._autoLevelCapping!==newLevel&&(logger.log(`set autoLevelCapping:${newLevel}`),this._autoLevelCapping=newLevel,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(value){(function isHdcpLevel(value){return HdcpLevels.indexOf(value)>-1})(value)&&this._maxHdcpLevel!==value&&(this._maxHdcpLevel=value,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels,config:{minAutoBitrate}}=this;if(!levels)return 0;const len=levels.length;for(let i=0;i<len;i++)if(levels[i].maxBitrate>=minAutoBitrate)return i;return 0}get maxAutoLevel(){const{levels,autoLevelCapping,maxHdcpLevel}=this;let maxAutoLevel;if(maxAutoLevel=-1===autoLevelCapping&&null!=levels&&levels.length?levels.length-1:autoLevelCapping,maxHdcpLevel)for(let i=maxAutoLevel;i--;){const hdcpLevel=levels[i].attrs["HDCP-LEVEL"];if(hdcpLevel&&hdcpLevel<=maxHdcpLevel)return i}return maxAutoLevel}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(nextLevel){this.abrController.nextAutoLevel=nextLevel}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(audioOption){var _this$audioTrackContr;return null==(_this$audioTrackContr=this.audioTrackController)?void 0:_this$audioTrackContr.setAudioOption(audioOption)}setSubtitleOption(subtitleOption){var _this$subtitleTrackCo;return null==(_this$subtitleTrackCo=this.subtitleTrackController)||_this$subtitleTrackCo.setSubtitleOption(subtitleOption),null}get allAudioTracks(){const audioTrackController=this.audioTrackController;return audioTrackController?audioTrackController.allAudioTracks:[]}get audioTracks(){const audioTrackController=this.audioTrackController;return audioTrackController?audioTrackController.audioTracks:[]}get audioTrack(){const audioTrackController=this.audioTrackController;return audioTrackController?audioTrackController.audioTrack:-1}set audioTrack(audioTrackId){const audioTrackController=this.audioTrackController;audioTrackController&&(audioTrackController.audioTrack=audioTrackId)}get allSubtitleTracks(){const subtitleTrackController=this.subtitleTrackController;return subtitleTrackController?subtitleTrackController.allSubtitleTracks:[]}get subtitleTracks(){const subtitleTrackController=this.subtitleTrackController;return subtitleTrackController?subtitleTrackController.subtitleTracks:[]}get subtitleTrack(){const subtitleTrackController=this.subtitleTrackController;return subtitleTrackController?subtitleTrackController.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(subtitleTrackId){const subtitleTrackController=this.subtitleTrackController;subtitleTrackController&&(subtitleTrackController.subtitleTrack=subtitleTrackId)}get subtitleDisplay(){const subtitleTrackController=this.subtitleTrackController;return!!subtitleTrackController&&subtitleTrackController.subtitleDisplay}set subtitleDisplay(value){const subtitleTrackController=this.subtitleTrackController;subtitleTrackController&&(subtitleTrackController.subtitleDisplay=value)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(mode){this.config.lowLatencyMode=mode}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Hls.defaultConfig=void 0},"./node_modules/.pnpm/hoist-non-react-statics@3.3.2/node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var reactIs=__webpack_require__("./node_modules/.pnpm/react-is@16.13.1/node_modules/react-is/index.js"),REACT_STATICS={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},KNOWN_STATICS={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};function getStatics(component){return reactIs.isMemo(component)?MEMO_STATICS:TYPE_STATICS[component.$$typeof]||REACT_STATICS}TYPE_STATICS[reactIs.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;var defineProperty=Object.defineProperty,getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getPrototypeOf=Object.getPrototypeOf,objectPrototype=Object.prototype;module.exports=function hoistNonReactStatics(targetComponent,sourceComponent,blacklist){if("string"!=typeof sourceComponent){if(objectPrototype){var inheritedComponent=getPrototypeOf(sourceComponent);inheritedComponent&&inheritedComponent!==objectPrototype&&hoistNonReactStatics(targetComponent,inheritedComponent,blacklist)}var keys=getOwnPropertyNames(sourceComponent);getOwnPropertySymbols&&(keys=keys.concat(getOwnPropertySymbols(sourceComponent)));for(var targetStatics=getStatics(targetComponent),sourceStatics=getStatics(sourceComponent),i=0;i<keys.length;++i){var key=keys[i];if(!(KNOWN_STATICS[key]||blacklist&&blacklist[key]||sourceStatics&&sourceStatics[key]||targetStatics&&targetStatics[key])){var descriptor=getOwnPropertyDescriptor(sourceComponent,key);try{defineProperty(targetComponent,key,descriptor)}catch(e){}}}}return targetComponent}},"./node_modules/.pnpm/react-is@16.13.1/node_modules/react-is/cjs/react-is.production.min.js":(__unused_webpack_module,exports)=>{"use strict";var b="function"==typeof Symbol&&Symbol.for,c=b?Symbol.for("react.element"):60103,d=b?Symbol.for("react.portal"):60106,e=b?Symbol.for("react.fragment"):60107,f=b?Symbol.for("react.strict_mode"):60108,g=b?Symbol.for("react.profiler"):60114,h=b?Symbol.for("react.provider"):60109,k=b?Symbol.for("react.context"):60110,l=b?Symbol.for("react.async_mode"):60111,m=b?Symbol.for("react.concurrent_mode"):60111,n=b?Symbol.for("react.forward_ref"):60112,p=b?Symbol.for("react.suspense"):60113,q=b?Symbol.for("react.suspense_list"):60120,r=b?Symbol.for("react.memo"):60115,t=b?Symbol.for("react.lazy"):60116,v=b?Symbol.for("react.block"):60121,w=b?Symbol.for("react.fundamental"):60117,x=b?Symbol.for("react.responder"):60118,y=b?Symbol.for("react.scope"):60119;function z(a){if("object"==typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l,exports.ConcurrentMode=m,exports.ContextConsumer=k,exports.ContextProvider=h,exports.Element=c,exports.ForwardRef=n,exports.Fragment=e,exports.Lazy=t,exports.Memo=r,exports.Portal=d,exports.Profiler=g,exports.StrictMode=f,exports.Suspense=p,exports.isAsyncMode=function(a){return A(a)||z(a)===l},exports.isConcurrentMode=A,exports.isContextConsumer=function(a){return z(a)===k},exports.isContextProvider=function(a){return z(a)===h},exports.isElement=function(a){return"object"==typeof a&&null!==a&&a.$$typeof===c},exports.isForwardRef=function(a){return z(a)===n},exports.isFragment=function(a){return z(a)===e},exports.isLazy=function(a){return z(a)===t},exports.isMemo=function(a){return z(a)===r},exports.isPortal=function(a){return z(a)===d},exports.isProfiler=function(a){return z(a)===g},exports.isStrictMode=function(a){return z(a)===f},exports.isSuspense=function(a){return z(a)===p},exports.isValidElementType=function(a){return"string"==typeof a||"function"==typeof a||a===e||a===m||a===g||a===f||a===p||a===q||"object"==typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)},exports.typeOf=z},"./node_modules/.pnpm/react-is@16.13.1/node_modules/react-is/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/.pnpm/react-is@16.13.1/node_modules/react-is/cjs/react-is.production.min.js")},"./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/cjs/react-is.production.min.js":(__unused_webpack_module,exports)=>{"use strict";var u,b=Symbol.for("react.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),e=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),h=Symbol.for("react.context"),k=Symbol.for("react.server_context"),l=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),n=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),t=Symbol.for("react.offscreen");function v(a){if("object"==typeof a&&null!==a){var r=a.$$typeof;switch(r){case b:switch(a=a.type){case d:case f:case e:case m:case n:return a;default:switch(a=a&&a.$$typeof){case k:case h:case l:case q:case p:case g:return a;default:return r}}case c:return r}}}u=Symbol.for("react.module.reference"),exports.ForwardRef=l,exports.Memo=p},"./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/.pnpm/react-is@18.3.1/node_modules/react-is/cjs/react-is.production.min.js")},"./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/Transition.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ay:()=>esm_Transition});var objectWithoutPropertiesLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"),inheritsLoose=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.24.7/node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js"),react_dom=__webpack_require__("./node_modules/.pnpm/react-dom@17.0.2_react@17.0.2/node_modules/react-dom/index.js");const config_disabled=!1;var TransitionGroupContext=__webpack_require__("./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/TransitionGroupContext.js"),Transition=function(_React$Component){function Transition(props,context){var _this;_this=_React$Component.call(this,props,context)||this;var initialStatus,appear=context&&!context.isMounting?props.enter:props.appear;return _this.appearStatus=null,props.in?appear?(initialStatus="exited",_this.appearStatus="entering"):initialStatus="entered":initialStatus=props.unmountOnExit||props.mountOnEnter?"unmounted":"exited",_this.state={status:initialStatus},_this.nextCallback=null,_this}(0,inheritsLoose.A)(Transition,_React$Component),Transition.getDerivedStateFromProps=function getDerivedStateFromProps(_ref,prevState){return _ref.in&&"unmounted"===prevState.status?{status:"exited"}:null};var _proto=Transition.prototype;return _proto.componentDidMount=function componentDidMount(){this.updateStatus(!0,this.appearStatus)},_proto.componentDidUpdate=function componentDidUpdate(prevProps){var nextStatus=null;if(prevProps!==this.props){var status=this.state.status;this.props.in?"entering"!==status&&"entered"!==status&&(nextStatus="entering"):"entering"!==status&&"entered"!==status||(nextStatus="exiting")}this.updateStatus(!1,nextStatus)},_proto.componentWillUnmount=function componentWillUnmount(){this.cancelNextCallback()},_proto.getTimeouts=function getTimeouts(){var exit,enter,appear,timeout=this.props.timeout;return exit=enter=appear=timeout,null!=timeout&&"number"!=typeof timeout&&(exit=timeout.exit,enter=timeout.enter,appear=void 0!==timeout.appear?timeout.appear:enter),{exit,enter,appear}},_proto.updateStatus=function updateStatus(mounting,nextStatus){if(void 0===mounting&&(mounting=!1),null!==nextStatus)if(this.cancelNextCallback(),"entering"===nextStatus){if(this.props.unmountOnExit||this.props.mountOnEnter){var node=this.props.nodeRef?this.props.nodeRef.current:react_dom.findDOMNode(this);node&&function forceReflow(node){node.scrollTop}(node)}this.performEnter(mounting)}else this.performExit();else this.props.unmountOnExit&&"exited"===this.state.status&&this.setState({status:"unmounted"})},_proto.performEnter=function performEnter(mounting){var _this2=this,enter=this.props.enter,appearing=this.context?this.context.isMounting:mounting,_ref2=this.props.nodeRef?[appearing]:[react_dom.findDOMNode(this),appearing],maybeNode=_ref2[0],maybeAppearing=_ref2[1],timeouts=this.getTimeouts(),enterTimeout=appearing?timeouts.appear:timeouts.enter;!mounting&&!enter||config_disabled?this.safeSetState({status:"entered"},(function(){_this2.props.onEntered(maybeNode)})):(this.props.onEnter(maybeNode,maybeAppearing),this.safeSetState({status:"entering"},(function(){_this2.props.onEntering(maybeNode,maybeAppearing),_this2.onTransitionEnd(enterTimeout,(function(){_this2.safeSetState({status:"entered"},(function(){_this2.props.onEntered(maybeNode,maybeAppearing)}))}))})))},_proto.performExit=function performExit(){var _this3=this,exit=this.props.exit,timeouts=this.getTimeouts(),maybeNode=this.props.nodeRef?void 0:react_dom.findDOMNode(this);exit&&!config_disabled?(this.props.onExit(maybeNode),this.safeSetState({status:"exiting"},(function(){_this3.props.onExiting(maybeNode),_this3.onTransitionEnd(timeouts.exit,(function(){_this3.safeSetState({status:"exited"},(function(){_this3.props.onExited(maybeNode)}))}))}))):this.safeSetState({status:"exited"},(function(){_this3.props.onExited(maybeNode)}))},_proto.cancelNextCallback=function cancelNextCallback(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},_proto.safeSetState=function safeSetState(nextState,callback){callback=this.setNextCallback(callback),this.setState(nextState,callback)},_proto.setNextCallback=function setNextCallback(callback){var _this4=this,active=!0;return this.nextCallback=function(event){active&&(active=!1,_this4.nextCallback=null,callback(event))},this.nextCallback.cancel=function(){active=!1},this.nextCallback},_proto.onTransitionEnd=function onTransitionEnd(timeout,handler){this.setNextCallback(handler);var node=this.props.nodeRef?this.props.nodeRef.current:react_dom.findDOMNode(this),doesNotHaveTimeoutOrListener=null==timeout&&!this.props.addEndListener;if(node&&!doesNotHaveTimeoutOrListener){if(this.props.addEndListener){var _ref3=this.props.nodeRef?[this.nextCallback]:[node,this.nextCallback],maybeNode=_ref3[0],maybeNextCallback=_ref3[1];this.props.addEndListener(maybeNode,maybeNextCallback)}null!=timeout&&setTimeout(this.nextCallback,timeout)}else setTimeout(this.nextCallback,0)},_proto.render=function render(){var status=this.state.status;if("unmounted"===status)return null;var _this$props=this.props,children=_this$props.children,childProps=(_this$props.in,_this$props.mountOnEnter,_this$props.unmountOnExit,_this$props.appear,_this$props.enter,_this$props.exit,_this$props.timeout,_this$props.addEndListener,_this$props.onEnter,_this$props.onEntering,_this$props.onEntered,_this$props.onExit,_this$props.onExiting,_this$props.onExited,_this$props.nodeRef,(0,objectWithoutPropertiesLoose.A)(_this$props,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return react.createElement(TransitionGroupContext.A.Provider,{value:null},"function"==typeof children?children(status,childProps):react.cloneElement(react.Children.only(children),childProps))},Transition}(react.Component);function noop(){}Transition.contextType=TransitionGroupContext.A,Transition.propTypes={},Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop,onEntering:noop,onEntered:noop,onExit:noop,onExiting:noop,onExited:noop},Transition.UNMOUNTED="unmounted",Transition.EXITED="exited",Transition.ENTERING="entering",Transition.ENTERED="entered",Transition.EXITING="exiting";const esm_Transition=Transition},"./node_modules/.pnpm/react-transition-group@4.4.5_sfoxds7t5ydpegc3knd667wn6m/node_modules/react-transition-group/esm/TransitionGroupContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js").createContext(null)}}]);
//# sourceMappingURL=923.a173fed3.iframe.bundle.js.map