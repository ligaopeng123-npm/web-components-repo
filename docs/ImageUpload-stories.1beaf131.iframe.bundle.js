(self.webpackChunkweb_components_repo=self.webpackChunkweb_components_repo||[]).push([[753],{"./stories/ImageUpload.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,default:()=>ImageUpload_stories,props:()=>props});var utils_types_esm=__webpack_require__("./node_modules/.pnpm/@gaopeng123+utils.types@1.1.16-alpha.4/node_modules/@gaopeng123/utils.types/dist/utils.types.esm.js"),utils_object_esm=__webpack_require__("./node_modules/.pnpm/@gaopeng123+utils.object@1.1.16/node_modules/@gaopeng123/utils.object/dist/utils.object.esm.js"),utils_file_esm=__webpack_require__("./node_modules/.pnpm/@gaopeng123+utils.file@1.1.16/node_modules/@gaopeng123/utils.file/dist/utils.file.esm.js");const isPictureItem=dom=>dom?.classList.contains("picture-item"),getSize=size=>`${size}`.endsWith("%")||`${size}`.endsWith("px")?size:`${size}px`,openToPreviewBase64=base64URL=>{window.open().document.write('<iframe src="'+base64URL+'" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>')};var message_esm=__webpack_require__("./packages/message/dist/message.esm.js");class ImageUpload extends HTMLElement{shadow=null;qmsg=null;__config={width:"100%",height:200,"prevent-preview":!1,"picture-width":48,"picture-height":48,action:"","list-type":"picture",accept:".png,.jpg,.jpeg",multiple:!0,"max-count":Number.MAX_SAFE_INTEGER,"file-list":[]};get config(){return this.__config}constructor(){super(),this.shadow=this.attachShadow({mode:"closed"}),this.qmsg=(0,message_esm.s)(this),this.qmsg.config({showClose:!0})}connectedCallback(){this.shadow.innerHTML=(config=>{const{width,height,accept,multiple}=config,listType=config["list-type"],pictureWidth=config["picture-width"],pictureHeight=config["picture-height"];return`\n\t\t\t<style>\n                .screenshot-upload {\n                    position: relative;\n                    display: flex;\n                    width: ${getSize(width)};\n\t\t\t\t    height: ${getSize(height)};\n                    background: #fafafa;\n                    border: 1px dashed #d9d9d9;\n                    border-radius: 2px;\n                }\n\t\t\t\t.target {\n\t\t\t\t    width: ${getSize(width)};\n\t\t\t\t    height: ${getSize(height)};\n\t\t\t\t    font-size: 14px;\n\t\t\t\t    border-radius: 2px;\n\t\t\t\t    caret-color: #07f1ab;\n\t\t\t\t    caret-shape: block;\n\t\t\t\t    position: absolute;\n\t\t\t\t}\n\t\t\t\t.target:focus {\n\t\t\t\t    outline: 1px dashed #07f1ab;\n\t\t\t\t    border-color: transparent;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.target > span {\n                    line-height: 60px;\n                    font-size: 16px;\n                    margin-left: 16px;\n                    position: absolute;\n                    user-select: none;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n                    pointer-events: none;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.target-text {\n\t\t\t\t     user-select: none;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t#screenshot-upload-list {\n                    user-select: none;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n\t\t\t\t    display: flex;\n\t\t\t\t    margin-top: 60px;\n\t\t\t\t    z-index: 1;\n\t\t\t\t    width: 100%;\n\t\t\t\t    height: calc(100% - 60px);\n                    overflow-y: auto;\n                    overflow-x: hidden;\n                    flex-flow: ${"picture-card"===listType?"row":"wrap"} wrap;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t/* 设置滚动条的样式 */\n                #screenshot-upload-list::-webkit-scrollbar {\n                    width: 4px;\n                    height: 4px;\n                }\n                /* 滚动槽 */\n                #screenshot-upload-list::-webkit-scrollbar-track {\n                    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.2);\n                    border-radius: 4px;\n                }\n                /* 滚动条滑块 */\n                #screenshot-upload-list::-webkit-scrollbar-thumb {\n                    border-radius: 4px;\n                    background: #bbb;\n                    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.25);\n                }\n\t\t\t\t/* 展示类型 */\n\t\t\t\t.picture {\n\t\t\t\t    flex-direction: column;\n\t\t\t\t}\n\t\t\t\t.picture-item {\n\t\t\t\t    margin: 0px;\n\t\t\t\t    width: 100%;\n\t\t\t\t    cursor: pointer;\n\t\t\t\t    display: flex;\n\t\t\t\t    align-items: center;\n\t\t\t\t}\n\t\t\t\t.picture > .picture-item {\n\t\t\t\t    border-top: 1px solid #d9d9d9;\n\t\t\t\t}\n\t\t\t\t.picture > .picture-item > .bth-icon {\n\t\t\t\t    margin-right: 16px;\n\t\t\t\t    margin-left: auto;\n\t\t\t\t    display: flex;\n\t\t\t\t}\n\t\t\t\t.picture-card > .picture-item > .bth-icon {\n\t\t\t\t    position: absolute;\n                    top: calc(50% - 8px);\n                    left: calc(50% - 16px);\n                    opacity: 0;\n                    display: flex;\n                    align-items: center;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-item > .bth-icon > .del-icon {\n\t\t\t\t    margin-left: 12px;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-card > .picture-item > .bth-icon > .preview-icon {\n\t\t\t\t    height: 20px;\n\t\t\t\t    width: 20px;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-card > .picture-item:before {\n\t\t\t\t    position: absolute;\n                    z-index: 1;\n                    width: 100%;\n                    height: 100%;\n                    background-color: #00000080;\n                    opacity: 0;\n                    transition: all .3s;\n                    content: " ";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-card > .picture-item:hover:before {\n\t\t\t\t    opacity: 1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-card > .picture-item:hover > .bth-icon {\n\t\t\t\t    opacity: 1;\n\t\t\t\t    z-index: 1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-card > .picture-item {\n\t\t\t\t    border: 1px solid #d9d9d9;\n\t\t\t\t    width: ${getSize(pictureWidth)};\n\t\t\t\t    height: ${getSize(pictureHeight)};\n\t\t\t\t    position: relative;\n\t\t\t\t    margin: 0px 4px 4px 0px;\n\t\t\t\t}\n\t\t\t\t/*展示类型2*/\n\t\t\t\t.picture-card {\n\t\t\t\t    flex-direction: row;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t#screenshot-upload-bth {\n\t\t\t\t    position: absolute;\n\t\t\t\t    right: 16px;\n                    top: 16px;\n                    user-select: none;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t#upload-bth {\n\t\t\t\t    cursor: pointer;\n\t\t\t\t    opacity: .8;\n\t\t\t\t}\n\n                #upload-bth:hover {\n\t\t\t\t    opacity: 1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.picture-item-title {\n\t\t\t\t    width: calc(100% - 100px);\n\t\t\t\t    margin-left: 12px;\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t</style>\n\t\t\t<div id="image-upload" class="screenshot-upload">\n\t\t\t    <div id="screenshot-upload-target" class="target" \n\t\t\t         readonly="true" contenteditable="true">\n\t\t\t         <span class="target-text">\n\t\t\t             光标选中后“Ctrl + V”粘贴图片\n                     </span>\n                    </div>\n\t\t\t    <div id="screenshot-upload-bth">\n\t\t\t        <input \n\t\t\t            style="display: none" \n\t\t\t            id="screenshot-upload-input" \n\t\t\t            type="file" \n\t\t\t            accept="${accept}" \n\t\t\t            name="file" \n\t\t\t            `+(multiple?"multiple":"")+`\n\t\t\t            />\n\t\t\t            <span><img title="点击上传" id="upload-bth"\n\t\t\t             width="24" height="24" alt="上传" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAcRJREFUWEftlt9twjAQxn0Oj0hlg4Y3iC2VDcoIdIN0gzIB7QTtBrBBGaFMUB4S4I10glKJR+KrHDmSCX/sGEtVJfKY5O775bu7+IA4XlEUxZTSVxkuhBguFouJSypwCVLiYz1WCPHoAlEb4Jh4CeICUQvgnLgrhDWAjbgLhBVAHfG6EEaAbrc7CILg3aVZ8zx/WC6X03OxRgDO+TchpFXteErpwRRU7xFCZkmS9C8F2BBCbqrWcs5RT5wkCVRLZTMVRgeiKOpRSj+kWJ7ncWnpMQD5Due8j4hPiDi1+S8YAU7Zdwqgbq/8PYCsGwCMJDkivtjYpqw+6AGbr1clkmdIS+oBY2wNAKECyNI0bVsmcgJgjH0CQK/UA9da+oq7Alwd+L8OMMbmAHCnxukrTdNilE1XdXoucUD+89/UUvpsOnZLMG8Api+1PUOcHbgC+HRgb+PZ7Xbt1WqVuQqci+t0OmGj0Vjr78gekNvOvXZzKoSQx/LcJ4QUD4JgBACxlnd2sMf5FDXlQsRhsREdccEU6+N5sTEXAGEYtprNptzf9VL4EDmVY7bdbgdZlm32dkK1VseIGALArWeCH0LIXAgx0de+X/IwP0q6D41SAAAAAElFTkSuQmCC"/></span>\n                </div>\n\t\t\t    <div id="screenshot-upload-list" class="${listType}"></div>\n            </div>\n\t\t\t`})(this.config),this.addEvent()}disconnectedCallback(){this.removeEvent()}static get observedAttributes(){return["width","height","picture-width","picture-height","list-type","accept","multiple","action","prevent-preview","max-count","file-list"]}attributeChangedCallback(name,oldValue,newValue){oldValue!==newValue&&(this.__config[name]=newValue,"file-list"===name&&this.renderFileList())}addEvent(){this.addMouseoverEvent(),this.addPasteEvent(),this.addPictureClick(),this.addUploadClick(),this.addUploadChange(),this.addDragEvent(),this.addEnterEvent()}removeEvent(){this.removeMouseoverEvent(),this.removePasteEvent(),this.removePictureClick(),this.removeUploadClick(),this.removeUploadChange(),this.removeDragEvent(),this.removeEnterEvent()}onInput=e=>{this.targetText.innerText="光标选中后“Ctrl + V”粘贴图片"};addEnterEvent(){this.imageUploadTarget.addEventListener("input",this.onInput)}removeEnterEvent(){this.imageUploadTarget.removeEventListener("input",this.onInput)}addDragEvent(){this.imageUpload.addEventListener("dragover",(e=>{e.preventDefault(),e.stopPropagation()}),!1),this.imageUpload.addEventListener("drop",this.onUploadChange,!1)}removeDragEvent(){this.imageUpload.removeEventListener("drop",this.onUploadChange,!1)}renderFileList(){const fileList=(0,utils_types_esm.Kg)(this.config["file-list"])?JSON.parse(this.config["file-list"]):this.config["file-list"];this.fileList=fileList,this.fileList.forEach((file=>{this.insertPicture(file.url||file,file)}))}isMax(len=0){return this.fileList.length+len>this.maxCount&&(this.qmsg.info(`上传图片不能多于${this.maxCount}张`),!0)}get maxCount(){return Number(this.config["max-count"])}__fileList=[];get fileList(){return this.__fileList}set fileList(files){this.__fileList=files}getFileList=()=>this.fileList;previewProcessing=(base64,file,index)=>{this.insertPicture(base64,file),this.fileList.push(file),this.uploadFetch(file,index),this.config.action||this.dispatchEvent(new CustomEvent("uploadChange",{detail:{file,fileList:this.fileList}}))};uploadFetch=(file,index)=>{if(this.config.action){const formData=new FormData;formData.append("file",file),fetch(this.config.action,{method:"post",body:formData}).then((response=>response.json())).then((data=>{const currentFile=this.fileList[(0,utils_types_esm.b0)(index)?this.fileList.length-1:index];currentFile&&(currentFile.response=data),this.dispatchEvent(new CustomEvent("afterUpload",{detail:{response:data,fileList:this.fileList}})),this.dispatchEvent(new CustomEvent("uploadChange",{detail:{file,fileList:this.fileList}}))}))}};onMouseover=()=>{this.imageUploadTarget.focus()};onPaste=event=>{if(event.preventDefault(),!this.isMax(1)){const pasteData=event.clipboardData||window.clipboardData,blob=pasteData?.items[0]?.getAsFile();if(blob){if((blob?1:-1)<0)return;(0,utils_file_esm.v0)(blob).then((base64_str=>{this.previewProcessing(base64_str,blob,void 0)}))}else console.warn("粘贴板上不是图片！"),this.qmsg.warning("粘贴板上不是图片！")}};getPreviewImageFormTarget=target=>(target.querySelector("img")||target).getAttribute("src");onPictureClick=event=>{if(isPictureItem(event.target)||(dom=event.target,dom?.classList.contains("picture-img"))){const base64=this.getPreviewImageFormTarget(event.target);openToPreviewBase64(base64)}else if((dom=>dom?.classList.contains("del-icon"))(event.target))this.removePicture(event.target);else if((dom=>dom?.classList.contains("preview-icon"))(event.target)){const picture=this.getPreviewPicture(event.target);if(picture){const preview=file=>{const preventPreview=this.config["prevent-preview"];var val;val=preventPreview,((0,utils_types_esm.Kg)(val)?"true"===val:val)||openToPreviewBase64(file.url),this.dispatchEvent(new CustomEvent("onPreview",{detail:{file,fileList:this.fileList}}))};(0,utils_types_esm.fo)(picture)?(0,utils_file_esm.v0)(picture).then((str=>{preview({url:str,name:picture.name})})):preview(picture)}}var dom};onUploadClick=event=>{event.stopPropagation(),this.uploadInput.click()};onUploadChange=event=>{event.preventDefault(),event.stopPropagation();const files=event.target.files||event.dataTransfer.files;if(!this.isMax(files.length)){const promises=[];for(let i=0;i<files.length;i++){-1!==files[i].type.indexOf("image")?promises.push((0,utils_file_esm.v0)(files[i])):this.qmsg.info("仅支持上传图片，非图片类型已被禁止！")}Promise.all(promises).then((urls=>{const baseLen=this.fileList.length;urls.forEach(((base64_str,index)=>{this.previewProcessing(base64_str,files[index],baseLen+index)}))}))}};addPasteEvent(){this.imageUploadTarget.addEventListener("paste",this.onPaste)}removePasteEvent(){this.imageUploadTarget.removeEventListener("paste",this.onPaste)}addMouseoverEvent(){this.imageUpload.addEventListener("mouseenter",this.onMouseover)}removeMouseoverEvent(){this.imageUpload.removeEventListener("mouseenter",this.onMouseover)}addPictureClick(){this.imageUploadList.addEventListener("click",this.onPictureClick)}removePictureClick(){this.imageUploadList.removeEventListener("click",this.onPictureClick)}addUploadClick(){this.uploadBth.addEventListener("click",this.onUploadClick)}removeUploadClick(){this.uploadBth.removeEventListener("click",this.onUploadClick)}addUploadChange(){this.uploadInput.addEventListener("change",this.onUploadChange)}removeUploadChange(){this.uploadInput.removeEventListener("change",this.onUploadChange)}get targetText(){return this.shadow.querySelector(".target-text")}get imageUpload(){return this.shadow.querySelector("#image-upload")}get imageUploadTarget(){return this.shadow.querySelector("#screenshot-upload-target")}get imageUploadList(){return this.shadow.querySelector("#screenshot-upload-list")}get uploadBth(){return this.shadow.querySelector("#upload-bth")}get uploadInput(){return this.shadow.querySelector("#screenshot-upload-input")}insertPicture=(url,file)=>{this.imageUploadList&&this.imageUploadList.appendChild(((url,config,file)=>{const listType=config["list-type"],pictureWidth=config["picture-width"],pictureHeight=config["picture-height"],div=document.createElement("div");div.classList.add("picture-item");const title=file?.name||url||"";div.setAttribute("title",title);const pictureTemplate=`\n            <img class="picture-img" width="${getSize(pictureWidth)}" height="${getSize(pictureHeight)}" alt="图片" src="${url}"/>\n            `+("picture"===listType?`<span class="picture-item-title" style="width: calc(100% - ${Number(pictureWidth)+46}px)">${title}</span>`:"")+'\n            <span class="bth-icon">\n                <img title="预览" class="preview-icon" width="18" height="18" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAArpJREFUWEftlkFS20AQRV9beB1uEG6As0ylEPIJYk5AOAFmmdhUTMVOlvgGcU6AOQHGKSrLiBOE3MBskeVOjbBcaDSyZW+oVDELLUY93X9+/+4e4ZmXPHN8XgD8fwx8+6U7ccSuCDVVto2GRJioEk5jrjt1mayjq9IMfB1rQ+EQaKwIMFQYtH25LANkJYDejdY05lwgKOMwtVEYeVWOPr6Vu2XnlgLoXWsH4fM6gXO2Qqe1J2dFPpwAOle6XfX4XoLustgGUcyJSx85AEnwClcINZd3hVsgFCVDrQo1UQKEV05UShjNqNsgMgCWBVf44VXprMrpXKxNYD8HxAEiA6A31pF9UOGveDRa7yRMHc6BHlJhuyi/3bE2Bc4dbAxbvhyk+wsAvWvtIxxnDij3bBE4gv9G2DG2LV8KhVwIQjlr7Usn6SHm8+WnBhXlykHZwjD9Z1eGwMEnX4ZFauyO9U7gde6/xxtzsQSAi3qzPxPqp3ti0rJYOdtHMfZFCB9ibm2ROZkFTJ9o+1JPAHTHapDs2ihLAXhyyGlf0EtMNbV9qSUA5sq9sAG46F2S1/toxo7NQHesQ4H3Rb4XAnIZpjQ9PWwqYMtjZDOmcNL2pf/U1gyuWcQfO7jCZduXZKYsABQ5BgYtX45sJ4lwZwQqTLwqQ7s/JMEfuLAbmqF+GhOkTGX7wI3WmDLKdTMlVKFTZsIlPWKLY53RFHkc14vlKOtcDZvp5wRhlKtMRBKAoZn/FUhmvyo105RUCQqnpiN4JgV27uIII55cZRTV+7J9Q7tXpeFq44VdbK6Jvjw+QjZeZoZMY5pFL6WVDxIjNlEMkLXYMLdWoWk3Mkc5lrtcb6wfFBqums7qjEsBM3AGZTyvZMB2YspLo+RBat4LqcqNOEOpEq4a1xszUOY2m9iszcAmQZadeQHw7Az8A2N4PjAAfKnfAAAAAElFTkSuQmCC"/>\n                <img title="删除" class="del-icon" width="16" height="16" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjQzMjUzMTkxNDA2IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIwNDMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNMzQxLjMxMiA4NS4zMTJsNjQtODUuMzEyaDIxMy4zNzZsNjQgODUuMzEySDk2MHY4NS4zNzZINjRWODUuMzEyaDI3Ny4zMTJ6TTE3MC42ODggMjU2aDY4Mi42MjR2NzY4SDE3MC42ODhWMjU2ek0yNTYgMzQxLjMxMnY1OTcuMzc2aDUxMlYzNDEuMzEySDI1NnogbTIxMy4zMTIgODUuMzc2djQyNi42MjRIMzg0VjQyNi42ODhoODUuMzEyeiBtMTcwLjY4OCAwdjQyNi42MjRINTU0LjY4OFY0MjYuNjg4SDY0MHoiIGZpbGw9IiNkODFlMDYiIHAtaWQ9IjIwNDQiPjwvcGF0aD48L3N2Zz4="/>\n            </span>\n        ';return div.innerHTML=pictureTemplate,div})(url,this.config,file))};getPreviewPicture(target){const rPicture=this.findRemovePicture(target),pictureList=this.imageUploadList.querySelectorAll(".picture-item");for(let i=0;i<pictureList.length;i++)if(rPicture===pictureList[i])return this.fileList[i]}removePicture(target){const rPicture=this.findRemovePicture(target),pictureList=this.imageUploadList.querySelectorAll(".picture-item");let delFile;for(let i=0;i<pictureList.length;i++)rPicture===pictureList[i]&&(delFile=this.fileList.splice(i,1));this.imageUploadList.removeChild(rPicture),this.dispatchEvent(new CustomEvent("afterDelete",{detail:{file:delFile,fileList:this.fileList}})),this.dispatchEvent(new CustomEvent("uploadChange",{detail:{file:null,fileList:this.fileList}}))}findRemovePicture(targe){return(0,utils_object_esm.Sq)(targe,(current=>isPictureItem(current)))}}customElements.get("image-upload")||customElements.define("image-upload",ImageUpload);var dist=__webpack_require__("./node_modules/.pnpm/@storybook+blocks@7.6.19_sfoxds7t5ydpegc3knd667wn6m/node_modules/@storybook/blocks/dist/index.mjs");var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const ImageUpload_stories={title:"Example/ImageUpload",component:ImageUpload,parameters:{layout:"centered",docs:{page:Story=>(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(dist.oz,{children:"# image-upload\n\n`截图上传插件，支持点击上传、截图粘贴上传、拖拽上传`\n\n[在线demo](https://ligaopeng123-npm.github.io/web-components-repo/?path=/story/example-imageupload--props)\n\n## 属性配置\n\n| 属性            | 配置                     | 说明                                         |\n| --------------- | ------------------------ | -------------------------------------------- |\n| width           | string \\| number         | 默认100%                                     |\n| height          | string \\| number         | 默认200                                      |\n| picture-width   | string \\| number         | 默认48                                       |\n| picture-height  | string \\| number         | 默认48                                       |\n| action          | string                   | 上传接口，默认为空字符串                     |\n| list-type       | picture \\|  picture-card | list排列或者卡片排列                         |\n| multiple        | boolean                  | 是否支持多选，默认单选，配置为true后支持多选 |\n| accept          | 支持的图片类型           | 默认.png,.jpg,.jpeg                          |\n| file-list       | string                   | 上传列表[{name: string, url: string}]        |\n| max-count       | number                   | 限制数据，默认不限制                         |\n| prevent-preview | boolean                  | 默认为false，是否阻止默认的预览方式          |\n\n## 事件接口\n\n### getFileList\n\n`当前上传的list`\n\n```typescript\ndocument.querySelector('image-upload').getFileList();\n// 传递进来的数据 或者 File\n```\n\n### onPreview\n\n`预览事件`\n\n```typescript\ndocument.querySelector('image-upload').addEventListener('onPreview', ({detail})=> {});\n```\n\n### uploadChange\n\n`上传更新接口`\n\n```typescript\ndocument.querySelector('image-upload').addEventListener('uploadChange', ({detail})=> {});\n```\n\n### afterUpload\n\n`上传后服务端返回的数据`\n\n```typescript\ndocument.querySelector('image-upload').addEventListener('afterUpload', ({detail})=> {});\n```\n\n### afterDelete\n\n```typescript\ndocument.querySelector('image-upload').addEventListener('afterDelete', ({detail})=> {});\n```\n\n## Usage\n\n![demo](https://raw.githubusercontent.com/ligaopeng123-npm/web-components-repo/main/packages/image-upload/__tests__/demo.png)\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>screenshot-upload</title>\n</head>\n<body style=\"margin: 0px;\">\n<div style=\"display: flex;align-items: center;justify-content: center;margin-top: 100px;\">\n    <image-upload\n            id=\"upload\"\n            list-type=\"picture\"\n            picture-width=\"64\"\n            picture-height=\"64\"\n            max-count=\"4\"\n            width=\"400px\">\n    </image-upload>\n</div>\n<script>\n    window.onload = () => {\n        // 支持的数据格式\n        const fileList = [{\n            name: 'tttt.png',\n            url: \"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png\"\n        }, {\n            name: 'aaaa.png',\n            url: \"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png\"\n        }, {\n            name: '666.png',\n            url: \"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png\"\n        }];\n        const upload = document.querySelector('#upload');\n        upload.setAttribute('file-list', JSON.stringify(fileList));\n        upload.addEventListener('uploadChange', ({detail}) => {\n            console.log(detail);\n        });\n        upload.addEventListener('afterUpload', ({detail}) => {\n            console.log(detail);\n        });\n        upload.addEventListener('afterDelete', ({detail}) => {\n            console.log(detail);\n        });\n    }\n<\/script>\n</body>\n</html>\n```\n\n"})})}},tags:["autodocs"],argTypes:{}},props={args:{},render:()=>(0,jsx_runtime.jsx)("image-upload",{id:"upload","list-type":"picture","picture-width":"120","picture-height":"120","max-count":"4",width:"400px"})};props.parameters={...props.parameters,docs:{...props.parameters?.docs,source:{originalSource:'{\n  args: {},\n  render: () => {\n    return <image-upload id="upload" list-type="picture" picture-width="120" picture-height="120" max-count="4" width="400px">\n        </image-upload>;\n  }\n}',...props.parameters?.docs?.source}}};const __namedExportsOrder=["props"]},"./packages/message/dist/message.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{s:()=>initMsg});var initMsg=function initMsg(global){!function addMessageCss(){if(!document.querySelector("#qmsg-message-css")){var styles=document.createElement("style");styles.id="qmsg-message-css",styles.innerHTML='\n    .qmsg.qmsg-wrapper{\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n    color: rgba(0, 0, 0, .55);\n    font-size: 13px;\n    font-variant: tabular-nums;\n    line-height: 1;\n    list-style: none;\n    font-feature-settings: "tnum";\n    position: fixed;\n    top: 16px;\n    left: 0;\n    z-index: 1010;\n    width: 100%;\n    pointer-events: none;\n}\n.qmsg .qmsg-item{\n    padding: 8px;\n    text-align: center;\n    -webkit-animation-duration: .3s;\n    animation-duration: .3s;\n    position: relative;\n}\n.qmsg .qmsg-item .qmsg-count{\n    position: absolute;\n    left: -4px;\n    top: -4px;\n    background-color: red;\n    color: #fff;\n    font-size: 12px;\n    line-height: 16px;\n    border-radius: 2px;\n    display: inline-block;\n    min-width: 16px;\n    height: 16px;\n    -webkit-animation-duration: .3s;\n    animation-duration: .3s;\n}\n.qmsg .qmsg-item:first-child{\n    margin-top: -8px;\n}\n.qmsg .qmsg-content{\n    position: relative;\n    display: inline-block;\n    padding: 10px 16px;\n    background: #fff;\n    border-radius: 4px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, .15);\n    pointer-events: all;\n    /* min-width: 175px; */\n}\n.qmsg .qmsg-content .qmsg-content-with-close{\n    padding-right: 20px;\n}\n.qmsg .qmsg-icon{\n    display: inline-block;\n    color: inherit;\n    font-style: normal;\n    line-height: 0;\n    text-align: center;\n    text-transform: none;\n    vertical-align: -.125em;\n    text-rendering: optimizeLegibility;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    position: relative;\n    top: 1px;\n    margin-right: 8px;\n    font-size: 16px;\n}\n.qmsg .qmsg-icon svg{\n    display: inline-block;\n}\n\n.qmsg .qmsg-content-info .qmsg-icon{\n    color: #1890ff;\n    user-select: none;\n}\n.qmsg .qmsg-icon-close{\n    position: absolute;\n    top: 11px;\n    right: 5px;\n    padding: 0;\n    overflow: hidden;\n    font-size: 12px;\n    line-height: 22px;\n    background-color: transparent;\n    border: none;\n    outline: none;\n    cursor: pointer;\n    color: rgba(0, 0, 0, .45);\n    transition: color .3s\n}\n.qmsg .qmsg-icon-close:hover>svg path{\n    stroke: #555;\n}\n.qmsg .animate-turn{\n    animation:MessageTurn 1s linear infinite;  \n    -webkit-animation: MessageTurn 1s linear infinite;\n}\n@keyframes MessageTurn{\n    0%{-webkit-transform:rotate(0deg);}\n    25%{-webkit-transform:rotate(90deg);}\n    50%{-webkit-transform:rotate(180deg);}\n    75%{-webkit-transform:rotate(270deg);}\n    100%{-webkit-transform:rotate(360deg);}\n}\n@-webkit-keyframes MessageTurn{\n    0%{-webkit-transform:rotate(0deg);}\n    25%{-webkit-transform:rotate(90deg);}\n    50%{-webkit-transform:rotate(180deg);}\n    75%{-webkit-transform:rotate(270deg);}\n    100%{-webkit-transform:rotate(360deg);}\n}\n\n@-webkit-keyframes MessageMoveOut {\n    0% {\n        max-height: 150px;\n        padding: 8px;\n        opacity: 1\n    }\n\n    to {\n        max-height: 0;\n        padding: 0;\n        opacity: 0\n    }\n}\n\n@keyframes MessageMoveOut {\n    0% {\n        max-height: 150px;\n        padding: 8px;\n        opacity: 1\n    }\n\n    to {\n        max-height: 0;\n        padding: 0;\n        opacity: 0\n    }\n}\n\n\n@-webkit-keyframes MessageMoveIn {\n    \n    0% {\n        transform: translateY(-100%);\n        transform-origin: 0 0;\n        opacity: 0\n    }\n\n    to {\n        transform: translateY(0);\n        transform-origin: 0 0;\n        opacity: 1\n    }\n}\n\n@keyframes MessageMoveIn {\n    0% {\n        transform: translateY(-100%);\n        transform-origin: 0 0;\n        opacity: 0\n    }\n\n    to {\n        transform: translateY(0);\n        transform-origin: 0 0;\n        opacity: 1\n    }\n}\n@-webkit-keyframes MessageShake {\n    0%,\n    100% {\n      transform: translateX(0px);\n      opacity: 1;\n    }\n  \n    25%,\n    75% {\n        transform: translateX(-4px);\n      opacity: 0.75;\n    }\n  \n    50% {\n        transform: translateX(4px);\n        opacity: 0.25;\n    }\n  }\n@keyframes MessageShake {\n    0%,\n    100% {\n      transform: translateX(0px);\n      opacity: 1;\n    }\n  \n    25%,\n    75% {\n        transform: translateX(-4px);\n      opacity: 0.75;\n    }\n  \n    50% {\n        transform: translateX(4px);\n        opacity: 0.25;\n    }\n  }   \n',document.head.appendChild(styles)}}();var style,NAMESPACE=global&&global.QMSG_GLOBALS&&global.QMSG_GLOBALS.NAMESPACE||"qmsg",STATES={opening:"MessageMoveIn",done:"",closing:"MessageMoveOut"},DEFAULTS=Object.assign({type:"info",showClose:!1,timeout:3500,animation:!0,autoClose:!0,content:"",onClose:null,maxNums:5,html:!1},global&&global.QMSG_GLOBALS&&global.QMSG_GLOBALS.DEFAULTS),ICONS={info:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C29.5228 44 34.5228 41.7614 38.1421 38.1421C41.7614 34.5228 44 29.5228 44 24C44 18.4772 41.7614 13.4772 38.1421 9.85786C34.5228 6.23858 29.5228 4 24 4C18.4772 4 13.4772 6.23858 9.85786 9.85786C6.23858 13.4772 4 18.4772 4 24C4 29.5228 6.23858 34.5228 9.85786 38.1421C13.4772 41.7614 18.4772 44 24 44Z" fill="#1890ff" stroke="#1890ff" stroke-width="4" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M24 11C25.3807 11 26.5 12.1193 26.5 13.5C26.5 14.8807 25.3807 16 24 16C22.6193 16 21.5 14.8807 21.5 13.5C21.5 12.1193 22.6193 11 24 11Z" fill="#FFF"/><path d="M24.5 34V20H23.5H22.5" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 34H28" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',warning:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C29.5228 44 34.5228 41.7614 38.1421 38.1421C41.7614 34.5228 44 29.5228 44 24C44 18.4772 41.7614 13.4772 38.1421 9.85786C34.5228 6.23858 29.5228 4 24 4C18.4772 4 13.4772 6.23858 9.85786 9.85786C6.23858 13.4772 4 18.4772 4 24C4 29.5228 6.23858 34.5228 9.85786 38.1421C13.4772 41.7614 18.4772 44 24 44Z" fill="#faad14" stroke="#faad14" stroke-width="4" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M24 37C25.3807 37 26.5 35.8807 26.5 34.5C26.5 33.1193 25.3807 32 24 32C22.6193 32 21.5 33.1193 21.5 34.5C21.5 35.8807 22.6193 37 24 37Z" fill="#FFF"/><path d="M24 12V28" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',error:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="#f5222d" stroke="#f5222d" stroke-width="4" stroke-linejoin="round"/><path d="M29.6569 18.3431L18.3432 29.6568" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M18.3432 18.3431L29.6569 29.6568" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',success:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 4L29.2533 7.83204L35.7557 7.81966L37.7533 14.0077L43.0211 17.8197L41 24L43.0211 30.1803L37.7533 33.9923L35.7557 40.1803L29.2533 40.168L24 44L18.7467 40.168L12.2443 40.1803L10.2467 33.9923L4.97887 30.1803L7 24L4.97887 17.8197L10.2467 14.0077L12.2443 7.81966L18.7467 7.83204L24 4Z" fill="#52c41a" stroke="#52c41a" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M17 24L22 29L32 19" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',loading:'<svg class="animate-turn" width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M4 24C4 35.0457 12.9543 44 24 44V44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4" stroke="#1890ff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M36 24C36 17.3726 30.6274 12 24 12C17.3726 12 12 17.3726 12 24C12 30.6274 17.3726 36 24 36V36" stroke="#1890ff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',close:'<svg width="16" height="16" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M14 14L34 34" stroke="#909399" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M14 34L34 14" stroke="#909399" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>'},CAN_ANIMATION=void 0!==(style=document.createElement("div").style).animationName||void 0!==style.WebkitAnimationName||void 0!==style.MozAnimationName||void 0!==style.msAnimationName||void 0!==style.OAnimationName;function namespacify(){for(var res=NAMESPACE,i=0;i<arguments.length;++i)res+="-"+(i<0||arguments.length<=i?void 0:arguments[i]);return res}function Msg(opts){var oMsg=this;oMsg.settings=Object.assign({},DEFAULTS,opts||{}),oMsg.id=Qmsg.instanceCount;var timeout=oMsg.settings.timeout;timeout=timeout&&parseInt(timeout)>=0&parseInt(timeout)<=Math.NEGATIVE_INFINITY?parseInt(timeout):DEFAULTS.timeout,oMsg.timeout=timeout,oMsg.settings.timeout=timeout,oMsg.timer=null;var $elem=document.createElement("div"),$svg=ICONS[oMsg.settings.type||"info"],contentClassName=namespacify("content-"+oMsg.settings.type||0);contentClassName+=oMsg.settings.showClose?" "+namespacify("content-with-close"):"";var content=oMsg.settings.content||"",$closeSvg=ICONS.close,$closeIcon=oMsg.settings.showClose?'<i class="qmsg-icon qmsg-icon-close">'+$closeSvg+"</i>":"",$span=document.createElement("span");oMsg.settings.html?$span.innerHTML=oMsg.settings.html:$span.innerText=content,$elem.innerHTML='<div class="qmsg-content">            <div class="'+contentClassName+'">                <i class="qmsg-icon">'+$svg+"</i>"+$span.outerHTML+$closeIcon+"</div>    </div>",$elem.classList.add(namespacify("item"));var $wrapper=document.querySelector("."+NAMESPACE);if($wrapper||(($wrapper=document.createElement("div")).classList.add(NAMESPACE,namespacify("wrapper"),namespacify("is-initialized")),document.body.appendChild($wrapper)),$wrapper.appendChild($elem),oMsg.$wrapper=$wrapper,oMsg.$elem=$elem,setState(oMsg,"opening"),oMsg.settings.showClose&&$elem.querySelector(".qmsg-icon-close").addEventListener("click",function(){oMsg.close()}.bind($elem)),$elem.addEventListener("animationend",function(e){var target=e.target;e.animationName==STATES.closing&&(clearInterval(this.timer),this.destroy()),target.style.animationName="",target.style.webkitAnimationName=""}.bind(oMsg)),oMsg.settings.autoClose){oMsg.timer=setInterval(function(){this.timeout-=10,this.timeout<=0&&(clearInterval(this.timer),this.close())}.bind(oMsg),10),oMsg.$elem.addEventListener("mouseover",function(){clearInterval(this.timer)}.bind(oMsg)),oMsg.$elem.addEventListener("mouseout",function(){"closing"!=this.state&&(this.timer=setInterval(function(){this.timeout-=10,this.timeout<=0&&(clearInterval(this.timer),this.close())}.bind(oMsg),10))}.bind(oMsg))}}function setState(inst,state){state&&STATES[state]&&(inst.state=state,inst.$elem.style.animationName=STATES[state])}function mergeArgs(txt,config){var opts=Object.assign({},DEFAULTS);return 0===arguments.length?opts:txt instanceof Object?Object.assign(opts,txt):(opts.content=txt.toString(),config instanceof Object?Object.assign(opts,config):opts)}function judgeReMsg(params){params=params||{};var oMsg,opt=JSON.stringify(params),oInx=-1;for(var i in this.oMsgs){var oMsgItem=this.oMsgs[i];if(oMsgItem.config==opt){oInx=i,oMsg=oMsgItem.inst;break}}if(oInx<0){this.instanceCount++;var oItem={};oItem.id=this.instanceCount,oItem.config=opt,(oMsg=new Msg(params)).id=this.instanceCount,oMsg.count="",oItem.inst=oMsg,this.oMsgs[this.instanceCount]=oItem;var len=this.oMsgs.length,maxNums=this.maxNums;if(len>maxNums)for(var oIndex=0,oMsgs=this.oMsgs;oIndex<len-maxNums;oIndex++)oMsgs[oIndex]&&oMsgs[oIndex].inst.settings.autoClose&&oMsgs[oIndex].inst.close()}else oMsg.count=oMsg.count?oMsg.count+1:2,function setMsgCount(oMsg){var countClassName=namespacify("count"),$content=oMsg.$elem.querySelector("."+namespacify("content")),$count=$content.querySelector("."+countClassName);$count||(($count=document.createElement("span")).classList.add(countClassName),$content.appendChild($count)),$count.innerHTML=oMsg.count,$count.style.animationName="",$count.style.animationName="MessageShake",oMsg.timeout=oMsg.settings.timeout||DEFAULTS.timeout}(oMsg);return oMsg.$elem.setAttribute("data-count",oMsg.count),oMsg}Msg.prototype.destroy=function(){this.$elem.parentNode&&this.$elem.parentNode.removeChild(this.$elem),clearInterval(this.timer),Qmsg.remove(this.id)},Msg.prototype.close=function(){setState(this,"closing"),CAN_ANIMATION?Qmsg.remove(this.id):this.destroy();var callback=this.settings.onClose;callback&&callback instanceof Function&&callback.call(this)};var Qmsg={version:"0.0.1",instanceCount:0,oMsgs:[],maxNums:DEFAULTS.maxNums||5,config:function config(cfg){DEFAULTS=cfg&&cfg instanceof Object?Object.assign(DEFAULTS,cfg):DEFAULTS,this.maxNums=DEFAULTS.maxNums&&DEFAULTS.maxNums>0?parseInt(DEFAULTS.maxNums):3},info:function info(txt,config){var params=mergeArgs(txt,config);return params.type="info",judgeReMsg.call(this,params)},warning:function warning(txt,config){var params=mergeArgs(txt,config);return params.type="warning",judgeReMsg.call(this,params)},success:function success(txt,config){var params=mergeArgs(txt,config);return params.type="success",judgeReMsg.call(this,params)},error:function error(txt,config){var params=mergeArgs(txt,config);return params.type="error",judgeReMsg.call(this,params)},loading:function loading(txt,config){var params=mergeArgs(txt,config);return params.type="loading",params.autoClose=!1,judgeReMsg.call(this,params)},remove:function remove(id){this.oMsgs[id]&&delete this.oMsgs[id]},closeAll:function closeAll(){for(var i in this.oMsgs)this.oMsgs[i]&&this.oMsgs[i].inst.close()}};return Qmsg}},"./node_modules/.pnpm/memoizerific@1.11.3/node_modules/memoizerific sync recursive":module=>{function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./node_modules/.pnpm/memoizerific@1.11.3/node_modules/memoizerific sync recursive",module.exports=webpackEmptyContext}}]);