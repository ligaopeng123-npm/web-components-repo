"use strict";(self.webpackChunkweb_components_repo=self.webpackChunkweb_components_repo||[]).push([[8757],{"./stories/RcMultiScreenPlayer.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,default:()=>RcMultiScreenPlayer_stories,props:()=>props});var RcMultiPlayer=__webpack_require__("./packages/rc-multi-player/src/Player/RcMultiPlayer.tsx"),react=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js");let MultiStoreEnum;!function(MultiStoreEnum){MultiStoreEnum.layout="layout",MultiStoreEnum.selectedScreen="selectedScreen",MultiStoreEnum.selectedPlayer="selectedPlayer",MultiStoreEnum.playerList="playerList",MultiStoreEnum.drawer="drawer",MultiStoreEnum.screenConfig="screenConfig",MultiStoreEnum.actionConfig="actionConfig"}(MultiStoreEnum||(MultiStoreEnum={}));var utils_esm=__webpack_require__("./node_modules/.pnpm/@gaopeng123+utils@1.1.12-alpha.7/node_modules/@gaopeng123/utils/dist/utils.esm.js");const DEFAULT_SCREEN_CONFIG={protocol:{defaultValue:"FLV",options:[{label:"HTTP-FLV",value:"FLV"},{label:"WebRTC",value:"WebRTC"}]},objectFit:{defaultValue:"fill",options:[{label:"铺满",value:"fill"},{label:"原始尺寸",value:"contain"}]},maxPlayerTime:{defaultValue:"forever",options:[{label:"3分钟",value:"3min"},{label:"5分钟",value:"5min"},{label:"长期",value:"forever"}]},resolution:{defaultValue:"720P",options:[{label:"720P",value:"720P"},{label:"超清",value:"4K"}]}},State={[MultiStoreEnum.selectedPlayer]:"0",[MultiStoreEnum.playerList]:[],[MultiStoreEnum.screenConfig]:DEFAULT_SCREEN_CONFIG},getLocalStorage=_id=>localStorage.getItem(_id)?Object.assign({},JSON.parse(localStorage.getItem(_id))):{},ScreenConfigHelper={id:"",getConfig:()=>getLocalStorage(ScreenConfigHelper.id),setConfig:val=>{((_id,val)=>{localStorage.setItem(_id,val)})(ScreenConfigHelper.id,JSON.stringify(val))},setSingleConfig:val=>{ScreenConfigHelper.setConfig(Object.assign({},ScreenConfigHelper.getConfig(),val))},getSingleConfig:valKey=>ScreenConfigHelper.getConfig()[valKey],getDefaultConfig:defaultConfigProps=>{const currentConfig={},defaultConfigStorage=ScreenConfigHelper.getConfig(),actionConfig=ScreenConfigHelper.getActionConfig(defaultConfigProps);for(const i in DEFAULT_SCREEN_CONFIG){const key=i;if(defaultConfigProps&&!1===defaultConfigProps[key])currentConfig[key]=!1;else{const currentOptions=actionConfig[key]?.options,currentValue=ScreenConfigHelper.getDefaultValueByKey(key,defaultConfigStorage,defaultConfigProps)||DEFAULT_SCREEN_CONFIG[key].defaultValue;currentConfig[key]=currentOptions.filter((item=>item.value===currentValue))?.length?currentValue:currentOptions[0]?.value}}const currentDefaultConfig=Object.assign({},defaultConfigStorage,currentConfig);return ScreenConfigHelper.setConfig(currentDefaultConfig),currentDefaultConfig},getDefaultValueByKey:(key,defaultConfigStorage,defaultConfigProps)=>defaultConfigStorage[key]?defaultConfigStorage[key]:defaultConfigProps&&defaultConfigProps[key]?defaultConfigProps[key].defaultValue?defaultConfigProps[key].defaultValue:defaultConfigProps[key]:void 0,getActionConfig:defaultConfigProps=>{if(defaultConfigProps){const currentConfig={},defaultConfigStorage=ScreenConfigHelper.getConfig();for(const i in DEFAULT_SCREEN_CONFIG){const key=i;let currentItemConfig;if((0,utils_esm.o8e)(defaultConfigProps[key]))currentItemConfig=DEFAULT_SCREEN_CONFIG[key];else if(!1===defaultConfigProps[key])currentItemConfig={defaultValue:DEFAULT_SCREEN_CONFIG[key].defaultValue,options:[]};else{const currentDefaultValue=ScreenConfigHelper.getDefaultValueByKey(key,defaultConfigStorage,defaultConfigProps);currentItemConfig=(0,utils_esm.HD0)(currentDefaultValue)?{defaultValue:currentDefaultValue,options:defaultConfigProps[key]?.options||DEFAULT_SCREEN_CONFIG[key].options}:defaultConfigProps[key]}currentConfig[key]=currentItemConfig}return Object.assign({},defaultConfigProps,currentConfig)}return DEFAULT_SCREEN_CONFIG},getSelectedScreen:()=>ScreenConfigHelper.getConfig()?.defaultSelectedScreen};const reducer=(state,action)=>{switch(action.type){case MultiStoreEnum.layout:return Object.assign({},state,{[MultiStoreEnum.layout]:action.value});case MultiStoreEnum.selectedScreen:const newConfig=Object.assign({},ScreenConfigHelper.getConfig(),{defaultSelectedScreen:action.value});return ScreenConfigHelper.setConfig(newConfig),Object.assign({},state,{[MultiStoreEnum.selectedScreen]:action.value});case MultiStoreEnum.selectedPlayer:return Object.assign({},state,{[MultiStoreEnum.selectedPlayer]:action.value});case MultiStoreEnum.playerList:if((0,utils_esm.kJL)(action.value))return Object.assign({},state,{[MultiStoreEnum.playerList]:action.value});const playerList=state[MultiStoreEnum.playerList],{index,data}=action.value;return JSON.stringify(playerList[index])!==JSON.stringify(data)?(playerList[index]=data,Object.assign({},state,{[MultiStoreEnum.playerList]:playerList})):state;case MultiStoreEnum.drawer:return Object.assign({},state,{[MultiStoreEnum.drawer]:action.value});case MultiStoreEnum.actionConfig:return Object.assign({},state,{[MultiStoreEnum.actionConfig]:action.value});case MultiStoreEnum.screenConfig:const{type,value}=action.value,screenConfig=state[MultiStoreEnum.screenConfig],newScreenConfig=Object.assign({},screenConfig,ScreenConfigHelper.getConfig(),{[type]:value});return ScreenConfigHelper.setConfig(newScreenConfig),Object.assign({},state,{[MultiStoreEnum.screenConfig]:newScreenConfig});default:return state}};var Grid=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Grid/Grid.js"),styles_module=__webpack_require__("./packages/rc-multi-player/src/styles.module.less"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js");const LayoutPlayer=props=>{const{layoutIndex,playerConfig,selected,mediaDataSource,dispatch,events,state}=props,videoRef=(0,react.useRef)();(0,react.useEffect)((()=>{videoRef.current.playerConfig=playerConfig}),[playerConfig]);const playerEvents=Object.assign({},events,{onLoadStart:e=>{events?.onLoadStart&&events?.onLoadStart(Object.assign({},videoRef.current.playerConfig,{layoutIndex}))},onClose:playerConfig=>{dispatch({index:layoutIndex,value:null}),events?.onClose&&events?.onClose(Object.assign({},videoRef.current.playerConfig,{layoutIndex}))},onReload:playerConfig=>{events?.onReload&&events?.onReload(Object.assign({},videoRef.current.playerConfig,{layoutIndex}))},onMaxReload:playerConfig=>{events?.onMaxReload&&events?.onMaxReload(Object.assign({},videoRef.current.playerConfig,{layoutIndex}))}}),screenConfig=state[MultiStoreEnum.screenConfig],{maxPlayerTime}=screenConfig;return(0,jsx_runtime.jsx)(RcMultiPlayer.Z,{ref:videoRef,objectFit:ScreenConfigHelper.getSingleConfig("objectFit"),maxPlayerTime,events:playerEvents,mediaDataSource,robustness:playerConfig?.robustness,protocol:playerConfig?.protocol,extraParams:playerConfig?.extraParams,config:playerConfig?.config,title:playerConfig?.title,className:selected?styles_module.Z.selected:styles_module.Z.player})};LayoutPlayer.displayName="LayoutPlayer";const Player_LayoutPlayer=LayoutPlayer,LayoutContentGrid=({layout,dispatch,state,playerList,events})=>{const selectedPlayer=state[MultiStoreEnum.selectedPlayer];return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:layout?.children?.map(((item,index)=>(0,jsx_runtime.jsx)(Grid.ZP,{container:!0,style:{height:item.height},children:item?.children?.map(((colItem,index)=>colItem?.children?.length?(0,jsx_runtime.jsx)(Grid.ZP,{item:!0,style:{height:colItem.height},xs:colItem.width/2,children:(0,jsx_runtime.jsx)(LayoutContentGrid,{events,state,dispatch,layout:colItem,playerList})},colItem.key||index):(0,jsx_runtime.jsx)(Grid.ZP,{onClick:()=>{var key;key=colItem.key,dispatch({type:MultiStoreEnum.selectedPlayer,value:key})},item:!0,id:`multi-screen-player-item-${colItem.key}`,className:`${styles_module.Z.item} multi-screen-player-item`,xs:colItem.width/2,style:{height:colItem.height},children:(0,jsx_runtime.jsx)(Player_LayoutPlayer,{events,state,dispatch,layoutIndex:colItem.key,playerConfig:playerList[+colItem.key]?.playerConfig,mediaDataSource:playerList[+colItem.key]?.mediaDataSource,selected:selectedPlayer===colItem.key})},colItem.key||index)))},item.key||index)))})},LayoutContent=props=>{const{state,dispatch,events}=props,layoutVal=state[MultiStoreEnum.layout],playerList=state[MultiStoreEnum.playerList];return(0,jsx_runtime.jsx)("div",{className:styles_module.Z.content,children:(0,jsx_runtime.jsx)(LayoutContentGrid,{events,playerList,layout:layoutVal,dispatch,state})})};LayoutContent.displayName="LayoutContent";const Layout_LayoutContent=LayoutContent,_1_namespaceObject=__webpack_require__.p+"static/media/1屏.d738ea3d.svg",_4_namespaceObject=__webpack_require__.p+"static/media/4屏.c36ea2a8.svg",_6_namespaceObject=__webpack_require__.p+"static/media/6屏.332c1e8d.svg",_8_namespaceObject=__webpack_require__.p+"static/media/8屏.0d54826f.svg",_9_namespaceObject=__webpack_require__.p+"static/media/9屏.0ae56a89.svg",_12_namespaceObject=__webpack_require__.p+"static/media/12屏.46a221a4.svg",_13_namespaceObject=__webpack_require__.p+"static/media/13屏.7ceb3561.svg",_16_namespaceObject=__webpack_require__.p+"static/media/16屏.42b85b6e.svg",layout_namespaceObject=JSON.parse('{"defaultSelected":"4","data":[{"name":"1分屏","key":"1","stream":"mainStream","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIS+3SsQkAAAwCwbj/0GaEr1LlrQXhMG07h4kDpCsRCY1EEqEAFnyRRCiABV/0gGgBj4BfuRanDZkAAAAASUVORK5CYII=","children":[{"type":"row","height":"100%","children":[{"type":"col","key":"0","width":24,"height":"100%"}]}]},{"name":"4分屏","key":"4","icon":"data:image/g;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAeklEQVRIS2P8////fwbiQQMDAwMIEw0YRy0gFFajQUQohBhGg2hwBFE9QWdQoIDUSOZkYGD4Top9pFogwcDA8IKWFqgzMDDcpKUFZgwMDKdoaYEbAwPDLlpaEMrAwLCalhakMDAwzKGlBcUMDAy9tLRgtE4mGLokBxEAWbp2OaL7UUIAAAAASUVORK5CYII=","children":[{"type":"row","height":"50%","children":[{"type":"col","key":"0","width":12},{"type":"col","key":"1","width":12}]},{"type":"row","height":"50%","children":[{"type":"col","key":"2","width":12},{"type":"col","key":"3","width":12}]}]},{"name":"6分屏","key":"6","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAArElEQVRIS+3Tqw7CQBCF4a+GBAS8EkEgkUgkEslDIJFIJBJJwuWJuAgCrqRJm6C2gXbBdJOTmWx259/snEnSNE19v07oh64nDaD5ojJ//cRFwUfUYdMrCt3QRa9QHYBm0II9/ImL/t+DPR545vE9z/ZaaKOTxywvlJRNYmbTY+DQAYOSInecccn10RzMsQgAKjd5hmVMwBSrmIAJ1jEBY2xiAkbYxgQMsasCeAFpiYuxF7ZEFQAAAABJRU5ErkJggg==","children":[{"type":"row","height":"66.66666666%","children":[{"type":"col","width":16,"key":"0","height":"100%"},{"type":"col","width":8,"height":"100%","children":[{"type":"row","height":"100%","children":[{"type":"col","width":24,"key":"1","height":"50%"},{"type":"col","width":24,"height":"50%","key":"2"}]}]}]},{"type":"row","height":"33.3333333333%","children":[{"type":"col","width":8,"key":"3"},{"type":"col","width":8,"key":"4"},{"type":"col","width":8,"key":"5"}]}]},{"name":"8分屏","key":"8","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAuUlEQVRIS+2VoQ7CQAyGvz0Adg+DIiFZ8LPg0fAA8ALzuIlpPIaAQPMQBIWdwxxpchMsveSaBTPuksr2S//+12bOOcfwd/UlZv1SWQJ4ScYh0V7zShpyp8o4hizd/PQndzJ9mSm56E9cdBl+b8IVxEUa4AzMlTSx4hR4+WgDpSdALhGy6RaolGTZmNrWrIEHsIs9mWvgYABIxzcLYAU0BoBIdwc2sR2UwNEIeALLWMACOBkBb6Do53wAJ7KJ838GpCwAAAAASUVORK5CYII=","children":[{"type":"row","height":"75%","children":[{"type":"col","height":"100%","key":"0","width":18},{"type":"col","width":6,"height":"100%","children":[{"type":"row","height":"100%","children":[{"type":"col","width":24,"key":"1","height":"33.333333333%"},{"type":"col","width":24,"key":"2","height":"33.333333333%"},{"type":"col","width":24,"key":"3","height":"33.333333333%"}]}]}]},{"type":"row","height":"25%","children":[{"type":"col","key":"4","width":6},{"type":"col","width":6,"key":"5"},{"type":"col","width":6,"key":"6"},{"type":"col","width":6,"key":"7"}]}]},{"name":"9分屏","key":"9","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABAklEQVRIS7XVL0gEQRiG8d/ZVNAgWGwWwWgSk4gIFqPBYLQIxstymIyCxWgwGC2CiprEZBQsNovgv3DFsjKwB1tuFhm+gZfZ5WPnGWa/Z7dTVVVl+FjDVaZ+j+VMXacFsIGLSMAmziMB2ziNBOzgJBKwh6NIQBeHpYC7zAK3WMm1YVsttek1PvFVz7+Nhw6wjzGM1hlcp3kE3438YAKTg7R5MI330iPKmTyHl0jAIh4jAeu4jARs4SwSsIvjUkDOgxustvV62+c650EPKannm0lOpPs0+g2Pkkv/8mC8XmDYJot/OFP4KH0HOdFm8BYJmMVrJGAez5GABTxFApbwUAL4A7sDmrHi+FH1AAAAAElFTkSuQmCC","children":[{"type":"row","height":"33.33333333%","children":[{"type":"col","width":8,"key":"0"},{"type":"col","width":8,"key":"1"},{"type":"col","width":8,"key":"2"}]},{"type":"row","height":"33.33333333%","children":[{"type":"col","width":8,"key":"3"},{"type":"col","width":8,"key":"4"},{"type":"col","width":8,"key":"5"}]},{"type":"row","height":"33.33333333%","children":[{"type":"col","width":8,"key":"6"},{"type":"col","width":8,"key":"7"},{"type":"col","width":8,"key":"8"}]}]},{"name":"12分屏","key":"12","children":[{"type":"row","height":"33.33333333%","children":[{"type":"col","width":6,"key":"0"},{"type":"col","width":6,"key":"1"},{"type":"col","width":6,"key":"2"},{"type":"col","width":6,"key":"3"}]},{"type":"row","height":"33.33333333%","children":[{"type":"col","width":6,"key":"4"},{"type":"col","width":6,"key":"5"},{"type":"col","width":6,"key":"6"},{"type":"col","width":6,"key":"7"}]},{"type":"row","height":"33.33333333%","children":[{"type":"col","width":6,"key":"8"},{"type":"col","width":6,"key":"9"},{"type":"col","width":6,"key":"10"},{"type":"col","width":6,"key":"11"}]}]},{"name":"13分屏","key":"13","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAYCAYAAACfpi8JAAAAz0lEQVRIS+2V0QmCMRCDv38S3UA30E10E3UCHUEnUTfQDXQDnaAS6NOPdy20PggX6FMDDWlyN6SUEjauwBY4O5xdvtu0cIYQMrIvHBnnSY4snZC9gAcwdzi6F6YtHAnxGnEHjsDeeaTm6pRJK4vcIyM1QooVDyHfwto6Wbt9jUa4BTVCxwt0rZALYDZUGfF2xLOzkEW0JjsQ9R1HocoRpdnCLY/4Q001HI7WhLD2wmomGXjn1sycR9QsYdLC6THii7YDRU4I+cWuKdr+V1/zAVWpsrwtNJ3PAAAAAElFTkSuQmCC","children":[{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"0"},{"type":"col","width":6,"key":"1"},{"type":"col","width":6,"key":"2"},{"type":"col","width":6,"key":"3"}]},{"type":"row","height":"50%","children":[{"type":"col","width":6,"height":"100%","children":[{"type":"row","height":"100%","children":[{"type":"col","height":"50%","width":24,"key":"4"},{"type":"col","height":"50%","width":24,"key":"5"}]}]},{"type":"col","width":12,"key":"6"},{"type":"col","width":6,"height":"100%","children":[{"type":"row","height":"100%","children":[{"type":"col","height":"50%","width":24,"key":"7"},{"type":"col","height":"50%","width":24,"key":"8"}]}]}]},{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"9"},{"type":"col","width":6,"key":"10"},{"type":"col","width":6,"key":"11"},{"type":"col","width":6,"key":"12"}]}]},{"name":"16分屏","key":"16","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABZklEQVRIS7XWP0hWYRTH8c+7q0OD4JqDTc1N5SS0CEE4NTQEgTS51BIJgig4SpOQODu1lEIU0SAECeKgQwaSJA4KUgQ5vPLAXbqeI/fC+x54lt/z58t5fufc+3S63W7X1biPd4E+izLq8akSxusTnQTwEOv9BDzGaj8Bz7DcT8BzLPYKcC84qGdSZvINnAaUTF/CH7xqWkW3sBcAMn0NP9oA7uJzAMj09/iKl00zyPog00uj7eNpU8A0XgcZZHoBnOFBBLhiTM9KCFkVDeB3AMr0eVy0MfkmDgJApq/gqA3gDrYCQKa/xXYbwCTKpnpkejF5F+Ub9l9kHjxBSbsemV4AJ5iKAB+DgzYx0UJPC69ksIHjavytVs5FXYkFvKjWlD9hJzl5EMNlZFc0hPNg81jVsfWpNzhsY/IIfgWAcm3l+urxAV/aAEbxvaXJ3zDTtIpuYycAXPeq+IlHTQFZQ10H+BdV3iXft7Dz+OemEQAAAABJRU5ErkJggg==","children":[{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"0"},{"type":"col","width":6,"key":"1"},{"type":"col","width":6,"key":"2"},{"type":"col","width":6,"key":"3"}]},{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"4"},{"type":"col","width":6,"key":"5"},{"type":"col","width":6,"key":"6"},{"type":"col","width":6,"key":"7"}]},{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"8"},{"type":"col","width":6,"key":"9"},{"type":"col","width":6,"key":"10"},{"type":"col","width":6,"key":"11"}]},{"type":"row","height":"25%","children":[{"type":"col","width":6,"key":"12"},{"type":"col","width":6,"key":"13"},{"type":"col","width":6,"key":"14"},{"type":"col","width":6,"key":"15"}]}]}]}'),AssetsIcon={1:_1_namespaceObject,4:_4_namespaceObject,6:_6_namespaceObject,8:_8_namespaceObject,9:_9_namespaceObject,12:_12_namespaceObject,13:_13_namespaceObject,16:_16_namespaceObject},LayoutJson=layout_namespaceObject;var Button=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Button/Button.js"),Menu=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Menu/Menu.js"),MenuItem=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/MenuItem/MenuItem.js"),es=__webpack_require__("./node_modules/.pnpm/material-ui-popup-state@4.1.0_2mete2oe2kozaocyy47tavsz2y/node_modules/material-ui-popup-state/es/index.js"),Apps=__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.10.16_fc6xgk24gufrjg6uf4vmaeyk24/node_modules/@mui/icons-material/Apps.js");const LayoutButton=props=>{const{state,dispatch}=props,bthRef=(0,react.useRef)(null);return(0,jsx_runtime.jsx)(es.ZP,{variant:"popover",popupId:"demo-popup-menu",children:popupState=>(0,jsx_runtime.jsxs)(react.Fragment,{children:[(0,jsx_runtime.jsx)(Button.Z,{style:props.style,ref:bthRef,startIcon:(0,jsx_runtime.jsx)(Apps.Z,{}),size:"small",className:`${styles_module.Z.bottom} ${props.className}`,color:"info",...(0,es.vW)(popupState),children:"分屏"}),(0,jsx_runtime.jsx)(Menu.Z,{...(0,es.wK)(popupState),className:styles_module.Z.menu,anchorEl:bthRef.current,children:LayoutJson?.data?.map((item=>(0,jsx_runtime.jsx)(MenuItem.Z,{selected:item.key==state[MultiStoreEnum.selectedScreen],onClick:()=>((item,popupState)=>{const selectedPlayer=state[MultiStoreEnum.selectedPlayer],lastSelectedScreen=parseInt(state[MultiStoreEnum.selectedScreen]),currentSelectedScreen=+item.key,playerList=state[MultiStoreEnum.playerList];if(+selectedPlayer>currentSelectedScreen&&dispatch({type:MultiStoreEnum.selectedPlayer,value:"0"}),lastSelectedScreen>currentSelectedScreen){const latestPlayer=[],startLen=currentSelectedScreen-1,endLen=lastSelectedScreen,newPlayerList=[...playerList];for(let i=startLen;i<endLen;i++)newPlayerList[i]&&!(0,utils_esm.Qr$)(newPlayerList[i])&&latestPlayer.push(newPlayerList[i]);if(latestPlayer?.length)for(let i=0;i<newPlayerList.length&&latestPlayer.length;i++)if(!newPlayerList[i]||(0,utils_esm.Qr$)(newPlayerList[i])){const currentPlayer=latestPlayer.shift();newPlayerList[i]=currentPlayer}dispatch({type:MultiStoreEnum.playerList,value:newPlayerList?.slice(0,currentSelectedScreen)})}else{const addPlayerList=new Array(currentSelectedScreen-lastSelectedScreen).fill(0)?.map((()=>({})));dispatch({type:MultiStoreEnum.playerList,value:[...playerList,...addPlayerList]})}dispatch({type:MultiStoreEnum.selectedScreen,value:item.key}),dispatch({type:MultiStoreEnum.layout,value:item}),popupState.close()})(item,popupState),children:(0,jsx_runtime.jsxs)("span",{className:styles_module.Z.menuItem,children:[(0,jsx_runtime.jsx)("img",{width:16,height:16,src:AssetsIcon[item.key]}),item.name]})},item.key)))})]})})};LayoutButton.displayName="LayoutButton";const Action_LayoutButton=LayoutButton;try{LayoutButton.displayName="LayoutButton",LayoutButton.__docgenInfo={description:"",displayName:"LayoutButton",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"any"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rc-multi-player/src/Action/LayoutButton.tsx#LayoutButton"]={docgenInfo:LayoutButton.__docgenInfo,name:"LayoutButton",path:"packages/rc-multi-player/src/Action/LayoutButton.tsx#LayoutButton"})}catch(__react_docgen_typescript_loader_error){}var FullScreenButton=__webpack_require__("./packages/rc-multi-player/src/Action/FullScreenButton.tsx"),Divider=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Divider/Divider.js"),ActionColumn=__webpack_require__("./packages/rc-multi-player/src/Action/ActionColumn.tsx"),HideFullScreen=__webpack_require__("./packages/rc-multi-player/src/Action/HideFullScreen.tsx"),Drawer=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Drawer/Drawer.js"),BrightnessHigh=__webpack_require__("./node_modules/.pnpm/@mui+icons-material@5.10.16_fc6xgk24gufrjg6uf4vmaeyk24/node_modules/@mui/icons-material/BrightnessHigh.js"),Action_styles_module=__webpack_require__("./packages/rc-multi-player/src/Action/styles.module.less"),IconCloseButton=__webpack_require__("./packages/rc-multi-player/src/Action/IconCloseButton.tsx"),Paper=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Paper/Paper.js"),Box=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/Box/Box.js"),ToggleButton=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/ToggleButton/ToggleButton.js"),styled=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/styles/styled.js"),ToggleButtonGroup=__webpack_require__("./node_modules/.pnpm/@mui+material@5.10.17_2mete2oe2kozaocyy47tavsz2y/node_modules/@mui/material/esm/ToggleButtonGroup/ToggleButtonGroup.js"),Title=__webpack_require__("./packages/rc-multi-player/src/components/Title.tsx");const StyledToggleButtonGroup=(0,styled.ZP)(ToggleButtonGroup.Z)((({theme})=>({"& .MuiToggleButtonGroup-grouped":{textTransform:"capitalize",margin:theme.spacing(.5),marginLeft:0,marginRight:12,border:0,"&.Mui-disabled":{border:0},"&:not(:first-of-type)":{borderRadius:theme.shape.borderRadius},"&:first-of-type":{borderRadius:theme.shape.borderRadius}}}))),FormItem=props=>{const{label,options,onChange,defaultValue}=props,[alignment,setAlignment]=react.useState(defaultValue);return(0,jsx_runtime.jsxs)(Paper.Z,{elevation:0,sx:{},children:[(0,jsx_runtime.jsx)(Box.Z,{component:"div",sx:{padding:"8px 0px"},children:(0,jsx_runtime.jsx)(Title.Z,{children:label})}),(0,jsx_runtime.jsx)(Box.Z,{component:"div",children:(0,jsx_runtime.jsx)(StyledToggleButtonGroup,{color:"primary",value:alignment,exclusive:!0,onChange:(event,newAlignment)=>{newAlignment&&(setAlignment(newAlignment),onChange&&onChange(newAlignment))},"aria-label":"Platform",children:options?.map((({label,value})=>(0,jsx_runtime.jsx)(ToggleButton.Z,{style:{margin:"0px 8px 0px 0px",lineHeight:1},size:"small",value,children:label},value)))})})]})};FormItem.displayName="FormItem";const components_FormItem=FormItem,MultiScreenDrawer=props=>{const{state,dispatch,screenKey}=props;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(Drawer.ZP,{classes:{root:Action_styles_module.Z.drawer,paper:Action_styles_module.Z.paper},sx:{position:"absolute"},variant:"persistent",anchor:"right",open:state[MultiStoreEnum.drawer],children:[(0,jsx_runtime.jsx)(ActionColumn.Z,{className:Action_styles_module.Z.header,left:(0,jsx_runtime.jsx)("span",{style:{marginLeft:16},children:"播放器配置"}),right:(0,jsx_runtime.jsx)(IconCloseButton.Z,{onClick:open=>{dispatch({type:MultiStoreEnum.drawer,value:!1})}})}),(0,jsx_runtime.jsxs)("div",{style:{padding:16},children:[!1===state[MultiStoreEnum.screenConfig]?.protocol?null:(0,jsx_runtime.jsx)(components_FormItem,{defaultValue:state[MultiStoreEnum.screenConfig]?.protocol,onChange:v=>{ScreenConfigHelper.setSingleConfig({protocol:v})},label:"播放策略",options:state[MultiStoreEnum.actionConfig]?.protocol.options}),!1===state[MultiStoreEnum.screenConfig]?.objectFit?null:(0,jsx_runtime.jsx)(components_FormItem,{defaultValue:state[MultiStoreEnum.screenConfig]?.objectFit,onChange:v=>{(val=>{const videoList=document.querySelector(`#${screenKey}`)?.querySelectorAll("video")||[],multiPlayer=document.querySelectorAll("multi-player");for(let i=0;i<(0,utils_esm.Fp7)(videoList.length,multiPlayer.length);i++)videoList[i]&&(videoList[i].style["object-fit"]=val),multiPlayer[i]&&(multiPlayer[i].objectFit=val)})(v),ScreenConfigHelper.setSingleConfig({objectFit:v})},label:"视频比例",options:state[MultiStoreEnum.actionConfig]?.objectFit.options}),!1===state[MultiStoreEnum.screenConfig]?.maxPlayerTime?null:(0,jsx_runtime.jsx)(components_FormItem,{defaultValue:state[MultiStoreEnum.screenConfig]?.maxPlayerTime,onChange:v=>{dispatch({type:MultiStoreEnum.screenConfig,value:{type:"maxPlayerTime",value:v}})},label:"播放方式",options:state[MultiStoreEnum.actionConfig]?.maxPlayerTime.options}),!1===state[MultiStoreEnum.screenConfig]?.resolution?null:(0,jsx_runtime.jsx)(components_FormItem,{defaultValue:state[MultiStoreEnum.screenConfig]?.resolution,onChange:v=>{ScreenConfigHelper.setSingleConfig({resolution:v})},label:"分辨率",options:state[MultiStoreEnum.actionConfig]?.resolution.options})]})]})})},MultiScreenDrawerButton=props=>{const{dispatch,style}=props;return(0,jsx_runtime.jsx)(Button.Z,{onClick:()=>{dispatch({type:MultiStoreEnum.drawer,value:!0})},startIcon:(0,jsx_runtime.jsx)(BrightnessHigh.Z,{}),size:"small",className:styles_module.Z.bottom,style:props.style,children:"配置"})};MultiScreenDrawerButton.displayName="MultiScreenDrawerButton";const Action_MultiScreenDrawer=MultiScreenDrawer;try{MultiScreenDrawerButton.displayName="MultiScreenDrawerButton",MultiScreenDrawerButton.__docgenInfo={description:"",displayName:"MultiScreenDrawerButton",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"any"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rc-multi-player/src/Action/MultiScreenDrawer.tsx#MultiScreenDrawerButton"]={docgenInfo:MultiScreenDrawerButton.__docgenInfo,name:"MultiScreenDrawerButton",path:"packages/rc-multi-player/src/Action/MultiScreenDrawer.tsx#MultiScreenDrawerButton"})}catch(__react_docgen_typescript_loader_error){}try{MultiScreenDrawer.displayName="MultiScreenDrawer",MultiScreenDrawer.__docgenInfo={description:"",displayName:"MultiScreenDrawer",props:{state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"any"}},dispatch:{defaultValue:null,description:"",name:"dispatch",required:!0,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rc-multi-player/src/Action/MultiScreenDrawer.tsx#MultiScreenDrawer"]={docgenInfo:MultiScreenDrawer.__docgenInfo,name:"MultiScreenDrawer",path:"packages/rc-multi-player/src/Action/MultiScreenDrawer.tsx#MultiScreenDrawer"})}catch(__react_docgen_typescript_loader_error){}const MultiScreenPlayerAction=props=>{const{state,dispatch,defaultSelectedScreen,multiScreenPlayerId}=props;return(0,jsx_runtime.jsx)(ActionColumn.Z,{right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[!1===defaultSelectedScreen||null===defaultSelectedScreen?null:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HideFullScreen.Z,{children:(0,jsx_runtime.jsx)(Action_LayoutButton,{state,dispatch})}),(0,jsx_runtime.jsx)(Divider.Z,{classes:{root:styles_module.Z.hr},orientation:"vertical",variant:"middle",flexItem:!0})]}),(0,jsx_runtime.jsx)(MultiScreenDrawerButton,{state,dispatch}),(0,jsx_runtime.jsx)(Divider.Z,{classes:{root:styles_module.Z.hr},orientation:"vertical",variant:"middle",flexItem:!0}),(0,jsx_runtime.jsx)(FullScreenButton.Z,{fullScreenId:multiScreenPlayerId})]})})};MultiScreenPlayerAction.displayName="MultiScreenPlayerAction";const Action_MultiScreenPlayerAction=MultiScreenPlayerAction;var ThemeProvider=__webpack_require__("./node_modules/.pnpm/@mui+system@5.10.17_nj4y2rcimqny27utrl764tjxdm/node_modules/@mui/system/esm/ThemeProvider/ThemeProvider.js"),Theme=__webpack_require__("./packages/rc-multi-player/src/Theme.ts");__webpack_require__("./packages/video-progress-bar/dist/index.js");const RcMultiScreenPlayer=(0,react.forwardRef)(((props,ref)=>{const{defaultSelectedScreen,defaultPlayerConfig,currentConfig,id,events,playType,style,className}=props,_id=id||"multi-screen-player",screenConfig=function ScreenConfig(id){return ScreenConfigHelper.id=id,ScreenConfigHelper}(_id),[state,dispatch]=(0,react.useReducer)(reducer,State,(currentState=>{const currentDefaultSelectedScreen=Number(screenConfig.getSelectedScreen()||defaultSelectedScreen||1),currentSelectedLayout=LayoutJson?.data?.filter((item=>item.key===`${currentDefaultSelectedScreen}`));return Object.assign({},currentState,{[MultiStoreEnum.selectedScreen]:currentDefaultSelectedScreen,[MultiStoreEnum.layout]:currentSelectedLayout[0]||{},[MultiStoreEnum.playerList]:new Array(currentDefaultSelectedScreen)?.fill(0)?.map((()=>({}))),[MultiStoreEnum.actionConfig]:screenConfig.getActionConfig(defaultPlayerConfig),[MultiStoreEnum.screenConfig]:screenConfig.getDefaultConfig(defaultPlayerConfig)})}));(0,react.useEffect)((()=>{if(currentConfig){const{playerConfig,mediaDataSource}=currentConfig;if(playerConfig&&mediaDataSource){const layoutIndex=state[MultiStoreEnum.selectedPlayer],playerList=state[MultiStoreEnum.playerList];if(dispatch({type:MultiStoreEnum.playerList,value:{index:playerConfig?.layoutIndex||layoutIndex,data:{mediaDataSource,playerConfig}}}),!playerConfig?.layoutIndex){const searchPlayer=index=>{for(let i=index;i<playerList.length;i++)if(!playerList[i]||(0,utils_esm.Qr$)(playerList[i]))return dispatch({type:MultiStoreEnum.selectedPlayer,value:`${i}`}),`${i}`};searchPlayer(+(playerConfig?.layoutIndex||layoutIndex)+1)||searchPlayer(0)}}}}),[currentConfig]);const getSelectedPlayerVideo=()=>{const selectedPlayerIndex=state[MultiStoreEnum.selectedPlayer],selectedPlayer=document.querySelector(`#${_id}`).querySelectorAll(".multi-screen-player-item")[Number(selectedPlayerIndex)];return selectedPlayer.querySelector("video")||selectedPlayer.querySelector("multi-player")?.video},videoProgressBar=()=>document.querySelector(`#${_id}-bar`),changeSpeed=data=>{if("replay"===playType&&videoProgressBar()?.changeSpeed(data),data["speed-value"]){const video=getSelectedPlayerVideo();video&&(video.playbackRate=Number(data["speed-value"]))}},fastForward=data=>{"replay"===playType&&videoProgressBar()?.fastForward(data)};return(0,react.useImperativeHandle)(ref,(()=>({getScreenConfig:()=>Object.assign({screenConfig:Object.assign({},state[MultiStoreEnum.screenConfig],ScreenConfigHelper.getConfig(),{selectedScreen:state[MultiStoreEnum.selectedScreen],selectedPlayer:state[MultiStoreEnum.selectedPlayer]})}),videoProgressBar,drawData(data){"replay"===playType&&videoProgressBar()?.drawData(data)},getSelectedPlayerVideo,changeSpeed,fastForward,getCurrentTime:()=>videoProgressBar()?.currentTime}))),(0,react.useEffect)((()=>{if("replay"===playType){const onTimeChange=e=>{events&&events.onTimeChange&&events.onTimeChange(e.detail)};videoProgressBar()?.addEventListener("timeChange",onTimeChange)}}),[]),(0,jsx_runtime.jsx)(ThemeProvider.Z,{theme:Theme.X,children:(0,jsx_runtime.jsxs)("div",{id:_id,style:Object.assign({height:"100%"},style),children:[(0,jsx_runtime.jsxs)("div",{style:"replay"===playType?{height:"calc(100% - 60px)"}:{},className:`${styles_module.Z.main} ${1==state[MultiStoreEnum.selectedScreen]?styles_module.Z.noScreen:""}`,children:[(0,jsx_runtime.jsx)(Action_MultiScreenPlayerAction,{multiScreenPlayerId:_id,defaultSelectedScreen,state,dispatch}),(0,jsx_runtime.jsx)(Layout_LayoutContent,{layoutKey:_id,events:{...events,onLoadStart:e=>{events.onLoadStart&&events.onLoadStart(e),"replay"===playType&&(videoProgressBar()?.drawData(e),changeSpeed(e),fastForward(e))},onReload:e=>{events.onReload&&events.onReload(e),"replay"===playType&&videoProgressBar()?.stop()}},state,dispatch}),(0,jsx_runtime.jsx)(Action_MultiScreenDrawer,{screenKey:_id,state,dispatch})]}),"replay"===playType?(0,jsx_runtime.jsx)("video-progress-bar",{id:`${_id}-bar`}):null]})})})),src_RcMultiScreenPlayer=RcMultiScreenPlayer;__webpack_require__("./packages/rc-multi-player/src/Player/WebRTCPlayer.tsx"),__webpack_require__("./packages/rc-multi-player/src/Player/RcFlvPlayer.tsx");var blocks_dist=__webpack_require__("./node_modules/.pnpm/@storybook+blocks@7.2.1_sfoxds7t5ydpegc3knd667wn6m/node_modules/@storybook/blocks/dist/index.mjs"),READMEraw=__webpack_require__("./packages/rc-multi-player/README.md?raw");const RcMultiScreenPlayer_stories={title:"Example/RcMultiScreenPlayer",component:src_RcMultiScreenPlayer,parameters:{layout:"centered",docs:{page:Story=>(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(blocks_dist.UG,{children:READMEraw})})}},tags:["autodocs"],argTypes:{}},props={args:{style:{height:400},currentConfig:{mediaDataSource:{url:"https://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv",type:"flv"},playerConfig:{protocol:"FLV",title:"xgplayer-demo-360p",extraParams:{test:1},layoutIndex:"0",robustness:{maxResetTimes:1,retryDuration:15e3}}}}};props.parameters={...props.parameters,docs:{...props.parameters?.docs,source:{originalSource:"{\n  args: {\n    style: {\n      height: 400\n    },\n    currentConfig: {\n      mediaDataSource: {\n        url: \"https://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv\",\n        type: 'flv'\n      },\n      playerConfig: {\n        protocol: \"FLV\",\n        title: 'xgplayer-demo-360p',\n        extraParams: {\n          test: 1\n        },\n        layoutIndex: '0',\n        robustness: {\n          maxResetTimes: 1,\n          retryDuration: 15000 // 15秒加载\n        }\n      }\n    }\n  }\n}",...props.parameters?.docs?.source}}};const __namedExportsOrder=["props"]},"./packages/video-progress-bar/dist/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{__webpack_require__("./packages/video-progress-bar/dist/video-progress-bar.cjs.production.min.js")},"./packages/video-progress-bar/dist/video-progress-bar.cjs.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{var e,t=__webpack_require__("./node_modules/.pnpm/@gaopeng123+utils@1.1.8/node_modules/@gaopeng123/utils/dist/utils.esm.js"),n=(e=__webpack_require__("./node_modules/.pnpm/flatpickr@4.6.13/node_modules/flatpickr/dist/esm/index.js"))&&"object"==typeof e&&"default"in e?e.default:e;__webpack_require__("./node_modules/.pnpm/flatpickr@4.6.13/node_modules/flatpickr/dist/flatpickr.css");var i=__webpack_require__("./node_modules/.pnpm/flatpickr@4.6.13/node_modules/flatpickr/dist/l10n/zh.js");function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key))?r:String(r),i)}var r}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return(u=d()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&c(r,n.prototype),r}).apply(null,arguments)}function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return u(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,e)})(e)}var f="#000000",p="#333333",g=function(e,t,n,i){void 0===i&&(i=!1),e&&e.addEventListener(t,n,i)},m=function(e,t,n,i){void 0===i&&(i=!1),e&&e.removeEventListener(t,n,i)},v={0:{n:"24h",v:864e5},1:{n:"12h",v:432e5},2:{n:"6h",v:216e5},3:{n:"1h",v:36e5},4:{n:"36m",v:216e4},5:{n:"24m",v:144e4},6:{n:"12m",v:72e4}},_=t.getTime(t.formatTimestamp(Date.now(),"yyyy-MM-dd")+" 00:00:00"),b=function(e){function n(){var n;return(n=e.call(this)||this).shadow=null,n.config={},n._wheelDelta=0,n.__dragStartEvent=null,n.__dragCurrentX=0,n.__dragX=0,n._onmousewheel=t.debounce((function(e){n.wheelDelta=e.wheelDelta>0?1:-1}),200,{notDebounce:function(e){e.preventDefault(),e.stopPropagation()}}),n.layerX=null,n.onAddClick=t.debounce((function(){n.wheelDelta=1}),50),n.onDelClick=t.debounce((function(){n.wheelDelta=-1}),50),n.__scaleLevel=v,n.__startTime=null,n.__endTime=null,n.defaultCurrentTime=_,n.protectCurrentTime=function(){return n.currentTime||n.defaultCurrentTime},n.__currentTime=null,n.drawData=function(e){n.initVideoOptions({periods:e.periods||[],currentTime:t.getTime(e.currentTime||_)}),n.draw(),n.start()},n.changeSpeed=function(e){n.__intervalSpeed=e["speed-value"]?Number(e["speed-value"]):n.__intervalSpeed,n.start()},n.fastForward=function(e){var t=e["forward-value"]?Number(e["forward-value"]):0;t&&(n.__periodsTime=t,n.start())},n.timeCalibration=function(){n.__dragCurrentX=-1e3*n.timelineWidth/n.scaleLevelV+(n.__dragCurrentX||0)},n.onResizeSubscribe=t.debounce((function(){n.__dragX=n.timelineWidth/n._canvas.offsetWidth*n.__dragX,n.setCanvasStyle(),n.draw()})),n.loadingState=function(e){"loading"===(null==e?void 0:e.status)&&(n.stop(),n.publish("loading",{type:!0}),setTimeout((function(){n.publish("loading",{type:!1})}),5e3))},n.setDateTimeFn=function(e,t){n.sendToOutside(e,t),n.loadingState(e)},n.setDateTime=t.debounce((function(e){n.setDateTimeFn(e)}),200,{notDebounce:function(e){n.initialize(e)}}),n.changeEvent=function(e){n.checkDatetime()&&(n.__dragCurrentX=(n.currentTime-new Date(n.datetime.value).getTime())*n.timelineWidth/n.scaleLevelV,n.dragStart(null),n.initialize({status:"loading"}),n.setDateTimeFn({status:"loading"},e.detail))},n.onchange=t.debounce((function(e){n.changeEvent(e),n.stop()})),n.publish=function(e,t){},n.checkDatetime=function(){return n.datetime.value},n.__pollingTimer=null,n.stop=function(){n.clearPollingTime()},n.__periodsTime=1,n.__intervalSpeed=1,n.scale=12,n.__periods=null,n.getSingleScheduleData=function(e,t){var i=n.timelineWidth/n.scaleLevelV;return{w:(t-e)*i,x:n.timelineWidth/2-(n.currentTime-e)*i}},n.shadow=n.attachShadow({mode:"open"}),n.shadow.innerHTML="\n        <style>\n             /*时间拖动区域*/\n            .timeline {\n                position: relative;\n                height: 60px;\n                line-height: 60px;\n                text-align: center;\n                background-color: #000000;\n                overflow: hidden;\n             }\n             /*拖拽样式*/\n            .timeline-drag {\n                position: absolute;\n                width: 100%;\n                height: 100%;\n            }\n           \n             .timeline-datetime-level {\n                position: absolute;\n                font-size: 12px;\n                bottom: 24px;\n                right: 0px;\n                height: 12px;\n                line-height: 12px;\n                border: 1px solid "+p+";\n                background-color: "+f+';\n                border-radius: 2px;\n                display: flex;\n                color: #ffffff;\n             }\n\n             .tbar {\n                 cursor: pointer;\n             }\n             .tbar:hover {\n                background-color: #a59999;\n             }\n\n             .disabled {\n                cursor: not-allowed;\n                background-color: #726c6c;\n             }\n\n             #levelValue {\n                width: 28px;\n                padding: 0px;\n             }\n\n            .disabled-input {\n                 height: 16px;\n                 width: 150px;\n                 top: 44px;\n                 position: absolute;\n                 left: calc(50% - 86px);\n            }\n            \n            .active {\n                text-align: center;\n                height: 60px;\n                -webkit-user-select: none; /* Safari */\n                user-select: none;\n            }\n        </style>\n       <div id="timeline" class="timeline">\n        <div class="timeline-drag">\n            <canvas id="timeline-drag-canvas"></canvas>\n        </div>\n        <div class="active">\n            <video-progress-bar-active-time></video-progress-bar-active-time>\n        </div>\n        \n        <div class="timeline-datetime-level">\n            <img id="del" class="tbar" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABVUlEQVQ4T6WTv0vWURSHn+cfKINMCoKmElzcWgUnx8BIGuxtylmUnNS20IqGpiZbmnRu6YcEDf4PipDIizpotrSdOHpvvL4m7ze6cLnD+dyHz7nnc+U/l533I+I6MAxcAi4DV4DUHAHHZR+oG/XeH0BELAILwIci/AEcFmGC+gr0LvBafZa1E0BEZPFQPePob90Vl6vAuNqugHHggXq/yZNExFNgU12rgBlgQJ1tCEh9qC8r4AWwry41BKSDfnWmAlaAdTXPfJPHwO0u2Lb6ttRbwIjaqoB3wJcOwBRwpwuwpb4pgAlgTH1UAa+AtrrcsIXJzIs6XQFzwNXsqSHgSYZMfV4BD4F7/zjGHfV9BWR8PwNDGY5eLiLiGzCvfuqMcsZ4FPieIwX2yk7eAHAt2wRuAl/VjP5plOuKiFvAYMn8jTLK1GwCu8BP4Jf68dxn6mX7ovpvr1CGEYQMEQkAAAAASUVORK5CYII=" />\n            <div id="levelValue">24h</div>\n            <img id="add" class="tbar" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABRUlEQVQ4T6WTvyvGURSHn6cMWFAGbCZZZFEMdiRlEpNSb2IyMbLpnWTwY38zK2VgsBODUkxvMsjkxz9wdXWvXl/0TW6d5d7Pfe45n3uO/HPZeD+EMAh0Ae0NESUvwFuKR/Uy3/sEhBDWgUXgKglfgWcgAG0pIngC2FCjng9ACKEbeFCbyipK2jrQqz5mwDhQUafLAOnBNeBaPc6AGWBYXSl4UoleqNXC/lL0RT3IgChsVbcKwg2gU10u7M8m8G4GrAJ36mFKcR7oA0aBFuAEuFf30vkYMKhuZkCs6bYBEDPqB0aAZuAMqKvbvwHi9zX/sYQOdSdnMAcM/WBiNDeauP+DiW9qLQMmgYU/fuONepQBQ0BNjcaVrhBCDaiq18VWHgDOUyvHNm5s5Y40H1PA6ZdWzk+GECKgp2SYntSLb8NUmvcvgndf85gRc9c+xwAAAABJRU5ErkJggg==" />\n        </div>\n       </div>\n    ',n.init(),n}s(n,e);var i=n.prototype;return i.init=function(){},i.zoomStart=function(){this.draw()},i.dragStart=function(e){this.draw(),this.setCurrentTime()},i._onmousedown=function(e){this.__dragStartEvent=e,e&&this.stop()},i._onmouseup=function(e){this.__dragStartEvent&&this.setDateTime({status:"loading"}),e&&this.__dragStartEvent&&this.start(),this.__dragStartEvent=null,this.__dragX+=this.__dragCurrentX,this.__dragCurrentX=null,this.endTime=this.currentTime,this.datetime.canClick()},i._onmousemove=function(e){this.__dragStartEvent&&(this.__dragCurrentX=e.offsetX-this.__dragStartEvent.offsetX,this.dragStart(null),this.datetime.canNotClick())},i.addEvent=function(){g(this._canvas,"mousewheel",this._onmousewheel.bind(this)),g(this._canvas,"mousedown",this._onmousedown.bind(this)),g(this._canvas,"mousemove",this._onmousemove.bind(this)),g(this._canvas,"mouseout",this._onmouseup.bind(this)),g(this._canvas,"mouseup",this._onmouseup.bind(this)),g(this.shadow.querySelector("#add"),"click",this.onAddClick.bind(this)),g(this.shadow.querySelector("#del"),"click",this.onDelClick.bind(this)),g(this.datetime,"change",this.onchange.bind(this)),g(window,"resize",this.onResizeSubscribe.bind(this))},i.removeEvent=function(){m(this._canvas,"mousewheel",this._onmousewheel),m(this._canvas,"mousedown",this._onmousedown),m(this._canvas,"mousemove",this._onmousemove),m(this._canvas,"mouseout",this._onmouseup),m(this._canvas,"mouseup",this._onmouseup),m(this.shadow.querySelector("#add"),"click",this.onAddClick),m(this.shadow.querySelector("#del"),"click",this.onDelClick),m(this.datetime,"change",this.onchange.bind(this)),m(window,"resize",this.onResizeSubscribe.bind(this))},i.afterConnectedFn=function(){this.setCanvasStyle(),this.startTime=this.defaultCurrentTime,this.initialize({status:"loading"}),this.setLevelValue(),this.draw()},i.connectedCallback=function(){this.addEvent(),this.afterConnectedCallback()},i.afterConnectedCallback=function(){var e=this;this.afterConnectedFn(),setTimeout((function(){e.sendToOutside({status:"loading"})}))},i.disconnectedCallback=function(){this.stop()},i.setCanvasStyle=function(){this._canvas.style.width=this.timelineWidth+"px",this._canvas.style.height="60px",this._canvas.width=this.timelineWidth,this._canvas.height=60},i._setTBarClass=function(e,t){this.scaleLevelN===t?(e.classList.add("disabled"),e.classList.remove("tbar")):e.classList.contains("tbar")||(e.classList.add("tbar"),e.classList.remove("disabled"))},i.setLevelValue=function(){var e=this.shadow.querySelector("#add"),t=this.shadow.querySelector("#del"),n=this.shadow.querySelector("#levelValue");this._setTBarClass(e,"12m"),this._setTBarClass(t,"24h"),n.innerText=this.scaleLevelN},i.setCurrentTime=function(){this.currentTime=(this.endTime||this.startTime)-parseInt(""+this.__dragCurrentX/this.timelineWidth*this.scaleLevelV)},i.publishTimeline=function(e){this.dispatchEvent(new CustomEvent("timeChange",{detail:e}))},i.sendToOutside=function(e,n){if("loading"===(null==e?void 0:e.status)){var i=this.protectCurrentTime();this.publishTimeline(Object.assign({action:"drag",isInPeriods:this.checkCurrentTimeInPeriods(i),timestamp:i,date:t.formatTimestamp(i),"speed-value":this.datetime.speed},n))}},i.initVideoOptions=function(e){this.__periods=null==e?void 0:e.periods,this.defaultCurrentTime=t.getTime(e.currentTime);var n=(null==e?void 0:e.currentTime)!==this.startTime?{status:"reset"}:null;this.startTime=e.currentTime,this.initialize(n)},i.onSplitScreenChangeSubscribe=function(e){var t=e.data,n=t.value,i=t.videoOptions;this.reset(),this.startTime=this.defaultCurrentTime,this.initialize(null),n&&(this.reset(),this.startTime=null==n?void 0:n.currentPlayTime(),this.initVideoOptions(i),this.draw(),this.start())},i.setTime=function(e){this.datetime.setAttribute("time-value",t.formatTimestamp(e))},i.initialize=function(e){this.startTime&&(this.currentTime="reset"===(null==e?void 0:e.status)?this.startTime:this.currentTime||this.startTime,this.setTime(this.currentTime),"reset"===(null==e?void 0:e.status)&&(e.status="loading"))},i.resetSubscribe=function(e){"timeline"===e.data.type&&this.reset()},i.reset=function(){this.stop(),this.__dragStartEvent=null,this.__dragCurrentX=0,this.__dragX=0,this._wheelDelta=0,this.currentTime=null,this.startTime=null,this.endTime=null,this.__periods=null,this.setDateTime({status:"reset"}),this.setLevelValue()},i.timelineSubscribe=function(e){var t=e.data,n=t.value;if("needle"===t.type)switch(n){case"start":this.start();break;case"stop":this.stop();break;case"restart":this.sendToOutside({status:"loading"});break;default:console.log("needle的type: "+n)}},i.clearPollingTime=function(){clearInterval(this.__pollingTimer)},i.checkPeriods=function(){var e;if(null!=(e=this.__periods)&&e.length)for(var t=new Date(this.currentTime).getTime(),n=0;n<(null==(i=this.__periods)?void 0:i.length);n++){var i,r=this.__periods[n].__end,a=this.__periods[n+1];if(a&&t>r&&t<=a.__start){this.__periodsTime=(a.__start-r)/1e3;break}}},i.checkCurrentTimeInPeriods=function(e){var t;if(null!=(t=this.__periods)&&t.length)for(var n=0;n<(null==(i=this.__periods)?void 0:i.length);n++){var i,r=this.__periods[n];if(e>=r.__start&&e<=r.__end)return!0}return!1},i.pollingTimeRun=function(){var e=this;this.__pollingTimer=setInterval((function(){e._onmousedown(null),e.checkPeriods(),e.__dragCurrentX=-1e3*e.__periodsTime*e.timelineWidth/e.scaleLevelV+(e.__dragCurrentX||0),e.__periodsTime=1,e.dragStart(null),e.setDateTime({status:"polling"}),e._onmouseup(null)}),1e3/this.__intervalSpeed)},i.start=function(){this.clearPollingTime(),this.pollingTimeRun()},i.draw=function(){this.clearCanvas(),this.drawScale(),this.drawDispatch(),this.drawSchedule()},i.clearCanvas=function(){this._context.clearRect(0,0,this.timelineWidth,60)},i.drawLine=function(e,t,n,i,r,a){void 0===a&&(a=1),this._context.save(),this._context.beginPath(),this._context.moveTo(e,t),this._context.lineTo(n,i),this._context.strokeStyle=r,this._context.lineWidth=a,this._context.stroke(),this._context.closePath(),this._context.restore()},i.drawText=function(e,t,n,i,r,a){void 0===r&&(r=12),this._context.save(),this._context.textAlign="center",this._context.font=r+"px Arial",this._context.fillStyle=i,this._context.fillText(e,t,n,24),this._context.restore()},i.drawScale=function(){var e=this;this.drawLine(0,0,this.timelineWidth,0,"#f7ff2f"),this.scaleData.forEach((function(t,n){var i=t.time,r=t.x;e.drawLine(r,0,r,9,"#fffdd9"),e.drawText(i,r,21,"#ffffff")}))},i.drawDispatch=function(){var e=this.timelineWidth/2;this.drawLine(e,2,e,this._canvas.offsetHeight,"#2bff3c",2),this.drawLine(e,2,e+4,8,"#2bff3c",2),this.drawLine(e,2,e-4,8,"#2bff3c",2)},i.drawSchedule=function(){var e,t=this;null!==this.__periods&&(null==(e=this.scheduleData)||e.forEach((function(e){t.drawSingleSchedule(e)})))},i.drawSingleSchedule=function(e){var t=e.w,n=e.x;this._context.save(),this._context.fillStyle="rgba(174,218,255,.7)",this._context.fillRect(n,22,t,15),this._context.restore()},a(n,[{key:"_canvas",get:function(){return this.shadow.querySelector("#timeline-drag-canvas")}},{key:"_context",get:function(){return this._canvas.getContext("2d")}},{key:"datetime",get:function(){return this.shadow.querySelector("video-progress-bar-active-time")}},{key:"wheelDelta",get:function(){return this._wheelDelta},set:function(e){var t=this.wheelDelta,n=this._wheelDelta+e;n>=0&&n<Object.keys(this.__scaleLevel).length&&(this._wheelDelta+=e),t!==this.wheelDelta&&(this.__dragCurrentX=this.diffZoomLevelValue,this.zoomStart(),this.setLevelValue(),this.__dragX+=this.__dragCurrentX),this.__dragCurrentX=0}},{key:"timeline",get:function(){return this.shadow.querySelector("#timeline")}},{key:"timelineWidth",get:function(){return this.timeline.offsetWidth}},{key:"scaleLevelV",get:function(){return this.scaleLevel.v}},{key:"scaleLevelN",get:function(){return this.scaleLevel.n}},{key:"scaleLevel",get:function(){return this.__scaleLevel[this.wheelDelta]}},{key:"diffZoomLevelValue",get:function(){return this.timelineWidth*(this.startTime-this.currentTime)/this.scaleLevelV-this.__dragX}},{key:"scaleData",get:function(){var e=this,n=this.scale/2,i=this.scaleLevelV/this.scale,r=this.timelineWidth/this.scale,a=this.__dragCurrentX+this.__dragX;return new Array(this.scale+1).fill("00:00").map((function(o,s){return{time:""+t.formatTimestamp(e.startTime+(s-n-parseInt(""+a/r))*i,"HH:mm"),x:s*r+(a||0)%r}}))}},{key:"startTime",get:function(){return this.__startTime},set:function(e){this.__startTime=e}},{key:"endTime",get:function(){return this.__endTime},set:function(e){this.__endTime=e}},{key:"currentTime",get:function(){return this.__currentTime},set:function(e){this.__currentTime=e}},{key:"scheduleData",get:function(){var e,n=this,i=[];return null==(e=this.__periods)||e.forEach((function(e){var r=t.getTime(e.startTime),a=t.getTime(e.endTime);i.push(Object.assign({_startTime:r,_endTime:a},n.getSingleScheduleData(r,a),e))})),i}}]),n}(h(HTMLElement));customElements.get("video-progress-bar")||customElements.define("video-progress-bar",b);var w=function(e){function t(){var t;return(t=e.call(this)||this).shadow=null,t.__config={options:[]},t.onChange=function(e){t.dispatchEvent(new CustomEvent("onChange",{detail:{value:e.target.value}}))},t.shadow=t.attachShadow({mode:"open"}),t.shadow.innerHTML=t.createTemplate(),t}s(t,e);var n=t.prototype;return n.connectedCallback=function(){this.select.addEventListener("change",this.onChange)},n.disconnectedCallback=function(){this.select.removeEventListener("change",this.onChange)},n.attributeChangedCallback=function(e,t,n){t!==n&&(this.__config[e]=JSON.parse(n)),this.renderOption()},n.renderOption=function(){this.select.innerHTML=this.getOption()},n.getOption=function(){var e=this.__config["default-value"];return this.__config.options.map((function(t){return"<option "+(t.value==e?"selected":"")+' value="'+t.value+'">'+t.label+"</option>"})).join("")},n.createTemplate=function(){return'\n            <style>\n                .dropdown {\n                    display: inline-block;\n                    position: relative;\n                    overflow: hidden;\n                    height: 20px;\n                    width: 60px;\n                    background: #f2f2f2;\n                    border: 1px solid;\n                    border-color: white #f7f7f7 whitesmoke;\n                    border-radius: 3px;\n                    background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.06));\n                    background-image: -moz-linear-gradient(top, transparent, rgba(0, 0, 0, 0.06));\n                    background-image: -o-linear-gradient(top, transparent, rgba(0, 0, 0, 0.06));\n                    background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.06));\n                    -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.08);\n                    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.08);\n                    -webkit-user-select: none; /* Safari */\n                    user-select: none;\n                }\n                \n                .dropdown:before, .dropdown:after {\n                    content: \'\';\n                    position: absolute;\n                    z-index: 2;\n                    top: 4px;\n                    right: 10px;\n                    width: 0;\n                    height: 0;\n                    border: 4px dashed;\n                    border-color: #888888 transparent;\n                    pointer-events: none;\n                }\n                \n                .dropdown:before {\n                    border-bottom-style: solid;\n                    border-top: none;\n                }\n                \n                .dropdown:after {\n                    margin-top: 7px;\n                    border-top-style: solid;\n                    border-bottom: none;\n                }\n                \n                .dropdown-select {\n                    position: relative;\n                    width: 100%;\n                    margin: 0;\n                    padding: 0px 4px 0px 4px;\n                    height: 20px;\n                    line-height: 14px;\n                    font-size: 12px;\n                    color: #ffffff;\n                    text-shadow: 0 1px white;\n                    background: #333333; /* Fallback for IE 8 */\n                    background: #333333 !important; /* "transparent" doesn\'t work with Opera */\n                    border: 0;\n                    border-radius: 0;\n                    -webkit-appearance: none;\n                    top: -22px;\n                }\n                \n                .dropdown-select:focus {\n                    z-index: 3;\n                    width: 100%;\n                    color: #394349;\n                    outline: 2px solid #49aff2;\n                    outline: 2px solid -webkit-focus-ring-color;\n                    outline-offset: -2px;\n                }\n                \n                .dropdown-select > option {\n                    margin: 3px;\n                    padding: 6px 8px;\n                    text-shadow: none;\n                    background: #f2f2f2;\n                    border-radius: 3px;\n                    cursor: pointer;\n                }\n                \n                /* Fix for IE 8 putting the arrows behind the select element. */\n                \n                .lt-ie9 .dropdown {\n                    z-index: 1;\n                }\n                \n                .lt-ie9 .dropdown-select {\n                    z-index: -1;\n                }\n                \n                .lt-ie9 .dropdown-select:focus {\n                    z-index: 3;\n                }\n                \n                /* Dirty fix for Firefox adding padding where it shouldn\'t. */\n                \n                @-moz-document url-prefix() {\n                    .dropdown-select {\n                        padding-left: 6px;\n                    }\n                }\n                \n                .dropdown-dark {\n                    background: #444;\n                    border-color: #111111 #0a0a0a black;\n                    background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));\n                    background-image: -moz-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));\n                    background-image: -o-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));\n                    background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.4));\n                    -webkit-box-shadow: inset 0 1px rgba(255, 255, 255, 0.1), 0 1px 1px rgba(0, 0, 0, 0.2);\n                    box-shadow: inset 0 1px rgba(255, 255, 255, 0.1), 0 1px 1px rgba(0, 0, 0, 0.2);\n                }\n                \n                .dropdown-dark:before {\n                    border-bottom-color: #aaa;\n                }\n                \n                .dropdown-dark:after {\n                    border-top-color: #aaa;\n                }\n                \n                .dropdown-dark .dropdown-select {\n                    color: #aaa;\n                    text-shadow: 0 1px black;\n                    background: #444;  /* Fallback for IE 8 */\n                    -webkit-user-select: none;\n                    user-select: none;\n                }\n                \n                .dropdown-dark .dropdown-select:focus {\n                    color: #ccc;\n                }\n                \n                .dropdown-dark .dropdown-select > option {\n                    background: #444;\n                    text-shadow: 0 1px rgba(0, 0, 0, 0.4);\n                }\n            </style>\n            <div class="dropdown dropdown-dark">\n            <select name="two" class="dropdown-select">\n              '+this.getOption()+"\n            </select>\n          </div>\n        "},a(t,[{key:"select",get:function(){return this.shadow.querySelector(".dropdown-select")}}],[{key:"observedAttributes",get:function(){return["options","default-value"]}}]),t}(h(HTMLElement));customElements.get("video-progress-bar-forward-select")||customElements.define("video-progress-bar-forward-select",w);var x=[{label:"30s",value:"30"},{label:"1分钟",value:"60"},{label:"5分钟",value:"300"}],T=[{label:"1/4x",value:"0.25"},{label:"1/2x",value:"0.5"},{label:"正常",value:"1"},{label:"2x",value:"2"},{label:"4x",value:"4"}],k=function(e){function r(){var t;return(t=e.call(this)||this).shadow=null,t.__config={"time-value":"","forward-value":"60","speed-value":"1"},t.__oldConfig={"time-value":"","forward-value":"60","speed-value":"1"},t.onSpeedChange=function(e){t.__config["speed-value"]=Number(e.detail.value),t.onChange("speed-value")},t.onForwardChange=function(e){t.__config["forward-value"]=Number(e.detail.value)},t.onBackwardClick=function(){t.onChange("forward-value",{forwardValue:1e3*-Number(t.__config["forward-value"])})},t.onForwardClick=function(){t.onChange("forward-value",{forwardValue:1e3*Number(t.__config["forward-value"])})},t.canNotClick=function(){t.time.classList.add("disabled")},t.canClick=function(){t.time.classList.remove("disabled")},t.__flatpickr=null,t.shadow=t.attachShadow({mode:"open"}),t.shadow.innerHTML=t.createTemplate(),t}s(r,e);var l=r.prototype;return l.onChange=function(e,t){this.dispatchEvent(new CustomEvent("change",{detail:o({currentType:e},this.__config,t||{})}))},l.connectedCallback=function(){this.initFlatpickr(),this.shadow.querySelector("#speed").addEventListener("onChange",this.onSpeedChange),this.shadow.querySelector("#forward").addEventListener("onChange",this.onForwardChange),this.shadow.querySelector("#bth-backward").addEventListener("click",this.onBackwardClick),this.shadow.querySelector("#bth-forward").addEventListener("click",this.onForwardClick)},l.disconnectedCallback=function(){this.shadow.querySelector("#speed").removeEventListener("onChange",this.onSpeedChange),this.shadow.querySelector("#forward").removeEventListener("onChange",this.onForwardChange),this.shadow.querySelector("#bth-backward").removeEventListener("click",this.onBackwardClick),this.shadow.querySelector("#bth-forward").removeEventListener("click",this.onForwardClick)},l.attributeChangedCallback=function(e,t,n){t!==n&&(this.__config[e]=n),this.setAllValue()},l.setTimeValue=function(){var e=this.__config["time-value"];this.datetime.value=e,this.setFlatpickrVal(e)},l.setAllValue=function(){this.setTimeValue()},l.initFlatpickr=function(){var e=this;this.__flatpickr=n(this.datetime,{dateFormat:"Y-m-d H:i:S",locale:i.Mandarin,time_24hr:!0,onClose:function(n){var i=t.formatTimestamp(n[0]);e.__oldConfig["time-value"]!=i?(e.__config["time-value"]=i,e.onChange("time-value")):e.value=e.__config["time-value"]},onOpen:function(){e.__oldConfig["time-value"]=e.__config["time-value"]}})},l.setFlatpickrVal=function(e){this.__flatpickr&&!this.__flatpickr.isOpen&&this.__flatpickr.setDate(e)},l.createTemplate=function(){return"\n            <style>\n            /*时间弹窗*/\n            .timeline-datetime {\n                height: 18px !important;\n                border: 1px solid "+p+";\n                background-color: "+f+';\n                color: #fff;\n                border-radius: 2px;\n                width: 130px;\n                position: relative;\n                 -webkit-user-select: none; /* Safari */\n                user-select: none;\n            }\n\n             .time img {\n                cursor: pointer;\n                margin: 0px 8px;\n                z-index: 1;\n                height: 16px;\n                 -webkit-user-select: none; /* Safari */\n                user-select: none;\n            }\n            \n            .time img:hover {\n                background-color: #333333;\n            }\n            \n            .time {\n                height: 22px;\n                padding-top: 38px;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                color: #ffffff;\n                -webkit-user-select: none; /* Safari */\n                user-select: none;\n              \n            }\n            \n            .disabled {\n                pointer-events: none;\n            }\n            \n            video-progress-bar-forward-select {\n                position: relative;\n                top: -24.5px;\n                height: 0px;\n            }\n            </style>\n             <div class="time">\n                <div style="width: 60px"></div>\n                <video-progress-bar-forward-select id="speed" default-value="1" options='+JSON.stringify(T)+"></video-progress-bar-forward-select>\n                <input id=\"datetime\"  class=\"flatpickr timeline-datetime\" data-enable-time=\"true\" data-enable-seconds=\"true\" >\n                <img id=\"bth-backward\"  title=\"快退\" src=\"data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg t='1688386636990' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='3457' width='24' height='24' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath d='M512 512a53.44 53.44 0 0 0 17.4 39.413333l362.666667 330.6a52.833333 52.833333 0 0 0 35.713333 14 53.84 53.84 0 0 0 21.76-4.666666 52.666667 52.666667 0 0 0 31.793333-48.793334V181.406667A53.333333 53.333333 0 0 0 892.073333 142l-362.666666 330.6A53.44 53.44 0 0 0 512 512zM60.086667 472.586667l362.666666-330.6A53.333333 53.333333 0 0 1 512 181.406667v661.186666a52.666667 52.666667 0 0 1-31.793333 48.793334 53.84 53.84 0 0 1-21.76 4.666666 52.833333 52.833333 0 0 1-35.713334-14l-362.666666-330.6a53.333333 53.333333 0 0 1 0-78.826666z' fill='%235C5C66' p-id='3458'%3e%3c/path%3e%3c/svg%3e\" />\n                <video-progress-bar-forward-select id=\"forward\" default-value=\"60\" options="+JSON.stringify(x)+"></video-progress-bar-forward-select>\n                <img id=\"bth-forward\" title=\"快进\" src=\"data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3c!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg t='1688386783324' class='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='4663' width='24' height='24' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath d='M512 512a53.44 53.44 0 0 1-17.4 39.413333L131.933333 882a52.833333 52.833333 0 0 1-35.713333 14 53.84 53.84 0 0 1-21.76-4.666667A52.666667 52.666667 0 0 1 42.666667 842.593333V181.406667A53.333333 53.333333 0 0 1 131.926667 142l362.666666 330.6A53.44 53.44 0 0 1 512 512z m451.933333-39.413333L601.26 142A53.333333 53.333333 0 0 0 512 181.406667v661.186666a52.666667 52.666667 0 0 0 31.793333 48.793334 53.84 53.84 0 0 0 21.76 4.666666 52.833333 52.833333 0 0 0 35.713334-14l362.666666-330.6a53.333333 53.333333 0 0 0 0-78.826666z' fill='%235C5C66' p-id='4664'%3e%3c/path%3e%3c/svg%3e\" />\n            </div>\n        "},a(r,[{key:"value",get:function(){return this.__config["time-value"]},set:function(e){this.__config["time-value"]=e,this.setTimeValue()}},{key:"speed",get:function(){return Number(this.__config["speed-value"])}},{key:"datetime",get:function(){return this.shadow.querySelector("#datetime")}},{key:"time",get:function(){return this.shadow.querySelector(".time")}}],[{key:"observedAttributes",get:function(){return["time-value","forward-value","speed-value"]}}]),r}(h(HTMLElement));customElements.get("video-progress-bar-active-time")||customElements.define("video-progress-bar-active-time",k);var y=function(e){return t.getTime(e)},C=function(e,t){var n,i=t.startKey,r=t.endKey;return(n={}).__start=y(e[i]),n.__end=y(e[r]),n.startTime=e[i],n.endTime=e[r],n}}}]);